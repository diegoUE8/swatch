/*! AgoraRTC|BUILD v3.0.2-0-geb536be */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("AgoraRTC",[],t):"object"==typeof exports?exports.AgoraRTC=t():e.AgoraRTC=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=36)}([function(e,t,n){"use strict";n.r(t);var r=n(9),i=n.n(r),o=n(10),a=n(3),s=n(2),u=0,c="free",l=[],d=[],p=0;setInterval((function(){Object(a.getParameter)("UPLOAD_LOG")&&f.info("console log upload")}),9e5);var f=function(){var e,t,n,r,f,h,g="https://".concat(Object(a.getParameter)("LOG_UPLOAD_SERVER"),"/upload/v1"),m=["DEBUG","INFO","WARNING","ERROR","NONE"],v=0,y=function e(t){c="uploading",setTimeout((function(){!function(e,t,n){var r;Array.isArray(e)||(e=[e]),e=e.map((function(e){return{log_item_id:u++,log_level:e.log_level,payload_str:e.payload}})),r={sdk_version:a.VERSION,process_id:Object(s.a)(),payload:JSON.stringify(e)};try{Object(o.post)(g,r,(function(e){"OK"===e?t&&t():n&&n()}),(function(e){n&&n()}),{withCredentials:!0})}catch(e){n&&n()}}(t,(function(){p=0,0!==l.length?(d=l.length<10?l.splice(0,l.length):l.splice(0,10),e(d)):c="free"}),(function(){setTimeout((function(){e(d)}),p++<2?200:1e4)}))}),3e3)};t=function(){for(var t=[0],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)},n=function(){for(var t=[1],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)},r=function(){for(var t=[2],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)},f=function(){for(var t=[3],n=0;n<arguments.length;n++)t.push(arguments[n]);e.apply(this,t)};var _={};return h=function(e){_[e]||(r.apply(void 0,arguments),_[e]=!0)},{DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4,enableLogUpload:function(){Object(a.setParameter)("UPLOAD_LOG",!0)},disableLogUpload:function(){Object(a.setParameter)("UPLOAD_LOG",!1)},setProxyServer:function(e){g=e?"https://".concat(e,"/ls/?h=").concat(Object(a.getParameter)("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(Object(a.getParameter)("LOG_UPLOAD_SERVER"),"/upload/v1")},setLogLevel:function(e){e>4?e=4:e<0&&(e=0),v=e},log:e=function(){var e,t=arguments[0],n=arguments;if(n[0]=(e=new Date).toTimeString().split(" ")[0]+":"+e.getMilliseconds()+" Agora-SDK ["+(m[t]||"DEFAULT")+"]:",function(e,t){if(Object(a.getParameter)("UPLOAD_LOG"))try{t=Array.prototype.slice.call(t);var n="";t.forEach((function(e){"object"===i()(e)&&(e=JSON.stringify(e)),n=n+e+" "})),l.push({payload:n,log_level:e}),"free"===c&&(d=l.length<10?l.splice(0,l.length):l.splice(0,10),y(d))}catch(e){}}(t,n),!(t<v))switch(t){case 0:case 1:console.log.apply(console,n);break;case 2:console.warn.apply(console,n);break;case 3:console.error.apply(console,n);break;default:return void console.log.apply(console,n)}},debug:t,info:n,warning:r,deprecate:h,error:f}}();t.default=f},function(e,t,n){"use strict";n.r(t),n.d(t,"checkValidObject",(function(){return a})),n.d(t,"checkValidString",(function(){return s})),n.d(t,"checkValidNumber",(function(){return u})),n.d(t,"checkValidFloatNumber",(function(){return c})),n.d(t,"checkValidBoolean",(function(){return l})),n.d(t,"checkValidEnum",(function(){return o})),n.d(t,"isValidString",(function(){return d})),n.d(t,"isValidNumber",(function(){return p})),n.d(t,"isValidBoolean",(function(){return h})),n.d(t,"isASCII",(function(){return v})),n.d(t,"isInteger",(function(){return y})),n.d(t,"isNumber",(function(){return _})),n.d(t,"isString",(function(){return b})),n.d(t,"isArray",(function(){return S})),n.d(t,"isEmpty",(function(){return E})),n.d(t,"isValidToken",(function(){return g})),n.d(t,"isValidChannelName",(function(){return m}));var r=n(9),i=n.n(r),o=function(e,t,n){for(var r=0;r<n.length;r++)if(e===n[r])return!0;throw new Error("".concat(t," can only be set as ").concat(JSON.stringify(n)))},a=function(e,t){if(!e)throw new Error("Invalid param: ".concat(t||"param"," cannot be empty"));if("object"!==i()(e))throw new Error("".concat(t||"This paramter"," is of the object type"));return!0},s=function(e,t,n,r,i){if(E(n)&&(n=1),r=r||255,E(i)&&(i=!0),E(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!d(e,n,r,i))throw new Error("Invalid ".concat(t||"string param",": Length of the string: [").concat(n,",").concat(r,"].").concat(i?" ASCII characters only.":""))},u=function(e,t,n,r){if(E(n)&&(n=1),r=r||1e4,E(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!p(e,n,r))throw new Error("Invalid ".concat(t||"number param",": The value range is [").concat(n,",").concat(r,"]. integer only"))},c=function(e,t,n,r){if(null==e)throw new Error("".concat(t||"param"," cannot be null"));if(E(n)&&(n=0),r=r||1e4,E(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!f(e,n,r))throw new Error("Invalid ".concat(t||"number param",": The value range is [").concat(n,",").concat(r,"]."))},l=function(e,t){if(E(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!h(e))throw new Error("Invalid ".concat(t||"boolean param",": The value is of the boolean type."))},d=function(e,t,n,r){return t||(t=0),n||(n=Number.MAX_SAFE_INTEGER),E(r)&&(r=!0),b(e)&&(!r||v(e))&&e.length>=t&&e.length<=n},p=function(e,t,n){return y(e)&&e>=t&&e<=n},f=function(e,t,n){return _(e)&&e>=t&&e<=n},h=function(e){return"boolean"==typeof e},g=function(e){return d(e,1,2047)},m=function(e){return b(e)&&/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e)},v=function(e){if("string"==typeof e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(n<0||n>255)return!1}return!0}},y=function(e){return"number"==typeof e&&e%1==0},_=function(e){return"number"==typeof e},b=function(e){return"string"==typeof e},S=function(e){return e instanceof Array},E=function(e){return null==e}},function(e,t,n){"use strict";var r=n(14),i=n.n(r),o=n(6),a=n.n(o),s=n(3),u=n(0),c=n(10),l=n(16),d=n.n(l);n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return h}));var p={eventType:null,sid:null,lts:null,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0},f=null,h=function(){return f||(f="process-"+d()(),u.default.info("processId: "+f)),f},g=function(){var e={list:{}};e.url=Object(c.shouldUseHttps)()?"https://".concat(Object(s.getParameter)("EVENT_REPORT_DOMAIN"),":6443/events/message"):"http://".concat(Object(s.getParameter)("EVENT_REPORT_DOMAIN"),":6080/events/message"),e.urlBackup=Object(c.shouldUseHttps)()?"https://".concat(Object(s.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),":6443/events/message"):"http://".concat(Object(s.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),":6080/events/message"),e.setProxyServer=function(t){t?(e.url=Object(c.shouldUseHttps)()?"https://".concat(t,"/rs/?h=").concat(Object(s.getParameter)("EVENT_REPORT_DOMAIN"),"&p=6443&d=events/message"):"http://".concat(t,"/rs/?h=").concat(Object(s.getParameter)("EVENT_REPORT_DOMAIN"),"&p=6080&d=events/message"),e.urlBackup=Object(c.shouldUseHttps)()?"https://".concat(t,"/rs/?h=").concat(Object(s.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),"&p=6443&d=events/message"):"http://".concat(t,"/rs/?h=").concat(Object(s.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),"&p=6080&d=events/message"),u.default.debug("reportProxyServerURL: ".concat(e.url)),u.default.debug("reportProxyServerBackupURL: ".concat(e.urlBackup))):(e.url=Object(c.shouldUseHttps)()?"https://".concat(Object(s.getParameter)("EVENT_REPORT_DOMAIN"),":6443/events/message"):"http://".concat(Object(s.getParameter)("EVENT_REPORT_DOMAIN"),":6080/events/message"),e.urlBackup=Object(c.shouldUseHttps)()?"https://".concat(Object(s.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),":6443/events/message"):"http://".concat(Object(s.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),":6080/events/message"))},e.sessionInit=function(t,n){var r=a()({},p);r.startTime=+new Date,r.sid=t,r.cname=n.cname,e.list[t]=r;var i=a()({},{willUploadConsoleLog:Object(s.getParameter)("UPLOAD_LOG")},n.extend),o=a()({},r);o.eventType="session_init",o.appid=n.appid,o.browser=navigator.userAgent,o.build=s.BUILD,o.lts=+new Date,o.elapse=o.lts-o.startTime,o.extend=JSON.stringify(i),o.mode=n.mode,o.process=h(),o.success=n.succ,o.version=s.VERSION,delete o.startTime,e.send({type:"io.agora.pb.Wrtc.Session",data:o}),e._flushInvokeReport(t)},e.joinChooseServer=function(t,n,r){if(e.list[t]){n.uid&&(e.list[t].uid=parseInt(n.uid)),n.cid&&(e.list[t].cid=parseInt(n.cid));var i=a()({},e.list[t]);i.eventType="join_choose_server";var o=n.lts;i.lts=Date.now(),i.eventElapse=i.lts-o,i.chooseServerAddr=n.csAddr,i.errorCode=n.ec,i.elapse=i.lts-i.startTime,i.success=n.succ,i.chooseServerAddrList=JSON.stringify(n.serverList),delete i.startTime,e.send({type:"io.agora.pb.Wrtc.JoinChooseServer",data:i})}},e.reqUserAccount=function(t,n){n.vid&&(e.list[t].vid=n.vid);var r=a()({},e.list[t]),i=n.lts;r.eventType="req_user_account",r.lts=Date.now(),r.success=n.success,r.serverAddress=n.serverAddress,r.stringUid=n.stringUid,r.uid=n.uid,r.errorCode=n.errorCode,r.elapse=r.lts-r.startTime,r.eventElapse=r.lts-i,r.extend="string"==typeof n.extend?n.extend:JSON.stringify(n.extend),delete r.startTime,e.send({type:"io.agora.pb.Wrtc.ReqUserAccount",data:r})},e.joinGateway=function(t,n){n.vid&&(e.list[t].vid=n.vid);var r=a()({},e.list[t]),i=n.lts;r.eventType="join_gateway",r.lts=Date.now(),r.gatewayAddr=n.addr,r.success=n.succ,r.errorCode=n.ec,r.elapse=r.lts-r.startTime,r.eventElapse=r.lts-i,delete r.startTime,e.send({type:"io.agora.pb.Wrtc.JoinGateway",data:r})},e.publish=function(t,n){var r=a()({},e.list[t]);r.eventType="publish";var i=n.lts;r.lts=Date.now(),r.eventElapse=r.lts-i,r.elapse=r.lts-r.startTime,r.success=n.succ,r.errorCode=n.ec,n.videoName&&(r.videoName=n.videoName),n.audioName&&(r.audioName=n.audioName),n.screenName&&(r.screenName=n.screenName),delete r.startTime,e.send({type:"io.agora.pb.Wrtc.Publish",data:r}),e._flushInvokeReport(t)},e.subscribe=function(t,n){var r=a()({},e.list[t]);r.eventType="subscribe";var i=n.lts;r.lts=Date.now(),r.eventElapse=r.lts-i,r.elapse=r.lts-r.startTime,r.errorCode=n.ec,r.success=n.succ,isFinite(n.peerid)?r.peer=n.peerid:r.peerSuid=""+n.peerid,"boolean"==typeof n.video&&(r.video=n.video),"boolean"==typeof n.audio&&(r.audio=n.audio),delete r.startTime,e.send({type:"io.agora.pb.Wrtc.Subscribe",data:r}),e._flushInvokeReport(t)},e.firstRemoteFrame=function(t,n){var r=a()({},e.list[t]);r.eventType="first_remote_frame";var i=n.lts;r.lts=Date.now(),r.eventElapse=r.lts-i,r.elapse=r.lts-r.startTime,r.width=n.width,r.height=n.height,r.success=n.succ,r.errorCode=n.ec,isFinite(n.peerid)?r.peer=n.peerid:r.peerSuid=""+n.peerid,delete r.startTime,e.send({type:"io.agora.pb.Wrtc.FirstFrame",data:r})},e.streamSwitch=function(t,n){var r=a()({},e.list[t]);r.eventType="stream_switch",r.lts=Date.now(),r.isDual=n.isdual,r.elapse=r.lts-r.startTime,r.success=r.succ,delete r.startTime,e.send({type:"io.agora.pb.Wrtc.StreamSwitch",data:r})},e.audioSendingStopped=function(t,n){var r=a()({},e.list[t]);r.eventType="audio_sending_stopped",r.lts=Date.now(),r.elapse=r.lts-r.startTime,r.reason=n.reason,r.success=n.succ,delete r.startTime,e.send({type:"io.agora.pb.Wrtc.AudioSendingStopped",data:r})},e.videoSendingStopped=function(t,n){var r=a()({},e.list[t]);r.eventType="video_sending_stopped",r.lts=Date.now(),r.elapse=r.lts-r.startTime,r.reson=n.reason,r.success=n.succ,delete r.startTime,e.send({type:"io.agora.pb.Wrtc.VideoSendingStopped",data:r})},e.requestProxyAppCenter=function(t,n){var r=a()({},e.list[t]),i=n.lts;r.eventType="request_proxy_appcenter",r.lts=Date.now(),r.eventElapse=r.lts-i,r.elapse=r.lts-r.startTime,r.extend=n.extend+"",r.APAddr=n.APAddr,r.workerManagerList=n.workerManagerList,r.response=n.response,r.errorCode=n.ec,r.success=n.succ,delete r.startTime,e.send({type:"io.agora.pb.Wrtc.RequestProxyAppCenter",data:r})},e.requestProxyWorkerManager=function(t,n){var r=a()({},e.list[t]),i=n.lts;r.eventType="request_proxy_worker_manager",r.lts=Date.now(),r.eventElapse=r.lts-i,r.elapse=r.lts-r.startTime,r.extend=n.extend,r.workerManagerAddr=n.workerManagerAddr,r.response=n.response,r.errorCode=n.ec,r.success=n.succ,delete r.startTime,e.send({type:"io.agora.pb.Wrtc.RequestProxyWorkerManager",data:r})};var t=0;return e.reportApiInvoke=function(e,n){var r=n.tag,o=n.name,a=n.getStates,c=n.options,l=n.timeout,d=void 0===l?6e4:l,p=n.callback,f=n.reportResult,h=void 0===f||f,m=Date.now(),v=0,y=t++,_=function(){return i()({tag:r,invokeId:y,sid:e,name:o,apiInvokeTime:m,options:c},a&&{states:(t=a(),Object.keys(t).reduce((function(e,n){var r=e;return null!=t[n]&&(r[n]=t[n]),r}),{}))});var t},b=!!Object(s.getParameter)("SHOW_REPORT_INVOKER_LOG");b&&u.default.info("".concat(o," start"));var S=setTimeout((function(){g._sendApiInvoke(i()({},_(),{error:"API_INVOKE_TIMEOUT",success:!1}))}),d);return function(e,t){if(clearTimeout(S),++v>1&&(e="EXECUTOR_INVOKE_".concat(v)),e)return g._sendApiInvoke(i()({},_(),{success:!1,error:e},a&&{states:a()})),b&&u.default.info("".concat(o," onFailure"),e),p&&p(e);g._sendApiInvoke(i()({},_(),{success:!0},h&&{result:t},a&&{states:a()})),b&&u.default.info("".concat(o," onSuccess")),p&&p(null,t)}},e._cachedItems=[],e._cacheInvokeReport=function(t){t.lts||(t.lts=Date.now()),e._cachedItems.push(t),e._cachedItems.length>50&&e._cachedItems.shift()},e._flushInvokeReport=function(t){if(e._cachedItems.length){var n=e._cachedItems;e._cachedItems=[],u.default.debug("Flush cached event reporting:",n.length),n.forEach((function(n,r){n.sid=t,setTimeout((function(){e._sendApiInvoke(n)}),5e3+500*r)}))}},e._sendApiInvoke=function(t){var n=t.tag,r=t.invokeId,o=t.sid,a=t.name,u=t.result,c=t.states,l=t.options,d=t.error,p=t.success,f=t.apiInvokeTime,h=t.lts,g=Object(s.getParameter)("NOT_REPORT_EVENT");if(!(n&&g instanceof Array&&-1!==g.indexOf(n)))if(e.list[o]){var m=e.list[o],v=m.startTime,y=m.cname,_=m.uid,b=m.cid,S=(h=h||Date.now())-v,E=h-f,w="";if(l)try{w=JSON.stringify(l)}catch(e){w=l.toString()}var I=i()({invokeId:r,sid:o,cname:y,cid:b,lts:h,uid:_,success:p,elapse:S,apiName:a,execElapse:E},void 0!==l&&{options:w},void 0!==c&&{execStates:JSON.stringify(c)},void 0!==d&&{errorCode:JSON.stringify(d)},void 0!==u&&{execResult:JSON.stringify(u)});e.send({type:"io.agora.pb.Wrtc.ApiInvoke",data:I})}else e._cacheInvokeReport(arguments[0])},e._send=function(t){try{var n=[];t&&t.data&&t.data.apiName?n.push(["apiName",""+t.data.apiName]):t&&t.data&&t.data.eventType&&n.push(["eventType",t.data.eventType]);var r=n.map((function(e){return"".concat(e[0],"=").concat(encodeURIComponent(e[1]))})).join("&"),i=-1===e.url.indexOf("?")?"".concat(e.url,"?").concat(r):e.url;Object(c.post)(i,t,null,(function(n){var i=-1===e.urlBackup.indexOf("?")?"".concat(e.urlBackup,"?").concat(r):e.urlBackup;Object(c.post)(i,t,null,(function(e){}),{timeout:1e4})}),{timeout:1e4})}catch(e){}},e.sendCache=[],e.sendTimer=null,e.send=function(t){if(t.data){var n=t.data;e._lastLts&&e._lastLts>=n.lts&&(n.lts=e._lastLts+1),e._lastLts=n.lts}if(e.sendCache.push(t),null===e.sendTimer)return function t(){e.sendTimer=setTimeout((function(){if(0!==e.sendCache.length)return e._send(e.sendCache.shift()),t();e.sendTimer=null}),Object(s.getParameter)("EVENT_REPORT_SEND_INTERVAL"))}()},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BUILD="v3.0.2-0-geb536be",t.VERSION="3.0.2",t.SUPPORT_RESOLUTION_LIST={"90p_1":[160,90,null,null,null,null],"120p_1":[160,120,15,15,30,65],"120p_3":[120,120,15,15,30,50],"120p_4":[212,120,null,null,null,null],"180p_1":[320,180,15,15,30,140],"180p_3":[180,180,15,15,30,100],"180p_4":[240,180,15,15,30,120],"240p_1":[320,240,15,15,40,200],"240p_3":[240,240,15,15,40,140],"240p_4":[424,240,15,15,40,220],"360p_1":[640,360,15,15,80,400],"360p_3":[360,360,15,15,80,260],"360p_4":[640,360,30,30,80,600],"360p_6":[360,360,30,30,80,400],"360p_7":[480,360,15,15,80,320],"360p_8":[480,360,30,30,80,490],"360p_9":[640,360,15,15,80,800],"360p_10":[640,360,24,24,80,800],"360p_11":[640,360,24,24,80,1e3],"480p_1":[640,480,15,15,100,500,1,5],"480p_2":[640,480,30,30,100,1e3,25,30],"480p_3":[480,480,15,15,100,400],"480p_4":[640,480,30,30,100,750],"480p_6":[480,480,30,30,100,600],"480p_8":[848,480,15,15,100,610],"480p_9":[848,480,30,30,100,930],"480p_10":[640,480,10,10,100,400],"720p_1":[1280,720,15,15,120,1130,1,5],"720p_2":[1280,720,30,30,120,2e3,25,30],"720p_3":[1280,720,30,30,120,1710],"720p_5":[960,720,15,15,120,910],"720p_6":[960,720,30,30,120,1380],"1080p_1":[1920,1080,15,15,120,2080,1,5],"1080p_2":[1920,1080,30,30,120,3e3,25,30],"1080p_3":[1920,1080,30,30,120,3150],"1080p_5":[1920,1080,60,60,120,4780],"1440p_1":[2560,1440,30,30,120,4850],"1440p_2":[2560,1440,60,60,120,7350],"4k_1":[3840,2160,30,30,120,8910],"4k_3":[3840,2160,60,60,120,13500]},t.AUDIO_PROFILE_SETTINGS={speech_low_quality:[!1,!1,!0,!0],speech_standard:[!1,!1,!0,!1],music_standard:[!1,!1,!1,!1],standard_stereo:[!1,!0,!1,!1],high_quality:[!0,!1,!1,!1],high_quality_stereo:[!0,!0,!1,!1],default:[!1,!1,!1,!1]};var r={WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-ap-web-2.agoraio.cn"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-ap-web-4.agoraio.cn"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-2.agoraio.cn","cds-ap-web-3.agora.io","cds-ap-web-4.agoraio.cn"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-2.agoraio.cn","sua-ap-web-3.agora.io","sua-ap-web-4.agoraio.cn"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-2.agoraio.cn","uap-ap-web-3.agora.io","uap-ap-web-4.agoraio.cn"],ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"webcollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"webcollector-2.agoraio.cn",WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,LIVESTREAMING_ALIGN:!0,HTTP_CONNECT_TIMEOUT:5e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_TIMEOUT:1e4,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,REPORT_STATS:!0,REPORT_STATS_TIMEOUT:3e3,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],FILEPATH_LENMAX:255,SUBSCRIBE_TCC:!1,PING_PONG_TIME_OUT:10,DUALSTREAM_OPERATION_CHECK:!0,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:1e3,MEDIA_ELEMENT_EXISTS_DEPTH:3,CANDIDATE_TIMEOUT:2e3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,TICKET_RENEW_TIMEOUT:828e5,SHOW_REPORT_INVOKER_LOG:!1,STATS_FILTER:{transportId:!0,googTrackId:!0},FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,FORCE_CHANGED_GATEWAY_FLAG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",CHROME_NEW_STATS:!1,AP_BACKOFF_MAX_TIME:8};t.setParameter=function(e,t){return void 0!==r[e]&&(r[e]=t,!0)},t.getParameter=function(e){return void 0!==r[e]?r[e]:null}},function(e,t,n){"use strict";n.r(t),n.d(t,"APErrorCode",(function(){return r})),n.d(t,"GatewayErrorCode",(function(){return i})),n.d(t,"StringUidErrorCode",(function(){return o})),n.d(t,"JOIN_GS_TRYNEXT_LIST",(function(){return a})),n.d(t,"JOIN_CS_RETRY_LIST",(function(){return s})),n.d(t,"INJECT_STREAM_STATUS",(function(){return u}));var r={101100:"NO_FLAG_SET",101101:"FLAG_SET_BUT_EMPTY",101102:"INVALID_FALG_SET",101203:"NO_SERVICE_AVIABLE",0:"OK_CODE",5:"INVALID_VENDOR_KEY",7:"INVALID_CHANNEL_NAME",8:"INTERNAL_ERROR",9:"NO_AUTHORIZED",10:"DYNAMIC_KEY_TIMEOUT",11:"NO_ACTIVE_STATUS",13:"DYNAMIC_KEY_EXPIRED",14:"STATIC_USE_DYANMIC_KEY",15:"DYNAMIC_USE_STATIC_KEY",1010100:"NO_FLAG_SET",1010101:"FLAG_SET_BUT_EMPTY",1010102:"INVALID_FALG_SET",1010200:"NO_SERVICE_AVAILABLE",1010203:"NO_SERVICE_AVAILABLE_WEBRTC",1010205:"NO_SERVICE_AVAILABLE_DISPATCHER",1010208:"NO_SERVICE_AVAILABLE_APPCENTER",1010211:"NO_SERVICE_AVAILABLE_SUA",2010005:"INVALID_VENDOR_KEY",2010007:"INVALID_CHANNEL_NAME",2010008:"INTERNAL_ERROR",2010009:"NO_AUTHORIZED",2010010:"DYNAMIC_KEY_TIMEOUT",2010011:"NO_ACTIVE_STATUS",2010013:"DYNAMIC_KEY_EXPIRED",2010014:"STATIC_USE_DYANMIC_KEY",2010015:"DYNAMIC_USE_STATIC_KEY"},i={2e3:"ERR_NO_VOCS_AVAILABLE",2001:"ERR_NO_VOS_AVAILABLE",2002:"ERR_JOIN_CHANNEL_TIMEOUT",2003:"WARN_REPEAT_JOIN",2004:"ERR_JOIN_BY_MULTI_IP",2011:"ERR_NOT_JOINED",2012:"WARN_REPEAT_JOIN",2013:"ERR_INVALID_VENDOR_KEY",2014:"ERR_INVALID_CHANNEL_NAME",2015:"ERR_INVALID_STRINGUID",2016:"ERR_TOO_MANY_USERS",2017:"ERR_SET_CLIENT_ROLE_TIMEOUT",2018:"ERR_SET_CLIENT_ROLE_NO_PERMISSION",2019:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",2020:"ERR_PUBLISH_REQUEST_INVALID",2021:"ERR_SUBSCRIBE_REQUEST_INVALID",2022:"ERR_NOT_SUPPORTED_MESSAGE",2023:"ERR_ILLEAGAL_PLUGIN",101:"ERR_INVALID_VENDOR_KEY",102:"ERR_INVALID_CHANNEL_NAME",103:"WARN_NO_AVAILABLE_CHANNEL",104:"WARN_LOOKUP_CHANNEL_TIMEOUT",105:"WARN_LOOKUP_CHANNEL_REJECTED",106:"WARN_OPEN_CHANNEL_TIMEOUT",107:"WARN_OPEN_CHANNEL_REJECTED",108:"WARN_REQUEST_DEFERRED",109:"ERR_DYNAMIC_KEY_TIMEOUT",110:"ERR_NO_AUTHORIZED",111:"ERR_VOM_SERVICE_UNAVAILABLE",112:"ERR_NO_CHANNEL_AVAILABLE_CODE",113:"ERR_TOO_MANY_USERS",114:"ERR_MASTER_VOCS_UNAVAILABLE",115:"ERR_INTERNAL_ERROR",116:"ERR_NO_ACTIVE_STATUS",117:"ERR_INVALID_UID",118:"ERR_DYNAMIC_KEY_EXPIRED",119:"ERR_STATIC_USE_DYANMIC_KE",120:"ERR_DYNAMIC_USE_STATIC_KE",2:"K_TIMESTAMP_EXPIRED",3:"K_CHANNEL_PERMISSION_INVALID",4:"K_CERTIFICATE_INVALID",5:"K_CHANNEL_NAME_EMPTY",6:"K_CHANNEL_NOT_FOUND",7:"K_TICKET_INVALID",8:"K_CHANNEL_CONFLICTED",9:"K_SERVICE_NOT_READY",10:"K_SERVICE_TOO_HEAVY",14:"K_UID_BANNED",15:"K_IP_BANNED",16:"K_CHANNEL_BANNED"},o={1:"ERROR_ILLEAGAL_APPID",2:"ERROR_ILLEAGAL_UID",3:"INTERNAL_SERVER_ERROR"},a=["ERR_NO_VOCS_AVAILABLE","ERR_NO_VOS_AVAILABLE","ERR_JOIN_CHANNEL_TIMEOUT","WARN_LOOKUP_CHANNEL_TIMEOUT","WARN_OPEN_CHANNEL_TIMEOUT","ERR_VOM_SERVICE_UNAVAILABLE","ERR_TOO_MANY_USERS","ERR_MASTER_VOCS_UNAVAILABLE","ERR_INTERNAL_ERROR"],s=["NO_FLAG_SET","NO_SERVICE_AVIABLE","FLAG_SET_BUT_EMPTY","EMPTY_ADDRESS_RESPONSE"],u={INJECT_STREAM_STATUS_START_SUCCESS:0,INJECT_STREAM_STATUS_START_ALREADY_EXISTS:1,INJECT_STREAM_STATUS_START_UNAUTHORIZED:2,INJECT_STREAM_STATUS_START_TIMEDOUT:3,INJECT_STREAM_STATUS_START_FAILED:4,INJECT_STREAM_STATUS_STOP_SUCCESS:5,INJECT_STREAM_STATUS_STOP_NOT_FOUND:6,INJECT_STREAM_STATUS_STOP_UNAUTHORIZED:7,INJECT_STREAM_STATUS_STOP_TIMEDOUT:8,INJECT_STREAM_STATUS_STOP_FAILED:9,INJECT_STREAM_STATUS_BROKEN:10};t.default={FAILED:"FAILED",INVALID_KEY:"INVALID_KEY",INVALID_CLIENT_MODE:"INVALID_CLIENT_MODE",INVALID_CLIENT_CODEC:"INVALID_CLIENT_CODEC",CLIENT_MODE_CODEC_MISMATCH:"CLIENT_MODE_CODEC_MISMATCH",WEB_API_NOT_SUPPORTED:"WEB_API_NOT_SUPPORTED",INVALID_PARAMETER:"INVALID_PARAMETER",NO_TRACK_IN_STREAM:"NO_TRACK_IN_STREAM",INVALID_OPERATION:"INVALID_OPERATION",INVALID_LOCAL_STREAM:"INVALID_LOCAL_STREAM",INVALID_REMOTE_STREAM:"INVALID_REMOTE_STREAM",INVALID_DYNAMIC_KEY:"INVALID_DYNAMIC_KEY",DYNAMIC_KEY_TIMEOUT:"DYNAMIC_KEY_TIMEOUT",NO_VOCS_AVAILABLE:"NO_VOCS_AVAILABLE",NO_VOS_AVAILABLE:"ERR_NO_VOS_AVAILABLE",JOIN_CHANNEL_TIMEOUT:"ERR_JOIN_CHANNEL_TIMEOUT",NO_AVAILABLE_CHANNEL:"NO_AVAILABLE_CHANNEL",LOOKUP_CHANNEL_TIMEOUT:"LOOKUP_CHANNEL_TIMEOUT",LOOKUP_CHANNEL_REJECTED:"LOOKUP_CHANNEL_REJECTED",OPEN_CHANNEL_TIMEOUT:"OPEN_CHANNEL_TIMEOUT",OPEN_CHANNEL_REJECTED:"OPEN_CHANNEL_REJECTED",REQUEST_DEFERRED:"REQUEST_DEFERRED",STREAM_ALREADY_PUBLISHED:"STREAM_ALREADY_PUBLISHED",STREAM_NOT_YET_PUBLISHED:"STREAM_NOT_YET_PUBLISHED",JOIN_TOO_FREQUENT:"JOIN_TOO_FREQUENT",SOCKET_ERROR:"SOCKET_ERROR",SOCKET_DISCONNECTED:"SOCKET_DISCONNECTED",PEERCONNECTION_FAILED:"PEERCONNECTION_FAILED",CONNECT_GATEWAY_ERROR:"CONNECT_GATEWAY_ERROR",SERVICE_NOT_AVAILABLE:"SERVICE_NOT_AVAILABLE",JOIN_CHANNEL_FAILED:"JOIN_CHANNEL_FAILED",PUBLISH_STREAM_FAILED:"PUBLISH_STREAM_FAILED",UNPUBLISH_STREAM_FAILED:"UNPUBLISH_STREAM_FAILED",SUBSCRIBE_STREAM_FAILED:"SUBSCRIBE_STREAM_FAILED",UNSUBSCRIBE_STREAM_FAILED:"UNSUBSCRIBE_STREAM_FAILED",NO_SUCH_REMOTE_STREAM:"NO_SUCH_REMOTE_STREAM",ERR_FAILED:"1",ERR_INVALID_VENDOR_KEY:"101",ERR_INVALID_CHANNEL_NAME:"102",WARN_NO_AVAILABLE_CHANNEL:"103",WARN_LOOKUP_CHANNEL_TIMEOUT:"104",WARN_LOOKUP_CHANNEL_REJECTED:"105",WARN_OPEN_CHANNEL_TIMEOUT:"106",WARN_OPEN_CHANNEL_REJECTED:"107",WARN_REQUEST_DEFERRED:"108",ERR_DYNAMIC_KEY_TIMEOUT:"109",ERR_INVALID_DYNAMIC_KEY:"110",ERR_NO_VOCS_AVAILABLE:"2000",ERR_NO_VOS_AVAILABLE:"2001",ERR_JOIN_CHANNEL_TIMEOUT:"2002",IOS_NOT_SUPPORT:"IOS_NOT_SUPPORT",WECHAT_NOT_SUPPORT:"WECHAT_NOT_SUPPORT",SHARING_SCREEN_NOT_SUPPORT:"SHARING_SCREEN_NOT_SUPPORT",STILL_ON_PUBLISHING:"STILL_ON_PUBLISHING",LOW_STREAM_ALREADY_PUBLISHED:"LOW_STREAM_ALREADY_PUBLISHED",LOW_STREAM_NOT_YET_PUBLISHED:"LOW_STREAM_ALREADY_PUBLISHED",HIGH_STREAM_NOT_VIDEO_TRACE:"HIGH_STREAM_NOT_VIDEO_TRACE",NOT_FIND_DEVICE_BY_LABEL:"NOT_FIND_DEVICE_BY_LABEL",ENABLE_DUALSTREAM_FAILED:"ENABLE_DUALSTREAM_FAILED",DISABLE_DUALSTREAM_FAILED:"DISABLE_DUALSTREAM_FAILED",PLAYER_NOT_FOUND:"PLAYER_NOT_FOUND",ELECTRON_NOT_SUPPORT_SHARING_SCREEN:"ELECTRON_NOT_SUPPORT_SHARING_SCREEN",BAD_ENVIRONMENT:"BAD_ENVIRONMENT",LOAD_AUDIO_FAILED:"LOAD_AUDIO_FAILED"}},function(e,t,n){"use strict";n.r(t),n.d(t,"getBrowserInfo",(function(){return y})),n.d(t,"getBrowserVersion",(function(){return p})),n.d(t,"getBrowserOS",(function(){return f})),n.d(t,"isChrome",(function(){return r})),n.d(t,"isSafari",(function(){return i})),n.d(t,"isFireFox",(function(){return a})),n.d(t,"isOpera",(function(){return s})),n.d(t,"isEdge",(function(){return o})),n.d(t,"isQQBrowser",(function(){return u})),n.d(t,"isWeChatBrowser",(function(){return c})),n.d(t,"isLegacyChrome",(function(){return g})),n.d(t,"isSupportedPC",(function(){return l})),n.d(t,"isSupportedMobile",(function(){return d})),n.d(t,"getChromeKernelVersion",(function(){return v})),n.d(t,"isChromeKernel",(function(){return h}));var r=function(){var e=y();return e.name&&"Chrome"===e.name},i=function(){var e=y();return e.name&&"Safari"===e.name},o=function(){var e=y();return e.name&&"Edge"===e.name},a=function(){var e=y();return e.name&&"Firefox"===e.name},s=function(){var e=y();return e.name&&"OPR"===e.name},u=function(){var e=y();return e.name&&"QQBrowser"===e.name},c=function(){var e=y();return e.name&&"MicroMessenger"===e.name},l=function(){var e=f();return"Linux"===e||"Mac OS X"===e||"Mac OS"===e||-1!==e.indexOf("Windows")},d=function(){var e=f();return"Android"===e||"iOS"===e},p=function(){return y().version},f=function(){return y().os},h=function(){return!!navigator.userAgent.match(/chrome\/[\d]./i)};function g(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}var m,v=function(){var e=navigator.userAgent.match(/chrome\/[\d]./i);return e&&e[0]&&e[0].split("/")[1]},y=(m=function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];"Chrome"===n[1]&&null!=(e=t.match(/(OPR(?=\/))\/?(\d+)/i))&&(n=e),"Safari"===n[1]&&null!=(e=t.match(/version\/(\d+)/i))&&(n[2]=e[1]),~t.toLowerCase().indexOf("qqbrowser")&&null!=(e=t.match(/(qqbrowser(?=\/))\/?(\d+)/i))&&(n=e),~t.toLowerCase().indexOf("micromessenger")&&null!=(e=t.match(/(micromessenger(?=\/))\/?(\d+)/i))&&(n=e),~t.toLowerCase().indexOf("edge")&&null!=(e=t.match(/(edge(?=\/))\/?(\d+)/i))&&(n=e),~t.toLowerCase().indexOf("trident")&&null!=(e=/\brv[ :]+(\d+)/g.exec(t)||[])&&(n=[null,"IE",e[1]]);var r=void 0,i=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var o in i){var a=i[o];if(a.r.test(navigator.userAgent)){r=a.s;break}}return{name:n[1],version:n[2],os:r}}(),function(){return m})},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t,n){e.exports=n(26)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n(32)),c=n(3),l=s(n(0)),d=n(1),p=n(10),f=n(11),h=function(e){function t(t,n){var r=e.call(this)||this;return r._state=_.RELAY_STATE_IDLE,r._onStatus=function(e){l.default.debug("["+r.clientId+"] ChannelMediaStatus: "+JSON.stringify(e)),e&&e.command&&("onAudioPacketReceived"===e.command&&r.emit("event",y.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===e.command&&r.emit("event",y.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===e.command&&(r._state=_.RELAY_STATE_FAILURE,r.emit("state",_.RELAY_STATE_FAILURE,b.SRC_TOKEN_EXPIRED)),"onDestTokenPrivilegeDidExpire"===e.command&&(r._state=_.RELAY_STATE_FAILURE,r.emit("state",_.RELAY_STATE_FAILURE,b.DEST_TOKEN_EXPIRED,e.channelName?{came:e.channelName}:null)))},r._onClose=function(){return o(r,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:if(l.default.debug("["+this.clientId+"] ChannelMediaSocket onClose"),this.emit("event",y.NETWORK_DISCONNECTED),this.state=_.RELAY_STATE_IDLE,!this._prevChannelMediaConfig)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startChannelMediaRelay(this._prevChannelMediaConfig)];case 2:return t.sent(),[3,4];case 3:return(e=t.sent())instanceof E&&(e.message===m.WS_ABORT||e.message===m.AP_REQUEST_ABORT)?[2]:(this.emit("state",_.RELAY_STATE_FAILURE,b.SERVER_CONNECTION_LOST),[3,4]);case 4:return[2]}}))}))},r.token=t.appId,r.appId=t.appId,r.cname=t.cname,r.uid=t.uid,r.sid=t.sid,r.clientId=n,r}return i(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){var t=this._state;this._state=e,t!==e&&this.emit("state",e)},enumerable:!0,configurable:!0}),t.prototype.startChannelMediaRelay=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:if(this.state!==_.RELAY_STATE_IDLE)throw new E(m.BAD_STATE);return this.state=_.RELAY_STATE_CONNECTING,[4,this._connect()];case 1:return t.sent(),l.default.debug("["+this.clientId+"] startChannelMediaRelay: connect success"),[4,this._sendStartRelayMessage(e)];case 2:return t.sent(),this._prevChannelMediaConfig=e,[2]}}))}))},t.prototype.updateChannelMediaRelay=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:if(this.state!==_.RELAY_STATE_RUNNING)throw new E(m.BAD_STATE);return[4,this._sendUpdateMessage(e)];case 1:return t.sent(),this._prevChannelMediaConfig=e,[2]}}))}))},t.prototype.stopChannelMediaRelay=function(){return o(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this._sendStopRelayMessage()];case 1:return e.sent(),l.default.debug("["+this.clientId+"] stopChannelMediaRelay: send stop message success"),this.state=_.RELAY_STATE_IDLE,this.dispose(),[2]}}))}))},t.prototype.dispose=function(){l.default.debug("["+this.clientId+"] disposeChannelMediaRelay"),this.state=_.RELAY_STATE_IDLE,this.emit("dispose"),this._signal&&this._signal.dispose(),this._prevChannelMediaConfig=null,this.removeEvent()},t.prototype._requestOneAP=function(e){var t=this;return new Promise((function(n,r){var i={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:"",ts:+new Date,version:c.VERSION,cname:t.cname,uid:t.uid+"",seq:1,requestId:1},o={service_name:"tele_channel",json_body:JSON.stringify(i)},a="https://"+e;p.post(a,o,(function(e){var t=null,i=null;try{t=JSON.parse(e)}catch(e){r(new E(m.AP_JSON_PARSE_ERROR,e))}0!==t.code&&r(new E(m.AP_REQUEST_ERROR,t));try{i=JSON.parse(t.json_body)}catch(e){r(new E(m.AP_JSON_PARSE_ERROR,e))}200!==i.code&&r(new E(m.AP_REQUEST_ERROR,i)),i.servers?n(i.servers):r(new E(m.AP_JSON_PARSE_ERROR,i))}),(function(e){return r(e)}),{"X-Packet-Service-Type":0,"X-Packet-URI":61})}))},t.prototype._requestAP=function(){var e=this,t=c.getParameter("UAP_AP");return new Promise((function(n,r){setTimeout((function(){r(new E(m.AP_REQUEST_TIMEOUT))}),3e3),e.on("dispose",(function(){r(new E(m.AP_REQUEST_ABORT))})),t.forEach((function(t){t+="/api/v1",e._requestOneAP(t).then((function(r){l.default.debug("["+e.clientId+"] startChannelMediaRelay request AP "+t+" success: "+JSON.stringify(r));var i=r[0],o="wss://"+i.address.replace(/\./g,"-")+".edge.agora.io:"+i.wss;n(o)})).catch((function(n){l.default.debug("["+e.clientId+"] startChannelMediaRelay request AP "+t+" failed: "+JSON.stringify(n))}))}))}))},t.prototype._connectWebsocket=function(e){return this._signal=new S(this.appId,this.cname,this.uid,this.sid),this._signal.connect(e)},t.prototype._connect=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,this._requestAP()];case 1:return e=t.sent(),[4,this._connectWebsocket(e)];case 2:return t.sent(),this._signal.on("close",this._onClose.bind(this)),this._signal.on("status",this._onStatus.bind(this)),this.emit("event",y.NETWORK_CONNECTED),[2]}}))}))},t.prototype._sendStartRelayMessage=function(e){return o(this,void 0,void 0,(function(){var t,n,r,i,o,s;return a(this,(function(a){switch(a.label){case 0:return this._checkSignal(),t=this._genMessage(v.StopPacketTransfer),[4,this._signal.request(t)];case 1:return a.sent(),[4,this._signal.waitStatus("Normal Quit")];case 2:return a.sent(),l.default.debug("["+this.clientId+"] startChannelMediaRelay: StopPacketTransfer success"),n=this._genMessage(v.SetSdkProfile,e),[4,this._signal.request(n)];case 3:return a.sent(),l.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSdkProfile success"),r=this._genMessage(v.SetSourceChannel,e),[4,this._signal.request(r)];case 4:return a.sent(),[4,this._signal.waitStatus("SetSourceChannelStatus")];case 5:return a.sent(),this.emit("event",y.PACKET_JOINED_SRC_CHANNEL),l.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSourceChannel success"),i=this._genMessage(v.SetSourceUserId,e),[4,this._signal.request(i)];case 6:return a.sent(),l.default.debug("["+this.clientId+"] startChannelMediaRelay: SetSourceUserId success"),o=this._genMessage(v.SetDestChannel,e),[4,this._signal.request(o)];case 7:return a.sent(),[4,this._signal.waitStatus("SetDestChannelStatus")];case 8:return a.sent(),this.emit("event",y.PACKET_JOINED_DEST_CHANNEL),l.default.debug("["+this.clientId+"] startChannelMediaRelay: SetDestChannel success"),s=this._genMessage(v.StartPacketTransfer,e),[4,this._signal.request(s)];case 9:return a.sent(),this.emit("event",y.PACKET_SENT_TO_DEST_CHANNEL),this.state=_.RELAY_STATE_RUNNING,l.default.debug("["+this.clientId+"] startChannelMediaRelay: StartPacketTransfer success"),[2]}}))}))},t.prototype._sendReconnectMessage=function(e){return o(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return this._checkSignal(),t=this._genMessage(v.Reconnect,e),[4,this._signal.request(t)];case 1:return n.sent(),[2]}}))}))},t.prototype._sendUpdateMessage=function(e){return o(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return this._checkSignal(),t=this._genMessage(v.UpdateDestChannel,e),[4,this._signal.request(t)];case 1:return n.sent(),this.emit("event",y.PACKET_UPDATE_DEST_CHANNEL),l.default.debug("["+this.clientId+"] sendUpdateMessage: UpdateDestChannel success"),[2]}}))}))},t.prototype._sendStopRelayMessage=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return this._checkSignal(),e=this._genMessage(v.StopPacketTransfer),[4,this._signal.request(e)];case 1:return t.sent(),l.default.debug("["+this.clientId+"] sendStopRelayMessage: StopPacketTransfer success"),[2]}}))}))},t.prototype._genMessage=function(e,t){var n=this,r=[],i=[],o=[],a={appId:this.appId,cname:this.cname,uid:this.uid+"",sdkVersion:c.VERSION,sid:this.sid,ts:+new Date,requestId:0,seq:0,allocate:!0,clientRequest:{}},s=null;switch(e){case v.SetSdkProfile:return a.clientRequest={command:"SetSdkProfile",type:"multi_channel"},a;case v.SetSourceChannel:return s=t.getSrcChannelMediaInfo(),a.clientRequest={command:"SetSourceChannel",uid:s.uid+"",channelName:s.channelName,token:s.token||this.appId},a;case v.SetSourceUserId:return s=t.getSrcChannelMediaInfo(),a.clientRequest={command:"SetSourceUserId",uid:this.uid+""},a;case v.SetDestChannel:return t.getDestChannelMediaInfos().forEach((function(e){r.push(e.channelName),i.push(e.uid+""),o.push(e.token||n.appId)})),a.clientRequest={command:"SetDestChannel",channelName:r,uid:i,token:o},a;case v.StartPacketTransfer:return a.clientRequest={command:"StartPacketTransfer"},a;case v.Reconnect:return a.clientRequest={command:"Reconnect"},a;case v.StopPacketTransfer:return a.clientRequest={command:"StopPacketTransfer"},a;case v.UpdateDestChannel:return t.getDestChannelMediaInfos().forEach((function(e){r.push(e.channelName),i.push(e.uid+""),o.push(e.token||n.appId)})),a.clientRequest={command:"UpdateDestChannel",channelName:r,uid:i,token:o},a}},t.prototype._checkSignal=function(){if(!this._signal||!this._signal.isConnect())throw new E(m.WS_DISCONNECTED)},t}(u.default);t.default=h;var g=function(){function e(){this.destChannelMediaInfos=new Map}return e.prototype.setSrcChannelInfo=function(e){d.checkValidObject(e,"srcInfo");var t=e.uid,n=e.channelName,r=e.token;if(r&&!d.isValidToken(r))throw new Error("Invalid token in SrcChannelInfo");if(!d.isValidChannelName(n))throw new Error("Invalid channelName in SrcChannelInfo");if(!f.is32Uint(t))throw new Error("Invalid uid in SrcChannelInfo");this.srcChannelMediaInfo=e},e.prototype.setDestChannelInfo=function(e,t){if(!d.isValidChannelName(e))throw new Error("Invalid channelName in DestChannelInfo");d.checkValidObject(t,"destInfo");var n=t.uid,r=t.token,i=t.channelName;if(r&&!d.isValidToken(r))throw new Error("Invalid token in DestChannelInfo");if(!d.isValidChannelName(i))throw new Error("Invalid channelName in DestChannelInfo");if(!f.is32Uint(n))throw new Error("Invalid uid in DestChannelInfo");this.destChannelMediaInfos.set(e,t)},e.prototype.removeDestChannelInfo=function(e){if(!d.isValidChannelName(e))throw new Error("Invalid channelName when invoke removeDestChannelInfo");this.destChannelMediaInfos.delete(e)},e.prototype.getSrcChannelMediaInfo=function(){return this.srcChannelMediaInfo},e.prototype.getDestChannelMediaInfos=function(){return this.destChannelMediaInfos},e}();t.ChannelMediaRelayConfiguration=g;var m,v,y,_,b,S=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o._onOpen=function(){o.emit("open")},o._onClose=function(e){o.emit("close"),o.dispose()},o._onMessage=function(e){var t=JSON.parse(e.data);if(!t||"serverResponse"!==t.command||!t.requestId)return t&&"serverStatus"===t.command&&t.serverStatus&&t.serverStatus.command?(o.emit("status",t.serverStatus),void o.emit(t.serverStatus.command,t.serverStatus)):void 0;o.emit("req_"+t.requestId,t)},o._requestId=1,o.appId=t,o.cname=n,o.uid=r,o.sid=i,o}return i(t,e),t.prototype.isConnect=function(){return this._ws&&this._ws.readyState===WebSocket.OPEN},t.prototype.sendMessage=function(e){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)throw new E(m.WS_DISCONNECTED);var t=this._requestId++;return e.requestId=t,e.seq=t,this._ws.send(JSON.stringify(e)),t},t.prototype.waitStatus=function(e){var t=this;return new Promise((function(n,r){var i=window.setTimeout((function(){r(new E(m.WAIT_STATUS_TIMEOUT,e))}),5e3);t.once(e,(function(t){clearTimeout(i),t.state&&0!==t.state?r(new E(m.WAIT_STATUS_ERROR,e)):n()})),t.once("dispose",(function(){clearTimeout(i),r(new E(m.WS_ABORT))}))}))},t.prototype.request=function(e){var t=this;return new Promise((function(n,r){var i=t.sendMessage(e),o=window.setTimeout((function(){t.removeAllListeners("req_"+i),r(new E(m.REQUEST_TIMEOUT))}),3e3);t.once("req_"+i,(function(e){clearTimeout(o),e&&200===e.code?n(e):r(new E(m.REQUEST_FAILED,e))})),t.once("dispose",(function(){clearTimeout(o),r(new E(m.WS_ABORT))}))}))},t.prototype.connect=function(e){var t=this;return new Promise((function(n,r){t._ws=new WebSocket(e),t._ws.onopen=function(){t._onOpen(),t._prvUrl=e,t._ws.onmessage=t._onMessage,t._ws.onclose=t._onClose,t._startHeartBeatCheck(),n()},t._ws.onclose=function(e){t._ws=null,r(new E(m.CONNECT_FAILED,"websocket error code: "+e.code))},setTimeout((function(){t._ws&&t._ws.readyState!==WebSocket.OPEN&&(t._ws.onopen=null,t._ws.onclose=null,t._ws.close(),t._ws=null,r(new E(m.CONNECT_TIMEOUT)))}),5e3),t.once("dispose",(function(){r(new E(m.WS_ABORT))}))}))},t.prototype.dispose=function(){this._clearHeartBeatCheck(),this.emit("dispose"),this.removeEvent(),this._ws&&(this._ws.onopen=null,this._ws.onclose=null,this._ws.onmessage=null,this._ws.close()),this._ws=null},t.prototype._sendPing=function(e){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)throw new E(m.WS_DISCONNECTED);var t=this._requestId++;return e.requestId=t,this._ws.send(JSON.stringify(e)),t},t.prototype._startHeartBeatCheck=function(){var e=this;this._heartBeatTimer=window.setInterval((function(){e._sendPing({command:"ping",appId:e.appId,cname:e.cname,uid:e.uid+"",sid:e.sid,ts:+new Date,requestId:0})}),3e3)},t.prototype._clearHeartBeatCheck=function(){window.clearInterval(this._heartBeatTimer)},t}(u.default),E=function(e,t,n){void 0===e&&(e=""),this.code=n,this.data=t,this.message=e};t.ChannelMediaError=E,function(e){e.CONNECT_FAILED="connect failed",e.CONNECT_TIMEOUT="connect timeout",e.WS_DISCONNECTED="websocket disconnected",e.REQUEST_TIMEOUT="request timeout",e.REQUEST_FAILED="request failed",e.WAIT_STATUS_TIMEOUT="wait status timeout",e.WAIT_STATUS_ERROR="wait status error",e.BAD_STATE="bad state",e.WS_ABORT="ws abort",e.AP_REQUEST_TIMEOUT="AP request timeout",e.AP_JSON_PARSE_ERROR="AP json parse error",e.AP_REQUEST_ERROR="AP request error",e.AP_REQUEST_ABORT="AP request abort"}(m=t.CHANNEL_MEDIA_ERROR||(t.CHANNEL_MEDIA_ERROR={})),function(e){e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile"}(v||(v={})),function(e){e[e.NETWORK_DISCONNECTED=0]="NETWORK_DISCONNECTED",e[e.NETWORK_CONNECTED=1]="NETWORK_CONNECTED",e[e.PACKET_JOINED_SRC_CHANNEL=2]="PACKET_JOINED_SRC_CHANNEL",e[e.PACKET_JOINED_DEST_CHANNEL=3]="PACKET_JOINED_DEST_CHANNEL",e[e.PACKET_SENT_TO_DEST_CHANNEL=4]="PACKET_SENT_TO_DEST_CHANNEL",e[e.PACKET_RECEIVED_VIDEO_FROM_SRC=5]="PACKET_RECEIVED_VIDEO_FROM_SRC",e[e.PACKET_RECEIVED_AUDIO_FROM_SRC=6]="PACKET_RECEIVED_AUDIO_FROM_SRC",e[e.PACKET_UPDATE_DEST_CHANNEL=7]="PACKET_UPDATE_DEST_CHANNEL",e[e.PACKET_UPDATE_DEST_CHANNEL_REFUSED=8]="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e[e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE=9]="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(y=t.CHANNEL_MEDIA_RELAY_EVENT||(t.CHANNEL_MEDIA_RELAY_EVENT={})),function(e){e[e.RELAY_STATE_IDLE=0]="RELAY_STATE_IDLE",e[e.RELAY_STATE_CONNECTING=1]="RELAY_STATE_CONNECTING",e[e.RELAY_STATE_RUNNING=2]="RELAY_STATE_RUNNING",e[e.RELAY_STATE_FAILURE=3]="RELAY_STATE_FAILURE"}(_=t.CHANNEL_MEDIA_RELAY_STATE||(t.CHANNEL_MEDIA_RELAY_STATE={})),function(e){e[e.RELAY_OK=0]="RELAY_OK",e[e.SERVER_ERROR_RESPONSE=1]="SERVER_ERROR_RESPONSE",e[e.SERVER_NO_RESPONSE=2]="SERVER_NO_RESPONSE",e[e.NO_RESOURCE_AVAILABLE=3]="NO_RESOURCE_AVAILABLE",e[e.FAILED_JOIN_SRC=4]="FAILED_JOIN_SRC",e[e.FAILED_JOIN_DEST=5]="FAILED_JOIN_DEST",e[e.FAILED_PACKET_RECEIVED_FROM_SRC=6]="FAILED_PACKET_RECEIVED_FROM_SRC",e[e.FAILED_PACKET_SENT_TO_DEST=7]="FAILED_PACKET_SENT_TO_DEST",e[e.SERVER_CONNECTION_LOST=8]="SERVER_CONNECTION_LOST",e[e.INTERNAL_ERROR=9]="INTERNAL_ERROR",e[e.SRC_TOKEN_EXPIRED=10]="SRC_TOKEN_EXPIRED",e[e.DEST_TOKEN_EXPIRED=11]="DEST_TOKEN_EXPIRED",e[e.RELAY_ALREADY_START=12]="RELAY_ALREADY_START",e[e.RELAY_NOT_START=13]="RELAY_NOT_START",e[e.OPERATION_ABORT=14]="OPERATION_ABORT"}(b=t.CHANNEL_MEDIA_RELAY_ERROR||(t.CHANNEL_MEDIA_RELAY_ERROR={}))},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=r=function(e){return n(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},r(t)}e.exports=r},function(e,t,n){"use strict";n.r(t),n.d(t,"post",(function(){return l})),n.d(t,"shouldUseHttps",(function(){return d})),n.d(t,"getHTTPSendBytes",(function(){return s})),n.d(t,"getHTTPRecvBytes",(function(){return u})),n.d(t,"resetHTTPByetsCount",(function(){return c}));var r=n(3),i=n(11),o=0,a=0,s=function(){return o},u=function(){return a},c=function(){o=0,a=0},l=function(e,t,n,s,u){var c=new XMLHttpRequest;if(c.timeout=t.timeout||Object(r.getParameter)("HTTP_CONNECT_TIMEOUT"),c.open("POST",e,!0),c.setRequestHeader("Content-type","application/json; charset=utf-8"),u)for(var l in u)"withCredentials"==l?c.withCredentials=!0:c.setRequestHeader(l,u[l]);c.onload=function(e){a+=Object(i.lengthInUtf8Bytes)(c.responseText),n&&n(c.responseText)},c.onerror=function(t){s&&s(t,e)},c.ontimeout=function(t){s&&s(t,e)};var d=JSON.stringify(t);o+=Object(i.lengthInUtf8Bytes)(d),c.send(d)},d=function(){return"https:"==document.location.protocol}},function(e,t,n){"use strict";n.r(t),n.d(t,"isLiveTranscodingValid",(function(){return m})),n.d(t,"generateSessionId",(function(){return f})),n.d(t,"audioLevelHelper",(function(){return p})),n.d(t,"vsResHack",(function(){return h})),n.d(t,"is32Uint",(function(){return g})),n.d(t,"safeCall",(function(){return d})),n.d(t,"random",(function(){return y})),n.d(t,"popBanTip",(function(){return b})),n.d(t,"lengthInUtf8Bytes",(function(){return _}));var r=n(9),i=n.n(r),o=n(5),a=n(0),s=n(16),u=n.n(s),c=n(15),l=n(13),d=function(){var e=arguments[0];if("function"==typeof e){var t=Array.prototype.slice.call(arguments,1);e.apply(null,t)}},p=function(e){return this.audioContext=Object(c.a)(),this.sourceNode=e.otWebkitAudioSource||this.audioContext.createMediaStreamSource(e),this.analyser=this.audioContext.createAnalyser(),this.timeDomainData=new Uint8Array(this.analyser.frequencyBinCount),this.sourceNode.connect(this.analyser),this.getAudioLevel=function(){if(this.analyser){this.analyser.getByteTimeDomainData(this.timeDomainData);for(var e=0,t=0;t<this.timeDomainData.length;t++)e=Math.max(e,Math.abs(this.timeDomainData[t]-128));return e/128}return a.default.warning("can't find analyser in audioLevelHelper"),0},this};function f(){return u()().replace(/-/g,"").toUpperCase()}var h=function(e,t,n){try{a.default.debug("start vsResHack",e);var r=document.createElement("video");r.setAttribute("autoplay",""),r.setAttribute("muted",""),r.muted=!0,r.setAttribute("playsinline",""),r.setAttribute("style","position: absolute; top: 0; left: 0; width:1px; high:1px;"),document.body.appendChild(r),r.addEventListener("playing",(function(n){o.isFireFox()?r.videoWidth&&(a.default.debug("[vsResHack] get stream resolution: ","".concat(r.videoWidth," x ").concat(r.videoHeight),e),t(r.videoWidth,r.videoHeight),document.body.removeChild(r)):(a.default.debug("[vsResHack] get stream resolution: ","".concat(r.videoWidth," x ").concat(r.videoHeight),e),t(r.videoWidth,r.videoHeight),document.body.removeChild(r))})),Object(l.setSrcObject)(r,e)}catch(e){n(e)}},g=function(e){return"number"==typeof e&&0<=e&&e<=4294967295},m=function(e){var t=["lowLatency","userConfigExtraInfo","transcodingUsers"];for(var n in e)if("lowLatency"===n&&"boolean"!=typeof e[n]||"userConfigExtraInfo"===n&&"object"!==i()(e[n])||"transcodingUsers"===n&&!v(e[n])||!~t.indexOf(n)&&"number"!=typeof e[n])throw new Error("Param ["+n+"] is inValid");return!0},v=function(e){for(var t=0;t<e.length;t++)for(var n in e[t])if("number"!=typeof e[t][n])throw new Error("Param user["+t+"] - ["+n+"] is inValid");return!0},y=function(e){isNaN(e)&&(e=1e3);var t=+new Date,n=(t=(9301*t+49297)%233280)/233280;return Math.ceil(n*e)},_=function(e){var t=encodeURIComponent(e).match(/%[89ABab]/g);return e.length+(t?t.length:0)},b=function(){if(!document.getElementById("agora-ban-tip")){var e=document.createElement("div");e.id="agora-ban-tip",e.style="position: absolute; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; color: #fff;",document.querySelector("body").prepend(e);var t=document.createElement("div");t.style="background: #000; width: 346px; height: 116px; z-index: 100000; opacity: 0.6; border-radius: 10px; box-shadow: 0 2px 4px #000;",e.append(t);var n=document.createElement("div");n.style="height: 76px; display: flex; justify-content: center; align-items: center;";var r=document.createElement("span");r.style="height: 28px; width: 28px; color: #000; text-align: center; line-height: 30px; background: #fff; border-radius: 50%; font-weight: 600; font-size: 20px;margin-right: 5px;",r.innerText="!";var i=document.createElement("span");i.innerText="This browser does not support webRTC",n.append(r),n.append(i);var o=document.createElement("div");o.style="height: 38px; display: flex; border-top: #fff 1px solid; justify-content: center; align-items: center;",o.innerText="OK",t.append(n),t.append(o),o.onclick=function(){var e=document.getElementById("agora-ban-tip");e.parentNode.removeChild(e)}}}},function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,u,"next",e)}function u(e){n(a,i,o,s,u,"throw",e)}s(void 0)}))}}},function(e,t,n){"use strict";n.r(t),n.d(t,"RTCPeerConnection",(function(){return w})),n.d(t,"getUserMedia",(function(){return a})),n.d(t,"attachMediaStream",(function(){return s})),n.d(t,"reattachMediaStream",(function(){return u})),n.d(t,"setSrcObject",(function(){return f})),n.d(t,"getSrcObject",(function(){return h})),n.d(t,"webrtcDetectedBrowser",(function(){return c})),n.d(t,"webrtcDetectedVersion",(function(){return l})),n.d(t,"webrtcMinimumVersion",(function(){return d})),n.d(t,"webrtcTesting",(function(){return I})),n.d(t,"webrtcUtils",(function(){return v}));var r=n(9),i=n.n(r),o=n(5),a=null,s=null,u=null,c=null,l=null,d=null,p=null,f=null,h=null,g=null,m={addStream:null},v={log:function(){},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n])}};if("object"==("undefined"==typeof window?"undefined":i()(window))?(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype?(f=function(e,t){e.srcObject=t},h=function(e){return e.srcObject}):(f=function(e,t){"mozSrcObject"in e?e.mozSrcObject=t:(e._srcObject=t,e.src=t?URL.createObjectURL(t):null)},h=function(e){return"mozSrcObject"in e?e.mozSrcObject:e._srcObject}),a=window.navigator&&window.navigator.getUserMedia):(f=function(e,t){e.srcObject=t},h=function(e){return e.srcObject}),s=function(e,t){f(e,t)},u=function(e,t){f(e,h(t))},"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia&&window.mozRTCPeerConnection){for(var y in v.log("This appears to be Firefox"),c="firefox",l=v.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),d=31,g=mozRTCPeerConnection,m)m[y]=g.prototype[y];if(p=function(e,t){if(l<38&&e&&e.iceServers){for(var n=[],r=0;r<e.iceServers.length;r++){var i=e.iceServers[r];if(i.hasOwnProperty("urls"))for(var o=0;o<i.urls.length;o++){var a={url:i.urls[o]};0===i.urls[o].indexOf("turn")&&(a.username=i.username,a.credential=i.credential),n.push(a)}else n.push(e.iceServers[r])}e.iceServers=n}var s=new g(e,t);for(var u in m)s[u]=m[u];return s},window.RTCSessionDescription||(window.RTCSessionDescription=mozRTCSessionDescription),window.RTCIceCandidate||(window.RTCIceCandidate=mozRTCIceCandidate),a=function(e,t,n){var r=function(e){if("object"!==i()(e)||e.require)return e;var t=[];return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r=e[n]="object"===i()(e[n])?e[n]:{ideal:e[n]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||t.push(n),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:e[n]=r.exact,delete r.exact),void 0!==r.ideal){e.advanced=e.advanced||[];var o={};"number"==typeof r.ideal?o[n]={min:r.ideal,max:r.ideal}:o[n]=r.ideal,e.advanced.push(o),delete r.ideal,Object.keys(r).length||delete e[n]}}})),t.length&&(e.require=t),e};return l<38&&(v.log("spec: "+JSON.stringify(e)),e.audio&&(e.audio=r(e.audio)),e.video&&(e.video=r(e.video)),v.log("ff37: "+JSON.stringify(e))),navigator.mozGetUserMedia(e,t,n)},navigator.getUserMedia=a,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:E,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise((function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])}))},l<41){var _=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return _().then(void 0,(function(e){if("NotFoundError"===e.name)return[];throw e}))}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){for(var y in v.log("This appears to be Chrome"),c="chrome",l=v.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),d=38,g=webkitRTCPeerConnection,m)m[y]=g.prototype[y];p=function(e,t){e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new g(e,t);for(var r in m)n[r]=m[r];var i=n.getStats.bind(n);return n.getStats=function(e,t,n){var r=arguments;return r.length>0&&"function"==typeof e&&(t?(n=t,t=e,r=[e=null,t,n]):(t=e,r=[e=null,t])),r.length>=2?i.apply(this,[function(e){r[1](function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t}(e))},r[0]]):i()},n},["createOffer","createAnswer"].forEach((function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"===i()(arguments[0])){var n=1===arguments.length?arguments[0]:void 0;return new Promise((function(r,i){t.apply(e,[r,i,n])}))}return t.apply(this,arguments)}})),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this;return new Promise((function(r,i){t.apply(n,[e[0],function(){r(),e.length>=2&&e[1].apply(null,[])},function(t){i(t),e.length>=3&&e[2].apply(null,[t])}])}))}}));var b=function(e){if("object"!==i()(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===i()(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[o("min",n)]=r.ideal,t.optional.push(a),(a={})[o("max",n)]=r.ideal,t.optional.push(a)):(a[o("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t};if(a=function(e,t,n){return e.audio&&(e.audio=b(e.audio)),e.video&&(e.video=b(e.video)),v.log("chrome: "+JSON.stringify(e)),navigator.webkitGetUserMedia(e,t,n)},navigator.getUserMedia=a,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:E,enumerateDevices:function(){return new Promise((function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources((function(n){e(n.map((function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}})))}))}))}}),navigator.mediaDevices.getUserMedia){if((Object(o.getBrowserVersion)()?Number(Object(o.getBrowserVersion)().split(".")[0]):void 0)<46){var S=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return v.log("spec:   "+JSON.stringify(e)),e.audio=b(e.audio),e.video=b(e.video),v.log("chrome: "+JSON.stringify(e)),S(e)}}}else navigator.mediaDevices.getUserMedia=function(e){return E(e)};void 0===navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){v.log("Dummy mediaDevices.addEventListener called.")}),void 0===navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){v.log("Dummy mediaDevices.removeEventListener called.")}),s=function(e,t){l>=43?f(e,t):void 0!==e.src?e.src=t?URL.createObjectURL(t):null:v.log("Error attaching stream to element.")},u=function(e,t){l>=43?f(e,h(t)):e.src=t.src}}else navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(v.log("This appears to be Edge"),c="edge",l=v.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),d=12):v.log("Browser does not appear to be WebRTC-capable");else v.log("This does not appear to be a browser"),c="not a browser";function E(e){return new Promise((function(t,n){a(e,t,n)}))}var w,I={};try{Object.defineProperty(I,"version",{set:function(e){l=e}})}catch(e){}p?w=p:"undefined"!=typeof window&&(w=window.RTCPeerConnection)},function(e,t,n){var r=n(25);e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){r(e,t,n[t])}))}return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=window.AudioContext||window.webkitAudioContext,i=n(3),o=i.getParameter,a=i.setParameter,s=function(){return o("AUDIO_CONTEXT")||(console.log("Creating Audio Context"),a("AUDIO_CONTEXT",function(){if(r)return new r;throw new Error("AUDIO_CONTEXT_NOT_SUPPORTED")}())),o("AUDIO_CONTEXT")}},function(e,t,n){var r=n(23),i=n(24);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i,o=r(n(0)),a=n(13);!function(e){e.NEW="new",e.PREPARING_OFFER="preparing-offer",e.OFFER_SENT="offer-sent",e.ESTABLISHED="established",e.CLOSED="closed"}(i||(i={}));var s=function(){function e(e){this.candidate=null,this.state=i.NEW,this.config=e,this.isSubscriber=this.config.isSubscriber,this.peerConnection=this.initPeecConnection(e),this.peerConnection.onicecandidate=this._onicecandidate.bind(this),this.peerConnection.oniceconnectionstatechange=this._oniceconnectionstatechange.bind(this),this.peerConnection.onaddstream=this._onaddstream.bind(this),this.peerConnection.ontrack=this._ontrack.bind(this),this.processSignalingMessage=this.setAnswer.bind(this),this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(this.setLocalSDP.bind(this)),this.sendVideoStats={id:"",type:"",mediaType:"",googCodecName:"h264"===this.config.codec?"H264":"VP8",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0",googFramesEncoded:"0"},this.sendAudioStats={id:"",type:"",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},this.receiveAudioStats={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},this.receiveVideoStats={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googFramesDecoded:"0",googFrameReceived:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0"}}return e.prototype.addStream=function(e){this.peerConnection.addStream(e)},e.prototype.setAnswer=function(e){var t=JSON.parse(e);this.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:t.sdp,type:"answer"})),this.onsignalingmessage&&this.onsignalingmessage("")},e.prototype.close=function(){this.peerConnection.close()},e.prototype.getStats=function(e,t){if(void 0===t&&(t=500),t=t>500?500:t,Date.now()-this.lastTimeGetStats<t){var n=[];this.config.isSubscriber?(n.push(this.receiveVideoStats),n.push(this.receiveAudioStats)):(n.push(this.sendAudioStats),n.push(this.sendVideoStats)),n.push({id:"time",startTime:this.connectedTime,timestamp:Date.now()}),e&&e(n)}else this._getStats(e)},e.prototype._getStats=function(e){var t=this,n=[];this.peerConnection.getStats(null).then((function(r){t.lastTimeGetStats=Date.now(),Object.keys(r).map((function(e){var n=r[e];t.config.isSubscriber?n.type&&"inboundrtp"===n.type&&n.mediaType&&"audio"===n.mediaType?(t.receiveAudioStats.id=n.id+"recv",t.receiveAudioStats.type=n.type+"",t.receiveAudioStats.mediaType=n.mediaType+"",t.receiveAudioStats.packetsReceived=n.packetsReceived+"",t.receiveAudioStats.bytesReceived=n.bytesReceived+"",t.receiveAudioStats.packetsLost=n.packetsLost+"",t.receiveAudioStats.googJitterReceived=n.jitter+""):n.type&&"inboundrtp"===n.type&&n.mediaType&&"video"===n.mediaType?(t.receiveVideoStats.id=n.id+"recv",t.receiveVideoStats.type=n.type+"",t.receiveVideoStats.mediaType=n.mediaType+"",t.receiveVideoStats.packetsReceived=n.packetsReceived+"",t.receiveVideoStats.bytesReceived=n.bytesReceived+"",t.receiveVideoStats.packetsLost=n.packetsLost+"",t.receiveVideoStats.googJitterBufferMs=n.jitter+"",t.receiveVideoStats.googPlisSent=n.pliCount+"",t.receiveVideoStats.googFirsSent=n.firCount+"",t.receiveVideoStats.googNacksSent=n.nackCount+""):n.remoteSource&&n.type&&"track"===n.type&&n.trackIdentifier&&-1!==n.trackIdentifier.indexOf("v")?(t.receiveVideoStats.googFrameHeightReceived=n.frameHeight+"",t.receiveVideoStats.googFrameWidthReceived=n.frameWidth+"",t.receiveVideoStats.googFrameRateDecoded=n.framesPerSecond+"",t.receiveVideoStats.googFrameRateOutput=n.framesPerSecond+"",t.receiveVideoStats.googFrameRateReceived=n.framesPerSecond+"",t.receiveVideoStats.googFramesDecoded=n.framesDecoded+"",t.receiveVideoStats.googFrameReceived=n.framesReceived+""):n.remoteSource&&n.type&&"track"===n.type&&n.trackIdentifier&&-1!==n.trackIdentifier.indexOf("a")&&(t.receiveAudioStats.audioOutputLevel=n.audioLevel+""):!n.isRemote&&n.type&&"outboundrtp"===n.type&&n.mediaType&&"audio"===n.mediaType?(t.sendAudioStats.id=n.id+"send",t.sendAudioStats.type=n.type+"",t.sendAudioStats.mediaType=n.mediaType+"",t.sendAudioStats.packetsSent=n.packetsSent+"",t.sendAudioStats.bytesSent=n.bytesSent+""):!n.isRemote&&n.type&&"outboundrtp"===n.type&&n.mediaType&&"video"===n.mediaType?(t.sendVideoStats.id=n.id+"send",t.sendVideoStats.type=n.type+"",t.sendVideoStats.mediaType=n.mediaType+"",t.sendVideoStats.packetsSent=n.packetsSent+"",t.sendVideoStats.bytesSent=n.bytesSent+"",t.sendVideoStats.googRtt=n.roundTripTime+"",t.sendVideoStats.googPlisReceived=n.pliCount+"",t.sendVideoStats.googFirsReceived=n.firCount+"",t.sendVideoStats.googNacksReceived=n.nackCount+""):!n.remoteSource&&n.type&&"track"===n.type&&n.framesSent&&0!==n.framesSent&&(t.sendVideoStats.googFrameHeightSent=n.frameHeight+"",t.sendVideoStats.googFrameHeightInput=n.frameHeight+"",t.sendVideoStats.googFrameWidthSent=n.frameWidth+"",t.sendVideoStats.googFrameWidthInput=n.frameWidth+"",t.sendVideoStats.googFramesEncoded=n.framesSent+"",t.sendVideoStats.googFrameRateSent=n.framesPerSecond+"")})),t.config.isSubscriber?(n.push(t.receiveVideoStats),n.push(t.receiveAudioStats)):(n.push(t.sendAudioStats),n.push(t.sendVideoStats)),n.push({id:"time",startTime:t.connectedTime,timestamp:Date.now()}),e&&e(n)}))},e.prototype.getStatsRate=function(e){this.getStats(e)},e.prototype.initPeecConnection=function(e){var t=e.stunServerUrl,n=e.turnServer,r=e.iceServers;return this.pcConfig={iceServers:[{urls:"stun:webcs.agora.io:3478"}]},r instanceof Array?this.pcConfig.iceServers=e.iceServers:t&&(t instanceof Array?t.map((function(e){"string"==typeof e&&""!==e&&this.pcConfig.iceServers.push({urls:e})})):"string"==typeof t&&""!==t&&this.pcConfig.iceServers.push({urls:t})),n&&(n instanceof Array?n.map((function(e){"string"==typeof e.url&&""!==e.url&&this.pcConfig.iceServers.push({username:e.username,credential:e.credential,url:e.url})})):"auto"!==n.mode&&"manual"!==n.mode||(n.udpport&&this.pcConfig.iceServers.push({username:n.username,credential:n.credential,credentialType:"password",urls:"turn:"+n.url+":"+n.udpport+"?transport=udp"}),"string"==typeof n.tcpport&&""!==n.tcpport&&this.pcConfig.iceServers.push({username:n.username,credential:n.credential,credentialType:"password",urls:"turn:"+n.url+":"+n.tcpport+"?transport=tcp"}),!0===n.forceturn&&(this.pcConfig.iceTransportPolicy="relay"))),new a.RTCPeerConnection(this.pcConfig)},e.prototype._ontrack=function(e){this.onaddstream&&this.onaddstream(e,"ontrack")},e.prototype._onaddstream=function(e){this.onaddstream&&this.onaddstream(e,"onaddstream")},e.prototype._oniceconnectionstatechange=function(e){"connected"===e.currentTarget.iceConnectionState&&(this.state=i.ESTABLISHED,this.connectedTime=Date.now()),this.oniceconnectionstatechange&&this.oniceconnectionstatechange(e.currentTarget.iceConnectionState)},e.prototype._onicecandidate=function(e){!this.candidate&&e&&(this.candidate=e.candidate,this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(this.editLocalSDP.bind(this)).then(this.setLocalSDP.bind(this)).then(this.sendOffer.bind(this)).catch())},e.prototype.setLocalSDP=function(e){return this.peerConnection.setLocalDescription(new RTCSessionDescription({sdp:e.sdp,type:"offer"})),this.state=i.PREPARING_OFFER,e},e.prototype.editLocalSDP=function(e){return e.sdp=this.setBandWidth(e.sdp),e.sdp=this.reviseOpus(e.sdp),e.sdp=this.addCandidate(e.sdp),e},e.prototype.setSendRecv=function(e){return(e=(e=e.replace(/a=recvonly\r\n/g,"a=sendrecv\r\n")).replace(/a=sendonly\r\n/g,"a=sendrecv\r\n")).replace(/a=inactive\r\n/g,"a=sendrecv\r\n")},e.prototype.setBandWidth=function(e){var t,n,r=this.config,i=r.codec,a=r.minVideoBW,s=r.maxVideoBW,u=r.maxAudioBW,c=r.clientId;if((t=e.match(/m=video.*\r\n/))&&a&&s){n=t[0]+"b=AS:"+s+"\r\n";var l=0,d=0;"h264"===i?(l=e.search(/a=rtpmap:(\d+) H264\/90000\r\n/),d=e.search(/H264\/90000\r\n/)):"vp8"===i&&(l=e.search(/a=rtpmap:(\d+) VP8\/90000\r\n/),d=e.search(/VP8\/90000\r\n/)),-1!==l&&-1!==d&&d-l>10&&(n=n+"a=fmtp:"+e.slice(l+9,d-1)+" x-google-min-bitrate="+a+"\r\n"),e=e.replace(t[0],n),o.default.debug("["+c+"]Set Video Bitrate - min:"+a+" max:"+s)}return(t=e.match(/m=audio.*\r\n/))&&u&&(n=t[0]+"b=AS:"+u+"\r\n",e=e.replace(t[0],n)),e},e.prototype.reviseOpus=function(e){return(e=e.replace(/a=rtpmap:102 opus\/48000\/2/g,"a=rtpmap:111 opus/48000/2")).replace(/m=audio 9 UDP\/TLS\/RTP\/SAVPF 102 0 8 97 13 118 101/g,"m=audio 9 UDP/TLS/RTP/SAVPF 111 0 8 97 13 118 101")},e.prototype.addCandidate=function(e){return e+"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"},e.prototype.sendOffer=function(e){this.config.callback(JSON.stringify({sdp:e.sdp,messageType:"OFFER",tiebreaker:Math.floor(429496723*Math.random()+1)})),this.state=i.OFFER_SENT},e}();t.default=s},function(e,t,n){var r=n(28),i=n(29),o=n(30);e.exports=function(e,t){return r(e)||i(e,t)||o()}},function(e,t,n){var r,i;i=this,void 0===(r=function(){return function(){"use strict";var e,t=this;function n(e){t.console&&(t.console.error?t.console.error(e):t.console.log&&t.console.log(e))}function r(e,t,r,i){var o=i||n,a=e.createShader(r);return e.shaderSource(a,t),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:(o("*** Error compiling shader '"+a+"':"+e.getShaderInfoLog(a)),e.deleteShader(a),null)}function i(e,t,r,i,o){var a=o||n,s=e.createProgram();return t.forEach((function(t){e.attachShader(s,t)})),r&&r.forEach((function(t,n){e.bindAttribLocation(s,i?i[n]:n,t)})),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)?s:(a("Error in program linking:"+e.getProgramInfoLog(s)),e.deleteProgram(s),null)}(e=e||t)===e.top&&(console.log("%c%s","color:blue;font-weight:bold;","for more about webgl-utils.js see:"),console.log("%c%s","color:blue;font-weight:bold;","http://webglfundamentals.org/webgl/lessons/webgl-boilerplate.html"));var o,a=["VERTEX_SHADER","FRAGMENT_SHADER"];return!document.documentMode&&window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(o=HTMLCanvasElement.prototype.getContext,function(){var e=arguments,t=e[0];return"webgl"===t&&((e=[].slice.call(arguments))[0]="experimental-webgl"),o.apply(this,e)})),{createProgram:i,createProgramFromSources:function(e,t,n,o,s){for(var u=[],c=0;c<t.length;++c)u.push(r(e,t[c],e[a[c]],s));return i(e,u,n,o,s)}}}.call(i)}.apply(t,[]))||(e.exports=r)},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},a=this;Object.defineProperty(t,"__esModule",{value:!0});var s=n(31),u=n(5),c=o(n(0));t.getSupportedCodec=function(e){return r(a,void 0,void 0,(function(){var t,n,r,o,a;return i(this,(function(i){switch(i.label){case 0:return t={video:[],audio:[]},"undefined"!=typeof window?[3,1]:(c.default.error("getSupportedCodec: NOT_BROWSER_ENV"),[2,Promise.reject("NOT_BROWSER_ENV")]);case 1:try{n=s.createRTCPeerConnection({iceServers:[]})}catch(e){return c.default.error("Failed to init RTCPeerConnection",e),[2,Promise.reject(e)]}return n?[3,2]:(c.default.warning("getSupportedCodec: no RTCPeerConnection constructor is detected"),[2,Promise.resolve(t)]);case 2:return e&&e.stream?[3,7]:(r={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},o=void 0,(u.isSafari()||u.isFireFox()||u.isWeChatBrowser())&&n.addTransceiver?(n.addTransceiver("audio"),n.addTransceiver("video"),[4,n.createOffer()]):[3,4]);case 3:return o=i.sent(),[3,6];case 4:return[4,new Promise((function(e,t){var i=setTimeout((function(){t("CREATEOFFER_TIMEOUT")}),3e3);n.createOffer((function(t){clearTimeout(i),e(t)}),(function(e){clearTimeout(i),t(e)}),r)}))];case 5:o=i.sent(),i.label=6;case 6:return n.close(),a=o.sdp,[2,l(a)];case 7:return e.stream.getTracks&&n.addTrack?e.stream.getTracks().forEach((function(t){n.addTrack(t,e.stream)})):n.addStream(e.stream),o=void 0,u.isSafari()||u.isFireFox()?[4,n.createOffer()]:[3,9];case 8:return o=i.sent(),[3,11];case 9:return[4,new Promise((function(e,t){n.createOffer(e,t)}))];case 10:o=i.sent(),i.label=11;case 11:return n.close(),a=o.sdp,[2,l(a)]}}))}))};var l=function(e){var t={video:[],audio:[]};return e.match(/ VP8/i)&&t.video.push("VP8"),e.match(/ H264/i)&&t.video.push("H264"),e.match(/ opus/i)&&t.audio.push("OPUS"),Promise.resolve(t)}},function(e,t,n){var r=n(33),i=n(34),o=n(35);e.exports=function(e){return r(e)||i(e)||o()}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(4)),o=r(n(0));t.default=function(e,t){void 0===t&&(t={width:160,height:120,framerate:15});var n=t.width,r=t.height,a=t.framerate;if(!e)throw i.default.INVALID_LOCAL_STREAM;if(!e.getVideoTracks()[0])throw i.default.HIGH_STREAM_NOT_VIDEO_TRACE;o.default.debug("Start getLowStream");var s=document.createElement("video"),u=document.createElement("canvas");s.setAttribute("style","display:none"),u.setAttribute("style","display:none"),u.setAttribute("width",n.toString()),u.setAttribute("height",r.toString()),document.body.append(s),document.body.append(u);var c=u.getContext("2d");s.srcObject=e,s.autoplay=!0,o.default.debug("Start render lowStream");var l=setInterval((function(){c.drawImage(s,0,0,n,r)}),Math.floor(1e3/a)),d=u.captureStream(a);return d.clean=function(){o.default.debug("Start clean lowStream"),clearInterval(l),(s||s.parentNode||s.parentNode.removeChild)&&s.parentNode.removeChild(s),(u||u.parentNode||u.parentNode.removeChild)&&u.parentNode.removeChild(u),o.default.debug("Clean lowStream")},d}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){var r=function(){return this||"object"==typeof self&&self}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=n(27),i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}},function(e,t){!function(t){"use strict";var n,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",c="object"==typeof e,l=t.regeneratorRuntime;if(l)c&&(e.exports=l);else{(l=t.regeneratorRuntime=c?e.exports:{}).wrap=b;var d="suspendedStart",p="suspendedYield",f="executing",h="completed",g={},m={};m[a]=function(){return this};var v=Object.getPrototypeOf,y=v&&v(v(C([])));y&&y!==r&&i.call(y,a)&&(m=y);var _=I.prototype=E.prototype=Object.create(m);w.prototype=_.constructor=I,I.constructor=w,I[u]=w.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,I):(e.__proto__=I,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create(_),e},l.awrap=function(e){return{__await:e}},T(O.prototype),O.prototype[s]=function(){return this},l.AsyncIterator=O,l.async=function(e,t,n,r){var i=new O(b(e,t,n,r));return l.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},T(_),_[u]="Generator",_[a]=function(){return this},_.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=C,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),g}}}function b(e,t,n,r){var i=t&&t.prototype instanceof E?t:E,o=Object.create(i.prototype),a=new L(r||[]);return o._invoke=function(e,t,n){var r=d;return function(i,o){if(r===f)throw new Error("Generator is already running");if(r===h){if("throw"===i)throw o;return N()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var u=S(e,t,n);if("normal"===u.type){if(r=n.done?h:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=h,n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function S(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function E(){}function w(){}function I(){}function T(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function O(e){var t;this._invoke=function(n,r){function o(){return new Promise((function(t,o){!function t(n,r,o,a){var s=S(e[n],e,r);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,o,a)}),(function(e){t("throw",e,o,a)})):Promise.resolve(c).then((function(e){u.value=e,o(u)}),(function(e){return t("throw",e,o,a)}))}a(s.arg)}(n,r,t,o)}))}return t=t?t.then(o,o):o()}}function x(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,x(e,t),"throw"===t.method))return g;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=S(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,g;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,g):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function C(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:N}}function N(){return{value:n,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="object"==typeof window&&window.RTCPeerConnection,i="object"==typeof window&&window.webkitRTCPeerConnection,o="object"==typeof window&&window.mozRTCPeerConnection;t.createRTCPeerConnection=function(e){var t=r||i||o;return t?new t(e):null}},function(e,t,n){var r;
/*!
 * EventEmitter v5.2.8 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */!function(t){"use strict";function i(){}var o=i.prototype,a=t.EventEmitter;function s(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function u(e){return function(){return this[e].apply(this,arguments)}}o.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp)for(n in t={},r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n]);else t=r[e]||(r[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},o.addListener=function(e,t){if(!function e(t){return"function"==typeof t||t instanceof RegExp||!(!t||"object"!=typeof t)&&e(t.listener)}(t))throw new TypeError("listener must be a function");var n,r=this.getListenersAsObject(e),i="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&-1===s(r[n],t)&&r[n].push(i?t:{listener:t,once:!1});return this},o.on=u("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=u("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&-1!==(n=s(i[r],t))&&i[r].splice(n,1);return this},o.off=u("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var r,i,o=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)o.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?o.call(this,r,i):a.call(this,r,i));return this},o.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},o.removeAllListeners=u("removeEvent"),o.emitEvent=function(e,t){var n,r,i,o,a=this.getListenersAsObject(e);for(o in a)if(a.hasOwnProperty(o))for(n=a[o].slice(0),i=0;i<n.length;i++)!0===(r=n[i]).once&&this.removeListener(e,r.listener),r.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},o.trigger=u("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return t.EventEmitter=a,i},void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)}("undefined"!=typeof window?window:this||{})},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,n,r){"use strict";r.r(n);var o=r(3),a=r(0),s=r(2),u=function(){var e={dispatcher:{}};return e.dispatcher.eventListeners={},e.addEventListener=function(t,n){void 0===e.dispatcher.eventListeners[t]&&(e.dispatcher.eventListeners[t]=[]),e.dispatcher.eventListeners[t].push(n)},e.hasListeners=function(t){return!(!e.dispatcher.eventListeners[t]||!e.dispatcher.eventListeners[t].length)},e.on=e.addEventListener,e.removeEventListener=function(t,n){var r;e.dispatcher.eventListeners[t]&&-1!==(r=e.dispatcher.eventListeners[t].indexOf(n))&&e.dispatcher.eventListeners[t].splice(r,1)},e.dispatchEvent=function(t,n){var r;for(r in e.dispatcher.eventListeners[t.type])e.dispatcher.eventListeners[t.type]&&e.dispatcher.eventListeners[t.type].hasOwnProperty(r)&&"function"==typeof e.dispatcher.eventListeners[t.type][r]&&(n?e.dispatcher.eventListeners[t.type][r](t):Promise.resolve(t).then(e.dispatcher.eventListeners[t.type][r]))},e.dispatchSocketEvent=function(t){var n;for(n in e.dispatcher.eventListeners[t.type])e.dispatcher.eventListeners[t.type]&&e.dispatcher.eventListeners[t.type].hasOwnProperty(n)&&"function"==typeof e.dispatcher.eventListeners[t.type][n]&&e.dispatcher.eventListeners[t.type][n](t.msg)},e},c=function(e){var t={};return t.type=e.type,t},l=function(e){var t=c(e);return t.stream=e.stream,t.reason=e.reason,t.msg=e.msg,t},d=function(e){var t=c(e);return t.uid=e.uid,t.attr=e.attr,t.stream=e.stream,t},p=function(e){var t=c(e);return t.msg=e.msg,t},f=function(e){var t=c(e);return t.url=e.url,t.uid=e.uid,t.status=e.status,t.reason=e.reason,t},h=r(5),g=function(){};g.prototype.set=function(e,t){["BatteryLevel"].indexOf(e)>-1&&(this[e]=t)};var m=new function(){var e=u();return e.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},e.state=e.states.UNINIT,e.batteryManager=null,e._init=function(t,n){e.state=e.states.INITING,navigator.getBattery?navigator.getBattery().then((function(n){e.batteryManager=n,t&&setTimeout((function(){t()}),0)})).catch((function(e){a.default.debug("navigator.getBattery is disabled",e),t&&t()})):(e.state=e.states.INITED,t&&t())},e._getBatteryStats=function(){var t={};return e.batteryManager&&e.batteryManager.level?t.BatteryLevel=Math.floor(100*e.batteryManager.level):t.BatteryLevel="UNSUPPORTED",t},e.getStats=function(t,n){var r=new g,i=e._getBatteryStats();i&&i.BatteryLevel&&r.set("BatteryLevel",i.BatteryLevel),t&&t(r)},e._init(),e},v=r(6),y=r.n(v),_=function(e){var t=u();return t.url=".",t},b=r(13),S=r(4),E=0,w=function(e){var t=_();t.id=e.id,t.playerId=E++,t.fit=e.options&&e.options.fit,"contain"!==t.fit&&"cover"!==t.fit&&(t.fit=null),t.url=e.url,t.stream=e.stream.stream,t.elementID=e.elementID,t.setAudioOutput=function(e,n,r){var i=t.video||t.audio;return i?i.setSinkId?void i.setSinkId(e).then((function(){return a.default.debug("["+t.id+"] "+"video ".concat(t.id," setAudioOutput ").concat(e," SUCCESS")),i==t.video&&t.audio?t.audio.setSinkId(e):Promise.resolve()})).then((function(){return a.default.debug("["+t.id+"] "+"audio ".concat(t.id," setAudioOutput ").concat(e," SUCCESS")),n&&n()})).catch((function(e){return a.default.error("["+t.id+"] VideoPlayer.setAudioOutput",e),r&&r(e)})):(a.default.error("["+t.id+"] ",S.default.WEB_API_NOT_SUPPORTED),r&&r(S.default.WEB_API_NOT_SUPPORTED)):(a.default.error("["+t.id+"] ",S.default.PLAYER_NOT_FOUND),r&&r(S.default.PLAYER_NOT_FOUND))},t.destroy=function(){a.default.debug("[".concat(t.id,"] destroy ").concat(e.stream.local?"local":"remote"," Player ").concat(t.id)),Object(b.setSrcObject)(t.video,null),Object(b.setSrcObject)(t.audio,null),t.video.pause(),delete t.resizer,clearInterval(t.mediaPlayerTimer),t.mediaPlayerTimer=null,document.getElementById(t.div.id)&&t.parentNode.contains(t.div)&&t.parentNode.removeChild(t.div),["video","audio"].forEach((function(n){t[n];var r=i[n];clearTimeout(r.playDeferTimeout),r.formerMediaState=null;var o={playerId:t.playerId,stateId:r.stateId+1,playDeferTimeout:null,error:!1,status:"aborted",reason:"stop",updatedAt:Date.now()};i[n]=o;var u={type:"player-status-change",playerId:t.playerId,mediaType:n,status:o.status,reason:o.reason,isErrorState:!1,streamId:t.id};a.default.debug("[".concat(t.id,"] Media Player Status Change Triggered by destroy()"),u),e.stream.dispatchEvent(u),s.b.reportApiInvoke(e.stream.sid,{name:"Stream.playerStatusChange",options:u,tag:"tracer"})()}))},t.div=document.createElement("div"),t.div.setAttribute("id","player_"+t.id),e.stream.video?t.div.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;"):t.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),t.video=document.createElement("video"),t.video.setAttribute("id","video"+t.id),e.stream.local&&!e.stream.screen?e.stream.mirror?t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; transform: rotateY(180deg); object-fit: ".concat(t.fit||"cover",";")):t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: ".concat(t.fit||"cover",";")):e.stream.video?t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: ".concat(t.fit||"cover",";")):e.stream.screen?t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; object-fit: ".concat(t.fit||"contain")):t.video.setAttribute("style","width: 100%; height: 100%; position: absolute; display: none; object-fit: ".concat(t.fit||"cover"));var n={autoplay:!0,muted:!!e.stream.local||!(!h.isSafari()&&"iOS"!==h.getBrowserOS())&&"video_element_muted",playsinline:!0,controls:!(!h.isSafari()&&"iOS"!==h.getBrowserOS()||e.stream.local),volume:null},r=y()({},n,e.options);!0!==r.muted||r.volume||(r.volume=0),r.autoplay&&t.video.setAttribute("autoplay",""),!0!==r.muted&&"video_element_muted"!==r.muted||(t.video.setAttribute("muted",""),t.video.muted=!0),r.playsinline&&t.video.setAttribute("playsinline",""),r.controls&&t.video.setAttribute("controls",""),Number.isFinite(r.volume)&&(t.video.volume=r.volume),t.audio=document.createElement("audio"),t.audio.setAttribute("id","audio"+t.id),r.autoplay&&t.audio.setAttribute("autoplay",""),!0===r.muted&&t.audio.setAttribute("muted",""),!0===r.muted&&(t.audio.muted=!0),r.playsinline&&t.audio.setAttribute("playsinline",""),Number.isFinite(r.volume)&&(t.audio.volume=r.volume),void 0!==t.elementID?(document.getElementById(t.elementID).appendChild(t.div),t.container=document.getElementById(t.elementID)):(document.body.appendChild(t.div),t.container=document.body),t.parentNode=t.div.parentNode;var i={video:{playerId:t.playerId,stateId:0,playDeferTimeout:null,error:!1,status:"init",reason:null,updatedAt:Date.now()},audio:{playerId:t.playerId,stateId:0,playDeferTimeout:null,error:!1,status:"init",reason:null,updatedAt:Date.now()}};t.mediaElemExists=function(e){for(var t=e,n=0;n<Object(o.getParameter)("MEDIA_ELEMENT_EXISTS_DEPTH")&&t;n++)t=t.parentNode;return!!t};var u=function(e){return t.mediaElemExists(e)?e.paused?"paused":"play":"aborted"},c=function(e,t,n){var r=u(e),i=!0;return"paused"===r?("audio"===t&&!0===n.muted&&(i=!1),n.autoplay||(i=!1)):"play"===r?"video"===t?i=!1:!0===n.muted?e.muted&&(i=!1):e.muted||(i=!1):"aborted"===r&&(i=!1),i},l=function(n){var l,d=this;if(d===t.video?l="video":d===t.audio&&(l="audio"),l){n.type||a.default.error("[".concat(t.id,"] Unexpected evt"),n);var p=u(d);clearTimeout(i[l].playDeferTimeout),i[l].playDeferTimeout=setTimeout((function(){i[l].playDeferTimeout=null;var o=i[l],f=u(d);if(p===f){var h={playerId:t.playerId,stateId:o.stateId+1,playDeferTimeout:null,error:c(d,l,r),status:u(d),reason:n.type,updatedAt:Date.now()};if(o.status!==h.status){i[l]=h;var g={type:"player-status-change",playerId:t.playerId,mediaType:l,status:h.status,reason:h.reason,isErrorState:h.error,streamId:t.id};a.default.debug("[".concat(t.id,"] Media Player Status Change"),g),e.stream.dispatchEvent(g),s.b.reportApiInvoke(e.stream.sid,{name:"Stream.playerStatusChange",options:g,tag:"tracer"})()}}else a.default.debug("[".concat(t.id,"] Status Change after event Triggered.")+"Stream ".concat(t.id," PlayerId ").concat(t.playerId," mediaType ").concat(l," Status ").concat(p,"=>").concat(f))}),Object(o.getParameter)("PLAYER_STATE_DEFER"))}else a.default.error("[".concat(t.id,"] Unknown media element"),d)};if(t.mediaPlayerTimer=setInterval((function(){["video","audio"].forEach((function(n){var o=t[n],l=i[n];if(!l.playDeferTimeout){var d={playerId:t.playerId,stateId:l.stateId+1,playDeferTimeout:null,error:c(o,n,r),status:u(o),reason:"timer",updatedAt:Date.now()};if(l.status!==d.status){a.default.debug("[".concat(t.id,"] Player ").concat(t.playerId," ").concat(n," Status Changed Detected by Timer: ").concat(l.status,"=>").concat(d.status)),i[n]=d;var p={type:"player-status-change",playerId:t.playerId,mediaType:n,status:d.status,reason:d.reason,isErrorState:d.error,streamId:t.id};a.default.debug("[".concat(t.id,"] Media Player Status Change"),p),e.stream.dispatchEvent(p),s.b.reportApiInvoke(e.stream.sid,{name:"Stream.playerStatusChange",options:p,tag:"tracer"})()}}}))}),Object(o.getParameter)("PLAYER_STATE_DEFER")),t.video.addEventListener("playing",(function(e){!function e(){t.video.videoWidth*t.video.videoHeight>4?a.default.debug("["+t.id+"] video dimensions:",t.video.videoWidth,t.video.videoHeight):setTimeout(e,50)}()})),t.video.addEventListener("playing",l),t.video.addEventListener("canplay",l),t.video.addEventListener("abort",l),t.video.addEventListener("onerror",l),t.video.addEventListener("suspend",l),t.video.addEventListener("stalled",l),t.video.addEventListener("pause",l),t.audio.addEventListener("playing",l),t.audio.addEventListener("canplay",l),t.audio.addEventListener("abort",l),t.audio.addEventListener("onerror",l),t.audio.addEventListener("suspend",l),t.audio.addEventListener("stalled",l),t.audio.addEventListener("pause",l),e.stream.hasVideo()||e.stream.hasScreen())t.div.appendChild(t.video),t.div.appendChild(t.audio),h.isEdge()?t.video.srcObject=e.stream.stream:(Object(b.attachMediaStream)(t.video,e.stream.stream),Object(b.attachMediaStream)(t.audio,e.stream.stream));else if(!1!==r.muted&&"video_element_muted"!==r.muted||(t.video.removeAttribute("muted"),t.video.muted=!1),t.div.appendChild(t.video),window.MediaStream&&(h.isSafari()||"iOS"===h.getBrowserOS())){var d=new MediaStream(e.stream.stream.getAudioTracks());Object(b.setSrcObject)(t.video,d)}else Object(b.setSrcObject)(t.video,e.stream.stream);return t.setAudioVolume=function(e){var n=parseInt(e)/100;isFinite(n)&&(n<0?n=0:n>1&&(n=1),t.video&&(t.video.volume=n),t.audio&&(t.audio.volume=n))},t},I=r(17),T=r.n(I),O=null,x=function(){try{O=window.require("electron")}catch(e){}return O},R=function(e){var t=s.b.reportApiInvoke(null,{callback:e,name:"getScreenSources",options:arguments,tag:"tracer"}),n=x();if(!n)return t&&t("electron is null");n.desktopCapturer.getSources({types:["window","screen"]},(function(e,n){if(e)return t&&t(e);t&&t(null,n)}))},A=function(e,t,n){var r=t.width;t={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:t.height,maxWidth:r,maxFrameRate:t.frameRate&&t.frameRate.max,minFrameRate:t.frameRate&&t.frameRate.min}}},navigator.webkitGetUserMedia(t,(function(e){n&&n(null,e)}),(function(e){n&&n(e)}))},L=R,C=A,N=103,M=function(e){var t={};if(t.clientId=e.clientId,e.session_id=N+=1,"undefined"==typeof window||!window.navigator)throw a.default.error("["+t.streamId+"]["+t.clientId+"]Publish/subscribe video/audio streams not supported yet"),new Error("NON_BROWSER_ENV_DETECTED");return null!==window.navigator.userAgent.match("Firefox")?(t.browser="mozilla",t=function(e){var t={},n=(mozRTCPeerConnection,mozRTCSessionDescription),r=!1;t.uid=e.uid,t.isVideoMute=e.isVideoMute,t.isAudioMute=e.isAudioMute,t.isSubscriber=e.isSubscriber,t.clientId=e.clientId,t.filterStatsCache=[],t.originStatsCache=[],t.lastTimeGetStats=null,t.pc_config={iceServers:[]},e.iceServers instanceof Array?e.iceServers.map((function(e){0===e.url.indexOf("stun:")&&t.pc_config.iceServers.push({url:e.url})})):(e.stunServerUrl&&(e.stunServerUrl instanceof Array?e.stunServerUrl.map((function(e){"string"==typeof e&&""!==e&&t.pc_config.iceServers.push({url:e})})):"string"==typeof e.stunServerUrl&&""!==e.stunServerUrl&&t.pc_config.iceServers.push({url:e.stunServerUrl})),e.turnServer&&"string"==typeof e.turnServer.url&&""!==e.turnServer.url&&(e.turnServer.udpport&&t.pc_config.iceServers.push({username:e.turnServer.username,credential:e.turnServer.credential,credentialType:"password",urls:"turn:"+e.turnServer.url+":"+e.turnServer.udpport+"?transport=udp"}),"string"==typeof e.turnServer.tcpport&&""!==e.turnServer.tcpport&&t.pc_config.iceServers.push({username:e.turnServer.username,credential:e.turnServer.credential,credentialType:"password",urls:"turn:"+e.turnServer.url+":"+e.turnServer.tcpport+"?transport=tcp"}),!0===e.turnServer.forceturn&&(t.pc_config.iceTransportPolicy="relay"))),void 0===e.audio&&(e.audio=!0),void 0===e.video&&(e.video=!0),t.mediaConstraints={offerToReceiveAudio:e.audio,offerToReceiveVideo:e.video,mozDontOfferDataChannel:!0},t.roapSessionId=103,t.peerConnection=new b.RTCPeerConnection(t.pc_config),a.default.debug("["+t.clientId+']safari Created RTCPeerConnnection with config "'+JSON.stringify(t.pc_config)+'".'),t.iceCandidateTimer=setTimeout((function(){t.iceCandidateTimer=null,a.default.debug("[".concat(t.clientId,"]Candidates collected: ").concat(t.iceCandidateCount)),t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),Object(o.getParameter)("CANDIDATE_TIMEOUT")),t.peerConnection.onicecandidate=function(e){var n,r,i,o;r=(n=t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),i=n.match(/a=candidate:.+typ\shost.+\r\n/),o=n.match(/a=candidate:.+typ\srelay.+\r\n/),null===r&&null===i&&null===o||void 0!==t.ice||!t.iceCandidateTimer||(a.default.debug("["+t.clientId+"]srflx candidate : "+r+" relay candidate: "+o+" host candidate : "+i),clearTimeout(t.iceCandidateTimer),t.iceCandidateTimer=null,t.ice=0,t.moreIceComing=!1,t.markActionNeeded()),t.iceCandidateCount=t.iceCandidateCount+1},t.checkMLineReverseInSDP=function(e){return!(!~e.indexOf("m=audio")||!~e.indexOf("m=video"))&&e.indexOf("m=audio")>e.indexOf("m=video")},t.reverseMLineInSDP=function(e){var t=e.split("m=audio"),n=t[1].split("m=video"),r="m=video"+n[1],i="m=audio"+n[0];return t[0]+r+i},t.processSignalingMessage=function(e){var r,i=JSON.parse(e);t.incomingMessage=i,"new"===t.state?"OFFER"===i.messageType?(i.sdp=d(i.sdp),r={sdp:i.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new n(r),(function(){a.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){a.default.info("["+t.clientId+"]setRemoteDescription failed: "+e.name)})),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+i.messageType+" in state "+t.state):"offer-sent"===t.state?"ANSWER"===i.messageType?(i.sdp=d(i.sdp),i.sdp=i.sdp.replace(/ generation 0/g,""),i.sdp=i.sdp.replace(/ udp /g," UDP "),-1!==i.sdp.indexOf("a=group:BUNDLE")?(i.sdp=i.sdp.replace(/a=group:BUNDLE audio video/,"a=group:BUNDLE sdparta_0 sdparta_1"),i.sdp=i.sdp.replace(/a=mid:audio/,"a=mid:sdparta_0"),i.sdp=i.sdp.replace(/a=mid:video/,"a=mid:sdparta_1")):(i.sdp=i.sdp.replace(/a=mid:audio/,"a=mid:sdparta_0"),i.sdp=i.sdp.replace(/a=mid:video/,"a=mid:sdparta_0")),r={sdp:i.sdp,type:"answer"},t.peerConnection.setRemoteDescription(new n(r),(function(){a.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){a.default.info("["+t.clientId+"]setRemoteDescription failed: "+e)})),t.state="established"):"pr-answer"===i.messageType?(r={sdp:i.sdp,type:"pr-answer"},t.peerConnection.setRemoteDescription(new n(r),(function(){a.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){a.default.info("["+t.clientId+"]setRemoteDescription failed: "+e.name)}))):"offer"===i.messageType?t.error("Not written yet"):t.error("Illegal message for this state: "+i.messageType+" in state "+t.state):"established"===t.state&&("OFFER"===i.messageType?(r={sdp:i.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new n(r),(function(){a.default.debug("["+t.clientId+"]setRemoteDescription succeeded")}),(function(e){a.default.info("["+t.clientId+"]setRemoteDescription failed: "+e.name)})),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+i.messageType+" in state "+t.state))};var i={id:"",type:"",mediaType:"opus",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},s={id:"",type:"",mediaType:"",googCodecName:"h264"===e.codec?"H264":"VP8",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0"},u={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},c={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0",googFramesDecoded:"0"},l=0;t.getVideoRelatedStats=function(e){t.peerConnection.getStats().then((function(n){var r=!0,i=!1,o=void 0;try{for(var a,s=n.values()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(t.isSubscriber){if(("inbound-rtp"===u.type||"inboundrtp"===u.type)&&"video"===u.mediaType){if(!t.lastReport)return void(t.lastReport=u);e&&e({browser:"firefox",mediaType:"video",peerId:t.uid,isVideoMute:t.isVideoMute,frameRateReceived:u.framerateMean+"",frameRateDecoded:u.framesDecoded-t.lastReport.framesDecoded+"",bytesReceived:u.bytesReceived+"",packetsReceived:u.packetsReceived+"",packetsLost:u.packetsLost+""}),t.lastReport=u}}else if(("outbound-rtp"===u.type||"outboundrtp"===u.type)&&"video"===u.mediaType){if(!t.lastReport)return void(t.lastReport=u);e&&e({mediaType:"video",isVideoMute:t.isVideoMute,frameRateInput:u.framerateMean+"",frameRateSent:u.framesEncoded-t.lastReport.framesEncoded+""}),t.lastReport=u}}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}))},t.getAudioRelatedStats=function(e){t.peerConnection.getStats().then((function(n){var r=!0,i=!1,o=void 0;try{for(var a,s=n.values()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;t.isSubscriber&&("inbound-rtp"!==u.type&&"inboundrtp"!==u.type||"audio"!==u.mediaType||e&&e({browser:"firefox",mediaType:"audio",peerId:t.uid,isAudioMute:t.isAudioMute,frameDropped:u.packetsLost+"",frameReceived:u.packetsReceived+"",googJitterReceived:u.jitter+"",bytesReceived:u.bytesReceived+"",packetsReceived:u.packetsReceived+"",packetsLost:u.packetsLost+""}))}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}))},t.getStatsRate=function(e){t.getStats((function(t){t.forEach((function(e){"inbound-rtp"!==e.type&&"inboundrtp"!==e.type||"video"!==e.mediaType||e.googFrameRateDecoded&&(e.googFrameRateDecoded=((e.googFramesDecoded-l)/3).toString(),l=e.googFramesDecoded)})),e(t)}))},t.getStats=function(e,n){n=(n=n||500)>500?500:n,t.lastTimeGetStats&&Date.now()-t.lastTimeGetStats<n?e&&e(t.filterStatsCache,t.originStatsCache):this._getStats((function(n,r){t.filterStatsCache=n,t.originStatsCache=r,t.lastTimeGetStats=Date.now(),e&&e(n,r)}))},t._getStats=function(e){t.peerConnection.getStats().then((function(n){var r=[],o=!0,a=!1,l=void 0;try{for(var d,p=n.values()[Symbol.iterator]();!(o=(d=p.next()).done);o=!0){var f=d.value;r.push(f),"outbound-rtp"!==f.type&&"outboundrtp"!==f.type||"video"!==f.mediaType||-1!==f.id.indexOf("rtcp")||(s.id=f.id,s.type=f.type,s.mediaType=f.mediaType,s.bytesSent=f.bytesSent?f.bytesSent+"":"0",s.packetsSent=f.packetsSent?f.packetsSent+"":"0",s.googPlisReceived=f.pliCount?f.pliCount+"":"0",s.googNacksReceived=f.nackCount?f.nackCount+"":"0",s.googFirsReceived=f.firCount?f.firCount+"":"0",s.googFrameRateSent=f.framerateMean?f.framerateMean+"":"0"),"outbound-rtp"!==f.type&&"outboundrtp"!==f.type||"audio"!==f.mediaType||-1!==f.id.indexOf("rtcp")||(i.id=f.id,i.type=f.type,i.mediaType=f.mediaType,i.bytesSent=f.bytesSent?f.bytesSent+"":"0",i.packetsSent=f.packetsSent?f.packetsSent+"":"0"),"inbound-rtp"!==f.type&&"inboundrtp"!==f.type||"audio"!==f.mediaType||f.isRemote||-1!==f.id.indexOf("rtcp")||(u.id=f.id,u.type=f.type,u.mediaType=f.mediaType,u.bytesReceived=f.bytesReceived?f.bytesReceived+"":"0",u.packetsLost=f.packetsLost?f.packetsLost+"":"0",u.packetsReceived=f.packetsReceived?f.packetsReceived+"":"0",u.googJitterReceived=f.jitter?f.jitter+"":"0"),"inbound-rtp"!==f.type&&"inboundrtp"!==f.type||"video"!==f.mediaType||f.isRemote||-1!==f.id.indexOf("rtcp")||(c.id=f.id,c.type=f.type,c.mediaType=f.mediaType,c.bytesReceived=f.bytesReceived?f.bytesReceived+"":"0",c.googFrameRateReceived=f.framerateMean?f.framerateMean+"":"0",c.googFramesDecoded=f.framesDecoded?f.framesDecoded+"":"0",c.packetsLost=f.packetsLost?f.packetsLost+"":"0",c.packetsReceived=f.packetsReceived?f.packetsReceived+"":"0",c.googJitterBufferMs=f.jitter?f.jitter+"":"0",c.googNacksSent=f.nackCount?f.nackCount+"":"0",c.googPlisSent=f.pliCount?f.pliCount+"":"0",c.googFirsSent=f.firCount?f.firCount+"":"0"),-1!==f.id.indexOf("outbound_rtcp_video")&&(s.packetsLost=f.packetsLost?f.packetsLost+"":"0")}}catch(e){a=!0,l=e}finally{try{o||null==p.return||p.return()}finally{if(a)throw l}}var h=[s,i,u,c];h.push({id:"time",startTime:t.connectedTime,timestamp:new Date}),e(h,r)}),(function(e){a.default.error("["+t.clientId+"]"+e)}))},t.addStream=function(e){r=!0,t.peerConnection.addStream(e),t.markActionNeeded()},t.removeStream=function(){t.markActionNeeded()},t.close=function(){t.state="closed",t.peerConnection.close()},t.markActionNeeded=function(){t.actionNeeded=!0,t.doLater((function(){t.onstablestate()}))},t.doLater=function(e){window.setTimeout(e,1)},t.onstablestate=function(){if(t.actionNeeded){if("new"===t.state||"established"===t.state)r&&(t.mediaConstraints=void 0),t.peerConnection.createOffer((function(e){if(e.sdp=d(e.sdp),e.sdp=e.sdp.replace(/a=extmap:1 http:\/\/www.webrtc.org\/experiments\/rtp-hdrext\/abs-send-time/,"a=extmap:3 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"),e.sdp!==t.prevOffer)return t.peerConnection.setLocalDescription(e),t.state="preparing-offer",void t.markActionNeeded();a.default.debug("["+t.clientId+"]Not sending a new offer")}),(function(e){a.default.debug("["+t.clientId+"]Ups! create offer failed ",e)}),t.mediaConstraints);else if("preparing-offer"===t.state){if(t.moreIceComing)return;t.prevOffer=t.peerConnection.localDescription.sdp,t.offerCandidates=t.prevOffer.match(/a=candidate.+\r\n/g)||[],t.offerCandidates.length||(a.default.warning("[".concat(t.clientId,"]No Ice Candidate generated")),Object(o.getParameter)("SHIM_CANDIDATE")?(a.default.debug("Shimming fake candidate"),t.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):a.default.error("[".concat(t.clientId,"]None Ice Candidate not allowed"))),t.prevOffer=t.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),t.sendMessage("OFFER",t.prevOffer),t.state="offer-sent"}else if("offer-received"===t.state)t.peerConnection.createAnswer((function(e){if(t.peerConnection.setLocalDescription(e),t.state="offer-received-preparing-answer",t.iceStarted)t.markActionNeeded();else{var n=new Date;a.default.debug("["+t.clientId+"]"+n.getTime()+": Starting ICE in responder"),t.iceStarted=!0}}),(function(){a.default.debug("["+t.clientId+"]Ups! Something went wrong")}));else if("offer-received-preparing-answer"===t.state){if(t.moreIceComing)return;var e=t.peerConnection.localDescription.sdp;t.sendMessage("ANSWER",e),t.state="established"}else t.debug("Dazed and confused in state "+t.state+", stopping here");t.actionNeeded=!1}},t.sendMessage=function(e,n){var r={};r.messageType=e,r.sdp=n,"OFFER"===e?(r.offererSessionId=t.sessionId,r.answererSessionId=t.otherSessionId,r.seq=t.sequenceNumber+=1,r.tiebreaker=Math.floor(429496723*Math.random()+1)):(r.offererSessionId=t.incomingMessage.offererSessionId,r.answererSessionId=t.sessionId,r.seq=t.incomingMessage.seq),t.onsignalingmessage(JSON.stringify(r))},t._getSender=function(e){if(t.peerConnection&&t.peerConnection.getSenders){var n=t.peerConnection.getSenders().find((function(t){return t.track.kind==e}));if(n)return n}return null},t.hasSender=function(e){return!!t._getSender(e)},t.replaceTrack=function(e,n,r){var i=t._getSender(e.kind);if(!i)return r("NO_SENDER_FOUND");try{i.replaceTrack(e)}catch(e){return r&&r(e)}setTimeout((function(){return n&&n()}),50)},t.error=function(e){throw"Error in RoapOnJsep: "+e},t.sessionId=t.roapSessionId+=1,t.sequenceNumber=0,t.actionNeeded=!1,t.iceStarted=!1,t.moreIceComing=!0,t.iceCandidateCount=0,t.onsignalingmessage=e.callback,t.peerConnection.ontrack=function(e){t.onaddstream&&t.onaddstream(e,"ontrack")},t.peerConnection.onremovestream=function(e){t.onremovestream&&t.onremovestream(e)},t.peerConnection.oniceconnectionstatechange=function(e){"connected"===e.currentTarget.iceConnectionState&&(t.connectedTime=new Date),t.oniceconnectionstatechange&&t.oniceconnectionstatechange(e.currentTarget.iceConnectionState)};var d=function(t){var n;if(e.video&&e.maxVideoBW&&(null==(n=t.match(/m=video.*\r\n/))&&(n=t.match(/m=video.*\n/)),n&&n.length>0)){var r=n[0]+"b=TIAS:"+1e3*e.maxVideoBW+"\r\n";t=t.replace(n[0],r)}return e.audio&&e.maxAudioBW&&(null==(n=t.match(/m=audio.*\r\n/))&&(n=t.match(/m=audio.*\n/)),n&&n.length>0)&&(r=n[0]+"b=TIAS:"+1e3*e.maxAudioBW+"\r\n",t=t.replace(n[0],r)),t};return t.onaddstream=null,t.onremovestream=null,t.state="new",t.markActionNeeded(),t}(e)):"iOS"===h.getBrowserOS()||h.isSafari()?(a.default.debug("["+t.streamId+"]["+t.clientId+"]Safari"),(t=function(e){var t={},n=b.RTCPeerConnection;t.uid=e.uid,t.isVideoMute=e.isVideoMute,t.isAudioMute=e.isAudioMute,t.isSubscriber=e.isSubscriber,t.clientId=e.clientId,t.filterStatsCache=[],t.originStatsCache=[],t.lastTimeGetStats=null,t.pc_config={iceServers:[{urls:["stun:webcs.agora.io:3478","stun:stun.l.google.com:19302"]}],bundlePolicy:"max-bundle"},t.con={optional:[{DtlsSrtpKeyAgreement:!0}]},e.iceServers instanceof Array?t.pc_config.iceServers=e.iceServers:(e.stunServerUrl&&(e.stunServerUrl instanceof Array?e.stunServerUrl.map((function(e){"string"==typeof e&&""!==e&&t.pc_config.iceServers.push({url:e})})):"string"==typeof e.stunServerUrl&&""!==e.stunServerUrl&&t.pc_config.iceServers.push({url:e.stunServerUrl})),e.turnServer&&(e.turnServer instanceof Array?e.turnServer.map((function(e){"string"==typeof e.url&&""!==e.url&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,url:e.url})})):"auto"!==e.turnServer.mode&&"manual"!==e.turnServer.mode||(e.turnServer.udpport&&t.pc_config.iceServers.push({username:e.turnServer.username,credential:e.turnServer.credential,credentialType:"password",urls:["turn:"+e.turnServer.url+":"+e.turnServer.udpport+"?transport=udp"]}),"string"==typeof e.turnServer.tcpport&&""!==e.turnServer.tcpport&&t.pc_config.iceServers.push({username:e.turnServer.username,credential:e.turnServer.credential,credentialType:"password",urls:["turn:"+e.turnServer.url+":"+e.turnServer.tcpport+"?transport=tcp"]}),!0===e.turnServer.forceturn&&(t.pc_config.iceTransportPolicy="relay")))),void 0===e.audio&&(e.audio=!0),void 0===e.video&&(e.video=!0),t.mediaConstraints={mandatory:{OfferToReceiveVideo:e.video,OfferToReceiveAudio:e.audio}},t.roapSessionId=103;try{t.pc_config.sdpSemantics="plan-b",t.peerConnection=new n(t.pc_config,t.con)}catch(e){delete t.pc_config.sdpSemantics,t.peerConnection=new n(t.pc_config,t.con)}a.default.debug("["+t.clientId+']safari Created RTCPeerConnnection with config "'+JSON.stringify(t.pc_config)+'".'),t.iceCandidateTimer=setTimeout((function(){t.iceCandidateTimer=null,a.default.debug("[".concat(t.clientId,"]Candidates collected: ").concat(t.iceCandidateCount)),t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),Object(o.getParameter)("CANDIDATE_TIMEOUT")),t.peerConnection.onicecandidate=function(e){var n,r,i,o;r=(n=t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),i=n.match(/a=candidate:.+typ\shost.+\r\n/),o=n.match(/a=candidate:.+typ\srelay.+\r\n/),0===t.iceCandidateCount&&(t.timeout=setTimeout((function(){t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),1e3)),null===r&&null===i&&null===o||void 0!==t.ice||!t.iceCandidateTimer||(a.default.debug("["+t.clientId+"]srflx candidate : "+r+" relay candidate: "+o+" host candidate : "+i),clearTimeout(t.iceCandidateTimer),t.iceCandidateTimer=null,t.ice=0,t.moreIceComing=!1,t.markActionNeeded()),t.iceCandidateCount=t.iceCandidateCount+1};var r=function(t){return e.screen&&(t=t.replace("a=x-google-flag:conference\r\n","")),t},i=function(n){var r,i;return(r=n.match(/m=video.*\r\n/))&&e.minVideoBW&&e.maxVideoBW&&(i=r[0]+"b=AS:"+e.maxVideoBW+"\r\n",n=n.replace(r[0],i),a.default.debug("["+t.clientId+"]Set Video Bitrate - min:"+e.minVideoBW+" max:"+e.maxVideoBW)),(r=n.match(/m=audio.*\r\n/))&&e.maxAudioBW&&(i=r[0]+"b=AS:"+e.maxAudioBW+"\r\n",n=n.replace(r[0],i)),n};t.processSignalingMessage=function(e){var n,o=JSON.parse(e);t.incomingMessage=o,"new"===t.state?"OFFER"===o.messageType?(n={sdp:o.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+o.messageType+" in state "+t.state):"offer-sent"===t.state?"ANSWER"===o.messageType?((n={sdp:o.sdp,type:"answer"}).sdp=r(n.sdp),n.sdp=i(n.sdp),n.sdp=n.sdp.replace(/a=x-google-flag:conference\r\n/g,""),t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)),t.state="established"):"pr-answer"===o.messageType?(n={sdp:o.sdp,type:"pr-answer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(n))):"offer"===o.messageType?t.error("Not written yet"):t.error("Illegal message for this state: "+o.messageType+" in state "+t.state):"established"===t.state&&("OFFER"===o.messageType?(n={sdp:o.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)),t.state="offer-received",t.markActionNeeded()):"ANSWER"===o.messageType?((n={sdp:o.sdp,type:"answer"}).sdp=r(n.sdp),n.sdp=i(n.sdp),t.peerConnection.setRemoteDescription(new RTCSessionDescription(n))):t.error("Illegal message for this state: "+o.messageType+" in state "+t.state))};var s={id:"",type:"",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},u={id:"",type:"",mediaType:"",googCodecName:"h264"===e.codec?"H264":"VP8",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0",googFramesEncoded:"0"},c={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},l={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googFramesDecoded:"0",googFrameReceived:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0"},d={id:"bweforvideo",type:"VideoBwe",googAvailableSendBandwidth:"0",googAvailableReceiveBandwidth:"0",googActualEncBitrate:"0",googRetransmitBitrate:"0",googTargetEncBitrate:"0",googBucketDelay:"0",googTransmitBitrate:"0"},p=0,f=0,h=0;return t.getVideoRelatedStats=function(n){t.peerConnection.getStats().then((function(r){var i={peerId:t.uid,mediaType:"video",isVideoMute:t.isVideoMute};r.forEach((function(r){if(t.isSubscriber){if("track"===r.type&&(~r.id.indexOf("video")||~r.trackIdentifier.indexOf("v"))){if(!t.lastReport)return void(t.lastReport=r);i.frameRateReceived=r.framesReceived-t.lastReport.framesReceived+"",i.frameRateDecoded=r.framesDecoded-t.lastReport.framesDecoded+"",t.lastReport=r}"inbound-rtp"===r.type&&~r.id.indexOf("Video")&&(i.bytesReceived=r.bytesReceived+"",i.packetsReceived=r.packetsReceived+"",i.packetsLost=r.packetsLost+"")}else if("outbound-rtp"===r.type&&~r.id.indexOf("Video")){if(!t.lastReport)return void(t.lastReport=r);n&&n({mediaType:"video",isVideoMute:t.isVideoMute,frameRateInput:e.maxFrameRate+"",frameRateSent:r.framesEncoded-t.lastReport.framesEncoded+""}),t.lastReport=r}})),n&&n(i)}))},t.getAudioRelatedStats=function(e){t.peerConnection.getStats().then((function(n){n.forEach((function(n){t.isSubscriber&&"inbound-rtp"===n.type&&~n.id.indexOf("Audio")&&e&&e({peerId:t.uid,mediaType:"audio",isAudioMute:t.isAudioMute,frameDropped:n.packetsLost+"",frameReceived:n.packetsReceived+"",googJitterReceived:n.jitter+"",bytesReceived:n.bytesReceived+"",packetsReceived:n.packetsReceived+"",packetsLost:n.packetsLost+""})}))}))},t.getStatsRate=function(e){t.getStats((function(t){t.forEach((function(e){"outbound-rtp"===e.type&&"video"===e.mediaType&&e.googFramesEncoded&&(e.googFrameRateSent=((e.googFramesEncoded-p)/3).toString(),p=e.googFramesEncoded),"inbound-rtp"===e.type&&-1!=e.id.indexOf("55543")&&(e.googFrameRateReceived&&(e.googFrameRateReceived=((e.googFrameReceived-h)/3).toString(),h=e.googFrameReceived),e.googFrameRateDecoded&&(e.googFrameRateDecoded=((e.googFramesDecoded-f)/3).toString(),f=e.googFramesDecoded))})),e(t)}))},t.getStats=function(e,n){n=(n=n||500)>500?500:n,t.lastTimeGetStats&&Date.now()-t.lastTimeGetStats<n?e&&e(t.filterStatsCache,t.originStatsCache):this._getStats((function(n,r){t.filterStatsCache=n,t.originStatsCache=r,t.lastTimeGetStats=Date.now(),e&&e(n,r)}))},t._getStats=function(e){var n=[];t.peerConnection.getStats().then((function(r){r.forEach((function(e){n.push(e),"outbound-rtp"===e.type&&"audio"===e.mediaType&&(s.id=e.id,s.type=e.type,s.mediaType=e.mediaType,s.bytesSent=e.bytesSent?e.bytesSent+"":"0",s.packetsSent=e.packetsSent?e.packetsSent+"":"0"),"outbound-rtp"===e.type&&"video"===e.mediaType&&(u.id=e.id,u.type=e.type,u.mediaType=e.mediaType,u.bytesSent=e.bytesSent?e.bytesSent+"":"0",u.packetsSent=e.packetsSent?e.packetsSent+"":"0",u.googPlisReceived=e.pliCount?e.pliCount+"":"0",u.googNacksReceived=e.nackCount?e.nackCount+"":"0",u.googFirsReceived=e.firCount?e.firCount+"":"0",u.googFramesEncoded=e.framesEncoded?e.framesEncoded+"":"0"),"inbound-rtp"===e.type&&-1!=e.id.indexOf("44444")&&(c.id=e.id,c.type=e.type,c.mediaType="audio",c.packetsReceived=e.packetsReceived?e.packetsReceived+"":"0",c.bytesReceived=e.bytesReceived?e.bytesReceived+"":"0",c.packetsLost=e.packetsLost?e.packetsLost+"":"0",c.packetsReceived=e.packetsReceived?e.packetsReceived+"":"0",c.googJitterReceived=e.jitter?e.jitter+"":"0"),"inbound-rtp"===e.type&&-1!=e.id.indexOf("55543")&&(l.id=e.id,l.type=e.type,l.mediaType="video",l.packetsReceived=e.packetsReceived?e.packetsReceived+"":"0",l.bytesReceived=e.bytesReceived?e.bytesReceived+"":"0",l.packetsLost=e.packetsLost?e.packetsLost+"":"0",l.googJitterBufferMs=e.jitter?e.jitter+"":"0",l.googNacksSent=e.nackCount?e.nackCount+"":"0",l.googPlisSent=e.pliCount?e.pliCount+"":"0",l.googFirsSent=e.firCount?e.firCount+"":"0"),"track"!==e.type||-1==e.id.indexOf("55543")&&!~e.trackIdentifier.indexOf("v")&&null!=e.audioLevel||(l.googFrameWidthReceived=e.frameWidth?e.frameWidth+"":"0",l.googFrameHeightReceived=e.frameHeight?e.frameHeight+"":"0",l.googFrameReceived=e.framesReceived?e.framesReceived+"":"0",l.googFramesDecoded=e.framesDecoded?e.framesDecoded+"":"0"),"track"!==e.type||-1==e.id.indexOf("44444")&&!~e.trackIdentifier.indexOf("a")&&void 0===e.audioLevel||(c.audioOutputLevel=e.audioLevel+"",s.audioInputLevel=e.audioLevel+""),"candidate-pair"===e.type&&(0==e.availableIncomingBitrate?d.googAvailableSendBandwidth=e.availableOutgoingBitrate+"":d.googAvailableReceiveBandwidth=e.availableIncomingBitrate+"")}));var i=[d,s,u,c,l];i.push({id:"time",startTime:t.connectedTime,timestamp:new Date}),e(i,n)})).catch((function(e){console.error(e)}))},t.addTrack=function(e,n){t.peerConnection.addTrack(e,n)},t.removeTrack=function(e,n){var r=t.peerConnection.getSenders().find((function(t){return t.track==e}));r.replaceTrack(null),t.peerConnection.removeTrack(r)},t.addStream=function(e){window.navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")?e.getTracks().forEach((function(n){return t.peerConnection.addTrack(n,e)})):t.peerConnection.addStream(e),t.markActionNeeded()},t.removeStream=function(){t.markActionNeeded()},t.close=function(){t.state="closed",t.peerConnection.close()},t.markActionNeeded=function(){t.actionNeeded=!0,t.doLater((function(){t.onstablestate()}))},t.doLater=function(e){window.setTimeout(e,1)},t.onstablestate=function(){var n;if(t.actionNeeded){if("new"===t.state||"established"===t.state)e.isSubscriber&&(t.peerConnection.addTransceiver("audio",{direction:"recvonly"}),t.peerConnection.addTransceiver("video",{direction:"recvonly"})),t.peerConnection.createOffer(t.mediaConstraints).then((function(n){if(n.sdp=i(n.sdp),e.isSubscriber||(n.sdp=n.sdp.replace(/a=extmap:4 urn:3gpp:video-orientation\r\n/g,"")),n.sdp!==t.prevOffer)return t.peerConnection.setLocalDescription(n),t.state="preparing-offer",void t.markActionNeeded();a.default.debug("["+t.clientId+"]Not sending a new offer")})).catch((function(e){a.default.debug("["+t.clientId+"]peer connection create offer failed ",e)}));else if("preparing-offer"===t.state){if(t.moreIceComing)return;t.prevOffer=t.peerConnection.localDescription.sdp,t.offerCandidates=t.prevOffer.match(/a=candidate.+\r\n/g)||[],t.offerCandidates.length||(a.default.warning("[".concat(t.clientId,"]No Ice Candidate generated")),Object(o.getParameter)("SHIM_CANDIDATE")?(a.default.debug("Shimming fake candidate"),t.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):a.default.error("[".concat(t.clientId,"]None Ice Candidate not allowed"))),t.prevOffer=t.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),t.sendMessage("OFFER",t.prevOffer),t.state="offer-sent"}else if("offer-received"===t.state)t.peerConnection.createAnswer((function(e){if(t.peerConnection.setLocalDescription(e),t.state="offer-received-preparing-answer",t.iceStarted)t.markActionNeeded();else{var n=new Date;a.default.debug("["+t.clientId+"]"+n.getTime()+": Starting ICE in responder"),t.iceStarted=!0}}),(function(e){a.default.debug("["+t.clientId+"]peer connection create answer failed ",e)}),t.mediaConstraints);else if("offer-received-preparing-answer"===t.state){if(t.moreIceComing)return;n=t.peerConnection.localDescription.sdp,t.sendMessage("ANSWER",n),t.state="established"}else t.debug("Dazed and confused in state "+t.state+", stopping here");t.actionNeeded=!1}},t.sendMessage=function(e,n){var r={};r.messageType=e,r.sdp=n,"OFFER"===e?(r.offererSessionId=t.sessionId,r.answererSessionId=t.otherSessionId,r.seq=t.sequenceNumber+=1,r.tiebreaker=Math.floor(429496723*Math.random()+1)):(r.offererSessionId=t.incomingMessage.offererSessionId,r.answererSessionId=t.sessionId,r.seq=t.incomingMessage.seq),t.onsignalingmessage(JSON.stringify(r))},t._getSender=function(e){if(t.peerConnection&&t.peerConnection.getSenders){var n=t.peerConnection.getSenders().find((function(t){return t.track.kind==e}));if(n)return n}return null},t.hasSender=function(e){return!!t._getSender(e)},t.replaceTrack=function(e,n,r){var i=t._getSender(e.kind);if(!i)return r("NO_SENDER_FOUND");try{i.replaceTrack(e)}catch(e){return r&&r(e)}setTimeout((function(){return n&&n()}),50)},t.error=function(e){throw"Error in RoapOnJsep: "+e},t.sessionId=t.roapSessionId+=1,t.sequenceNumber=0,t.actionNeeded=!1,t.iceStarted=!1,t.moreIceComing=!0,t.iceCandidateCount=0,t.onsignalingmessage=e.callback,t.peerConnection.ontrack=function(e){console.log("!!! ontrack, ",e.track.kind,e.track),t.onaddstream&&t.onaddstream(e,"ontrack")},t.peerConnection.onremovestream=function(e){t.onremovestream&&t.onremovestream(e)},t.peerConnection.oniceconnectionstatechange=function(e){"connected"===e.currentTarget.iceConnectionState&&(t.connectedTime=new Date),t.oniceconnectionstatechange&&t.oniceconnectionstatechange(e.currentTarget.iceConnectionState)},t.renegotiate=function(){void 0!==t.prevOffer&&t.peerConnection.createOffer().then((function(e){return e.sdp=e.sdp.replace(/a=recvonly\r\n/g,"a=inactive\r\n"),e.sdp=r(e.sdp),e.sdp=i(e.sdp),t.peerConnection.setLocalDescription(e)})).then((function(){t.onnegotiationneeded&&t.onnegotiationneeded(t.peerConnection.localDescription.sdp)})).catch((function(e){console.log("createOffer error: ",e)}))},t.peerConnection.onnegotiationneeded=t.renegotiate,t.onaddstream=null,t.onremovestream=null,t.state="new",t.markActionNeeded(),t}(e)).browser="safari"):~window.navigator.userAgent.indexOf("Edge")?t=new T.a(e):(t=function(e){var t={},n=b.RTCPeerConnection;t.uid=e.uid,t.isVideoMute=e.isVideoMute,t.isAudioMute=e.isAudioMute,t.isSubscriber=e.isSubscriber,t.clientId=e.clientId,t.filterStatsCache=[],t.originStatsCache=[],t.lastTimeGetStats=null,t.pc_config={iceServers:[{url:"stun:webcs.agora.io:3478"}]};var r={id:"outbound_audio_ssrc_send",type:"ssrc",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},i={id:"outbound_video_ssrc_send",type:"ssrc",mediaType:"",googCodecName:"h264"===e.codec?"H264":"VP8",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0"},s={id:"inbound_audio_ssrc_recv",type:"ssrc",mediaType:"",googCodecName:"opus",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},u={id:"inbound_video_ssrc_recv",type:"ssrc",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0",googFramesReceived:"0",googFramesDecoded:"0"},c={id:"bweforvideo",type:"VideoBwe",googAvailableSendBandwidth:"0",googAvailableReceiveBandwidth:"0",googActualEncBitrate:"0",googRetransmitBitrate:"0",googTargetEncBitrate:"0",googBucketDelay:"0",googTransmitBitrate:"0"};t.con={optional:[{DtlsSrtpKeyAgreement:!0}]},e.iceServers instanceof Array?t.pc_config.iceServers=e.iceServers:(e.stunServerUrl&&(e.stunServerUrl instanceof Array?e.stunServerUrl.map((function(e){"string"==typeof e&&""!==e&&t.pc_config.iceServers.push({url:e})})):"string"==typeof e.stunServerUrl&&""!==e.stunServerUrl&&t.pc_config.iceServers.push({url:e.stunServerUrl})),e.turnServer&&(e.turnServer instanceof Array?e.turnServer.map((function(e){"string"==typeof e.url&&""!==e.url&&t.pc_config.iceServers.push({username:e.username,credential:e.credential,url:e.url})})):"auto"!==e.turnServer.mode&&"manual"!==e.turnServer.mode||(e.turnServer.udpport&&t.pc_config.iceServers.push({username:e.turnServer.username,credential:e.turnServer.credential,credentialType:"password",urls:"turn:"+e.turnServer.url+":"+e.turnServer.udpport+"?transport=udp"}),"string"==typeof e.turnServer.tcpport&&""!==e.turnServer.tcpport&&t.pc_config.iceServers.push({username:e.turnServer.username,credential:e.turnServer.credential,credentialType:"password",urls:"turn:"+e.turnServer.url+":"+e.turnServer.tcpport+"?transport=tcp"}),!0===e.turnServer.forceturn&&(t.pc_config.iceTransportPolicy="relay")))),void 0===e.audio&&(e.audio=!0),void 0===e.video&&(e.video=!0),t.mediaConstraints={mandatory:{OfferToReceiveVideo:e.video,OfferToReceiveAudio:e.audio}},t.roapSessionId=103;try{t.pc_config.sdpSemantics="plan-b",t.peerConnection=new n(t.pc_config,t.con)}catch(e){delete t.pc_config.sdpSemantics,t.peerConnection=new n(t.pc_config,t.con)}t.iceCandidateTimer=setTimeout((function(){t.iceCandidateTimer=null,a.default.debug("[".concat(t.clientId,"]Candidates collected: ").concat(t.iceCandidateCount)),t.moreIceComing&&(t.moreIceComing=!1,t.markActionNeeded())}),Object(o.getParameter)("CANDIDATE_TIMEOUT")),t.peerConnection.onicecandidate=function(e){var n,r,i,o;r=(n=t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),i=n.match(/a=candidate:.+typ\shost.+\r\n/),o=n.match(/a=candidate:.+typ\srelay.+\r\n/),null===r&&null===i&&null===o||void 0!==t.ice||!t.iceCandidateTimer||(a.default.debug("["+t.clientId+"]srflx candidate : "+r+" relay candidate: "+o+" host candidate : "+i),clearTimeout(t.iceCandidateTimer),t.iceCandidateTimer=null,t.ice=0,t.moreIceComing=!1,t.markActionNeeded()),t.iceCandidateCount=t.iceCandidateCount+1},a.default.debug("["+t.clientId+']Created webkitRTCPeerConnnection with config "'+JSON.stringify(t.pc_config)+'".');var l=function(t){return e.screen&&(t=t.replace("a=x-google-flag:conference\r\n","")),t},d=function(n){var r,i;if((r=n.match(/m=video.*\r\n/))&&e.minVideoBW&&e.maxVideoBW){i=r[0]+"b=AS:"+e.maxVideoBW+"\r\n";var o=0,s=0;"h264"===e.codec?(o=n.search(/a=rtpmap:(\d+) H264\/90000\r\n/),s=n.search(/H264\/90000\r\n/)):"vp8"===e.codec&&(o=n.search(/a=rtpmap:(\d+) VP8\/90000\r\n/),s=n.search(/VP8\/90000\r\n/)),-1!==o&&-1!==s&&s-o>10&&(i=i+"a=fmtp:"+n.slice(o+9,s-1)+" x-google-min-bitrate="+e.minVideoBW+"\r\n"),n=n.replace(r[0],i),a.default.debug("["+t.clientId+"]Set Video Bitrate - min:"+e.minVideoBW+" max:"+e.maxVideoBW)}return(r=n.match(/m=audio.*\r\n/))&&e.maxAudioBW&&(i=r[0]+"b=AS:"+e.maxAudioBW+"\r\n",n=n.replace(r[0],i)),n};t.processSignalingMessage=function(e){var n,r=JSON.parse(e);t.incomingMessage=r,"new"===t.state?"OFFER"===r.messageType?(n={sdp:r.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).catch((function(e){})),t.state="offer-received",t.markActionNeeded()):t.error("Illegal message for this state: "+r.messageType+" in state "+t.state):"offer-sent"===t.state?"ANSWER"===r.messageType?((n={sdp:r.sdp,type:"answer"}).sdp=l(n.sdp),n.sdp=d(n.sdp),t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).catch((function(e){})),t.state="established"):"pr-answer"===r.messageType?(n={sdp:r.sdp,type:"pr-answer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).catch((function(e){}))):"offer"===r.messageType?t.error("Not written yet"):t.error("Illegal message for this state: "+r.messageType+" in state "+t.state):"established"===t.state&&("OFFER"===r.messageType?(n={sdp:r.sdp,type:"offer"},t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).catch((function(e){})),t.state="offer-received",t.markActionNeeded()):"ANSWER"===r.messageType?((n={sdp:r.sdp,type:"answer"}).sdp=l(n.sdp),n.sdp=d(n.sdp),t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).catch((function(e){}))):t.error("Illegal message for this state: "+r.messageType+" in state "+t.state))};var p=0,f=0;return t.getVideoRelatedStats=function(e){t.getStats((function(n){n.forEach((function(n){if(t.isSubscriber){if("video"===n.mediaType&&n.id&&~n.id.indexOf("recv")){if(h.isChromeKernel()&&+h.getBrowserVersion()>=76){var r=+n.googFramesReceived-p,i=+n.googFramesDecoded-f;t._setStat(u,"googFrameRateReceived",r),t._setStat(u,"googFrameRateDecoded",i),t._setStat(u,"googFrameRateOutput",i),p=+n.googFramesReceived,f=+n.googFramesDecoded}e&&e({mediaType:"video",peerId:t.uid,isVideoMute:t.isVideoMute,frameRateReceived:n.googFrameRateReceived,frameRateDecoded:n.googFrameRateDecoded,bytesReceived:n.bytesReceived,packetsReceived:n.packetsReceived,packetsLost:n.packetsLost})}}else"video"===n.mediaType&&n.id&&~n.id.indexOf("send")&&e&&e({mediaType:"video",isVideoMute:t.isVideoMute,frameRateInput:n.googFrameRateInput,frameRateSent:n.googFrameRateSent,googRtt:n.googRtt})}))}))},t.getAudioRelatedStats=function(e){t.getStats((function(n){n.forEach((function(n){t.isSubscriber&&"audio"===n.mediaType&&n.id&&~n.id.indexOf("recv")&&e&&e({mediaType:"audio",peerId:t.uid,isAudioMute:t.isAudioMute,frameDropped:parseInt(n.googDecodingPLC)+parseInt(n.googDecodingPLCCNG)+"",frameReceived:n.googDecodingCTN,googJitterReceived:n.googJitterReceived,bytesReceived:n.bytesReceived,packetsReceived:n.packetsReceived,packetsLost:n.packetsLost})}))}))},t.getStatsRate=function(e){t.getStats((function(t){e(t)}))},t.getStats=function(e,n){n=(n=n||500)>500?500:n,t.lastTimeGetStats&&Date.now()-t.lastTimeGetStats<n?e&&e(t.filterStatsCache,t.originStatsCache):(t.lastTimeGetStats=Date.now(),this._getStats((function(n,r){t.filterStatsCache=n,t.originStatsCache=r,e&&e(n,r)})))},t._setStat=function(e,t,n){e.hasOwnProperty(t)&&(null!=n&&n!==1/0&&n==n||(n=0),e[t]=n+"")},t._processGetStatsAfterChrome76=function(e){var n=this;t.lastStats||(t.lastStats=new Map),t.peerConnection.getStats().then((function(o){var a=[],l=[],d=new Map,p=new Date,f=!0,h=!1,g=void 0;try{for(var m,v=o.values()[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var _=m.value;"codec"!=_.type?"candidate-pair"!=_.type?("inbound-rtp"===_.type&&"video"===_.mediaType&&d.set("inbound-video",_),"inbound-rtp"===_.type&&"audio"===_.mediaType&&d.set("inbound-audio",_),"outbound-rtp"===_.type&&"audio"===_.mediaType&&d.set("outbound-audio",_),"outbound-rtp"===_.type&&"video"===_.mediaType&&d.set("outbound-video",_),"track"===_.type&&"video"===_.kind&&_.remoteSource&&d.set("remote-video-track",_),"track"===_.type&&"audio"===_.kind&&_.remoteSource&&d.set("remote-audio-track",_),"remote-inbound-rtp"===_.type&&"video"===_.mediaType&&d.set("remote-inbound-video",_),"remote-inbound-rtp"===_.type&&"audio"===_.mediaType&&d.set("remote-inbound-audio",_),"track"!==_.type||"video"!==_.kind||_.remoteSource||d.set("local-video-track",_),"track"!==_.type||"audio"!==_.kind||_.remoteSource||d.set("local-audio-track",_),"media-source"===_.type&&"video"===_.kind&&d.set("media-source-video",_),"media-source"===_.type&&"audio"===_.kind&&d.set("media-source-audio",_)):l.push(_):a.push(_)}}catch(e){h=!0,g=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw g}}d.set("codec",a),d.set("candidatePairs",l),d.set("timestamp",+p);var b=null,S=null;if(u.timestamp=p,s.timestamp=p,r.timestamp=p,r.timestamp=p,c.timestamp=p,n.isSubscriber)(b=d.get("inbound-video"))&&(t._setStat(u,"id","inbound_video_ssrc_recv"),t._setStat(u,"mediaType",b.mediaType),t._setStat(u,"packetsLost",b.packetsLost),t._setStat(u,"googDecodeMs",null),t._setStat(u,"googMaxDecodeMs",null),t._setStat(u,"googRenderDelayMs",null),t._setStat(u,"googMinPlayoutDelayMs",null),t._setStat(u,"googNacksSent",b.nackCount),t._setStat(u,"googPlisSent",b.pliCount),t._setStat(u,"googFirsSent",b.firCount),t._setStat(u,"bytesReceived",b.bytesReceived),t._setStat(u,"packetsReceived",b.packetsReceived)),(b=d.get("inbound-audio"))&&(t._setStat(s,"id","inbound_audio_ssrc_recv"),t._setStat(s,"mediaType",b.mediaType),t._setStat(s,"bytesReceived",b.bytesReceived),t._setStat(s,"packetsLost",b.packetsLost),t._setStat(s,"packetsReceived",b.packetsReceived),t._setStat(s,"googAccelerateRate",b.removedSamplesForAcceleration),t._setStat(s,"googCurrentDelayMs",b.jitterBufferDelay),t._setStat(s,"googDecodingCNG",null),t._setStat(s,"googDecodingCTN",null),t._setStat(s,"googDecodingCTSG",null),t._setStat(s,"googDecodingNormal",null),t._setStat(s,"googDecodingPLC",null),t._setStat(s,"googDecodingPLCCNG",null),t._setStat(s,"googJitterReceived",b.jitter),t._setStat(s,"googPreferredJitterBufferMs",null),t._setStat(s,"googSecondaryDecodedRate",null)),(b=d.get("remote-video-track"))&&(t._setStat(u,"googTargetDelayMs",b.jitterBufferDelay),t._setStat(u,"googFrameWidthReceived",b.frameWidth),t._setStat(u,"googFrameHeightReceived",b.frameHeight),t._setStat(u,"googJitterBufferMs",b.jitterBufferDelay/b.jitterBufferEmittedCount*1e3),t._setStat(u,"googCurrentDelayMs",b.jitterBufferDelay),t._setStat(u,"googFramesDecoded",b.framesDecoded),t._setStat(u,"googFramesReceived",b.framesReceived)),(b=d.get("remote-audio-track"))&&(t._setStat(s,"audioOutputLevel",32767*b.audioLevel),t._setStat(s,"googJitterBufferMs",b.jitterBufferDelay/b.jitterBufferEmittedCount*1e3),t._setStat(s,"googExpandRate",b.concealedSamples),t._setStat(s,"googPreemptiveExpandRate",b.insertedSamplesForDeceleration),t._setStat(s,"googSpeechExpandRate",b.silentConcealedSamples));else{var E=t.lastStats.get("timestamp"),w=t.lastStats.get("outbound-video");if((b=d.get("outbound-audio"))&&(t._setStat(r,"id","outbound_audio_ssrc_send"),t._setStat(r,"mediaType",b.mediaType),t._setStat(r,"aecDivergentFilterFraction",null),t._setStat(r,"bytesSent",b.bytesSent),t._setStat(r,"packetsSent",b.packetsSent),S=b.transportId),b=d.get("outbound-video")){if(t._setStat(i,"id","outbound_video_ssrc_send"),t._setStat(i,"mediaType",b.mediaType),t._setStat(i,"bytesSent",b.bytesSent),t._setStat(i,"packetsSent",b.packetsSent),t._setStat(i,"googAdaptationChanges",b.qualityLimitationDurations),t._setStat(i,"googAvgEncodeMs",null),t._setStat(i,"googEncodeUsagePercent",null),S=b.transportId,b.totalEncodedBytesTarget&&w&&w.totalEncodedBytesTarget){var I=(b.totalEncodedBytesTarget-w.totalEncodedBytesTarget)/(+new Date-E);t._setStat(c,"googTargetEncBitrate",Math.floor(8*I*1e3))}if(b.retransmittedBytesSent&&w&&w.retransmittedBytesSent){var T=(b.retransmittedBytesSent-w.retransmittedBytesSent)/(+new Date-E);t._setStat(c,"googRetransmitBitrate",Math.floor(8*T*1e3))}if(b.bytesSent&&w&&w.bytesSent){var O=(b.bytesSent-w.bytesSent)/(+new Date-E);t._setStat(c,"googTransmitBitrate",Math.floor(8*O*1e3)),t._setStat(c,"googActualEncBitrate",Math.floor(8*O*1e3))}if(b.totalPacketSendDelay&&w&&w.totalPacketSendDelay){var x=(b.totalPacketSendDelay-w.totalPacketSendDelay)/(+new Date-E);t._setStat(c,"googBucketDelay",Math.floor(1e3*x))}}if((b=d.get("remote-inbound-video"))&&(t._setStat(i,"packetsLost",b.packetsLost),t._setStat(i,"googRtt",b.roundTripTime)),(b=d.get("local-video-track"))&&(t._setStat(i,"googFrameHeightSent",b.frameHeight),t._setStat(i,"googFrameWidthSent",b.frameWidth),void 0!==b.framesPerSecond&&t._setStat(i,"googFrameRateSent",b.framesPerSecond)),(b=d.get("local-audio-track"))&&(t._setStat(r,"googEchoCancellationReturnLoss",b.echoReturnLoss),t._setStat(r,"googEchoCancellationReturnLossEnhancement",b.echoReturnLossEnhancement)),(b=d.get("media-source-video"))&&(t._setStat(i,"googFrameHeightInput",b.height),t._setStat(i,"googFrameWidthInput",b.width),t._setStat(i,"googFrameRateInput",b.framesPerSecond)),(b=d.get("media-source-audio"))&&t._setStat(r,"audioInputLevel",32767*b.totalAudioEnergy),(b=d.get("inbound-video"))&&(t._setStat(i,"googFirsReceived",b.firCount),t._setStat(i,"googNacksReceived",b.nackCount),t._setStat(i,"googPlisReceived",b.pliCount)),S)d.get("candidatePairs").map((function(e){S==e.transportId&&t._setStat(c,"googAvailableSendBandwidth",e.availableOutgoingBitrate)}));else{var R=d.get("candidatePairs")[0];R&&t._setStat(c,"googAvailableSendBandwidth",R.availableOutgoingBitrate)}}t.lastStats=d;var A=[y()({},i),y()({},r),y()({},u),y()({},s),y()({},c)];A.push({id:"time",startTime:t.connectedTime,timestamp:new Date}),e(A)}))},t._processGetStatsBeforeChrome76=function(e){t.peerConnection.getStats((function(n){var o=[],a=[],l=null;Object.keys(n).forEach((function(e){var t=n[e];t&&(a.push(t),l=t.timestamp,"VideoBwe"===t.type?c=t:t.id.indexOf("_send")>-1&&"video"===t.mediaType?i=t:t.id.indexOf("_send")>-1&&"audio"===t.mediaType?r=t:t.id.indexOf("_recv")>-1&&"video"===t.mediaType?u=t:t.id.indexOf("_recv")>-1&&"audio"===t.mediaType&&(s=t))})),(o=[y()({},i),y()({},r),y()({},u),y()({},s),y()({},c)]).push({id:"time",startTime:t.connectedTime,timestamp:l||new Date}),e(o,a)}))},t._getStats=function(e){Object(o.getParameter)("CHROME_NEW_STATS")&&h.isChromeKernel()&&+h.getBrowserVersion()>=76?t._processGetStatsAfterChrome76(e):t._processGetStatsBeforeChrome76(e)},t.addTrack=function(e,n){t.peerConnection.addTrack(e,n)},t.removeTrack=function(e,n){t.peerConnection.removeTrack(t.peerConnection.getSenders().find((function(t){return t.track==e})))},t.addStream=function(e){t.peerConnection.addStream(e),t.markActionNeeded()},t.removeStream=function(){t.markActionNeeded()},t.close=function(){t.state="closed",t.peerConnection.close()},t.markActionNeeded=function(){t.actionNeeded=!0,t.doLater((function(){t.onstablestate()}))},t.doLater=function(e){window.setTimeout(e,1)},t.onstablestate=function(){var e;if(t.actionNeeded){if("new"===t.state||"established"===t.state)t.peerConnection.createOffer((function(e){if(e.sdp!==t.prevOffer)return t.peerConnection.setLocalDescription(e),t.state="preparing-offer",void t.markActionNeeded();a.default.debug("["+t.clientId+"]Not sending a new offer")}),(function(e){a.default.debug("["+t.clientId+"]peer connection create offer failed ",e)}),t.mediaConstraints);else if("preparing-offer"===t.state){if(t.moreIceComing)return;t.prevOffer=t.peerConnection.localDescription.sdp,t.offerCandidates=t.prevOffer.match(/a=candidate.+\r\n/g)||[],t.offerCandidates.length||(a.default.warning("[".concat(t.clientId,"]No Ice Candidate generated")),Object(o.getParameter)("SHIM_CANDIDATE")?(a.default.debug("Shimming fake candidate"),t.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):a.default.error("[".concat(t.clientId,"]None Ice Candidate not allowed"))),t.prevOffer=t.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),t.sendMessage("OFFER",t.prevOffer),t.state="offer-sent"}else if("offer-received"===t.state)t.peerConnection.createAnswer((function(e){if(t.peerConnection.setLocalDescription(e),t.state="offer-received-preparing-answer",t.iceStarted)t.markActionNeeded();else{var n=new Date;a.default.debug("["+t.clientId+"]"+n.getTime()+": Starting ICE in responder"),t.iceStarted=!0}}),(function(e){a.default.debug("["+t.clientId+"]peer connection create answer failed ",e)}),t.mediaConstraints);else if("offer-received-preparing-answer"===t.state){if(t.moreIceComing)return;e=t.peerConnection.localDescription.sdp,t.sendMessage("ANSWER",e),t.state="established"}else t.debug("Dazed and confused in state "+t.state+", stopping here");t.actionNeeded=!1}},t.sendMessage=function(e,n){var r={};r.messageType=e,r.sdp=n,"OFFER"===e?(r.offererSessionId=t.sessionId,r.answererSessionId=t.otherSessionId,r.seq=t.sequenceNumber+=1,r.tiebreaker=Math.floor(429496723*Math.random()+1)):(r.offererSessionId=t.incomingMessage.offererSessionId,r.answererSessionId=t.sessionId,r.seq=t.incomingMessage.seq),t.onsignalingmessage(JSON.stringify(r))},t._getSender=function(e){if(t.peerConnection&&t.peerConnection.getSenders){var n=t.peerConnection.getSenders().find((function(t){return t.track.kind==e}));if(n)return n}return null},t.hasSender=function(e){return!!t._getSender(e)},t.replaceTrack=function(e,n,r){var i=t._getSender(e.kind);if(!i)return r("NO_SENDER_FOUND");try{i.replaceTrack(e)}catch(e){return r&&r(e)}setTimeout((function(){return n&&n()}),50)},t.error=function(e){throw"Error in RoapOnJsep: "+e},t.sessionId=t.roapSessionId+=1,t.sequenceNumber=0,t.actionNeeded=!1,t.iceStarted=!1,t.moreIceComing=!0,t.iceCandidateCount=0,t.onsignalingmessage=e.callback,t.peerConnection.ontrack=function(e){t.onaddstream&&(t.onaddstream(e,"ontrack"),t.peerConnection.onaddstream=null)},t.peerConnection.onaddstream=function(e){t.onaddstream&&(t.onaddstream(e,"onaddstream"),t.peerConnection.ontrack=null)},t.peerConnection.onremovestream=function(e){t.onremovestream&&t.onremovestream(e)},t.peerConnection.oniceconnectionstatechange=function(e){"connected"===e.currentTarget.iceConnectionState&&(t.connectedTime=new Date),t.oniceconnectionstatechange&&t.oniceconnectionstatechange(e.currentTarget.iceConnectionState)},t.renegotiate=function(){void 0!==t.prevOffer&&t.peerConnection.createOffer().then((function(e){return e.sdp=e.sdp.replace(/a=recvonly\r\n/g,"a=inactive\r\n"),e.sdp=l(e.sdp),e.sdp=d(e.sdp),t.peerConnection.setLocalDescription(e)})).then((function(){t.onnegotiationneeded&&t.onnegotiationneeded(t.peerConnection.localDescription.sdp)})).catch((function(e){console.log("createOffer error: ",e)}))},t.peerConnection.onnegotiationneeded=t.renegotiate,t.onaddstream=null,t.onremovestream=null,t.onnegotiationneeded=null,t.state="new",t.markActionNeeded(),t}(e)).browser="chrome-stable",t},P=function(e,t,n){var r={};r.config=e,r.streamId=e.streamId,delete e.streamId,navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var i=0,o=1,s=!1,u=null,c=function(e){if(i++,u)if(u===e)a.default.debug("Using Video Source/ Audio Source");else{var n=u.getVideoTracks()[0],r=u.getAudioTracks()[0],c=e.getVideoTracks()[0],l=e.getAudioTracks()[0];c&&(n&&u.removeTrack(n),u.addTrack(c)),l&&(r&&u.removeTrack(r),u.addTrack(l))}else u=e;i!==o||s||(s=!0,setTimeout((function(){t(u)}),0))},l=function(e){a.default.error("Failed to GetUserMedia",e.name,e.code,e.message,e),i++,s||(s=!0,setTimeout((function(){n&&n(e)}),0))},d=function(){var t={video:e.video,audio:e.audio};if(a.default.debug("GetUserMedia",JSON.stringify(t)),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia(t).then(c).catch(l);else if("undefined"!=typeof navigator&&navigator.getMedia)navigator.getMedia(e,c,l);else{var i={name:"MEDIA_NOT_SUPPORT",message:"Video/audio streams not supported yet"};a.default.error("["+r.streamId+"]"+i.message),n&&n(i)}};if((e.videoSource||e.audioSource)&&(u=new MediaStream,e.videoSource&&u.addTrack(e.videoSource),e.audioSource&&u.addTrack(e.audioSource)),e.video||e.audio||e.screen||e.screenAudio){if(!e.screen&&e.screenAudio)return n&&n({code:"Set screen to true before sharing the audio"});if(e.screen){if(x())return e.screen.sourceId?C(e.screen.sourceId,e.screen,(function(e,t){e?l(e):c(t)})):function(e,t){R((function(n,r){if(n)return t&&t(n);!function(e,t){var n=document.createElement("div");n.innerText="share screen",n.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");var r=document.createElement("div");r.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");var i=document.createElement("div");i.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",i.setAttribute("style","height: 12%;");var o=document.createElement("div");o.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");var a=document.createElement("div");a.setAttribute("style","text-align: right; padding: 16px 0;");var s=document.createElement("button");s.innerHTML="cancel",s.setAttribute("style","width: 85px;"),s.onclick=function(){document.body.removeChild(u),t&&t("NotAllowedError")},a.appendChild(s),r.appendChild(i),r.appendChild(o),r.appendChild(a);var u=document.createElement("div");u.setAttribute("style","position: absolute; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),u.appendChild(n),u.appendChild(r),document.body.appendChild(u),e.map((function(e){if(e.id){var n=document.createElement("div");n.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;"),n.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+e.thumbnail.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+e.name+"</span>",n.onclick=function(){document.body.removeChild(u),t&&t(null,e.id)},o.appendChild(n)}}))}(r,(function(n,r){if(n)return t&&t(n);A(r,e,t)}))}))}(e.screen,(function(e,t){e?l(e):c(t)}));if(h.isFireFox()){if(a.default.debug("["+r.streamId+"]Screen access requested"),!~["screen","window","application"].indexOf(e.screen.mediaSource))return n&&n({code:"Invalid mediaSource, mediaSource should be one of [screen, window, application]"});navigator.getMedia({video:e.screen},(function(t){e.audio&&(o++,d()),c(t)}),l)}else if(h.isChromeKernel()&&e.screen.extensionId){if(window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<34)return void n({code:"This browser does not support screen sharing"});a.default.debug("["+r.streamId+"]Screen access on chrome stable, looking for extension");try{chrome.runtime.sendMessage(e.screen.extensionId,{getStream:!0},(function(t){void 0===t?(a.default.error("["+r.streamId+"]No response from Chrome Plugin. Plugin not installed properly"),l({name:"PluginNotInstalledProperly",message:"No response from Chrome Plugin. Plugin not installed properly."})):(e.screen.mandatory.chromeMediaSourceId=t.streamId,navigator.getMedia({video:e.screen},(function(t){e.audio&&(o++,d()),c(t)}),l))}))}catch(e){return a.default.debug("["+r.streamId+"]AgoraRTC screensharing plugin is not accessible"),void n({code:"no_plugin_present"})}}else{if(window.navigator.mediaDevices.getDisplayMedia){var p={};return"number"==typeof e.screen.width&&"number"==typeof e.screen.height?p.video={width:{ideal:e.screen.width},height:{ideal:e.screen.height}}:p.video={width:e.screen.width,height:e.screen.height},e.screen.frameRate&&e.screen.frameRate.min?p.video.frameRate={ideal:e.screen.frameRate.max,max:e.screen.frameRate.max}:p.video.frameRate=e.screen.frameRate,e.screenAudio&&(p.audio=e.screenAudio),a.default.debug("use getDisplayMedia, constraints:",p),window.navigator.mediaDevices.getDisplayMedia(p).then((function(t){!e.screenAudio&&e.audio&&(o++,d()),c(t)})).catch(l)}a.default.error("["+r.streamId+"]This browser does not support screenSharing"),n({code:"This browser does not support screen sharing"})}}else d()}else c(u)},$=r(11),k=function(e,t,n){if(["End2EndDelay","TransportDelay","PacketLossRate","RecvLevel","RecvBitrate","CodecType","MuteState","TotalFreezeTime","TotalPlayDuration","RecordingLevel","SendLevel","SamplingRate","SendBitrate","CodecType","MuteState","End2EndDelay","TransportDelay","PacketLossRate","RecvBitrate","RecvResolutionWidth","RecvResolutionHeight","RenderResolutionHeight","RenderResolutionWidth","RenderFrameRate","TotalFreezeTime","TotalPlayDuration","TargetSendBitrate","SendFrameRate","SendFrameRate","SendBitrate","SendResolutionWidth","SendResolutionHeight","CaptureResolutionHeight","CaptureResolutionWidth","EncodeDelay","MuteState","TotalFreezeTime","TotalDuration","CaptureFrameRate","RTT","OutgoingAvailableBandwidth","Duration","UserCount","SendBytes","RecvBytes","SendBitrate","RecvBitrate","accessDelay","audioSendBytes","audioSendPackets","videoSendBytes","videoSendPackets","videoSendPacketsLost","videoSendFrameRate","audioSendPacketsLost","videoSendResolutionWidth","videoSendResolutionHeight","accessDelay","audioReceiveBytes","audioReceivePackets","audioReceivePacketsLost","videoReceiveBytes","videoReceivePackets","videoReceivePacketsLost","videoReceiveFrameRate","videoReceiveDecodeFrameRate","videoReceiveResolutionWidth","videoReceiveResolutionHeight","endToEndDelay","videoReceiveDelay","audioReceiveDelay","FirstFrameTime","VideoFreezeRate","AudioFreezeRate","RenderResolutionWidth","RenderResolutionHeight"].indexOf(t)>-1&&("string"==typeof n||isFinite(n)))return e[t]=""+n},D=new function(){var e=u();return e.devicesHistory={},e.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},e.state=e.states.UNINIT,e.deviceStates={ACTIVE:"ACTIVE",INACTIVE:"INACTIVE"},e.deviceReloadTimer=null,e._init=function(t,n){e.state=e.states.INITING,e.devicesHistory={},e._reloadDevicesInfo((function(){e.state=e.states.INITED,e.dispatchEvent({type:"inited"}),t&&t()}),(function(t){a.default.warning("Device Detection functionality cannot start properly."),e.state=e.states.UNINIT,n&&n(t)}))},e._enumerateDevices=function(e,t){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return a.default.warning("enumerateDevices() not supported."),t&&t("enumerateDevices() not supported");navigator.mediaDevices.enumerateDevices().then((function(t){e&&setTimeout((function(){e(t)}),0)})).catch((function(e){t&&t(e)}))},e._reloadDevicesInfo=function(t,n){var r=[];e._enumerateDevices((function(n){var i=Date.now();for(var o in n.forEach((function(t){var n=e.devicesHistory[t.deviceId];if((n?n.state:e.deviceStates.INACTIVE)!=e.deviceStates.ACTIVE){var o=n||{initAt:i};o.device=t,o.state=e.deviceStates.ACTIVE,r.push(o),e.devicesHistory[t.deviceId]=o}e.devicesHistory[t.deviceId].lastReloadAt=i})),e.devicesHistory){var s=e.devicesHistory[o];s&&s.state==e.deviceStates.ACTIVE&&s.lastReloadAt!==i&&(s.state=e.deviceStates.INACTIVE,r.push(s)),s.lastReloadAt=i}e.state==e.states.INITED&&r.forEach((function(t){var n=y()({},t);switch(t.device.kind){case"audioinput":n.type="recordingDeviceChanged";break;case"audiooutput":n.type="playoutDeviceChanged";break;case"videoinput":n.type="cameraChanged";break;default:a.default.warning("Unknown device change",n),n.type="unknownDeviceChanged"}e.dispatchEvent(n)})),t&&t()}),n)},e.getDeviceById=function(t,n,r){e.getDevices((function(e){for(var i=0;i<e.length;i++){var o=e[i];if(o&&o.deviceId===t)return n&&n(o)}return r&&r()}))},e.searchDeviceNameById=function(t){var n=e.devicesHistory[t];return n?n.device.label||n.device.deviceId:null},e.getDevices=function(t,n){e._enumerateDevices(t,(function(e){n&&n(e.name+": "+e.message)}))},e.getVideoCameraIdByLabel=function(t,n,r){e.getCameras((function(e){var i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;if(c.label===t)return n&&n(c.deviceId)}}catch(e){o=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return r&&r(S.default.NOT_FIND_DEVICE_BY_LABEL)}),r)},e.getRecordingDevices=function(t,n){return e._enumerateDevices((function(e){var n=e.filter((function(e){return"audioinput"==e.kind}));t&&t(n)}),(function(e){n&&n(e)}))},e.getPlayoutDevices=function(t,n){return e._enumerateDevices((function(e){var n=e.filter((function(e){return"audiooutput"==e.kind}));t&&t(n)}),(function(e){n&&n(e)}))},e.getCameras=function(t,n){return e._enumerateDevices((function(e){var n=e.filter((function(e){return"videoinput"==e.kind}));t&&t(n)}),(function(e){n&&n(e)}))},e._init((function(){navigator.mediaDevices&&navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",(function(){e._reloadDevicesInfo()})),e.deviceReloadTimer=setInterval(e._reloadDevicesInfo,5e3)})),e},U=r(1),j=r(15),B=r(7),F=r.n(B),q=r(12),G=r.n(q),V=r(18),H=r.n(V),z=r(19),W=r.n(z),J=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189];function Y(e){for(var t=new Uint8Array([99,114,121,112,116,105,105]),n=t.length,r=e,i=r.length,o=new Uint8Array(i),a=new Uint8Array(256),s=0;s<256;s++)a[s]=s;for(var u=0,c=0;c<256;c++){var l=[a[u=(u+a[c]+t[c%n])%256],a[c]];a[c]=l[0],a[u]=l[1]}var d,p=0;u=0;for(var f=0;f<0+i;f++){var h=[a[u=(u+a[p=(p+1)%256])%256],a[p]];a[p]=h[0],a[u]=h[1],d=a[(a[p]+a[u])%256],f>=0&&(o[f-0]=r[f-0]^d)}var g=String.fromCharCode.apply(null,o);return Function("var winSize = 5; return `"+g+"`")()}function K(e,t){var n=Y(t),r=W.a.createProgramFromSources(e,[Y(J),n]),i=e.getAttribLocation(r,"a_position"),o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(i);var a=2,s=e.FLOAT,u=!1,c=0,l=0;e.vertexAttribPointer(i,a,s,u,c,l);var d=e.getAttribLocation(r,"a_texCoord"),p=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,p),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(d),a=2,s=e.FLOAT,u=!1,c=0,l=0,e.vertexAttribPointer(d,a,s,u,c,l),r}var X=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67];function Z(e,t,n){var r=e.gl;this.program=K(r,X),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY");r.uniform1f(e,1)}}var Q=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11];function ee(e,t,n){var r=e.gl,i=1/t,o=1/n,a=5;this.program=K(r,Q),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY"),t=r.getUniformLocation(this.program,"u_singleStepOffset"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform2f(t,i,o),r.uniform1f(n,a),r.uniform1f(e,1)},this.setParameters=function(e){void 0!==e.denoiseLevel&&(a=e.denoiseLevel)},this.setSize=function(e,t){i=1/e,o=1/t}}var te=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188];function ne(e,t,n){var r=e.gl,i=1/t,o=1/n,a=5;this.program=K(r,te),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY"),t=r.getUniformLocation(this.program,"u_singleStepOffset"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform2f(t,i,o),r.uniform1f(n,a),r.uniform1f(e,1)},this.setParameters=function(e){void 0!==e.denoiseLevel&&(a=e.denoiseLevel)},this.setSize=function(e,t){i=1/e,o=1/t}}var re=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24];function ie(e,t,n){var r=e.gl,i=1/t,o=1/n,a=5;this.program=K(r,re),this.setUniforms=function(){r.getUniformLocation(this.program,"u_image");var e=r.getUniformLocation(this.program,"u_flipY"),t=r.getUniformLocation(this.program,"u_singleStepOffset"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform2f(t,i,o),r.uniform1f(n,a),r.uniform1f(e,1)},this.setParameters=function(e){void 0!==e.denoiseLevel&&(a=e.denoiseLevel)},this.setSize=function(e,t){i=1/e,o=1/t}}var oe=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144];function ae(e,t,n){var r=e.gl,i=5,o=.1,a=.5,s=175/180*3.141593,u=115/180*3.141593,c=173/180*3.141593,l=116/180*3.141593,d=2.04203545,p=0,f=0,h=0,g=[],m=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],v=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],y=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255];this.program=K(r,oe),this.setUniforms=function(){var t=r.getUniformLocation(this.program,"u_flipY"),n=r.getUniformLocation(this.program,"u_denoiseLevel");r.uniform1f(n,i),r.uniform1f(t,1);var m=r.getUniformLocation(this.program,"light");r.uniform1f(m,o);var v=r.getUniformLocation(this.program,"redness");r.uniform1f(v,a);var y=r.getUniformLocation(this.program,"skin_he_max"),_=r.getUniformLocation(this.program,"skin_he_min"),b=r.getUniformLocation(this.program,"skin_hc_max"),S=r.getUniformLocation(this.program,"skin_hc_min"),E=r.getUniformLocation(this.program,"skin_hc_axis"),w=r.getUniformLocation(this.program,"facts_rotate_c"),I=r.getUniformLocation(this.program,"facts_rotate_le"),T=r.getUniformLocation(this.program,"facts_rotate_ge");r.uniform1f(y,s),r.uniform1f(_,u),r.uniform1f(b,c),r.uniform1f(S,l),r.uniform1f(E,d),r.uniform1f(w,p),r.uniform1f(I,f),r.uniform1f(T,h);var O=r.getUniformLocation(this.program,"u_originImage");r.activeTexture(r.TEXTURE2),r.bindTexture(r.TEXTURE_2D,e.inputTexture),r.uniform1i(O,2);for(var x=["lighten_lut"],R=[r.TEXTURE3],A=0;A<x.length;A++){var L=r.getUniformLocation(this.program,x[A]);r.activeTexture(R[A]),r.bindTexture(r.TEXTURE_2D,g[A]),r.uniform1i(L,A+3)}},this.setParameters=function(e){void 0!==e.denoiseLevel&&(i=e.denoiseLevel),void 0!==e.lightLevel&&(o=e.lightLevel),void 0!==e.rednessLevel&&(a=e.rednessLevel,this._updateRedness(a)),void 0!==e.lighteningContrastLevel&&this._updateLut(e.lighteningContrastLevel)},this._updateRedness=function(e){var t,n,r=3.141593,i=e,o=i;i>1&&(i=1),i<0&&(i=0),o>1&&(o=1),o<0&&(o=0),p=.8*i,o<.8&&(o=0),(d=(117-4*o)/180*r)<(l=(116-4*o)/180*r)&&(d=l),l<r/2&&(l=r/2),d<r/2&&(d=r/2),(u=(115-4*o)/180*r)<r/2&&(u=r/2),(c=173/180*r)>r&&(c=r),d>r&&(d=r),(s=175/180*r)>r&&(s=r),n=c-d,h=(t=s-c)>.01?p*n/t:p,n=d-l,f=(t=l-u)>.01?p*n/t:p},this._updateLut=function(e){var t=null;0==e&&(t=v),1==e&&(t=y),2==e&&(t=m);for(var n=[new Uint8Array(t)],i=[256],o=[1],a=0;a<n.length;a++)r.bindTexture(r.TEXTURE_2D,g[a]),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,i[a],o[a],0,r.LUMINANCE,r.UNSIGNED_BYTE,n[a])},this._init=function(){for(var e=[new Uint8Array(v)],t=[256],n=[1],i=0;i<e.length;i++){var o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,t[i],n[i],0,r.LUMINANCE,r.UNSIGNED_BYTE,e[i]),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),g.push(o)}},this._init()}var se=!1;function ue(){this.programs=[];var e=this,t=null,n=null;e.gl=null,e.inputTexture=null;var r=[],i=[],o=0,a=0;e._initGl=function(n,s){e.inputTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,e.inputTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR);for(var u=0;u<4;u++){var c=t.createTexture();t.bindTexture(t.TEXTURE_2D,c),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),u<2?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,s,0,t.RGBA,t.UNSIGNED_BYTE,null):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,s,n,0,t.RGBA,t.UNSIGNED_BYTE,null);var l=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,l),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,c,0),r.push(c),i.push(l)}t.viewport(0,0,n,s),o=n,a=s},e.render=function(s){if(t){var u=0;a==s.videoWidth&&o===s.videoHeight&&(u=2),t.viewport(0,0,s.videoWidth,s.videoHeight),t.bindTexture(t.TEXTURE_2D,e.inputTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,s);for(var c=se?e.programs.length-1:0,l=0;l<=c;l++){var d=e.programs[l].program;t.useProgram(d);var p=t.getUniformLocation(d,"u_image");e.programs[l].setUniforms(),t.bindFramebuffer(t.FRAMEBUFFER,i[u+l%2]),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLES,0,6),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,r[u+l%2]),t.uniform1i(p,0)}t.useProgram(n);var f=t.getUniformLocation(n,"u_flipY");t.uniform1f(f,-1),t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLES,0,6)}},e.setEnableBeauty=function(e){se=e},e.init=function(r,i,o){if("undefined"==typeof WebGLRenderingContext)throw new Error("NOT_SUPPORT");t=o.getContext("webgl"),e.gl=t,e._initGl(r,i),e.programs.push(new Z(this,r,i)),e.programs.push(new ee(this,r,i)),e.programs.push(new ne(this,r,i)),e.programs.push(new ie(this,r,i)),e.programs.push(new ae(this,r,i)),n=e.programs[0].program},e.release=function(){e.gl=null,t=null,n=null,e.inputTexture=null,e.programs=[],r=[],i=[]},e.setDenoiseLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({denoiseLevel:t})}))},e.setLightLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({lightLevel:t})}))},e.setRednessLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({rednessLevel:t})}))},e.setContrastLevel=function(t){e.programs.forEach((function(e){e.setParameters&&e.setParameters({lighteningContrastLevel:t})}))},e.setSize=function(t,n){e.programs.forEach((function(e){e.setSize&&e.setSize(t,n)}))}}ue._instance=null,ue.getInstance=function(){return ue._instance||(ue._instance=new ue),ue._instance};var ce=function(e){var t;e.videoEffect={canvas:null,video:null,fps:30,stopChromeBackgroundLoop:null,enableBeauty:!1,denoiseLevel:5,lightLevel:.35,rednessLevel:.5,lighteningContrastLevel:1,videoContextInited:!1,originVideoTrack:null,canvasVideoTrack:null,ctx:null},e._initVideoContext=function(){if(e.videoEffect.videoContextInited)throw new Error("Failed to init video context. Already inited");if(!e.stream)throw new Error("Failed to init video context. Local Stream not initialized");e.videoEffect.originVideoTrack=e.stream.getVideoTracks()[0],e.attributes&&e.attributes.maxFrameRate&&(e.videoEffect.fps=e.attributes.maxFrameRate),e.videoEffect.videoContextInited=!0},e._renderWithWebGL=function(t){return new Promise((function(n){e.videoEffect.canvas||(e.videoEffect.canvas=document.createElement("canvas")),e.videoEffect.video||(e.videoEffect.video=document.createElement("video")),e.videoEffect.video.setAttribute("autoplay",""),e.videoEffect.video.setAttribute("muted",""),e.videoEffect.video.muted=!0,e.videoEffect.video.setAttribute("playsinline",""),e.videoEffect.video.setAttribute("style","display:none"),e.videoEffect.video.srcObject=t;var r=t.getVideoTracks()[0].getSettings(),i=r.width,o=r.height;console.log("Width: ".concat(i,", Height: ").concat(o)),e.videoEffect.canvas.setAttribute("width",i),e.videoEffect.canvas.setAttribute("height",o),e.videoEffect.video.setAttribute("width",i),e.videoEffect.video.setAttribute("height",o);var a=ue.getInstance();a.init(e.videoEffect.video.width,e.videoEffect.video.height,e.videoEffect.canvas),a.setDenoiseLevel(e.videoEffect.denoiseLevel),a.setLightLevel(e.videoEffect.lightLevel),a.setRednessLevel(e.videoEffect.rednessLevel),a.setContrastLevel(e.videoEffect.lighteningContrastLevel),e.videoEffect.video.addEventListener("playing",(function t(){var r=e.videoEffect.canvas.captureStream(e.videoEffect.fps);e.videoEffect.video.removeEventListener("playing",t,!0),n([r.getVideoTracks()[0],e.videoEffect.video])}),!0),e.videoEffect.video.play()}))},e._disableEffect=function(){e.videoEffect.videoContextInited||e._initVideoContext();var t=e.videoEffect.originVideoTrack;if(!t)return a.default.warning("Video track is null, fail to disable video effect!"),Promise.resolve();if(e.pc&&e.pc.peerConnection&&e.pc.peerConnection){var n=(e.pc.peerConnection&&e.pc.peerConnection.getSenders()).find((function(e){return e&&e.track&&"video"==e.track.kind}));if(n&&n.replaceTrack&&t)return n.replaceTrack(t)}return Promise.resolve()},e._releaseEffect=function(){var t;return t=e.videoEffect.enableBeauty?e._disableEffect():Promise.resolve(),ue.getInstance().release(),e.videoEffect.videoContextInited=!1,e.videoEffect.canvasVideoTrack=null,t},e._enableEffect=function(){return e.videoEffect.videoContextInited||e._initVideoContext(),e.videoEffect.originVideoTrack?(e.videoEffect.canvasVideoTrack?(e._showEffectInLocalPlayer(),e._replaceWithCanvasTrack()):e._renderWithWebGL(e.stream).then((function(t){var n=H()(t,2),r=n[0],i=n[1];e.videoEffect.canvasVideoTrack=r;var o=ue.getInstance();requestAnimationFrame((function t(){e.videoEffect.enableBeauty&&o.render(i),e.videoEffect.videoContextInited&&requestAnimationFrame(t)})),h.isChrome()&&document.addEventListener("visibilitychange",(function(){document.hidden,document.hidden?e.videoEffect.stopChromeBackgroundLoop=function(e,t){var n=1/t,r=new AudioContext,i=r.createGain();i.gain.value=0,i.connect(r.destination),function t(){var a=r.createOscillator();a.onended=t,a.connect(i),a.start(0),a.stop(r.currentTime+n),e(r.currentTime),o&&(a.onended=function(){r.close()})}();var o=!1;return function(){o=!0}}((function(){e.videoEffect.enableBeauty&&o.render(i)}),e.videoEffect.fps):e.videoEffect.stopChromeBackgroundLoop&&(e.videoEffect.stopChromeBackgroundLoop(),e.videoEffect.stopChromeBackgroundLoop=null)}),!1),e._showEffectInLocalPlayer(),e._replaceWithCanvasTrack()})),Promise.resolve()):(a.default.warning("Video track is null, fail to enable video effect!"),Promise.resolve())},e._showEffectInLocalPlayer=function(){if(e.player){var t=e.player.div.children[0];if("none"!==t.style.display&&(e.player.div.appendChild(e.videoEffect.canvas),"video"===t.tagName.toLowerCase())){var n=t.getAttribute("style");e.videoEffect.canvas.setAttribute("style",n),"none"!==t.style.display&&(t.style.display="none")}}},e._removeEffectFromLocalPlayer=function(){if(e.player&&e.player.div&&e.videoEffect.enableBeauty&&e.videoEffect.canvas){e.player.div.removeChild(e.videoEffect.canvas);var t=e.player.div.children[0];"video"===t.tagName.toLowerCase()&&(e.videoEffect.canvas.style.display="none",t.style.display="block")}},e._replaceWithCanvasTrack=function(){var t=null;e.pc&&e.pc.peerConnection&&e.pc.peerConnection&&(t=(e.pc.peerConnection&&e.pc.peerConnection.getSenders()).find((function(e){return e&&e.track&&"video"==e.track.kind}))),t&&t.replaceTrack&&e.videoEffect.canvasVideoTrack&&t.replaceTrack(e.videoEffect.canvasVideoTrack)},e.setBeautyEffectOptions=(t=G()(F.a.mark((function t(n,r){var i,o=arguments;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Object(U.checkValidBoolean)(n,"enabled"),i=ue.getInstance(),e.videoEffect.enableBeauty==n){t.next=14;break}if(i.setEnableBeauty(n),!n){t.next=9;break}return t.next=7,e._enableEffect();case 7:t.next=12;break;case 9:return e._removeEffectFromLocalPlayer(),t.next=12,e._releaseEffect();case 12:e.videoEffect.enableBeauty=n,s.b.reportApiInvoke(e.sid,{callback:null,options:o,name:"Stream.setBeautyEffectOptions",tag:"tracer"});case 14:if(n){t.next=16;break}return t.abrupt("return");case 16:if(!r){t.next=20;break}Object(U.checkValidObject)(r,"options"),t.next=21;break;case 20:return t.abrupt("return");case 21:if(void 0!==r.smoothnessLevel&&(Object(U.checkValidFloatNumber)(r.smoothnessLevel,"smoothnessLevel",0,1),e.videoEffect.denoiseLevel=10*r.smoothnessLevel,e.videoEffect.denoiseLevel<.1&&(e.videoEffect.denoiseLevel=.1),i.setDenoiseLevel(e.videoEffect.denoiseLevel)),void 0!==r.lighteningLevel&&(Object(U.checkValidFloatNumber)(r.lighteningLevel,"lighteningLevel",0,1),e.videoEffect.lightLevel=r.lighteningLevel/2,e.videoEffect.lightLevel<.01&&(e.videoEffect.lightLevel=.01),i.setLightLevel(e.videoEffect.lightLevel)),void 0!==r.rednessLevel&&(Object(U.checkValidFloatNumber)(r.rednessLevel,"rednessLevel",0,1),e.videoEffect.rednessLevel=r.rednessLevel,e.videoEffect.rednessLevel<.01&&(e.videoEffect.rednessLevel=.01),i.setRednessLevel(e.videoEffect.rednessLevel)),void 0===r.lighteningContrastLevel){t.next=29;break}if(0===r.lighteningContrastLevel||1===r.lighteningContrastLevel||2===r.lighteningContrastLevel){t.next=27;break}throw new Error("Invalid lighteningContrastLevel: The value should be 0, 1 or 2.");case 27:e.videoEffect.lighteningContrastLevel=parseFloat(r.lighteningContrastLevel),i.setContrastLevel(e.videoEffect.lighteningContrastLevel);case 29:case"end":return t.stop()}}),t,this)}))),function(e,n){return t.apply(this,arguments)})},le=function(e){return e.videoEffect.enableBeauty?e._enableEffect():Promise.resolve()},de=function(e){return e._releaseEffect?e._releaseEffect():Promise.resolve()},pe=function(e){e.videoEffect.enableBeauty&&e.videoEffect.canvas&&e._showEffectInLocalPlayer()},fe=function(e){e._removeEffectFromLocalPlayer()},he=function(e){e.videoEffect.enableBeauty&&e._replaceWithCanvasTrack()},ge=function(e){return!!(e.videoEffect.enableBeauty&&e.videoEffect&&e.videoEffect.videoContextInited)&&(a.default.error("Operation not permitted: ".concat("VIDEO_EFFECT_ENABLED")),"VIDEO_EFFECT_ENABLED")},me=r(9),ve=r.n(me),ye=function(e){Object(U.checkValidString)(e,"profileName"),-1===(e=e.toLowerCase()).indexOf("_")&&(e+="_1"),Object(U.checkValidEnum)(e,"profileName",Object.keys(o.SUPPORT_RESOLUTION_LIST));var t=o.SUPPORT_RESOLUTION_LIST[e];t||(e=Object(o.getParameter)("DEFAULT_PROFILE"),t=o.SUPPORT_RESOLUTION_LIST[e]);var n={profileName:e,video:{width:t[0],height:t[1]},attributes:{resolution:"".concat(t[0],"x").concat(t[1]),minFrameRate:t[2],maxFrameRate:t[3],minVideoBW:t[4],maxVideoBW:t[5]}};return t[2]&&t[3]&&(n.video.frameRate={ideal:t[2],max:t[3]}),t[6]&&t[7]&&(n.screen={width:t[0],height:t[1],frameRate:{min:t[6],max:t[7]}}),n},_e=function(e){return Object.keys(o.SUPPORT_RESOLUTION_LIST).filter((function(t){var n=o.SUPPORT_RESOLUTION_LIST[t],r=["width","height","frameRate"];for(var i in r){var a=r[i];if(e[a]&&n[i]){if("number"==typeof e[a].max&&e[a].max<n[i])return!1;if("number"==typeof e[a].min&&e[a].min>n[i])return!1}}return!0})).reverse()},be=function(e){var t=o.AUDIO_PROFILE_SETTINGS[e]||o.AUDIO_PROFILE_SETTINGS.default;return{highQuality:t[0],stereo:t[1],speech:t[2],lowQuality:t[3]}},Se=function(e){var t=u();if(t.params=y()({},e),t.stream=e.stream,t.url=e.url,t.onClose=void 0,t.local=!1,t.videoSource=e.videoSource,t.audioSource=e.audioSource,e.video=!(!e.videoSource&&!e.video),t.video=e.video,e.audio=!(!e.audioSource&&!e.audio),t.audio=e.audio,t.screen=!!e.screen,t.screenAudio=!!e.screenAudio,t.screenAttributes={width:1920,height:1080,maxFr:5,minFr:1},t.videoSize=e.videoSize,t.player=void 0,t.audioLevelHelper=null,e.attributes=e.attributes||{},t.attributes=e.attributes,t.microphoneId=e.microphoneId,t.cameraId=e.cameraId,t.facingMode=e.facingMode,t.inSwitchDevice=!1,t.userMuteVideo=!1,t.userMuteAudio=!1,t.peerMuteVideo=!1,t.peerMuteAudio=!1,t.lowStream=null,t.videoWidth=0,t.videoHeight=0,t.streamId=e.streamID,t.userId=null,t.mirror=!1!==e.mirror,t.DTX=e.audioProcessing&&e.audioProcessing.DTX,t.audioProcessing=e.audioProcessing,t.highQuality=!1,t.stereo=!1,t.speech=!1,t.screen||delete t.screen,!(void 0===t.videoSize||t.videoSize instanceof Array&&4===t.videoSize.length))throw Error("Invalid Video Size");function n(){var e={};t.getVideoTrack()===this?(a.default.debug("Video Track Ended"),e.type="videoTrackEnded",e.track=this):t.getAudioTrack()===this?(a.default.debug("Audio Track Ended"),e.type="audioTrackEnded",e.track=this):a.default.debug("Detached Track ended",this.kind,this.label,this),e.type&&t.dispatchEvent(e)}return t.videoSize=[640,480,640,480],void 0!==e.local&&!0!==e.local||(t.local=!0),t.initialized=!t.local,t._streamInitID=null,function(e){e.audioMixing={audioContextInited:!1,defaultVolume:100,inEarMonitoring:"FILE",sounds:{},states:{IDLE:"IDLE",STARTING:"STARTING",BUSY:"BUSY",PAUSED:"PAUSED"},inEarMonitoringModes:{NONE:"NONE",FILE:"FILE",MICROPHONE:"MOCROPHONE",ALL:"ALL"},ctx:null,mediaStreamSource:null,mediaStreamDest:null,buffer:{}},e._initSoundIfNotExists=function(t,n){e.audioMixing.sounds[t]||(e.audioMixing.sounds[t]={soundId:t,state:"IDLE",muted:e.userMuteAudio,filePath:n,volume:e.audioMixing.defaultVolume,startAt:null,startOffset:null,pauseAt:null,pauseOffset:null,resumeAt:null,resumeOffset:null,stopAt:null,options:null,source:null})},e._initSoundIfNotExists(-1),e.loadAudioBuffer=function(t,n,r){var i=s.b.reportApiInvoke(e.sid,{callback:r,name:"Stream.loadAudioBuffer",options:arguments,tag:"tracer"});Object(U.checkValidString)(n,"url",1,1024,!1),Object(U.checkValidString)(t,"id",1,1024,!1);var o=function(t){a.default.error("[".concat(e.streamId,"] loadAudioBuffer Failed: ")+t),i(S.default.LOAD_AUDIO_FAILED)},u=new XMLHttpRequest;u.open("GET",n,!0),u.responseType="arraybuffer",u.onload=function(){if(u.status>400)o("".concat(u.status," ").concat(u.statusText));else{var n=u.response;e.audioMixing.audioContextInited||e._initAudioContext(),e.audioMixing.ctx.decodeAudioData(n,(function(n){e.audioMixing.buffer[t]=n,i(null)}),(function(t){a.default.error("[".concat(e.streamId,"] decodeAudioData Failed: "),t),i(t)}))}},u.onerror=function(){return o("load error")},u.ontimeout=function(){return o("timeout")},u.send()},e.createAudioBufferSource=function(t){var n=s.b.reportApiInvoke(e.sid,{name:"Stream.createAudioBufferSource",options:arguments,tag:"tracer"});if(e.audioMixing.buffer[t.id]){var r=e.audioMixing.buffer[t.id],i=e.audioMixing.ctx.createBufferSource();i.buffer=r;var o=e.audioMixing.ctx.createGain();if(i.connect(o),o.connect(e.audioMixing.mediaStreamDest),i.gainNode=o,t.loop)i.loop=!0,i.start(0,t.playTime/1e3);else if(t.cycle>1)if(Object(h.isChrome)()){i.loop=!0;var u=t.cycle*r.duration*1e3-(t.playTime||0);i.start(0,t.playTime/1e3,u/1e3)}else a.default.warning("[".concat(e.streamId,"] Cycle Param is ignored by current browser")),i.start(0,t.playTime/1e3);else i.start(0,t.playTime/1e3);var c=e.audioMixing.sounds[t.soundId];return c.source=i,e._flushAudioMixingMuteStatus(),i.addEventListener("ended",(function(){i===c.source&&e.dispatchEvent({type:"audioSourceEnded",soundId:t.soundId,source:i,sound:c})})),n(),i}return a.default.error("[".concat(e.streamId,"] "),"AUDIOBUFFER_NOT_FOUND",t.id),n(!1),!1},e.on("audioSourceEnded",(function(t){var n=t.source,r=t.sound;r&&r.state===e.audioMixing.states.BUSY&&!r.pauseAt&&(r.state=e.audioMixing.states.IDLE,r.startAt=null,r.startOffset=null,r.resumeAt=null,r.resumeOffset=null,n.gainNode&&n.gainNode.disconnect&&n.gainNode.disconnect(),n.buffer=null,e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest))})),e.clearAudioBufferSource=function(){e.audioBufferSource.forEach((function(e){e.stop()}))},e._isSoundExists=function(t){return!!e.audioMixing.sounds[t.soundId]||(a.default.error("SoundId not exists. #".concat(t.soundId)),!1)},e._initAudioContext=function(){if(e.audioMixing.audioContextInited)throw new Error("Failed to init audio context. Already inited");if(!e.stream)throw new Error("Failed to init audio context. Local Stream not initialized");e.audioMixing.ctx=Object(j.a)(),e.audioMixing.mediaStreamSource=e.audioMixing.ctx.createMediaStreamSource(e.stream),e.audioMixing.mediaStreamDest=e.audioMixing.ctx.createMediaStreamDestination(),e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest);var t=e.stream.getVideoTracks()[0];if(t&&e.audioMixing.mediaStreamDest.stream.addTrack(t),e._isAudioMuted()?(e._unmuteAudio(),e.stream=e.audioMixing.mediaStreamDest.stream,e._muteAudio()):e.stream=e.audioMixing.mediaStreamDest.stream,e.audioLevelHelper=null,e.pc&&e.pc.peerConnection&&e.pc.peerConnection){var n=(e.pc.peerConnection&&e.pc.peerConnection.getSenders()).find((function(e){return e&&e.track&&"audio"==e.track.kind})),r=e.audioMixing.mediaStreamDest.stream.getAudioTracks()[0];n&&n.replaceTrack&&r&&n.replaceTrack(r)}e.audioMixing.audioContextInited=!0},e._cleanupAudioMixing=function(){if(e.audioMixing.audioContextInited){for(var t in e.audioMixing.sounds){var n=e.audioMixing.sounds[t];n.state!==e.audioMixing.states.BUSY&&n.state!==e.audioMixing.states.PAUSED||e._stopOneEffect({soundId:t})}e.audioLevelHelper=null,e.audioMixing.audioContextInited=!1}},e._reloadInEarMonitoringMode=function(t){if(t){if(!e.audioMixing.inEarMonitoringModes[t])return a.default.error("[".concat(e.streamId,"] Invalid InEarMonitoringMode ").concat(t));e.audioMixing.inEarMonitoring=t}switch(e.audioMixing.audioContextInited||e._initAudioContext(),e.audioMixing.inEarMonitoring){case e.audioMixing.inEarMonitoringModes.FILE:e.audioMixing.mediaStreamSource.connectedToDestination&&(e.audioMixing.mediaStreamSource.disconnect(e.audioMixing.ctx.destination),e.audioMixing.mediaStreamSource.connectedToDestination=!1);case e.audioMixing.inEarMonitoringModes.ALL:for(var n in e.audioMixing.sounds){var r=e.audioMixing.sounds[n];r&&r.source&&!r.source.connectedToDestination&&(r.source.gainNode.connect(e.audioMixing.ctx.destination),r.source.connectedToDestination=!0)}}switch(e.audioMixing.inEarMonitoring){case e.audioMixing.inEarMonitoringModes.MICROPHONE:e.audioMixing.source.forEach((function(t){t.connectedToDestination&&(t.gainNode.disconnect(e.audioMixing.ctx.destination),t.connectedToDestination=!1)}));case e.audioMixing.inEarMonitoringModes.ALL:e.audioMixing.mediaStreamSource.connectedToDestination||(e.audioMixing.mediaStreamSource.connect(e.audioMixing.ctx.destination),e.audioMixing.mediaStreamSource.connectedToDestination=!0)}},e._startAudioMixingBufferSource=function(t){e.audioMixing.audioContextInited||e._initAudioContext();var n={soundId:t.soundId,id:t.filePath,loop:t.loop,cycle:t.cycle,playTime:t.playTime||0},r=t.replace,i=e.createAudioBufferSource(n);return i.sound=e.audioMixing.sounds[t.soundId],i?(i.addEventListener("ended",e._audioMixingFinishedListener,{once:!0}),e._reloadInEarMonitoringMode(),r&&e.audioMixing.mediaStreamSource.disconnect(e.audioMixing.mediaStreamDest),i):null},e._stopAudioMixingBufferSource=function(t){var n=e.audioMixing.sounds[t.soundId].source;return n?(n.removeEventListener("ended",e._audioMixingFinishedListener),e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest),n.stop(),n.gainNode&&n.gainNode.disconnect&&n.gainNode.disconnect(),n.buffer=null,n):null},e._flushAudioMixingMuteStatus=function(t){for(var n in e.audioMixing.sounds){var r=e.audioMixing.sounds[n];r&&(void 0!==t&&(r.muted=!!t),r.source&&(r.muted?r.source.gainNode.gain.value=0:r.source.gainNode.gain.value=r.volume/100))}},e._handleAudioMixingInvalidStateError=function(t,n,r){var i=e.audioMixing.sounds[n.soundId],o=-1===n.soundId?"INVALID_AUDIO_MIXING_STATE":"INVALID_PLAY_EFFECT_STATE";a.default.error("[".concat(e.streamId,"] Cannot ").concat(t,": ").concat(o,", state is ").concat(i.state)),r&&r(o)},e._handleAudioMixingNoSourceError=function(t,n,r){e.audioMixing.sounds[n.soundId].state=e.audioMixing.states.IDLE;var i=-1===n.soundId?"NO_AUDIO_MIXING_SOURCE":"NO_EFFECT_SOURCE";a.default.error("[".concat(e.streamId,"] Cannot ").concat(t,": ").concat(i)),r&&r(i)},e._getOneEffectStates=function(t){var n=e.audioMixing.sounds[t.soundId];return function(){return n?{state:n.state,startAt:n.startAt,resumeAt:n.resumeAt,pauseOffset:n.pauseOffset,pauseAt:n.pauseAt,resumeOffset:n.resumeOffset,stopAt:n.stopAt,duration:e._getOneEffectDuration(t),position:e._getOneEffectCurrentPosition(t)}:{}}},e._audioMixingFinishedListener=function(){var t=this.sound;t.state===e.audioMixing.states.IDLE&&e.audioMixing.buffer[t.options.filePath]&&!t.options.cacheResource&&(a.default.debug("Recycled buffer ".concat(t.options.filePath)),delete e.audioMixing.buffer[t.options.filePath]),-1===t.soundId&&e.dispatchEvent({type:"audioMixingFinished"})},e._playOneEffect=function(t,n){Object(U.checkValidObject)(t,"options");var r=t.soundId,i=(t.filePath,t.cacheResource);if(t.cycle,t.loop,t.playTime,t.replace,Object(h.isSafari)()&&Object(h.getBrowserVersion)()<12){var o="BROWSER_NOT_SUPPORT";return a.default.error("[".concat(e.streamId,"] Cannot _playOneEffect: "),o),n(o)}e.audioMixing.audioContextInited||e._initAudioContext(),e._initSoundIfNotExists(r);var s=e.audioMixing.sounds[r];if(s.state===e.audioMixing.states.IDLE){if(void 0!==t.cycle&&!t.cycle>0)return o="Invalid Parmeter cycle: "+t.cycle,a.default.error("[".concat(e.streamId,"] ").concat(r),o),n(o);if(Object(U.isEmpty)(i)&&(t.cacheResource=!0),s.state=e.audioMixing.states.STARTING,s.options=t,e.audioMixing.buffer[t.filePath]){var u=e._startAudioMixingBufferSource(t);if(u)return s.source=u,s.startAt=Date.now(),s.resumeAt=null,s.pauseOffset=null,s.pauseAt=null,s.resumeOffset=null,s.stopAt=null,s.startOffset=t.playTime||0,s.state=e.audioMixing.states.BUSY,e._flushAudioMixingMuteStatus(),n(null);s.state=e.audioMixing.states.IDLE;var c="CREATE_BUFFERSOURCE_FAILED";if(n)return n(c);a.default.error("[".concat(e.streamId,"] "),c)}else e.loadAudioBuffer(t.filePath,t.filePath,(function(r){if(r)s.state=e.audioMixing.states.IDLE,n?n(r):a.default.error("[".concat(e.streamId,"] "),r);else{var i=e._startAudioMixingBufferSource(t);if(i)return s.source=i,s.startAt=Date.now(),s.resumeAt=null,s.pauseOffset=null,s.pauseAt=null,s.resumeOffset=null,s.stopAt=null,s.startOffset=t.playTime||0,s.state=e.audioMixing.states.BUSY,e._flushAudioMixingMuteStatus(),n(null);if(s.state=e.audioMixing.states.IDLE,r="CREATE_BUFFERSOURCE_FAILED",n)return n(r);a.default.error("[".concat(e.streamId,"] "),r)}}))}else e._handleAudioMixingInvalidStateError("_playEffect",t,n)},e._stopOneEffect=function(t,n){var r=e.audioMixing.sounds[t.soundId];return e._isSoundExists(t)?r.state===e.audioMixing.states.BUSY||r.state===e.audioMixing.states.PAUSED?(e._stopAudioMixingBufferSource(t),r.stopAt=Date.now(),r.state=e.audioMixing.states.IDLE,e.audioMixing.buffer[r.options.filePath]&&!r.options.cacheResource&&(a.default.debug("Recycled buffer ".concat(r.options.filePath)),delete e.audioMixing.buffer[r.options.filePath]),void(n&&n(null))):void e._handleAudioMixingInvalidStateError("_stopOneEffect",t,n):n("SOUND_NOT_EXISTS")},e._pauseOneEffect=function(t,n){var r=e.audioMixing.sounds[t.soundId];if(r.state===e.audioMixing.states.BUSY)return e._stopAudioMixingBufferSource(t)?(r.pauseAt=Date.now(),r.state=e.audioMixing.states.PAUSED,r.resumeAt?r.pauseOffset=r.pauseAt-r.resumeAt+r.resumeOffset:r.pauseOffset=r.pauseAt-r.startAt+r.startOffset,n&&n(null)):void e._handleAudioMixingNoSourceError("_pauseOneEffect",t,n);e._handleAudioMixingInvalidStateError("_pauseOneEffect",t,n)},e._resumeOneEffect=function(t,n){var r=e.audioMixing.sounds[t.soundId];if(r.state===e.audioMixing.states.PAUSED){var i={soundId:t.soundId,filePath:r.options.filePath,cycle:r.options.cycle,loop:r.options.loop,playTime:r.pauseOffset,replace:r.options.replace},o=e._startAudioMixingBufferSource(i);if(!o){var s="CREATE_BUFFERSOURCE_FAILED";return n(s),void a.default.error("[".concat(e.streamId,"] "),s)}r.source=o,r.resumeAt=Date.now(),r.resumeOffset=r.pauseOffset,r.state=e.audioMixing.states.BUSY,r.pauseAt=null,r.pauseOffset=null,n(null)}else e._handleAudioMixingInvalidStateError("_resumeOneEffect",t,n)},e._getOneEffectDuration=function(t){var n=e.audioMixing.sounds[t.soundId];return n.options&&n.options.filePath&&e.audioMixing.buffer[n.options.filePath]?1e3*e.audioMixing.buffer[n.options.filePath].duration:null},e._getOneEffectCurrentPosition=function(t,n){var r=e.audioMixing.sounds[t.soundId];return r.state===e.audioMixing.states.PAUSED?r.pauseOffset%e._getOneEffectDuration(t):r.state===e.audioMixing.states.BUSY?r.resumeAt?(Date.now()-r.resumeAt+r.resumeOffset)%e._getOneEffectDuration(t):(Date.now()-r.startAt+r.startOffset)%e._getOneEffectDuration(t):void(n&&e._handleAudioMixingInvalidStateError("_getOneEffectCurrentPosition",t))},e._setOneEffectPosition=function(t,n,r){var i=e.audioMixing.sounds[t.soundId];if(i.state===e.audioMixing.states.BUSY){if(!e._stopAudioMixingBufferSource(t))return void e._handleAudioMixingNoSourceError("_setOneEffectPosition",t,r);var o={soundId:t.soundId,filePath:i.options.filePath,loop:i.options.loop,cycle:i.options.cycle,playTime:n},s=e._startAudioMixingBufferSource(o);if(!s){var u="CREATE_BUFFERSOURCE_FAILED";return r&&r(u),void a.default.error("[".concat(e.streamId,"] "),u)}i.source=s,i.startAt=Date.now(),i.startOffset=n,i.resumeAt=null,i.resumeOffset=null,i.pauseOffset=null,i.pauseAt=null}else{if(i.state!==e.audioMixing.states.PAUSED)return void e._handleAudioMixingInvalidStateError("_setOneEffectPosition",t,r);i.pauseOffset=n}r&&r(null)},e.startAudioMixing=function(t,n){var r=s.b.reportApiInvoke(e.sid,{callback:function(t){if(t)return n&&n(t);e.dispatchEvent({type:"audioMixingPlayed"}),n&&n(null)},getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.startAudioMixing",options:t});Object(U.checkValidObject)(t,"options");var i=t.filePath,a=t.cacheResource,u=t.cycle,c=t.loop,l=t.playTime,d=t.replace;Object(U.checkValidString)(i,"filePath",1,Object(o.getParameter)("FILEPATH_LENMAX"),!1),Object(U.checkValidNumber)(l,"playTime",0,1e8),!Object(U.isEmpty)(u)&&Object(U.checkValidNumber)(u,"cycle"),!Object(U.isEmpty)(c)&&Object(U.checkValidBoolean)(c,"loop"),!Object(U.isEmpty)(d)&&Object(U.checkValidBoolean)(d,"replace"),!Object(U.isEmpty)(a)&&Object(U.checkValidBoolean)(a,"cacheResource");var p=y()({soundId:-1},t);e._playOneEffect(p,r)},e.stopAudioMixing=function(t){var n=s.b.reportApiInvoke(e.sid,{callback:t,getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.stopAudioMixing"});e._stopOneEffect({soundId:-1},n)},e.pauseAudioMixing=function(t){var n=s.b.reportApiInvoke(e.sid,{callback:t,getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.pauseAudioMixing"});return e._pauseOneEffect({soundId:-1},n)},e.resumeAudioMixing=function(t){var n=s.b.reportApiInvoke(e.sid,{callback:function(n,r){if(n)return t&&t(n);e.dispatchEvent({type:"audioMixingPlayed"}),t&&t(null)},getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.resumeAudioMixing"});e._resumeOneEffect({soundId:-1},n)},e.adjustAudioMixingVolume=function(t){var n=s.b.reportApiInvoke(e.sid,{getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.adjustAudioMixingVolume",options:arguments,tag:"tracer"});Object(U.checkValidNumber)(t,"volume",0,100),e.audioMixing.sounds[-1].volume=t,e._flushAudioMixingMuteStatus(),n()},e.getAudioMixingDuration=function(){var t=s.b.reportApiInvoke(e.sid,{getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.getAudioMixingDuration"}),n=e._getOneEffectDuration({soundId:-1});return t(null,n),n},e.getAudioMixingCurrentPosition=function(){var t=s.b.reportApiInvoke(e.sid,{getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.getAudioMixingCurrentPosition"}),n=e._getOneEffectCurrentPosition({soundId:-1},!0);return t(null,n),n},e.setAudioMixingPosition=function(t,n){var r=s.b.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",getStates:e._getOneEffectStates({soundId:-1}),name:"Stream.setAudioMixingPosition"});Object(U.checkValidNumber)(t,"position",0,1e8),e._setOneEffectPosition({soundId:-1},t,r)},e.playEffect=function(t,n){var r=s.b.reportApiInvoke(e.sid,{callback:function(t){if(t)return n&&n(t);e.dispatchEvent({type:"effectPlayed"}),n&&n(null)},name:"Stream.playEffect",options:t});Object(U.checkValidObject)(t,"options");var i=t.soundId,a=t.filePath,u=t.cycle;Object(U.checkValidNumber)(i,"soundId",1,1e4),Object(U.checkValidString)(a,"filePath",0,Object(o.getParameter)("FILEPATH_LENMAX"),!1),!Object(U.isEmpty)(u)&&Object(U.checkValidNumber)(u,"cycle"),e._playOneEffect(t,r)},e.stopEffect=function(t,n){var r=s.b.reportApiInvoke(e.sid,{callback:n,getStates:e._getOneEffectStates({soundId:t}),name:"Stream.stopEffect"});Object(U.checkValidNumber)(t,"soundId",1,1e4),e._stopOneEffect({soundId:t},r)},e.stopAllEffects=function(t){var n=s.b.reportApiInvoke(e.sid,{callback:t,name:"Stream.stopAllEffect"}),r=!1,i=0,o=0,a=function(e){r||(e?(n(e),r=!0):i+=1,i===o&&(n(null),r=!0))};for(var u in e.audioMixing.sounds){var c=e.audioMixing.sounds[u];-1!==c.soundId&&(c.state!==e.audioMixing.states.BUSY&&c.state!==e.audioMixing.states.PAUSED||(o++,e._stopOneEffect({soundId:u},a)))}o||n(null)},e.preloadEffect=function(t,n,r){var i=s.b.reportApiInvoke(e.sid,{callback:r,options:arguments,tag:"tracer",name:"Stream.preloadEffect"});Object(U.checkValidNumber)(t,"soundId",1,1e4),Object(U.checkValidString)(n,"filePath",1,Object(o.getParameter)("FILEPATH_LENMAX"),!1),e._initSoundIfNotExists(t,n),e.audioMixing.buffer[n]?i(null):e.loadAudioBuffer(n,n,i)},e.unloadEffect=function(t,n){var r=s.b.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",name:"Stream.unloadEffect"});Object(U.checkValidNumber)(t,"soundId",1,1e4);var i=e.audioMixing.sounds[t];if(!i){var o="SOUND_NOT_EXISTS";return a.default.error(o,t),void r(o)}var u=i.options?i.options.filePath:i.filePath;if(u)delete e.audioMixing.buffer[u],delete e.audioMixing.sounds[t],r(null);else{var c="SOUND_BUFFER_NOT_FOUND";a.default.error(c,t),r(c)}},e.pauseEffect=function(t,n){var r=s.b.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",name:"Stream.pauseEffect"});return e._pauseOneEffect({soundId:t},r)},e.pauseAllEffects=function(t){var n=s.b.reportApiInvoke(e.sid,{callback:t,name:"Stream.pauseAllEffects"}),r=!1,i=0,o=0,a=function(e){r||(e?(n(e),r=!0):i+=1,i===o&&(n(null),r=!0))};for(var u in e.audioMixing.sounds)"-1"!==u&&e.audioMixing.sounds[u].state===e.audioMixing.states.BUSY&&(o++,e._pauseOneEffect({soundId:u},a));o||n(null)},e.resumeEffect=function(t,n){Object(U.checkValidNumber)(t,"soundId",1,1e4);var r=s.b.reportApiInvoke(e.sid,{callback:n,options:arguments,tag:"tracer",name:"Stream.resumeEffect"});return e._resumeOneEffect({soundId:t},r)},e.resumeAllEffects=function(t){var n=s.b.reportApiInvoke(e.sid,{callback:t,name:"Stream.resumeAllEffects"}),r=!1,i=0,o=0,a=function(e){r||(e?(n(e),r=!0):i+=1,i===o&&(n(null),r=!0))};for(var u in e.audioMixing.sounds)"-1"!==u&&e.audioMixing.sounds[u].state===e.audioMixing.states.PAUSED&&(o++,e._resumeOneEffect({soundId:u},a));o||n(null)},e.getEffectsVolume=function(){var t=[];for(var n in e.audioMixing.sounds){var r=e.audioMixing.sounds[n];r&&"-1"!==n&&t.push({soundId:parseInt(n),volume:r.volume})}return t},e.setEffectsVolume=function(t,n){var r=s.b.reportApiInvoke(e.sid,{name:"Stream.setEffectsVolume",options:arguments,tag:"tracer",callback:n});for(var i in Object(U.checkValidNumber)(t,"volume",0,100),e.audioMixing.defaultVolume=t,e.audioMixing.sounds){var o=e.audioMixing.sounds[i];"-1"!==i&&(o.volume=t)}e._flushAudioMixingMuteStatus(),r(null)},e.setVolumeOfEffect=function(t,n,r){var i=s.b.reportApiInvoke(e.sid,{name:"Stream.setVolumeOfEffect",options:arguments,tag:"tracer",callback:r});Object(U.checkValidNumber)(t,"soundId",0,1e4),Object(U.checkValidNumber)(n,"volume",0,100),e._initSoundIfNotExists(t),e.audioMixing.sounds[t].volume=n,e._flushAudioMixingMuteStatus(),i(null)}}(t),ce(t),function(e,t){e.videoConstraint={},t.cameraId&&(e.videoConstraint.deviceId={exact:t.cameraId}),t.facingMode&&(e.videoConstraint.facingMode=t.facingMode),e.videoSize&&(e.videoConstraint.width=e.videoSize[0],e.videoConstraint.height=e.videoSize[1]),Object(h.isLegacyChrome)()||(e.videoConstraint.frameRate={ideal:30,max:30}),e.audioConstraint={},t.microphoneId&&(e.audioConstraint.deviceId={exact:t.microphoneId}),Object(h.isLegacyChrome)()||e.audioProcessing&&(void 0!==e.audioProcessing.AGC&&(Object(h.isFireFox)()?e.audioConstraint.autoGainControl=e.audioProcessing.AGC:Object(h.isChrome)()&&(e.audioConstraint.googAutoGainControl=e.audioProcessing.AGC,e.audioConstraint.googAutoGainControl2=e.audioProcessing.AGC)),void 0!==e.audioProcessing.AEC&&(e.audioConstraint.echoCancellation=e.audioProcessing.AEC),void 0!==e.audioProcessing.ANS&&(Object(h.isFireFox)()?e.audioConstraint.noiseSuppression=e.audioProcessing.ANS:Object(h.isChrome)()&&(e.audioConstraint.googNoiseSuppression=e.audioProcessing.ANS))),e.screenConstraint={},t.sourceId&&(e.screenConstraint.sourceId=t.sourceId),t.extensionId&&Object(h.isChrome)()?(e.screenConstraint.extensionId=t.extensionId,e.screenConstraint.mandatory={chromeMediaSource:"desktop",maxWidth:e.screenAttributes.width,maxHeight:e.screenAttributes.height,maxFrameRate:e.screenAttributes.maxFr,minFrameRate:e.screenAttributes.minFr}):(e.screenConstraint.mediaSource="screen",e.screenConstraint.width=e.screenAttributes.width,e.screenConstraint.height=e.screenAttributes.height,e.screenConstraint.frameRate={ideal:e.screenAttributes.maxFr,max:e.screenAttributes.maxFr}),t.mediaSource&&(e.screenConstraint.mediaSource=t.mediaSource),e.setVideoResolution=function(n){var r=s.b.reportApiInvoke(e.sid,{name:"Stream.setVideoResolution",options:arguments,tag:"tracer"});if(!(n instanceof Array)){var i=ye(n+="");return i&&i.video?(e.videoConstraint=y()(e.videoConstraint,{width:{ideal:i.video.width},height:{ideal:i.video.height}}),t.attributes.resolution=i.attributes.resolution,(o=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0])&&o.applyConstraints?(a.default.debug("setVideoResolution applyConstraints",e.videoConstraint),o.applyConstraints(e.videoConstraint).then(r).catch(r)):r(),!0):(r("NO_PROFILE_".concat(n)),!1)}var o,u=n[0],c=n[1];e.videoConstraint=y()(e.videoConstraint,{width:{ideal:u},height:{ideal:c}}),t.attributes.resolution="".concat(u,"x").concat(c),(o=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0])&&o.applyConstraints?(a.default.debug("setVideoResolution applyConstraints",e.videoConstraint),de(e).then((function(){return o.applyConstraints(e.videoConstraint).then(r).catch(r)})).then((function(){return le(e)}))):r()},e.setVideoFrameRate=function(n){var r=s.b.reportApiInvoke(e.sid,{name:"Stream.setVideoFrameRate",options:arguments,tag:"tracer"});if(Object(h.isFireFox)())return r("FIREFOX_NOT_SUPPORTED"),!1;if("object"===ve()(n)&&n instanceof Array&&n.length>1){e.videoConstraint=y()(e.videoConstraint,{frameRate:{ideal:n[0],max:n[1]}}),t.attributes.minFrameRate=n[0],t.attributes.maxFrameRate=n[1];var i=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0];return i&&i.applyConstraints?(a.default.debug("setVideoFrameRate applyConstraints",e.videoConstraint),i.applyConstraints(e.videoConstraint).then(r).catch(r)):r(),!0}return r("INVALID_PARAM_".concat(JSON.stringify(n))),!1},e.setVideoBitRate=function(n){var r=s.b.reportApiInvoke(e.sid,{name:"Stream.setVideoBitRate",options:arguments,tag:"tracer"});return"object"===ve()(n)&&n instanceof Array&&n.length>1?(t.attributes.minVideoBW=n[0],t.attributes.maxVideoBW=n[1],e.connectionSpec&&(e.connectionSpec.minVideoBW=n[0],e.connectionSpec.maxVideoBW=n[1]),e.pc&&e.pc.renegotiate&&e.pc.renegotiate(),r(),!0):(r("INVALID_PARAM_".concat(JSON.stringify(n))),!1)},e.setScreenBitRate=function(n){var r=s.b.reportApiInvoke(e.sid,{name:"Stream.setScreenBitRate",options:arguments,tag:"tracer"});return"object"===ve()(n)&&n instanceof Array&&n.length>1?(t.screenAttributes.minVideoBW=n[0],t.screenAttributes.maxVideoBW=n[1],r(),!0):(r("INVALID_PARAM_".concat(JSON.stringify(n))),!1)},e.setScreenProfile=function(t){var n=s.b.reportApiInvoke(e.sid,{name:"Stream.setScreenProfile",options:arguments,tag:"tracer"});Object(U.checkValidEnum)(t,"profile",["480p_1","480p_2","720p_1","720p_2","1080p_1","1080p_2"]);var r=ye(t);return r&&r.screen?(e.screenConstraint.mandatory?(e.screenConstraint.mandatory.maxWidth=r.screen.width,e.screenConstraint.mandatory.maxHeight=r.screen.height,r.screen.frameRate&&r.screen.frameRate.min&&r.screen.frameRate.max&&(e.screenConstraint.mandatory.minFrameRate=r.screen.frameRate.min,e.screenConstraint.mandatory.maxFrameRate=r.screen.frameRate.max)):e.screenConstraint=y()(e.screenConstraint,r.screen),e.screenAttributes.width=r.screen.width,e.screenAttributes.height=r.screen.height,e.screenAttributes.minFr=r.screen.frameRate.min,e.screenAttributes.maxFr=r.screen.frameRate.max,n(),!0):(n("NO_SCREEN_PROFILE_".concat(JSON.stringify(t))),!1)},e.setVideoProfileCustom=function(t){var n=s.b.reportApiInvoke(e.sid,{name:"Stream.setVideoProfileCustom",options:arguments,tag:"tracer"});e.setVideoResolution(t[0]),e.setVideoFrameRate([t[1],t[1]]),e.setVideoBitRate([t[2],t[2]]),n()},e.setVideoProfileCustomPlus=function(n){var r=s.b.reportApiInvoke(e.sid,{name:"Stream.setVideoProfileCustom",options:arguments,tag:"tracer"});e.videoConstraint.width=n.width,e.videoConstraint.height=n.height,t.attributes.resolution="".concat(n.width,"x").concat(n.height),e.setVideoFrameRate([n.framerate,n.framerate]),e.setVideoBitRate([n.bitrate,n.bitrate]),r()},e.setVideoProfile=function(n){var r=s.b.reportApiInvoke(e.sid,{name:"Stream.setVideoProfile",options:arguments,tag:"tracer"}),i=ye(n);if(!i){var o="Invalid Profile ".concat(n);throw new Error(o)}if(e.profile=n,i&&i.video){e.profile=i.profileName,e.videoConstraint=y()(e.videoConstraint,i.video),e.connectionSpec&&i.attributes.maxVideoBW&&(e.connectionSpec.minVideoBW=i.attributes.minVideoBW,e.connectionSpec.maxVideoBW=i.attributes.maxVideoBW),Object(h.isEdge)()&&(e.videoConstraint.frameRate.max=60),Object(h.isFireFox)()&&(e.videoConstraint.frameRate={ideal:30,max:30}),t.attributes=y()(t.attributes,i.attributes),e.pc&&e.pc.renegotiate&&e.pc.renegotiate();var u=e.stream&&e.stream.getVideoTracks&&e.stream.getVideoTracks()[0];return u&&u.applyConstraints?(a.default.debug("setVideoProfile applyConstraints",e.videoConstraint),de(e).then((function(){return u.applyConstraints(e.videoConstraint)})).then((function(){return le(e)})).then((function(t){return new Promise((function(n,i){r(t),Object($.vsResHack)(e.stream,(function(t,r){e.videoWidth=t,e.videoHeight=r,n()}),(function(t){a.default.warning("[".concat(e.streamId,"] vsResHack failed: "),t),i()}))}))})).catch(r)):r(),!0}return r("INVALID_VIDEO_PROFILE_".concat(n)),!1},e.setAudioProfile=function(t){var n=s.b.reportApiInvoke(e.sid,{name:"Stream.setAudioProfile",options:arguments,tag:"tracer"});Object(U.checkValidEnum)(t,"profile",["speech_low_quality","speech_standard","music_standard","standard_stereo","high_quality","high_quality_stereo"]),e.audioProfile=t;var r=be(t);return e.highQuality=r.highQuality,e.stereo=r.stereo,e.speech=r.speech,e.lowQuality=r.lowQuality,e.stereo&&Object(h.isChrome)()&&(e.audioConstraint.googAutoGainControl=!1,e.audioConstraint.googAutoGainControl2=!1,e.audioConstraint.echoCancellation=!1,e.audioConstraint.googNoiseSuppression=!1),n(),!0},e.setVideoEncoderConfiguration=function(t){Object(U.checkValidObject)(t,"config");var n=s.b.reportApiInvoke(e.sid,{name:"Stream.setVideoEncoderConfiguration",options:t,tag:"tracer"});t.resolution&&(Object(U.checkValidNumber)(t.resolution.width,"config.resolution.width"),Object(U.checkValidNumber)(t.resolution.height,"config.resolution.height"),e.setVideoResolution([t.resolution.width,t.resolution.height])),t.frameRate&&(Object(U.checkValidNumber)(t.frameRate.min,"config.frameRate.min"),Object(U.checkValidNumber)(t.frameRate.max,"config.frameRate.max"),e.setVideoFrameRate([t.frameRate.min,t.frameRate.max])),t.bitrate&&(Object(U.checkValidNumber)(t.bitrate.min,"config.bitrate.min",1,1e7),Object(U.checkValidNumber)(t.bitrate.max,"config.bitrate.max",1,1e7),e.setVideoBitRate([t.bitrate.min,t.bitrate.max])),n()},e.getSupportedProfile=function(t){var n=s.b.reportApiInvoke(e.sid,{name:"Stream.getSupportedProfile",options:arguments,tag:"tracer",callback:t});if(!e.local){var r="ONLY_LOCAL_STREAM_SUPPORTED";return a.default.error(r),n(r)}if(!e.stream)return r="STREAM_NOT_INIT",a.default.error(r),n(r);if(!e.stream.getVideoTracks)return r="TRACK_NOT_SUPPORT",a.default.error(r),n(r);var i=e.stream.getVideoTracks()[0];if(!i)return r="NO_VIDEO_TRACK_FOUND",a.default.error(r),n(r);if(!i.getCapabilities)return r="GETCAPABILITY_NOT_SUPPORT",a.default.error(r),n(r);var o=i.getCapabilities();return n(null,_e(o))}}(t,e),t.getId=function(){return t.streamId},t.getUserId=function(){return t.userId},t.checkDualStreamEnabled=function(){return!(!Object(o.getParameter)("DUALSTREAM_OPERATION_CHECK")||!t.isDualStream)&&(a.default.error("Operation not permitted: ".concat("DUAL_STREAM_ENABLED")),"DUAL_STREAM_ENABLED")},t.setUserId=function(e){var n=s.b.reportApiInvoke(t.sid,{name:"Stream.setUserId",options:arguments,tag:"tracer"});t.userId&&a.default.warning("[".concat(t.streamId,"] Stream.userId ").concat(t.userId," => ").concat(e)),t.userId=e,n()},t.getAttributes=function(){return e.screen?t.screenAttributes:e.attributes},t.hasAudio=function(){return t.audio},t.hasVideo=function(){return t.video},t.hasScreen=function(){return t.screen},t.hasScreenAudio=function(){return t.screenAudio},t.isVideoOn=function(){return(t.hasVideo()||t.hasScreen())&&!t.userMuteVideo},t.isAudioOn=function(){return t.hasAudio()&&!t.userMuteAudio},t.init=function(r,i){var o=s.b.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return i&&i(e);r&&r(t)},name:"Stream.init",options:arguments,tag:"tracer"}),u=((new Date).getTime(),arguments[2]);if(void 0===u&&(u=2),!0===t.initialized)return o({type:"warning",msg:"STREAM_ALREADY_INITIALIZED"});if(!0!==t.local)return o({type:"warning",msg:"STREAM_NOT_LOCAL"});var c=Math.random().toString().slice(3);t._streamInitID=c,t.videoSource?t.videoName="videoSource":t.video&&(t.videoName=D.searchDeviceNameById(e.cameraId)||"default"),t.audioSource?t.audioName="audioSource":t.audio&&(t.audioName=D.searchDeviceNameById(e.microphoneId)||"default"),t.screen&&(t.screenName=e.extensionId||"default");try{if(e.audio||e.video||e.screen||e.screenAudio||e.videoSource||e.audioSource){a.default.debug("[".concat(t.streamId,"] Requested access to local media"));var l={streamId:t.streamId};e.videoSource?l.videoSource=e.videoSource:e.screen?l.screen=t.screenConstraint:e.video&&(l.video=t.videoConstraint),e.audioSource?l.audioSource=e.audioSource:e.screenAudio?l.screenAudio=e.screenAudio:e.audio&&(l.audio=t.audioConstraint),P(l,(function(r){if(l.screenAudio&&!r.getAudioTracks()[0]&&a.default.warning("[".concat(t.streamId,"] Audio sharing is not selected")),l.screen&&a.default.debug("[".concat(t.streamId,"] User has granted access to screen sharing")),(l.video||l.audio)&&a.default.debug("[".concat(t.streamId,"] User has granted access to local media")),null===t._streamInitID){r.getTracks().forEach((function(e){e.stop()}));var i={type:"error",msg:"STREAM_IS_CLOSED",info:"stream is closed and cannot be initialized"};return a.default.error(t.streamId,i.info),void o(i)}if(t._streamInitID!==c)return r.getTracks().forEach((function(e){e.stop()})),i={type:"error",msg:"ABORT_OTHER_INIT",info:"stream initialization is aborted because of another stream.init"},a.default.error(t.streamId,i.info),void o(i);t.dispatchEvent({type:"accessAllowed"}),t.stream=r,t.initialized=!0,t.reloadDeviceName(),t.hasVideo()&&Object($.vsResHack)(r,(function(e,n){t.videoWidth=e,t.videoHeight=n}),(function(e){a.default.warning("[".concat(t.streamId,"] vsResHack failed: "),e)})),e.screen&&t.stream&&t.stream.getVideoTracks()[0]&&(t.stream.getVideoTracks()[0].onended=function(){t.dispatchEvent({type:"stopScreenSharing"})}),t.stream&&t.stream.getTracks&&t.stream.getTracks().forEach((function(e){e&&!e.onended&&(e.onended=n)})),o()}),(function(e){var n={type:"error",info:null};switch(e&&(n.msg=e.name||e.code||e,e.message&&(n.info=e.message),e.code&&(n.info?n.info+=". "+e.code:n.info=" "+e.code),e.constraint&&(n.info?n.info+=". Constraint: "+e.constraint:n.info="constraint: "+e.constraint)),n.msg){case"Starting video failed":case"TrackStartError":if(t.videoConstraint&&(delete t.videoConstraint.width,delete t.videoConstraint.height),u>0)return void setTimeout((function(){t.init((function(e){return o(e)}),o,u-1)}),1);n.msg="MEDIA_OPTION_INVALID";break;case"DevicesNotFoundError":n.msg="DEVICES_NOT_FOUND";break;case"NotSupportedError":n.msg="NOT_SUPPORTED";break;case"PermissionDeniedError":case"InvalidStateError":n.msg="PERMISSION_DENIED",t.dispatchEvent({type:"accessDenied"});break;case"PERMISSION_DENIED":case"NotAllowedError":t.dispatchEvent({type:"accessDenied"});break;case"ConstraintNotSatisfiedError":n.msg="CONSTRAINT_NOT_SATISFIED";break;default:n.msg||(n.msg="UNDEFINED")}var r="Media access ".concat(n.msg).concat(n.info?": "+n.info:"");a.default.error("[".concat(t.streamId,"] "),r),o(n)}))}else o({type:"warning",msg:"STREAM_HAS_NO_MEDIA_ATTRIBUTES"})}catch(e){a.default.error("[".concat(t.streamId,"] Stream init: "),e),o({type:"error",msg:e.message||e})}},t.reloadDeviceName=function(){if(t.stream){if(t.stream.getVideoTracks){var e=t.stream.getVideoTracks()[0];e&&e.label&&(t.videoName=e.label)}if(t.stream.getAudioTracks){var n=t.stream.getAudioTracks()[0];n&&n.label&&(t.audioName=n.label)}}},t.close=function(){var e=s.b.reportApiInvoke(null,{name:"Stream.close",options:arguments,tag:"tracer"});if(a.default.debug("[".concat(t.streamId,"] Close stream with id"),t.streamId),void 0!==t.stream){var n=t.stream.getTracks();for(var r in n)n.hasOwnProperty(r)&&n[r].stop();!t.isLowStream&&t.local?de(t).then((function(){t.stream=void 0})):(t.stream&&t.stream.clean&&t.stream.clean(),t.stream=void 0)}Object(h.isSafari)()&&t.pc&&t.pc.peerConnection&&t.pc.peerConnection.removeTrack&&t.pc.peerConnection.getSenders&&t.pc.peerConnection.getSenders().forEach((function(e){e&&(a.default.debug("[".concat(t.streamId,"] Remove Track"),e),t.pc.peerConnection.removeTrack(e))})),t.local&&(t.initialized=!1),t._streamInitID=null,t._onAudioMute=void 0,t._onAudioUnmute=void 0,t._onVideoMute=void 0,t._onVideoUnmute=void 0,t.lowStream&&t.lowStream.close(),e()},t.enableAudio=function(){var e,n=s.b.reportApiInvoke(t.sid,{name:"Stream.enableAudio",options:arguments,tag:"tracer"});return a.default.deprecate("[".concat(t.streamId,"] Stream.enableAudio is deprecated and will be removed in the future. Use Stream.unmuteAudio instead")),t.userMuteAudio||a.default.warning("[".concat(t.streamId,"] User already enableAudio")),t.userMuteAudio=!1,n(null,e=!t.peerMuteAudio&&t._unmuteAudio()),e},t.disableAudio=function(){var e=s.b.reportApiInvoke(t.sid,{name:"Stream.disableAudio",options:arguments,tag:"tracer"});a.default.deprecate("[".concat(t.streamId,"] Stream.disableAudio is deprecated and will be removed in the future. Use Stream.muteAudio instead")),t.userMuteAudio&&a.default.warning("[".concat(t.streamId,"] User already disableAudio")),t.userMuteAudio=!0;var n=t._muteAudio();return e(null,n),n},t.enableVideo=function(){var e,n=s.b.reportApiInvoke(t.sid,{name:"Stream.enableVideo",options:arguments,tag:"tracer"});return a.default.deprecate("[".concat(t.streamId,"] Stream.enableVideo is deprecated and will be removed in the future. Use Stream.unmuteVideo instead")),t.userMuteVideo||a.default.warning("[".concat(t.streamId,"] User already enableVideo")),t.userMuteVideo=!1,t.lowStream&&(t.lowStream.userMuteVideo=!1),n(null,e=!t.peerMuteVideo&&t._unmuteVideo()),e},t.disableVideo=function(){var e=s.b.reportApiInvoke(t.sid,{name:"Stream.disableVideo",options:arguments,tag:"tracer"});a.default.deprecate("[".concat(t.streamId,"] Stream.disableVideo is deprecated and will be removed in the future. Use Stream.muteVideo instead")),t.userMuteVideo&&a.default.warning("[".concat(t.streamId,"] User already disableVideo")),t.userMuteVideo=!0,t.lowStream&&(t.lowStream.userMuteVideo=!0);var n=t._muteVideo();return e(null,n),n},t.unmuteAudio=function(){var e,n=s.b.reportApiInvoke(t.sid,{name:"Stream.unmuteAudio",options:arguments,tag:"tracer"});return t.userMuteAudio||a.default.warning("[".concat(t.streamId,"] User already unmuteAudio")),t.userMuteAudio=!1,n(null,e=!t.peerMuteAudio&&t._unmuteAudio()),e},t.muteAudio=function(){var e=s.b.reportApiInvoke(t.sid,{name:"Stream.muteAudio",options:arguments,tag:"tracer"});t.userMuteAudio&&a.default.warning("[".concat(t.streamId,"] User already muteAudio")),t.userMuteAudio=!0;var n=t._muteAudio();return e(null,n),n},t.unmuteVideo=function(){var e,n=s.b.reportApiInvoke(t.sid,{name:"Stream.unmuteVideo",options:arguments,tag:"tracer"});return t.userMuteVideo||a.default.warning("[".concat(t.streamId,"] User already unmuteVideo")),t.userMuteVideo=!1,t.lowStream&&(t.lowStream.userMuteVideo=!1),n(null,e=!t.peerMuteVideo&&t._unmuteVideo()),e},t.muteVideo=function(){var e=s.b.reportApiInvoke(t.sid,{name:"Stream.muteVideo",options:arguments,tag:"tracer"});t.userMuteVideo&&a.default.warning("[".concat(t.streamId,"] User already muteVideo")),t.userMuteVideo=!0,t.lowStream&&(t.lowStream.userMuteVideo=!0);var n=t._muteVideo();return e(null,n),n},t._unmuteAudio=function(){return a.default.debug("[".concat(t.streamId,"] Unmuted audio stream with id "),t.streamId),t._flushAudioMixingMuteStatus(!1),!(!t.hasAudio()||!t.initialized||void 0===t.stream||!0===t.stream.getAudioTracks()[0].enabled||(t._onAudioUnmute&&t._onAudioUnmute(),t.pc&&(t.pc.isAudioMute=!1),t.stream.getAudioTracks()[0].enabled=!0,0))},t._isAudioMuted=function(){if(t.stream&&t.hasAudio()){var e=t.stream.getAudioTracks();return e.length>0&&!e[0].enabled}return!1},t._isVideoMuted=function(){if(t.stream&&t.hasVideo()){var e=t.stream.getVideoTracks();return e.length>0&&!e[0].enabled}return!1},t._muteAudio=function(){return a.default.debug("[".concat(t.streamId,"] Muted audio stream with id "),t.streamId),t._flushAudioMixingMuteStatus(!0),!!(t.hasAudio()&&t.initialized&&void 0!==t.stream&&t.stream.getAudioTracks()[0].enabled)&&(t._onAudioMute&&t._onAudioMute(),t.pc&&(t.pc.isAudioMute=!0),t.stream.getAudioTracks()[0].enabled=!1,t.sid&&s.b.audioSendingStopped(t.sid,{succ:!0,reason:"muteAudio"}),!0)},t._unmuteVideo=function(){return a.default.debug("[".concat(t.streamId,"] Unmuted video stream with id"),t.streamId),!(!t.initialized||void 0===t.stream||!t.stream.getVideoTracks().length||!0===t.stream.getVideoTracks()[0].enabled||(t._onVideoUnmute&&t._onVideoUnmute(),t.pc&&(t.pc.isVideoMute=!1),t.stream.getVideoTracks()[0].enabled=!0,t.lowStream&&t.lowStream._unmuteVideo(),0))},t._muteVideo=function(){return a.default.debug("[".concat(t.streamId,"] Muted video stream with id"),t.streamId),!!(t.initialized&&void 0!==t.stream&&t.stream.getVideoTracks().length&&t.stream.getVideoTracks()[0].enabled)&&(t._onVideoMute&&t._onVideoMute(),t.pc&&(t.pc.isVideoMute=!0),t.stream.getVideoTracks()[0].enabled=!1,t.lowStream&&t.lowStream._muteVideo(),t.sid&&s.b.videoSendingStopped(t.sid,{succ:!0,reason:"muteVideo"}),!0)},t.addTrack=function(r){var i=s.b.reportApiInvoke(t.sid,{name:"Stream.addTrack",options:arguments,tag:"tracer"}),o=t.checkDualStreamEnabled();if(o)return i(o);if(t.pc&&t.pc.addTrack(r,t.stream),"audio"==r.kind){t._cleanupAudioMixing();var a=new MediaStream;t.userMuteAudio&&(r.enabled=!1),a.addTrack(r);var u=t.stream.getVideoTracks()[0];u&&(a.addTrack(u),t.audio=!0,e.audio=!0),t.stream=a,t.audioLevelHelper=null,t.player&&t.player.video&&(t.player.video.srcObject=t.stream)}else t.userMuteVideo&&(r.enabled=!1),t.stream.addTrack(r),t.video=!0,e.video=!0;r.onended||(r.onended=n),i()},t.removeTrack=function(n){var r=s.b.reportApiInvoke(t.sid,{name:"Stream.removeTrack",options:arguments,tag:"tracer"}),i=t.checkDualStreamEnabled(),o=ge(t);if(i||o)return r(i);t.pc&&t.pc.removeTrack(n,t.stream),t.stream.removeTrack(n),t._cleanupAudioMixing(),"audio"===n.kind?(t.audio=!1,e.audio=!1):(t.video=!1,e.video=!1),t.audioLevelHelper=null,"live"==n.readyState&&(n.stop(),a.default.debug("[".concat(t.streamId,"] Track ").concat(n.kind," Stopped"))),r()},t.setAudioOutput=function(e,n,r){var i=s.b.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return r&&r(e);n&&n(t)},name:"Stream.setAudioOutput",options:arguments,tag:"tracer"});return Object(U.isValidString)(e,1,255)?(t.audioOutput=e,t.player?void t.player.setAudioOutput(e,(function(){return i()}),i):i()):(a.default.error("[".concat(t.streamId,"] setAudioOutput Invalid Parameter"),e),i(S.default.INVALID_PARAMETER))},t.play=function(e,n,r){"function"==typeof n&&(r=n,n=null),a.default.debug("[".concat(t.streamId,"] play()."),e,n);var i=s.b.reportApiInvoke(t.sid,{name:"Stream.play",options:arguments,tag:"tracer",callback:r});if(Object(U.checkValidString)(e,"elementID"),Object(U.isEmpty)(n)||(Object(U.isEmpty)(n.fit)||Object(U.checkValidEnum)(n.fit,"fit",["cover","contain"]),Object(U.isEmpty)(n.muted)||Object(U.checkValidBoolean)(n.muted,"muted")),t.player)a.default.warning("[".concat(t.streamId,"] Stream.play(): Stream is already playing. Fallback to resume stream")),t.resume().then((function(){i(null)})).catch(i);else{t.elementID=e,t.playOptions=n,!t.local||t.video||t.screen?(t.player=new w({id:t.getId(),stream:t,elementID:e,options:n}),t.local&&pe(t)):t.hasAudio()&&(t.player=new w({id:t.getId(),stream:t,elementID:e,options:n}));var o={audio:null,video:null};t.on("player-status-change",(function e(n){if(o[n.mediaType]=n,o.audio&&o.video)if(t.removeEventListener("player-status-change",e),o.video.isErrorState||o.audio.isErrorState){var r=o.video.isErrorState?o.video:o.audio;i({isErrorState:!0,status:r.status,reason:r.reason,video:o.video,audio:o.audio})}else"aborted"===o.video.status&&"aborted"===o.audio.status?i({status:"aborted",reason:"stop",video:o.video,audio:o.audio}):i(null)})),t.audioOutput&&t.player.setAudioOutput(t.audioOutput),void 0!==t.audioLevel&&t.player.setAudioVolume(t.audioLevel),t._flushAudioMixingMuteStatus(!1)}},t.stop=function(){var e=s.b.reportApiInvoke(t.sid,{name:"Stream.stop",options:arguments,tag:"tracer"});a.default.debug("[".concat(t.streamId,"] Stop stream player with id "),t.streamId),t.player?(fe(t),t.player.destroy(),delete t.player):a.default.error("[".concat(t.streamId,"] Stream.stop(): Stream is not playing")),t._flushAudioMixingMuteStatus(!0),e()},t.isPlaying=function(){return!!t.player},t.isPaused=function(){return!!(t.player&&(t.player.video&&t.player.video.paused&&t.player.mediaElemExists(t.player.video)||t.player.audio&&t.player.audio.paused&&t.player.mediaElemExists(t.player.audio)))},t.resume=function(){var e,n;return t.player?(t.player.video&&t.player.video.play&&(e=t.player.video.play()),e=e||Promise.resolve(),t.player.audio&&t.player.audio.play&&(n=t.player.audio.play()),n=n||Promise.resolve(),Promise.all([e,n])):Promise.reject("NO_PLAYER_FOUND")},t.getVideoTrack=function(){var e=s.b.reportApiInvoke(t.sid,{name:"Stream.getVideoTrack",options:arguments,tag:"tracer"});if(t.stream&&t.stream.getVideoTracks){var n=t.stream.getVideoTracks()[0];if(n)return a.default.info("[".concat(t.streamId,"] getVideoTrack"),n),e(),n}a.default.info("[".concat(t.streamId,"] getVideoTrack None")),e(null,"getVideoTrack None")},t.getAudioTrack=function(){var e=s.b.reportApiInvoke(t.sid,{name:"Stream.getAudioTrack",options:arguments,tag:"tracer"});if(t.stream&&t.stream.getAudioTracks){var n=t.stream.getAudioTracks()[0];if(n)return a.default.info("[".concat(t.streamId,"] getAudioTracks"),n),e(),n}a.default.info("[".concat(t.streamId,"] getAudioTracks None")),e(null,"getAudioTracks None")},t._hasVideoTracks=function(){return!!(t.stream&&t.stream.getVideoTracks&&t.stream.getVideoTracks()[0])},t._hasAudioTracks=function(){return!!(t.stream&&t.stream.getAudioTracks&&t.stream.getAudioTracks()[0])},t._replaceMediaStreamTrack=function(e,n,r){if(t.stream){if("video"==e.kind){if(o=t.stream.getVideoTracks()[0])return t.userMuteVideo&&(e.enabled=!1),t.stream.removeTrack(o),t.stream.addTrack(e),a.default.debug("[".concat(t.streamId,"] _replaceMediaStreamTrack ").concat(e.kind," SUCCESS")),"live"==o.readyState&&(o.stop(),a.default.debug("[".concat(t.streamId,"] Track ").concat(o.kind," Stopped"))),n&&n();var i="MEDIASTREAM_TRACK_NOT_FOUND";return a.default.error("[".concat(t.streamId,"] MEDIASTREAM_TRACK_NOT_FOUND ").concat(e.kind)),r(i)}if("audio"==e.kind){var o;if(o=t.stream.getAudioTracks()[0]){t.userMuteAudio&&(e.enabled=!1);var s=new MediaStream;s.addTrack(e);var u=t.stream&&t.stream.getVideoTracks()[0];return u&&s.addTrack(u),t.stream=s,t.audioLevelHelper=null,t.player&&t.player.video&&(t.player.video.srcObject=t.stream),a.default.debug("[".concat(t.streamId,"] _replaceMediaStreamTrack SUCCESS")),"live"==o.readyState&&(o.stop(),a.default.debug("[".concat(t.streamId,"] Track ").concat(o.kind," Stopped"))),n&&n()}return i="MEDIASTREAM_TRACK_NOT_FOUND",a.default.error("[".concat(t.streamId,"] MEDIASTREAM_TRACK_NOT_FOUND ").concat(e.kind)),r(i)}return i="INVALID_TRACK_TYPE",a.default.error("[".concat(t.streamId,"] _replaceMediaStreamTrack ").concat(i," ").concat(e.kind)),r&&r(i)}return i="NO_STREAM_FOUND",a.default.error("[".concat(t.streamId,"] _replaceMediaStreamTrack ").concat(i)),r&&r(i)},t.replaceTrack=function(e,r,i){var o=s.b.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return i&&i(e);r&&r(t)},name:"Stream.replaceTrack",options:arguments,tag:"tracer"});if(!e||!e.kind)return o("INVALID_TRACK");var u=t.checkDualStreamEnabled();return u?o(u):(t._cleanupAudioMixing(),e.onended||(e.onended=n),t.pc&&t.pc.hasSender&&t.pc.hasSender(e.kind)?void t.pc.replaceTrack(e,(function(){return a.default.debug("[".concat(t.streamId,"] PeerConnection.replaceTrack ").concat(e.kind," SUCCESS")),t._replaceMediaStreamTrack(e,(function(e){return o(null,e)}),o)}),(function(n){return a.default.error("[".concat(t.streamId,"] PeerConnection.replaceTrack ").concat(e.kind," Failed ").concat(n)),o(n)})):t._replaceMediaStreamTrack(e,(function(e){return o(null,e)}),o))},t.setAudioVolume=function(e){var n=s.b.reportApiInvoke(t.sid,{name:"Stream.setAudioVolume",options:arguments,tag:"tracer"});Object(U.checkValidNumber)(e,"level",0,100),t.audioLevel=e,t.player&&t.player.setAudioVolume(e),n()},t.getStats=function(e,n,r){var i=[];i.push(t._getPCStats(r)),i.push(new Promise((function(e){var n={};t.pc&&t.pc.isSubscriber?null!==window.navigator.userAgent.match("Firefox")&&(k(n,"videoReceiveResolutionHeight",t.videoHeight),k(n,"videoReceiveResolutionWidth",t.videoWidth)):t.pc&&!t.pc.isSubscriber&&((Object(h.isSafari)()||Object(h.isFireFox)())&&(k(n,"videoSendResolutionHeight",t.videoHeight),k(n,"videoSendResolutionWidth",t.videoWidth)),(Object(h.isSafari)()||Object(h.isFireFox)())&&t.uplinkStats&&k(n,"videoSendPacketsLost",t.uplinkStats.uplink_cumulative_lost)),e(n)}))),i.push(new Promise((function(e){var n={};return t.traffic_stats&&t.pc&&t.pc.isSubscriber?(k(n,"accessDelay",t.traffic_stats.access_delay),k(n,"endToEndDelay",t.traffic_stats.e2e_delay),k(n,"videoReceiveDelay",t.traffic_stats.video_delay),k(n,"audioReceiveDelay",t.traffic_stats.audio_delay)):t.traffic_stats&&t.pc&&!t.pc.isSubscriber&&k(n,"accessDelay",t.traffic_stats.access_delay),e(n)}))),Promise.all(i).then((function(n){for(var r={},i=n.length-1;i>=0;i--){var o=n[i];y()(r,o)}e&&setTimeout(e.bind(t,r),0)})).catch((function(e){n&&setTimeout(n.bind(t,e),0)}))},t._getPCStats=function(e){return new Promise((function(n,r){if(!t.pc||"established"!==t.pc.state||!t.pc.getStats)return r("PEER_CONNECTION_NOT_ESTABLISHED");t.pc.getStats((function(e){if(!t.pc||"established"!==t.pc.state||!t.pc.getStats)return r("PEER_CONNECTION_STATE_CHANGE");var i=t.pc.isSubscriber?function(e){var t={};return e.forEach((function(e){e.id&&(-1===e.id.indexOf("recv")&&-1===e.id.indexOf("inbound_rtp")&&-1===e.id.indexOf("inbound-rtp")&&-1===e.id.indexOf("InboundRTP")||("audio"===e.mediaType?(k(t,"audioReceiveBytes",e.bytesReceived),k(t,"audioReceivePackets",e.packetsReceived),k(t,"audioReceivePacketsLost",e.packetsLost)):(k(t,"videoReceiveBytes",e.bytesReceived),k(t,"videoReceivePacketsLost",e.packetsLost),k(t,"videoReceivePackets",e.packetsReceived),k(t,"videoReceiveFrameRate",e.googFrameRateReceived),k(t,"videoReceiveDecodeFrameRate",e.googFrameRateDecoded),k(t,"videoReceiveResolutionWidth",e.googFrameWidthReceived),k(t,"videoReceiveResolutionHeight",e.googFrameHeightReceived))))})),t}(e):function(e){var t={};return e.forEach((function(e){e.id&&(-1===e.id.indexOf("send")&&-1===e.id.indexOf("outbound_rtp")&&-1===e.id.indexOf("OutboundRTP")||("audio"===e.mediaType?(k(t,"audioSendBytes",e.bytesSent),k(t,"audioSendPackets",e.packetsSent),k(t,"audioSendPacketsLost",e.packetsLost)):(k(t,"videoSendBytes",e.bytesSent),k(t,"videoSendPackets",e.packetsSent),k(t,"videoSendPacketsLost",e.packetsLost),k(t,"videoSendFrameRate",e.googFrameRateSent),k(t,"videoSendResolutionWidth",e.googFrameWidthSent),k(t,"videoSendResolutionHeight",e.googFrameHeightSent))))})),t}(e);return n(i)}),e)})).then((function(e){return t.pc.isSubscriber?(Object(h.isFireFox)()||Object(h.isSafari)())&&(e.videoReceiveResolutionHeight&&"0"!==e.videoReceiveResolutionHeight||e.videoReceiveResolutionWidth&&"0"!==e.videoReceiveResolutionWidth||(k(e,"videoReceiveResolutionHeight",t.videoHeight),k(e,"videoReceiveResolutionWidth",t.videoWidth))):((Object(h.isSafari)()||Object(h.isFireFox)())&&(e.videoSendResolutionHeight&&"0"!==e.videoSendResolutionHeight||e.videoSendResolutionWidth&&"0"!==e.videoSendResolutionWidth||(k(e,"videoSendResolutionHeight",t.videoHeight),k(e,"videoSendResolutionWidth",t.videoWidth))),(Object(h.isSafari)()||Object(h.isFireFox)())&&t.uplinkStats&&k(e,"videoSendPacketsLost",t.uplinkStats.uplink_cumulative_lost)),Promise.resolve(e)}))},t.getAudioLevel=function(){if(t.audioLevelHelper)return t.audioLevelHelper.getAudioLevel();if(t.stream){if(0!==t.stream.getAudioTracks().length)return t.audioLevelHelper=new $.audioLevelHelper(t.stream),t.audioLevelHelper.getAudioLevel();a.default.warning("[".concat(t.streamId,"] can't get audioLevel beacuse no audio trace in stream"))}else a.default.warning("[".concat(t.streamId,"] can't get audioLevel beacuse no stream exist"))},t.setVideoProfile("480P"),t._switchVideoDevice=function(e,n,r){if(e===t.cameraId)return n&&n();var i={video:y()({},t.videoConstraint,{deviceId:{exact:e}}),audio:!1};a.default.debug("[".concat(t.streamId,"] ").concat(i)),P(i,(function(i){try{var o=function(){t.isPlaying()&&(t.stop(),t.elementID&&t.play(t.elementID,t.playOptions)),t.cameraId=e,t.videoConstraint.deviceId={exact:e},t.userMuteVideo&&(t.stream.getVideoTracks()[0].enabled=!1),le(t),n&&n()};de(t).then((function(){Object(h.isSafari)()?t.replaceTrack(i.getVideoTracks()[0],o,r):(t.removeTrack(t.stream.getVideoTracks()[0]),t.addTrack(i.getVideoTracks()[0]),o())}))}catch(e){return r&&r(e)}}),(function(e){return r&&r(e)}))},t._switchAudioDevice=function(e,n,r){if(e===t.microphoneId)return n&&n();var i={video:!1,audio:y()({},t.audioConstraint,{deviceId:{exact:e}})};a.default.debug("[".concat(t.streamId,"] "),i),P(i,(function(i){var o=function(){t._cleanupAudioMixing(),t.userMuteAudio&&(t.stream.getAudioTracks()[0].enabled=!1),t.isPlaying()&&(t.stop(),t.elementID&&t.play(t.elementID)),t.microphoneId=e,t.audioConstraint.deviceId={exact:e},n&&n()};try{Object(h.isSafari)()?t.replaceTrack(i.getAudioTracks()[0],o,r):(t.removeTrack(t.stream.getAudioTracks()[0]),t.addTrack(i.getAudioTracks()[0]),o())}catch(e){return r&&r(e)}}),(function(e){return r&&r(e)}))},t.switchDevice=function(e,n,r,i){var o=s.b.reportApiInvoke(t.sid,{callback:function(e,t){if(e)return i&&i(e);r&&r(t)},name:"Stream.switchDevice",options:arguments,tag:"tracer"});Object(U.checkValidString)(n,"deviceId");var u=function(){return t.inSwitchDevice=!1,o()},c=function(e){t.inSwitchDevice=!1,a.default.error("[".concat(t.streamId,"] "),e),o(e)};if(t.inSwitchDevice)return o("Device switch is in process.");if(t.inSwitchDevice=!0,!t.local)return c("Only the local stream can switch the device.");if(t.screen&&"video"===e)return c("The device cannot be switched during screen-sharing.");if(t.videoSource||t.audioSource)return c("The device cannot be switched when using videoSource or audioSource.");if(t.lowStream)return c("The device cannot be switched when using lowstream.");var l=!1;for(var d in t.audioMixing.sounds)if(t.audioMixing.sounds[d].state!==t.audioMixing.states.IDLE){l=!0;break}if(t.audioMixing.audioContextInited&&l)return c("The device cannot be switched when using audio Mixing.");D.getDeviceById(n,(function(){if("video"===e)t._switchVideoDevice(n,u,c);else{if("audio"!==e)return c("Invalid type.");t._switchAudioDevice(n,u,c)}}),(function(){return c("The device does not exist.")}))},t},Ee=r(20),we=r(8),Ie=r.n(we),Te=["live","rtc","web","interop","h264_interop","web-only"],Oe=["vp8","h264"],xe=["aes-128-xts","aes-256-xts","aes-128-ecb"],Re=r(21),Ae=r.n(Re),Le=function(e){e&&e.apply(this,[].slice.call(arguments,1))},Ce=r(10),Ne=function(e,t){var n={connect:function(){t.host=e,n.signal=function(e){var t=u();t.needReconnect=!0,t.isTimeout=!1,t.isInit=!0,t.sendbytes=0,t.recvbytes=0,t.startTime=Date.now(),t.lastMsgTime=null,t.clientId=e.clientId,t.hostIndex=0,t.requestID=0,e.host instanceof Array?t.host=e.host:t.host=[e.host],t.getSendBytes=function(){return t.sendbytes},t.getRecvBytes=function(){return t.recvbytes},t.getDuration=function(){return Math.ceil((Date.now()-t.startTime)/1e3)},t.getURL=function(){return t.connection.url},t.reconnect=function(){t.isInit=!0,t.creatConnection()},t.connectNext=function(){t.isInit=!0,++t.hostIndex,a.default.debug("["+t.clientId+"] Gateway length:"+t.host.length+" current index:"+t.hostIndex),t.hostIndex>=t.host.length?t.dispatchEvent(p({type:"recover"})):t.creatConnection()},t.replaceHost=function(e){t.host=e||t.host,t.hostIndex=0,t.creatConnection()},t.creatConnection=function(){if(t.needReconnect=!0,a.default.debug("["+t.clientId+"] start connect:"+t.host[t.hostIndex]),t.lts=(new Date).getTime(),t.connection=new WebSocket("wss://"+t.host[t.hostIndex]),t.connection.binaryType="arraybuffer",t.turnConfig={},t.connection.url){var n=t.connection.url.match(/wss\:\/\/([^:]+):(\d+)/);if(n)t.turnConfig.url=n[1],Object(o.getParameter)("TURN_ENABLE_TCP")&&(t.turnConfig.tcpport=parseInt(n[2])+30),Object(o.getParameter)("TURN_ENABLE_UDP")&&(t.turnConfig.udpport=parseInt(n[2])+30);else{var r=t.host[t.hostIndex].split(":");t.turnConfig.url=r[0],Object(o.getParameter)("TURN_ENABLE_TCP")&&(t.turnConfig.tcpport=parseInt(r[1])+30),Object(o.getParameter)("TURN_ENABLE_UDP")&&(t.turnConfig.udpport=parseInt(r[1])+30)}}t.connection.onopen=function(e){a.default.debug("["+t.clientId+"] websockect opened: "+t.host[t.hostIndex]),t.needReconnect=!0,t.isTimeout=!1,t.isInit=!1,t.sendbytes=0,t.recvbytes=0,t.startTime=Date.now(),Object(Ce.resetHTTPByetsCount)(),clearTimeout(t.timeoutCheck),t.dispatchEvent(p({type:"onopen",event:e,socket:t}))},t.connection.onmessage=function(e){if(e.data instanceof ArrayBuffer)t.dispatchEvent({type:"onBinaryData",data:e.data});else{t.recvbytes+=Object($.lengthInUtf8Bytes)(e.data);var n=JSON.parse(e.data);t.lastMsgTime=Date.now(),n.hasOwnProperty("_id")?t.dispatchEvent(p({type:n._id,msg:n})):n.hasOwnProperty("_type")&&t.dispatchSocketEvent(p({type:n._type,msg:n._message}))}},t.connection.onclose=function(n){t.needReconnect?t.isTimeout||t.isInit?(a.default.debug("["+t.clientId+"] websockect connect timeout"),s.b.joinGateway(e.sid,{lts:t.lts,succ:!1,ec:"timeout",addr:t.connection.url}),t.connectNext()):t.dispatchEvent(p({type:"disconnect",event:n})):(a.default.debug("["+t.clientId+"] websockect closeed"),Le(e.onFailure,n),clearTimeout(t.timeoutCheck),t.dispatchEvent(p({type:"close",event:n})),t.connection.onopen=void 0,t.connection.onclose=void 0,t.connection.onerror=void 0,t.connection.onmessage=void 0,t.connection=void 0)},t.connection.onerror=function(e){},setTimeout((function(){t.connection&&t.connection.readyState!=WebSocket.OPEN&&(t.isTimeout=!0,t.connection.close())}),5e3)},t.creatConnection(),t.sendMessage=function(e,n){if(t.connection&&t.connection.readyState==WebSocket.OPEN){var r=JSON.stringify(e);t.sendbytes+=Object($.lengthInUtf8Bytes)(r),t.connection.send(r)}else n({error:"Gateway not connected"})},t.disconnect=function(){t.needReconnect=!0,t.connection.close()},t.close=function(){t.needReconnect=!1,t.connection.onclose=void 0,t.connection.close()},t.sendSignalCommand=function(e,n){e._id="_request_"+t.requestID,t.requestID+=1,"publish_stats"!==e._type&&"subscribe_stats"!==e._type&&"publish_stats_low"!==e._type&&t.on(e._id,(function(r){r.msg&&n&&n(r.msg._result,r.msg.message),delete t.dispatcher.eventListeners[e._id]})),t.sendMessage(e,(function(e){e.reason="NOT_CONNECTED",n&&n(e.reason,e)}))},t.requests=[];var n=function(e){var n=t.requests.findIndex((function(t){return t.id===e.type}));if(n>=0)var r=t.requests.splice(n,1)[0];r&&t.dispatcher.eventListeners[e.type]?(delete t.dispatcher.eventListeners[e.type],e.msg&&r.callback&&r.callback(e.msg._result,e.msg._message)):a.default.warning("Detached Response",e.type,e.msg)};return t.sendRequest=function(e,r){e=y()({_id:"_request_"+t.requestID},e),t.requestID+=1;var i={id:e._id,timeoutCounter:0,stalledAt:Date.now(),message:e,callback:r};t.requests.push(i),t.addEventListener(e._id,n),t.sendMessage(e,function(e){var n=this,r=t.requests.findIndex((function(e){return e.id===n.id}));r>=0&&(n=t.requests.splice(r,1)[0]),n&&t.dispatcher.eventListeners[e.type]?(delete t.dispatcher.eventListeners[e.type],e.reason="NOT_CONNECTED",n.callback&&n.callback(e.reason,e)):a.default.warning("handleSendError",n)}.bind(i))},t.checkRequestTimeout=function(){for(var e=Math.ceil(Object(o.getParameter)("SIGNAL_REQUEST_TIMEOUT")/Object(o.getParameter)("SIGNAL_REQUEST_WATCH_INTERVAL")),n=t.requests.length-1;n>=0;n--){var r=t.requests[n];r.timeoutCounter>=e?(t.requests.splice(n,1),a.default.error("Request Timeout",r.timeoutCounter,r.message),r.callback&&r.callback("TIMEOUT")):r.timeoutCounter++}},clearInterval(t.requestTimer),t.requestTimer=setInterval(t.checkRequestTimeout,Object(o.getParameter)("SIGNAL_REQUEST_WATCH_INTERVAL")),t.sendReport=function(e){t.sendMessage(e,(function(){}))},t}(t),n.on=n.signal.on,n.dispatchEvent=n.signal.dispatchEvent,n.signal.on("onopen",(function(e){n.signal.onEvent=function(e){n.dispatchEvent(p({type:e.event,msg:e}))},n.dispatchEvent(p({type:"connect",msg:e}))})),n.signal.on("onError",(function(e){var t=e.msg;onError(t.code,"error")}))},getLastMsgTime:function(){return n.signal&&n.signal.lastMsgTime},getSendBytes:function(){return n.signal.getSendBytes()},getRecvBytes:function(){return n.signal.getRecvBytes()},getDuration:function(){return n.signal.getDuration()},disconnect:function(){n.signal.disconnect()},close:function(){n.signal.close()},getURL:function(){return n.signal.getURL()},reconnect:function(){n.signal.reconnect()},connectNext:function(){n.signal.connectNext()},replaceHost:function(e){n.signal.replaceHost(e)},emitSimpleMessage:function(e,t){n.signal.sendSignalCommand(e,t)},emitRequest:function(e,t){n.signal.sendRequest(e,t)},emitReport:function(e){n.signal.sendReport(e)}};return n.connect(),n},Me=function(e,t,n){var r={service_name:"webrtc_proxy",json_body:JSON.stringify(t)};Object(Ce.post)(e,r,(function(e){n&&n(null,e)}),(function(e){n&&n(e)}),{"X-Packet-Service-Type":0,"X-Packet-URI":61})},Pe=function(e){if(!e||[]instanceof Array==0)return[];var t=[];return e.forEach((function(e){var n;e.address&&e.tcp?(e.address.match(/^[\.\:\d]+$/)?n="".concat(e.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(a.default.info("["+joinInfo.clientId+"] "+"Cannot recognized as IP address ".concat(e.address,". Used As Host instead")),n="".concat(e.address,":").concat(e.tcp)),t.push(n)):a.default.error("["+joinInfo.clientId+"] Invalid address format ",e)})),t},$e={},ke={},De=function(e,t,n,r){var i=(new Date).getTime(),o=t,u="";t.multiIP&&t.multiIP.gateway_ip&&(u={vocs_ip:[t.multiIP.uni_lbs_ip],vos_ip:[t.multiIP.gateway_ip]});var c={opid:133,flag:4096,ts:+new Date,key:t.token,cname:t.cname,sid:t.sid,detail:{6:t.stringUid},uid:t.uid||0};u&&(c.detail[5]=JSON.stringify(u)),Object(Ce.post)(e+"".concat(-1===e.indexOf("?")?"?":"&","action=wrtc_gateway"),c,(function(u){try{var c=JSON.parse(u);c.res&&(c=c.res);var l=c.code}catch(e){var d="requestChooseServer failed with unexpected body "+u;return a.default.error("["+o.clientId+"]",d),r(d)}if(l){var p=S.APErrorCode[c.code]||l;return s.b.joinChooseServer(t.sid,{lts:i,succ:!1,csAddr:e,serverList:null,ec:p}),r("Get server node failed ["+p+"]",e,p)}var f=[],h=[".agora.io",".agoraio.cn"],g=0;if(e.indexOf(h[1])>-1&&(g=1),c.addresses.forEach((function(e){var t;e.ip&&e.port?(e.ip.match(/^[\.\:\d]+$/)?t="".concat(e.ip.replace(/[^\d]/g,"-"),".edge").concat(h[g++%h.length],":").concat(e.port):(a.default.info("["+o.clientId+"] "+"Cannot recognized as IP address ".concat(e.ip,". Used As Host instead")),t="".concat(e.ip,":").concat(e.port)),f.push(t)):a.default.error("["+o.clientId+"] Invalid address format ",e)})),!f.length)return a.default.error("["+o.clientId+"] Empty Address response",c),p="EMPTY_ADDRESS_RESPONSE",s.b.joinChooseServer(t.sid,{lts:i,succ:!1,csAddr:e,serverList:null,ec:p}),r("Get server node failed ["+p+"]",e,p);var m={gateway_addr:f,uid:c.uid,cid:c.cid,vid:c.detail&&c.detail[8],res:c,uni_lbs_ip:c.detail};return n(m,e)}),(function(e,n){"timeout"===e.type?(s.b.joinChooseServer(t.sid,{lts:i,succ:!1,csAddr:n,serverList:null,ec:"timeout"}),r("Connect choose server timeout",n)):s.b.joinChooseServer(t.sid,{lts:i,succ:!1,csAddr:n,serverList:null,ec:"server_wrong"})}),{"X-Packet-Service-Type":0,"X-Packet-URI":69})},Ue=function(e,t,n){var r=!1,i=null,u=1,c=1,l=null,d=e.clientId,p=function t(c,p){if(!r){var f=!1,g=!1,m=[],v=h.getBrowserInfo()||{};(function(e,t){var n=y()({},e),r=Object(o.getParameter)("CDS_AP"),i=[],a=!1;(r=r.map((function(e){return n.proxyServer?"https://".concat(n.proxyServer,"/ap/?url=").concat(e+"/api/v1"):"https://".concat(e,"/api/v1?action=config")}))).map((function(e){!function(e,t,n){var r={flag:64,cipher_method:0,timeout:1e3,features:t};Object(Ce.post)(e,r,(function(e){try{var t=JSON.parse(e);n&&n(null,t)}catch(e){n&&n(e)}n&&n(null,e)}),(function(e){n&&n(e)}),{"X-Packet-Service-Type":0,"X-Packet-URI":54})}(e,n,(function(e,n){a||(e?(i.push(e),i.length>=r.length&&t&&t("ALL_REQUEST_FAILED")):(a=!0,t&&t(null,n)))}))}))})({device:v.name,system:v.os,vendor:e.appId,version:o.VERSION,cname:e.cname,sid:e.sid,session_id:Object(s.a)(),detail:"",proxyServer:c},(function(t,n){g=!0;try{var r=Object.keys(n.test_tags)[0],i=JSON.parse(n.test_tags[r]);l=i[1]}catch(e){l=null}s.b.reportApiInvoke(e.sid,{name:"_config-distribute-request",options:{err:t,res:n}})(),ke[d]!==Ke.DISCONNECTED&&ke[d]!==Ke.DISCONNECTING?f&&p&&p(m,l):a.default.debug("[".concat(e.clientId,"] Request config success when connection state is ").concat(ke[d]))})),function(e,t,n){for(var r=(new Date).getTime(),i=!1,u=!0,c=function(n,o){if(i)s.b.joinChooseServer(e.sid,{lts:r,succ:!0,csAddr:o,serverList:n.gateway_addr,cid:n.cid+"",uid:n.uid+"",ec:null},!1);else{if(clearTimeout(g),i=!0,a.default.debug("["+e.clientId+"] Get gateway address:",n.gateway_addr),e.proxyServer){for(var u=n.gateway_addr,c=0;c<u.length;c++){var l=u[c].split(":");n.gateway_addr[c]=e.proxyServer+"/ws/?h="+l[0]+"&p="+l[1]}a.default.debug("["+e.clientId+"] Get gateway address:",n.gateway_addr)}t(n),s.b.joinChooseServer(e.sid,{lts:r,succ:!0,csAddr:o,serverList:n.gateway_addr,cid:n.cid+"",uid:n.uid+"",ec:null},!0)}},l=function(t,r,i){u&&(a.default.error("["+e.clientId+"]",t,r,i),i&&-1===S.JOIN_CS_RETRY_LIST.indexOf(i)&&(u=!1,n(i)))},d=Object(o.getParameter)("WEBCS_DOMAIN"),p=0;p<d.length;++p){var f;if("string"==typeof d[p]){var h=d[p];f=e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(h+"/api/v1"):"https://".concat(h,"/api/v1"),a.default.debug("["+e.clientId+"] "+"Connect to choose_server: ".concat(f)),De(f,e,c,l)}else a.default.error("["+e.clientId+"] Invalid Host",d[p])}var g=setTimeout((function(){if(!i)for(var t=Object(o.getParameter)("WEBCS_DOMAIN_BACKUP_LIST"),n=0;n<t.length;++n)if("string"==typeof t[n]){var r=t[n];f=e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(r+"/api/v1"):"https://".concat(r,"/api/v1"),a.default.debug("["+e.clientId+"] "+"Connect to backup_choose_server: ".concat(f)),De(f,e,c,l)}else a.default.error("["+e.clientId+"] Invalid Host",t[n])}),1e3);setTimeout((function(){!i&&u&&n()}),Object(o.getParameter)("WEBCS_BACKUP_CONNECT_TIMEOUT"))}(e,(function(t){r=!0,f=!0,m=t,clearTimeout(i),ke[d]!==Ke.DISCONNECTED&&ke[d]!==Ke.DISCONNECTING?g&&p&&p(m,l):a.default.debug("[".concat(e.clientId,"] Request gateway list success when connection state is ").concat(ke[d]))}),(function(r){if(r)return a.default.info("["+e.clientId+"] Join failed: "+r),void(n&&n(r));if(ke[d]===Ke.DISCONNECTED||ke[d]===Ke.DISCONNECTING)return a.default.debug("[".concat(e.clientId,"] Request gateway list falied when connection state is ").concat(ke[d])),void(n&&n("OPERATION_ABORT"));a.default.debug("["+e.clientId+"] Request gateway list will be restart in "+u+"s"),i=setTimeout((function(){t(c,p)}),1e3*u),$e[d]=i;var s=Object(o.getParameter)("AP_BACKOFF_MAX_TIME");u=u>=s?s:2*u}))}};e.useProxyServer?function n(){!function(e,t){!function(e,t){var n=!1,r=0,i={command:"convergeAllocateEdge",sid:e.sid,appId:e.appId,token:e.token,uid:e.uid,cname:e.cname,ts:Math.floor(Date.now()/1e3),version:o.VERSION,seq:0,requestId:1};Object(o.getParameter)("PROXY_CS").map((function(u){var c=(new Date).getTime();Me("https://"+u+"/api/v1",i,(function(i,l){if(i)return a.default.debug("["+e.clientId+"] Request proxy server failed: ",i),r++,s.b.requestProxyAppCenter(e.sid,{lts:c,succ:!1,APAddr:u,workerManagerList:null,ec:JSON.stringify(i),response:JSON.stringify({err:i,res:l})}),void(r>=Object(o.getParameter)("PROXY_CS").length&&t&&t("Get proxy server failed: request all failed"));if(!n)if((l=JSON.parse(l)).json_body){var d=JSON.parse(l.json_body);if(a.default.debug("["+e.clientId+"] App return:",d.servers),200!==d.code)i="Get proxy server failed: response code ["+d.code+"], reason [ "+d.reason+"]",a.default.debug("["+e.clientId+"] "+i),s.b.requestProxyAppCenter(e.sid,{lts:c,succ:!1,APAddr:u,workerManagerList:null,ec:i,response:JSON.stringify({err:i,res:l})});else{n=!0;var p=Pe(d.servers);s.b.requestProxyAppCenter(e.sid,{lts:c,succ:!0,APAddr:u,workerManagerList:JSON.stringify(p),ec:null,response:JSON.stringify({res:l})}),t&&t(null,p)}}else a.default.debug("["+e.clientId+"] Get proxy server failed: no json_body"),s.b.requestProxyAppCenter(e.sid,{lts:c,succ:!1,APAddr:u,workerManagerList:null,ec:"Get proxy server failed: no json_body",response:JSON.stringify({res:l})})}))}))}(e,(function(n,r){if(n)return t&&t(n);a.default.debug("["+e.clientId+"] getProxyServerList: ",r),function(e,t,n){var r=!1,i=0,o={command:"request",gatewayType:"http",appId:e.appId,cname:e.cname,uid:e.uid+"",sdkVersion:"2.3.1",sid:e.sid,seq:1,ts:+new Date,requestId:3,clientRequest:{appId:e.appId,cname:e.cname,uid:e.uid+"",sid:e.sid}};t.map((function(u){var c=(new Date).getTime();!function(e,t,n){Object(Ce.post)(e,t,(function(e){n&&n(null,e)}),(function(e){n&&n(e)}))}("https://"+u+":4000/v2/machine",o,(function(o,l){if(o)return a.default.debug("["+e.clientId+"] Request worker manager failed: ",o),i++,s.b.requestProxyWorkerManager(e.sid,{lts:c,succ:!1,workerManagerAddr:u,ec:JSON.stringify(o),response:JSON.stringify({res:l})}),void(i>=t.length&&n&&n("requeet worker manager server failed: request failed"));if(!r){if(!(l=JSON.parse(l)).serverResponse)return n&&n("requeet worker manager server failed: serverResponse is undefined");r=!0,s.b.requestProxyWorkerManager(e.sid,{lts:c,succ:!0,workerManagerAddr:u,ec:JSON.stringify(o),response:JSON.stringify({res:l})}),n&&n(null,{address:u,serverResponse:l.serverResponse})}}))}))}(e,r,t)}))}(e,(function(r,u){if(r){a.default.debug("["+e.clientId+"]",r),a.default.debug("["+e.clientId+"] Request proxy will be restart in "+c+"s"),i=setTimeout((function(){n()}),1e3*c),$e[d]=i;var l=Object(o.getParameter)("AP_BACKOFF_MAX_TIME");c=c>=l?l:2*c}else{clearTimeout(i);var f=u.address;e.proxyServer=f,e.turnServer={mode:"manual",url:u.address,tcpport:u.serverResponse.tcpport||"3433",udpport:u.serverResponse.udpport||"3478",username:u.serverResponse.username||"test",credential:u.serverResponse.password||"111111",forceturn:!0},e.turnServer.tcpport+="",e.turnServer.udpport+="",s.b.setProxyServer(f),a.default.setProxyServer(f),p(f,t)}}))}():p(null,t)},je=function(e,t,n,r){var i=Date.now();r=r||t.stringUid;var o={sid:t.sid,opid:10,appid:t.appId,string_uid:r};return new Promise((function(u,c){Object(Ce.post)(e+"".concat(-1===e.indexOf("?")?"?":"&","action=stringuid"),o,(function(l){try{var d=JSON.parse(l),p=d.code}catch(u){var f="requestUserAccount failed with unexpected body "+l;return a.default.error("["+t.clientId+"]",f),c({retryable:!0,info:f,url:e}),n&&n.dispatchEvent({type:"error",reason:"USER_ACCOUNT_BODY_NOT_JSON"}),void s.b.reqUserAccount(o.sid,{lts:i,success:!1,serverAddress:e,stringUid:r,uid:null,extend:l,errorCode:"USER_ACCOUNT_BODY_NOT_JSON"})}if(p){var h=S.StringUidErrorCode[d.code%1e4]||"REQ_ACCOUNT_ERR_".concat(p);return n&&n.dispatchEvent({type:"error",reason:h}),s.b.reqUserAccount(o.sid,{lts:i,success:!1,serverAddress:e,stringUid:r,uid:null,errorCode:h,extend:o}),c({retryable:!1,info:f="Get String Uid Failed ["+h+"]",url:e,error:h})}var g=d.uid;if(!(g>0&&g<Math.pow(2,32)))return a.default.error("["+t.clientId+"] "+"Invalid Uint Uid ".concat(r," => ").concat(g),d),h="INVALID_UINT_UID_".concat(g),n&&n.dispatchEvent({type:"error",reason:h}),s.b.reqUserAccount(o.sid,{lts:i,success:!1,serverAddress:e,stringUid:r,uid:null,errorCode:h,extend:o}),c({retryable:!0,error:h,info:"Get String Uid failed ["+h+"]",url:e});u({uid:g,url:e}),s.b.reqUserAccount(o.sid,{lts:i,success:!0,serverAddress:e,stringUid:r,uid:g,errorCode:null,extend:o})}),(function(e,t){if("timeout"===e.type){var a="USER_ACCOUNT_TIMEOUT";n&&n.dispatchEvent({type:"error",reason:a}),s.b.reqUserAccount(o.sid,{lts:i,success:!1,serverAddress:t,stringUid:r,uid:null,errorCode:a,extend:o}),c({retryable:!0,info:a,url:t})}else{var u="USER_ACCOUNT_SERVER_WRONG_".concat(e.type);n&&n.dispatchEvent({type:"error",reason:u}),s.b.reqUserAccount(o.sid,{lts:i,success:!1,serverAddress:t,stringUid:r,uid:null,errorCode:u,extend:o}),c({retryable:!0,info:u,url:t})}}),{"X-Packet-Service-Type":0,"X-Packet-URI":72})}))},Be=function(e,t,n){Date.now();var r,s=Object(o.getParameter)("ACCOUNT_REGISTER"),u=!1,c=Object(o.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT"),l=null,d=null,p=new Promise(function(){var p=G()(F.a.mark((function p(f,h){var g,m,v;return F.a.wrap((function(p){for(;;)switch(p.prev=p.next){case 0:l=f,d=h,r=0;case 3:if(!(r<Object(o.getParameter)("ACCOUNT_REGISTER_RETRY_COUNT_MAX"))){p.next=33;break}if(!u){p.next=6;break}return p.abrupt("return");case 6:return g=s[r%s.length],m=e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(s[i]+"/api/v1"):"https://".concat(g,"/api/v1"),p.prev=8,p.delegateYield(F.a.mark((function r(){var i;return F.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,je(m,e,t,n);case 2:if(i=r.sent,!u){r.next=5;break}return r.abrupt("return",{v:void 0});case 5:u=!0,setTimeout((function(){a.default.debug("Get UserAccount Successfully",i),l(i)}),0);case 7:case"end":return r.stop()}}),r,this)}))(),"t0",10);case 10:if(v=p.t0,"object"!==ve()(v)){p.next=13;break}return p.abrupt("return",v.v);case 13:p.next=30;break;case 15:if(p.prev=15,p.t1=p.catch(8),!u){p.next=19;break}return p.abrupt("return");case 19:if(!p.t1.retryable){p.next=27;break}return(c=Math.ceil(c*Object(o.getParameter)("ACCOUNT_REGISTER_RETRY_RATIO")))>Object(o.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX")&&(c=Object(o.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX")),a.default.error("".concat(p.t1.info," ").concat(p.t1.url," Will Fetch User Account in ").concat(c/1e3," seconds")),p.next=25,new Promise((function(e){setTimeout(e,c)}));case 25:p.next=30;break;case 27:a.default.error("Get UserAccount Error: ".concat(p.t1.info," ").concat(p.t1.url),p.t1.error),u=!0,d(p.t1);case 30:r++,p.next=3;break;case 33:case"end":return p.stop()}}),p,this,[[8,15]])})));return function(e,t){return p.apply(this,arguments)}}());return p.cancel=function(){u||(u=!0,d({info:"Request Cancelled",retryable:!1}))},p.isFinished=function(){return u},p},Fe={ERR_NO_VOCS_AVAILABLE:"tryNext",ERR_NO_VOS_AVAILABLE:"tryNext",ERR_JOIN_CHANNEL_TIMEOUT:"tryNext",WARN_REPEAT_JOIN:"quit",ERR_JOIN_BY_MULTI_IP:"recover",WARN_LOOKUP_CHANNEL_TIMEOUT:"tryNext",WARN_OPEN_CHANNEL_TIMEOUT:"tryNext",ERR_VOM_SERVICE_UNAVAILABLE:"tryNext",ERR_TOO_MANY_USERS:"tryNext",ERR_MASTER_VOCS_UNAVAILABLE:"tryNext",ERR_INTERNAL_ERROR:"tryNext",K_SERVICE_NOT_READY:"recover",notification_test_recover:"recover",notification_test_tryNext:"tryNext",notification_test_retry:"retry"},qe={googActualEncBitrate:"A_aeb",googAvailableSendBandwidth:"A_asb",googRetransmitBitrate:"A_rb",googAvailableReceiveBandwidth:"A_arb",googTargetEncBitrate:"A_teb",googBucketDelay:"A_bd",googTransmitBitrate:"A_tb",googCodecName:"A_cn",bytesSent:"bytesSent",packetsLost:"packetsLost",packetsSent:"packetsSent",googAdaptationChanges:"A_ac",googAvgEncodeMs:"A_aem",googEncodeUsagePercent:"A_eup",googFirsReceived:"A_fr",googFrameHeightInput:"A_fhi",googFrameHeightSent:"A_fhs",googFrameRateInput:"A_fri",googFrameRateSent:"A_frs",googFrameWidthInput:"A_fwi",googFrameWidthSent:"A_fws",googNacksReceived:"A_nr",googPlisReceived:"A_pr",googRtt:"A_rtt",aecDivergentFilterFraction:"A_adff",audioInputLevel:"A_ail",googEchoCancellationReturnLoss:"A_ecrl",googEchoCancellationReturnLossEnhancement:"A_ecrle",googResidualEchoLikelihood:"A_rel",googResidualEchoLikelihoodRecentMax:"A_relrm",googTargetDelayMs:"A_tdm",bytesReceived:"bytesReceived",packetsReceived:"packetsReceived",googDecodeMs:"A_dm",googMaxDecodeMs:"A_mdm",googRenderDelayMs:"A_rdm",googFrameWidthReceived:"A_fwr",googFrameHeightReceived:"A_fhr",googFrameRateReceived:"A_frr",googFrameRateDecoded:"A_frd",googFrameRateOutput:"A_fro",googJitterBufferMs:"A_jbm",googCurrentDelayMs:"A_cdm",googMinPlayoutDelayMs:"A_mpdm",googNacksSent:"A_ns",googPlisSent:"A_ps",googFirsSent:"A_fs",audioOutputLevel:"A_aol",googAccelerateRate:"A_ar",googDecodingCNG:"A_dcng",googDecodingCTN:"A_dctn",googDecodingCTSG:"A_dctsg",googDecodingNormal:"A_dn",googDecodingPLC:"A_dplc",googDecodingPLCCNG:"A_dplccng",googExpandRate:"A_er",googJitterReceived:"A_jr",googPreemptiveExpandRate:"A_per",googPreferredJitterBufferMs:"A_pjbm",googSecondaryDecodedRate:"A_sdr",googSpeechExpandRate:"A_ser",uplink_fraction_lost:"B_ufl",uplink_cumulative_lost:"B_ucl",uplink_available_bandwidth:"B_uab",period_fir:"B_fir",access_delay:"B_acd",uplink_network_quality:"B_unq",downlink_network_quality:"B_dnq",pub_audio_lost_ratio_400ms:"B_palr4",pub_video_lost_ratio_400ms:"B_pvlr4",e2e_delay:"B_ed",audio_delay:"B_ad",video_delay:"B_vd",stream_type:"B_st",e2e_audio_lost_ratio_400ms:"B_ealr4",e2e_video_lost_ratio_400ms:"B_evlr4",downlink_estimate_bandwidth:"B_deb"},Ge={};for(var Ve in qe){var He=qe[Ve];Ge[He]&&console.error("Key Conflict: ".concat(He,": ").concat(qe[He],"| ").concat(Ve)),Ge[He]=Ve}var ze=function(e){return qe[e]||e},We=function(e){return Ge[e]||e},Je=function t(n){var r=!1,i=function(e){return{_type:"control",_message:e}},c=function(e,t){var n={};return Object.keys(t).forEach((function(e){Object(o.getParameter)("STATS_FILTER")[e]||(n[ze(e)]=t[e])})),{_type:"subscribe_related_stats",_message:{stream_type:"high",stream_id:e,stats:n}}},g=function(e){return{_type:"publish",_message:e}},m=function(e,t){var n={};return Object.keys(t).forEach((function(e){Object(o.getParameter)("STATS_FILTER")[e]||(n[ze(e)]=t[e])})),{_type:"subscribe_stats",_message:{stream_id:e,stats:n}}},v=t.DISCONNECTED,_=t.CONNECTING,b=t.CONNECTED,E=t.DISCONNECTING,w=v,I=u();Object.defineProperty(I,"state",{set:function(e){var n=w;w=e,function(e,t){ke[e]=t}(I.clientId,e),n!==e&&I.dispatchEvent({type:"connection-state-change",prevState:t.connetionStateMap[n],curState:t.connetionStateMap[e]})},get:function(){return w}}),I.socket=void 0,I.state=v,I.mode=n.mode,I.role=n.role,I.codec=n.codec,I.config={},I.timers={},I.timer_counter={},I.localStreams={},I.remoteStreams={},I.remoteMuteState={},I.attemps=1,I.p2p_attemps=1,I.audioLevel={},I.activeSpeaker=void 0,I.reconnectMode="retry",I.rejoinAttempt=0,I.hasChangeBGPAddress=!1,I.traffic_stats={},I.clientId=n.clientId,I.pingpongCounter=0,I.hasInvokeLeave=!1,I.p2ps=new Map,I.liveStreams=new Map,I.injectLiveStreams=new Map,I.remoteStreamsInChannel=new Set,function(e){var t=Le;e.makeRequest=function(n,r,i){if(void 0===e.socket)return a.default.debug("[".concat(e.clientId,"] No socket available")),void t(i,S.default.INVALID_OPERATION);try{e.socket.emitRequest(n,(function(e,t){var n;"success"===e?"function"==typeof r&&r(t):"function"==typeof i&&(n=t&&t.error_code&&S.GatewayErrorCode[t.error_code]?S.GatewayErrorCode[t.error_code]:t&&t.error_str?t.error_str:t&&t.error_code?"UNKNOW_ERROR_".concat(t.error_code):e,i(n,t))}))}catch(r){a.default.debug("[".concat(e.clientId,"] Socket emit message failed ").concat(JSON.stringify(n))),a.default.debug("[".concat(e.clientId,"] "),r),t(i,S.default.SOCKET_ERROR)}},e.makeReport=function(t){void 0===e.socket&&a.default.debug("[".concat(e.clientId,"] No socket available"));try{e.socket.emitReport(t)}catch(n){a.default.debug("[".concat(e.clientId,"] Socket emit report failed ").concat(JSON.stringify(t)))}}}(I),I.inChannelInfo={joinAt:null,duration:0},I._sendMessage=function(e,t){switch(e){case"SubscribeStats":I.makeReport(m.apply(void 0,Ae()(t)))}};var T=Le;I.p2pCounter=Object($.random)(1e5),I.generateP2PId=function(){return++I.p2pCounter},I.audioVolumeIndication={enabled:!1,sortedAudioVolumes:[],smooth:3,interval:2e3},I.remoteVideoStreamTypes={REMOTE_VIDEO_STREAM_HIGH:0,REMOTE_VIDEO_STREAM_LOW:1,REMOTE_VIDEO_STREAM_MEDIUM:2},I.streamFallbackTypes={STREAM_FALLBACK_OPTION_DISABLED:0,STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:1,STREAM_FALLBACK_OPTION_AUDIO_ONLY:2},I.configPublisher=function(e){I.config=e},I.getGatewayInfo=function(e,t){I.makeRequest({_type:"gateway_info"},e,t)},I.setClientRole=function(e,t){a.default.debug("[".concat(I.clientId,"] setClientRole to ").concat(e));var n=s.b.reportApiInvoke(I.joinInfo.sid,{name:"_setClientRole",callback:t});I.makeRequest({_type:"set_client_role",_message:{role:e}},(function(){I.role=e,I.dispatchEvent({type:"client-role-changed",role:e}),n&&n(null,{role:e})}),(function(t,r){if(r&&r.code&&(t=S.GatewayErrorCode[r.code]||"UNKNOW_ERROR_"+r.code),"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE"===t)return n&&n(null);a.default.error("set Client role error to "+e+": "+t),n&&n(t)}))},I.join=function(e,t,r,i){e.useProxyServer&&(I.hasChangeBGPAddress=!0);var u=(new Date).getTime(),c=e.uid;if(I.inChannelInfo.joinAt&&(I.inChannelInfo.duration+=u-I.inChannelInfo.joinAt),I.inChannelInfo.joinAt=u,I.state!==_)return a.default.error("[".concat(I.clientId,"] GatewayClient.join Failed: state "),I.state),i&&i(S.default.INVALID_OPERATION),void s.b.joinGateway(e.sid,{lts:u,succ:!1,ec:S.default.INVALID_OPERATION,addr:null});if(null!=c&&parseInt(c)!==c)return a.default.error("[".concat(I.clientId,"] Input uid is invalid")),I.state=v,i&&i(S.default.INVALID_PARAMETER),void s.b.joinGateway(e.sid,{lts:u,succ:!1,ec:S.default.INVALID_PARAMETER,addr:null});var l=Ye.register(I,{uid:c,cname:e&&e.cname});if(l)return I.state=v,i&&i(l),void s.b.joinGateway(e.sid,{lts:u,succ:!1,ec:l,addr:null});I.joinInfo=y()({},e),I.uid=c,I.key=t,I.pingpongCounter=0,A(e,(function(t){if(I.state===E||I.state===v)return i&&i("LEAVE_BEFORE_JOIN_SUCCESS");var l,d,f;I.state=b,a.default.debug("[".concat(I.clientId,"] Connected to gateway server")),clearInterval(I.pingTimer),I.pingTimer=setInterval((function(){var e=Object(o.getParameter)("PING_PONG_TIME_OUT");if(++I.pingpongCounter>=e){var t=Date.now();I.socket&&a.default.warning("PINGPONG Timeout. Last Socket Message: ".concat(t-I.socket.getLastMsgTime(),"ms")),I.socket&&I.socket.getLastMsgTime()&&t-I.socket.getLastMsgTime()>Object(o.getParameter)("WEBSOCKET_TIMEOUT_MIN")&&(I.pingpongCounter=0,I.socket.close(),I.socket.dispatchEvent(p({type:"disconnect",event:{msg:"PING_PONG_TIME_OUT"}})))}var n=Date.now();I.makeRequest({_type:"ping"},(function(){I.pingpongCounter=0;var e=Date.now()-n;setTimeout((function(){Object(o.getParameter)("REPORT_STATS")&&I.makeRequest({_type:"ping_back",_message:{pingpongElapse:e}})}),1e3)}),(function(e,t){"TIMEOUT"!==e&&(a.default.error("Ping Error ".concat(e," ").concat(JSON.stringify(t))),t&&t.error_code&&I.socket&&I.socket.signal&&I.socket.signal.connection&&I.socket.signal.connection.readyState===WebSocket.OPEN&&(a.default.info("Disconnecting websocket connection"),I.socket.signal.connection.close()))}))}),3e3),I.makeRequest((l={role:I.role}.role,d=y()({},I.joinInfo.apResponse),f={session_id:I.joinInfo.sid,app_id:n.appId,channel_key:I.key,channel_name:I.joinInfo.cname,sdk_version:o.VERSION,browser:navigator.userAgent,process_id:Object(s.a)(),mode:I.mode,codec:I.codec,role:l,has_changed_gateway:Object(o.getParameter)("FORCE_CHANGED_GATEWAY_FLAG")||I.hasChangeBGPAddress,ap_response:d,extend:Object(o.getParameter)("JOIN_EXTEND"),details:{}},I.joinInfo.hasOwnProperty("stringUid")&&(f.string_uid=I.joinInfo.stringUid),I.joinInfo.aesmode&&I.joinInfo.aespassword&&(f.aes_mode=I.joinInfo.aesmode,f.aes_secret=I.joinInfo.aespassword),I.socket&&I.socket.signal&&I.socket.signal&&(d.addresses[I.socket.signal.hostIndex]&&(f.ap_response.ticket=d.addresses[I.socket.signal.hostIndex].ticket,delete d.addresses),I.joinInfo.turnServer&&"auto"===I.joinInfo.turnServer.mode&&I.socket.signal.turnConfig&&(I.joinInfo.turnServer.url=I.socket.signal.turnConfig.url,I.socket.signal.turnConfig.tcpport&&(I.joinInfo.turnServer.tcpport=""+I.socket.signal.turnConfig.tcpport),I.socket.signal.turnConfig.udpport&&(I.joinInfo.turnServer.udpport=""+I.socket.signal.turnConfig.udpport)),a.default.debug("Turn config",I.joinInfo.turnServer)),I.dispatchEvent({type:"join-message-hook",joinMessage:f},!0),{_type:"join",_message:f}),(function(t){s.b.joinGateway(e.sid,{lts:u,succ:!0,ec:null,vid:e.vid,addr:I.socket.getURL()}),I.rejoinAttempt=0,r&&r(t.uid),I.dispatchEvent({type:"join"}),clearInterval(I.timers.trafficStats),I.timers.trafficStats=setInterval((function(){I.makeRequest({_type:"traffic_stats"},(function(e){var t={};for(var n in e)t[We(n)]=e[n];if(t.peer_delay&&t.peer_delay.length){var r=[];t.peer_delay.forEach((function(e){var t={};for(var n in e)t[We(n)]=e[n];r.push(t)})),t.peer_delay=r}I.traffic_stats=t;var i=I.joinInfo.stringUid,o=I.localStreams[c]||I.localStreams[i];o&&(o.traffic_stats={access_delay:t.access_delay}),t.peer_delay&&t.peer_delay.forEach((function(e){var n=I.remoteStreams[e.peer_uid];n&&(n.traffic_stats={access_delay:t.access_delay,e2e_delay:e.e2e_delay,audio_delay:e.audio_delay,video_delay:e.video_delay})})),I.dispatchEvent({type:"after-getTrafficStats",trafficStats:t})}))}),3e3)}),(function(t,n){if(a.default.error("[".concat(I.clientId,"] User join failed [").concat(t,"]")),"ERR_JOIN_BY_MULTI_IP"===t){try{s.b.joinGateway(e.sid,{lts:u,succ:!1,ec:"ERR_JOIN_BY_MULTI_IP",addr:I.socket.getURL()})}catch(e){}return I.dispatchEvent({type:"onMultiIP",option:n.option},!0)}Fe[t]&&I.rejoinAttempt<4?I._doWithAction(Fe[t],r,i):i&&i(t),s.b.joinGateway(e.sid,{lts:u,succ:!1,ec:t,addr:I.socket.getURL()})}))}),(function(t){a.default.error("[".concat(I.clientId,"] User join failed [").concat(t,"]")),i&&i(t),s.b.joinGateway(e.sid,{lts:u,succ:!1,ec:t,addr:I.socket.getURL()})})),this.remoteMuteState={},I.resetAudioVolumeIndication()},I.leave=function(e,t){var n=Ye.unregister(I);switch(n&&a.default.debug("[".concat(I.clientId,"] "),n),I.state){case v:return a.default.debug("[".concat(I.clientId,"] Client Already in DISCONNECTED status")),void T(e);case E:return a.default.debug("[".concat(I.clientId,"] Client Already in DISCONNECTING status")),void T(t,S.default.INVALID_OPERATION);case _:return 1==I.reconnectingCS||(I.socket.close(),I.socket=void 0,a.default.info("[".concat(I.clientId,"] Client connecting, Leave channel success")),I.state=v),e&&e()}for(var r in I.state=E,I.channelMediaConfig&&(I.channelMediaRelayController&&I.channelMediaRelayController.dispose(),I.channelMediaConfig,I.channelMediaRelayController=null),clearInterval(I.pingTimer),I.timers)I.timers.hasOwnProperty(r)&&clearInterval(I.timers[r]);for(var r in I.inChannelInfo.joinAt&&(I.inChannelInfo.duration+=Date.now()-I.inChannelInfo.joinAt,I.inChannelInfo.joinAt=null),I.makeRequest({_type:"leave"},(function(t){I.socket.close(),I.socket=void 0,a.default.info("[".concat(I.clientId,"] Leave channel success")),I.state=v,e&&e(t)}),(function(e){"TIMEOUT"!==e&&(a.default.error("[".concat(I.clientId,"] Leave Channel Failed"),e),I.state=b,t&&t(e))})),I.localStreams)if(I.localStreams.hasOwnProperty(r)){var i=I.localStreams[r];delete I.localStreams[r],void 0!==i.pc&&(i.pc.close(),i.pc=void 0)}N()},I.publish=function(e,t,n,r){var u=(new Date).getTime(),c=!1;if(e.publishLTS=u,"object"!==ve()(e)||null===e)return a.default.error("[".concat(I.clientId,"] Invalid local stream")),r&&r(S.default.INVALID_LOCAL_STREAM),void s.b.publish(I.joinInfo.sid,{lts:u,succ:!1,audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:S.default.INVALID_LOCAL_STREAM});if(!e.stream&&void 0===e.url)return a.default.error("[".concat(I.clientId,"] Invalid local media stream")),r&&r(S.default.INVALID_LOCAL_STREAM),void s.b.publish(I.joinInfo.sid,{lts:u,succ:!1,audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:S.default.INVALID_LOCAL_STREAM});if(I.state!==b)return a.default.error("[".concat(I.clientId,"] User is not in the session")),r&&r(S.default.INVALID_OPERATION),void s.b.publish(I.joinInfo.sid,{lts:u,succ:!1,audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:S.default.INVALID_OPERATION});var l=e.getAttributes()||{};if(e.local&&void 0===I.localStreams[e.getId()]&&(e.hasAudio()||e.hasVideo()||e.hasScreen())){var p=I.generateP2PId();if(I.p2ps.set(p,e),e.p2pId=p,void 0!==e.url)L(g({state:"url",audio:e.hasAudio(),video:e.hasVideo(),attributes:e.getAttributes()},e.url),(function(t,n){"success"===t?(e.getUserId()!==n&&e.setUserId(n),I.localStreams[n]=e,e.onClose=function(){I.unpublish(e)}):a.default.error("[".concat(I.clientId,"] Publish local stream failed"),t)}));else{I.localStreams[e.getId()]=e,e.connectionSpec={callback:function(l){a.default.debug("[".concat(I.clientId,"] SDP exchange in publish : send offer --  "),JSON.parse(l)),I.makeRequest(g({state:"offer",stream_type:1==t.streamType?"low":"high",p2p_id:p,sdp:l,audio:e.audio||e.screenAudio,video:e.screen||e.video,screen:e.screen,attributes:e.getAttributes(),dtx:e.DTX,hq:e.highQuality,lq:e.lowQuality,stereo:e.stereo,speech:e.speech,codec:I.codec,extend:Object(o.getParameter)("PUB_EXTEND")}),(function(t){e.getUserId()!==t.uid&&e.setUserId(t.uid),a.default.info("[".concat(I.clientId,"] Local stream published with uid"),t.uid),e.onClose=function(){I.unpublish(e)},e._onAudioUnmute=function(){I.makeReport(i({action:"unmute_local_audio",stream_id:e.getId()}))},e._onVideoUnmute=function(){I.makeReport(i({action:"unmute_local_video",stream_id:e.getId()}))},e._onAudioMute=function(){I.makeReport(i({action:"mute_local_audio",stream_id:e.getId()}))},e._onVideoMute=function(){I.makeReport(i({action:"mute_local_video",stream_id:e.getId()}))},e.getId()===e.getUserId()&&(e.isAudioOn()||e.hasAudio()&&(a.default.debug("[".concat(I.clientId,"] local stream audio mute")),e._onAudioMute()),e.isVideoOn()||(e.hasVideo()||e.hasScreen())&&(a.default.debug("[".concat(I.clientId,"] local stream video mute")),e._onVideoMute())),e.pc.oniceconnectionstatechange=function(t){if("failed"===t){if(null!=I.timers[e.getId()]&&(clearInterval(I.timers[e.getId()]),clearInterval(I.timers[e.getId()]+"_RelatedStats")),a.default.error("[".concat(I.clientId,"] Publisher connection is lost -- streamId: ").concat(e.getId(),", p2pId: ").concat(p)),I.p2ps.delete(p),a.default.debug("[".concat(I.clientId,"] publish p2p failed: "),I.p2ps),!c)return c=!0,s.b.publish(I.joinInfo.sid,{lts:u,succ:!1,audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:S.default.PEERCONNECTION_FAILED}),I.dispatchEvent(d({type:"pubP2PLost",stream:e})),r&&r(S.default.PEERCONNECTION_FAILED);I.dispatchEvent(d({type:"pubP2PLost",stream:e}))}else if("connected"===t&&(a.default.debug("[".concat(I.clientId,"] publish p2p connected: "),I.p2ps),e._isAudioMuted()?I.makeReport(i({action:"mute_local_audio",stream_id:e.getId()})):I.makeReport(i({action:"unmute_local_audio",stream_id:e.getId()})),e._isVideoMuted()?I.makeReport(i({action:"mute_local_video",stream_id:e.getId()})):I.makeReport(i({action:"unmute_local_video",stream_id:e.getId()})),!c))return c=!0,s.b.publish(I.joinInfo.sid,{lts:u,succ:!0,audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:null}),n&&n()},a.default.debug("[".concat(I.clientId,"] SDP exchange in publish : receive answer --  "),JSON.parse(t.sdp)),e.pc.processSignalingMessage(t.sdp)}),(function(t,n){a.default.error("Publish Failed: ".concat(t)),s.b.publish(I.joinInfo.sid,{lts:u,succ:!0,audioName:e.hasAudio()&&e.audioName,videoName:e.hasVideo()&&e.videoName,screenName:e.hasScreen()&&e.screenName,ec:t}),"TIMEOUT"!=t&&(I.processPublishFailure(e),r&&r(t))}))},audio:e.hasAudio(),video:e.hasVideo(),screen:e.hasScreen(),isSubscriber:!1,stunServerUrl:I.stunServerUrl,turnServer:I.joinInfo.turnServer,maxAudioBW:l.maxAudioBW,minVideoBW:l.minVideoBW,maxVideoBW:l.maxVideoBW,mode:I.mode,codec:I.codec,isVideoMute:e.userMuteVideo||e.peerMuteVideo,isAudioMute:e.userMuteAudio||e.peerMuteAudio,maxFrameRate:e.attributes.maxFrameRate,clientId:I.clientId},e.pc=M(e.connectionSpec),e.pc.addStream(e.stream),a.default.debug("[".concat(I.clientId,"] PeerConnection add stream :"),e.stream),e.pc.onnegotiationneeded=function(n){var r={state:"negotiation",stream_type:1===t.streamType?"low":"high",p2p_id:p,sdp:n};I.makeRequest(g(r),(function(t){a.default.debug("Negotating Stream ".concat(e.getId())),e.pc.processSignalingMessage(t.sdp)}),(function(e,t){a.default.error("Negotiation failed ".concat(e),t,r)}))},clearInterval(I.timers[e.getId()]),I.timers[e.getId()]=setInterval((function(){if(Object(o.getParameter)("REPORT_STATS")){var t=0;e&&e.pc&&e.pc.getStats&&e.pc.getStatsRate((function(n){n.forEach((function(n){if(n&&n.id&&!/_recv$/.test(n.id)&&!/^time$/.test(n.id)&&e.getUserId()){if(-1===n.id.indexOf("outbound_rtp")&&-1===n.id.indexOf("OutboundRTP")||"video"!==n.mediaType||(n.googFrameWidthSent=e.videoWidth+"",n.googFrameHeightSent=e.videoHeight+""),"video"===n.mediaType)try{var r=e.stream.getVideoTracks()[0];n.A_vstd=r.enabled?"0":"1"}catch(e){}if("audio"===n.mediaType)try{var i=e.stream.getAudioTracks()[0];n.A_astd=i.enabled?"0":"1"}catch(e){}if(e.getId()==e.getUserId()){var s=200*t;t++,setTimeout((function(){var e=I.socket&&I.socket.getLastMsgTime()&&Date.now()-I.socket.getLastMsgTime();e>Object(o.getParameter)("REPORT_STATS_TIMEOUT")?a.default.debug("PublishStats report blocked by REPORT_STATS_TIMEOUT ".concat(e)):I.makeReport(function(e){var t={};return Object.keys(e).forEach((function(n){Object(o.getParameter)("STATS_FILTER")[n]||(t[ze(n)]=e[n])})),{_type:"publish_stats",_message:{stream_type:"high",stats:t}}}(n))}),s)}else s=200*t,t++,setTimeout((function(){var e=I.socket&&I.socket.getLastMsgTime()&&Date.now()-I.socket.getLastMsgTime();e>Object(o.getParameter)("REPORT_STATS_TIMEOUT")?a.default.debug("PublishStatsLow report blocked by REPORT_STATS_TIMEOUT ".concat(e)):I.makeReport(function(e){var t={};return Object.keys(e).forEach((function(n){Object(o.getParameter)("STATS_FILTER")[n]||(t[ze(n)]=e[n])})),{_type:"publish_stats",_message:{stream_type:"low",stats:t}}}(n))}),s)}}))}))}}),3e3);var f=function(){Object(o.getParameter)("REPORT_STATS")&&e&&e.pc&&e.pc.getVideoRelatedStats&&e.pc.getVideoRelatedStats((function(t){var n,r,i=I.socket&&I.socket.getLastMsgTime()&&Date.now()-I.socket.getLastMsgTime();i>Object(o.getParameter)("REPORT_STATS_TIMEOUT")?a.default.debug("PublishRelatedStats report blocked by REPORT_STATS_TIMEOUT ".concat(i)):e.getId()===e.getUserId()?I.makeReport((n=t,r={},Object.keys(n).forEach((function(e){Object(o.getParameter)("STATS_FILTER")[e]||(r[ze(e)]=n[e])})),{_type:"publish_related_stats",_message:{stream_type:"high",stats:r}})):I.makeReport(function(e){var t={};return Object.keys(e).forEach((function(n){Object(o.getParameter)("STATS_FILTER")[n]||(t[ze(n)]=e[n])})),{_type:"publish_related_stats",_message:{stream_type:"low",stats:t}}}(t))}))};f(),clearInterval(I.timers[e.getId()+"_RelatedStats"]),I.timers[e.getId()+"_RelatedStats"]=setInterval(f,1e3)}}},I.unpublish=function(e,t,n,r){if("object"!==ve()(e)||null===e)return a.default.error("[".concat(I.clientId,"] Invalid local stream")),void T(r,S.default.INVALID_LOCAL_STREAM);if(I.state!==b)return a.default.error("[".concat(I.clientId,"] User not in the session")),void T(r,S.default.INVALID_OPERATION);if(null!=I.timers[e.getId()]&&(clearInterval(I.timers[e.getId()]),clearInterval(I.timers[e.getId()+"_RelatedStats"])),void 0!==I.socket)if(e.local&&void 0!==I.localStreams[e.getId()]){delete I.localStreams[e.getId()];var i={stream_id:e.getUserId(),stream_type:1===t.streamType?"low":"high"};I.makeRequest({_type:"unpublish",_message:i}),(e.hasAudio()||e.hasVideo()||e.hasScreen())&&void 0===e.url&&void 0!==e.pc&&(e.pc.close(),e.pc=void 0),e.onClose=void 0,e._onAudioMute=void 0,e._onAudioUnute=void 0,e._onVideoMute=void 0,e._onVideoUnmute=void 0,I.p2ps.delete(e.p2pId),I.dispatchEvent({type:"stream-unpublished",stream:e,options:t}),n&&n()}else a.default.error("[".concat(I.clientId,"] Invalid local stream")),T(r,S.default.INVALID_LOCAL_STREAM);else a.default.error("[".concat(I.clientId,"] User not in the session")),T(r,S.default.INVALID_OPERATION)},I.subscribe=function(e,t,n){var r=(new Date).getTime();e.subscribeLTS=r;var u=!1;if(a.default.info("[".concat(I.clientId,"] Gatewayclient ").concat(I.uid," Subscribe ").concat(e.getId(),": ").concat(JSON.stringify(e.subscribeOptions))),"object"!==ve()(e)||null===e)return a.default.error("[".concat(I.clientId,"] Invalid remote stream")),n&&n(S.default.INVALID_REMOTE_STREAM),void s.b.subscribe(I.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:S.default.INVALID_REMOTE_STREAM});if(I.state!==b&&(a.default.error("[".concat(I.clientId,"] User is not in the session")),!u))return u=!0,s.b.subscribe(I.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:S.default.INVALID_OPERATION}),n&&n(S.default.INVALID_OPERATION);if(!e.local&&I.remoteStreams.hasOwnProperty(e.getId()))if(e.hasAudio()||e.hasVideo()||e.hasScreen()){var p=I.generateP2PId();I.p2ps.set(p,e),e.p2pId=p,e.pc=M({callback:function(t){a.default.debug("[".concat(I.clientId,"] SDP exchange in subscribe : send offer --  "),JSON.parse(t));var i={stream_id:e.getId(),audio:!e.subscribeOptions||e.subscribeOptions.audio,video:!e.subscribeOptions||e.subscribeOptions.video,codec:I.codec,p2p_id:p,sdp:t,tcc:Object(o.getParameter)("SUBSCRIBE_TCC"),extend:Object(o.getParameter)("SUB_EXTEND")};I.makeRequest({_type:"subscribe",_message:i},(function(t){a.default.debug("[".concat(I.clientId,"] SDP exchange in subscribe : receive answer --  "),JSON.parse(t.sdp)),e.pc.processSignalingMessage(t.sdp)}),(function(t,i){a.default.error("[".concat(I.clientId,"] Subscribe remote stream Failed: ").concat(t,", closing stream "),e.getId(),i),s.b.subscribe(I.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:t}),"TIMEOUT"!=t&&(I.processSubscribeFailure(e),n&&n(t))}))},nop2p:!0,audio:!0,video:!0,screen:e.hasScreen(),isSubscriber:!0,stunServerUrl:I.stunServerUrl,turnServer:I.joinInfo.turnServer,isVideoMute:e.userMuteVideo,isAudioMute:e.userMuteAudio,uid:e.getId(),clientId:I.clientId}),e.pc.onaddstream=function(t,n){if(e._onAudioUnmute=function(){I.makeReport(i({action:"unmute_remote_audio",stream_id:e.getId()}),(function(){}),(function(){}))},e._onAudioMute=function(){I.makeReport(i({action:"mute_remote_audio",stream_id:e.getId()}),(function(){}),(function(){}))},e._onVideoUnmute=function(){I.makeReport(i({action:"unmute_remote_video",stream_id:e.getId()}),(function(){}),(function(){}))},e._onVideoMute=function(){I.makeReport(i({action:"mute_remote_video",stream_id:e.getId()}),(function(){}),(function(){}))},"ontrack"===n&&"video"===t.track.kind||"onaddstream"===n){a.default.info("[".concat(I.clientId,"] Remote stream subscribed with uid "),e.getId());var r=I.remoteStreams[e.getId()];if(I.remoteStreams[e.getId()].stream="onaddstream"===n?t.stream:t.streams[0],I.remoteStreams[e.getId()].hasVideo()){if(Object(h.isFireFox)()||Object(h.isSafari)()){var o=I.remoteStreams[e.getId()].stream;Object($.vsResHack)(o,(function(t,n){e.videoWidth=t,e.videoHeight=n}),(function(e){return a.default.warning("[".concat(I.clientId,"] vsResHack failed: ")+e)}))}}else{var s=I.remoteStreams[e.getId()];s.peerMuteVideo=!0,I._adjustPCMuteStatus(s)}r&&r.isPlaying()&&r.elementID&&(a.default.debug("[".concat(I.clientId,"] Reload Player ").concat(r.elementID," StreamId ").concat(r.getId())),e.audioOutput=r.audioOutput,r.stop(),e.play(r.elementID,r.playOptions)),delete e.audioLevelHelper;var u=l({type:"stream-subscribed",stream:I.remoteStreams[e.getId()]});I.dispatchEvent(u)}},clearInterval(I.timers[e.getId()]),I.timers[e.getId()]=setInterval((function(){if(Object(o.getParameter)("REPORT_STATS")){var t=0;e&&e.pc&&e.pc.getStats&&e.pc.getStatsRate((function(n){n.forEach((function(n){if(n&&n.id){if(/_send$/.test(n.id)||/^time$/.test(n.id)||/^bweforvideo$/.test(n.id))return;-1===n.id.indexOf("inbound_rtp")&&-1===n.id.indexOf("inbound-rtp")||"video"!==n.mediaType||(n.googFrameWidthReceived=e.videoWidth+"",n.googFrameHeightReceived=e.videoHeight+"");var r=200*t;t++;var i=e.getId();setTimeout((function(){var e=I.socket&&I.socket.getLastMsgTime()&&Date.now()-I.socket.getLastMsgTime();e>Object(o.getParameter)("REPORT_STATS_TIMEOUT")?a.default.debug("SubscribeStats report blocked by REPORT_STATS_TIMEOUT ".concat(e)):I.makeReport(m(i,n))}),r)}}))}))}}),3e3),clearInterval(I.timers[e.getId()+"_RelatedStats"]),I.timers[e.getId()+"_RelatedStats"]=setInterval((function(){if(Object(o.getParameter)("REPORT_STATS")&&e&&e.pc){var t=I.socket&&I.socket.getLastMsgTime()&&Date.now()-I.socket.getLastMsgTime();if(t>Object(o.getParameter)("REPORT_STATS_TIMEOUT"))return void a.default.debug("SubscribeRelatedStats report blocked by REPORT_STATS_TIMEOUT ".concat(t));e.pc.getVideoRelatedStats&&e.pc.getVideoRelatedStats((function(t){I.makeReport(c(e.getId(),t))})),e.pc.getAudioRelatedStats&&e.pc.getAudioRelatedStats((function(t){I.makeReport(c(e.getId(),t))}))}}),1e3),I.audioLevel[e.getId()]=0,clearInterval(I.timers[e.getId()+"audio"]),I.timers[e.getId()+"audio"]=setInterval((function(){I.hasListeners("active-speaker")&&e&&e.pc&&"established"===e.pc.state&&e.pc.getStats&&e.pc.getStats((function(t){t.forEach((function(t){if("audio"===t.mediaType){if(t.audioOutputLevel>5e3)for(var n in I.audioLevel[e.getId()]<20&&(I.audioLevel[e.getId()]+=1),I.audioLevel)n!==""+e.getId()&&I.audioLevel[n]>0&&(I.audioLevel[n]-=1);var r=Object.keys(I.audioLevel).sort((function(e,t){return I.audioLevel[t]-I.audioLevel[e]}));if(I.activeSpeaker!==r[0]){var i=d({type:"active-speaker",uid:r[0]});I.dispatchEvent(i),I.activeSpeaker=r[0],a.default.debug("[".concat(I.clientId,"] Update active speaker: ").concat(I.activeSpeaker))}}}))}),50)}),50),e.pc.oniceconnectionstatechange=function(i){if("failed"===i)null!=I.timers[e.getId()]&&(clearInterval(I.timers[e.getId()]),clearInterval(I.timers[e.getId()]+"audio")),a.default.error("[".concat(I.clientId,"] Subscriber connection is lost -- streamId: ").concat(e.getId(),", p2pId: ").concat(p)),a.default.debug("[".concat(I.clientId,"] subscribe p2p failed: "),I.p2ps),u||(u=!0,n&&n(S.default.PEERCONNECTION_FAILED),s.b.subscribe(I.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:S.default.PEERCONNECTION_FAILED})),I.remoteStreams[e.getId()]&&I.p2ps.has(p)&&(I.p2ps.delete(p),I.dispatchEvent(d({type:"subP2PLost",stream:e})));else if("connected"===i&&(a.default.debug("[".concat(I.clientId,"] subscribe p2p connected: "),I.p2ps),!u)){u=!0,s.b.subscribe(I.joinInfo.sid,{lts:r,succ:!0,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:null}),I._adjustPCMuteStatus(e);var o=!1,c=!1,l=setInterval((function(){o&&c||(e.pc?e.pc.getStats((function(t){t.forEach((function(t){-1===t.id.indexOf("recv")&&-1===t.id.indexOf("inbound_rtp")&&-1===t.id.indexOf("inbound-rtp")&&-1===t.id.indexOf("InboundRTP")||"audio"===t.mediaType&&((t.googDecodingNormal>0||t.audioOutputLevel>0)&&(o||(o=!0,I.dispatchEvent({type:"first-audio-frame-decode",stream:e}),o&&c&&clearInterval(l),s.b.reportApiInvoke(I.joinInfo.sid,{name:"firstAudioDecode"})(null,{elapse:Date.now()-e.subscribeLTS}))),parseInt(t.packetsReceived)>0&&(c||(c=!0,I.dispatchEvent({type:"first-audio-packet-received",stream:e}),o&&c&&clearInterval(l),s.b.reportApiInvoke(I.joinInfo.sid,{name:"firstAudioReceived"})(null,{elapse:Date.now()-e.subscribeLTS}))))}))}),100):clearInterval(l))}),100),f=!1,h=!1,g=setInterval((function(){f&&h||(e.pc?e.pc.getStats((function(t){t.forEach((function(t){-1===t.id.indexOf("recv")&&-1===t.id.indexOf("inbound_rtp")&&-1===t.id.indexOf("inbound-rtp")&&-1===t.id.indexOf("InboundRTP")||"video"===t.mediaType&&((t.framesDecoded>0||t.googFramesDecoded>0)&&(f||(f=!0,I.dispatchEvent({type:"first-video-frame-decode",stream:e}),f&&h&&clearInterval(g),e.firstFrameTime=(new Date).getTime()-e.subscribeLTS,s.b.firstRemoteFrame(I.joinInfo.sid,{lts:(new Date).getTime(),peerid:e.getId(),succ:!0,width:+t.googFrameWidthReceived,height:+t.googFrameHeightReceived}))),t.packetsReceived>0&&(h||(h=!0,I.dispatchEvent({type:"first-video-packet-received",stream:e}),f&&h&&clearInterval(g),s.b.reportApiInvoke(I.joinInfo.sid,{name:"firstVideoReceived"})(null,{elapse:Date.now()-e.subscribeLTS}))))}))}),100):clearInterval(g))}),100);return e.sid=I.joinInfo.sid,t&&t()}}}else a.default.error("[".concat(I.clientId,"] Invalid remote stream")),u||(u=!0,n&&n(S.default.INVALID_REMOTE_STREAM),s.b.subscribe(I.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:S.default.INVALID_REMOTE_STREAM}));else a.default.error("[".concat(I.clientId,"] No such remote stream")),u||(u=!0,n&&n(S.default.NO_SUCH_REMOTE_STREAM),s.b.subscribe(I.joinInfo.sid,{lts:r,succ:!1,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:S.default.NO_SUCH_REMOTE_STREAM}))},I.subscribeChange=function(e,t,n){var r=Date.now();a.default.info("[".concat(I.clientId,"] Gatewayclient ").concat(I.uid," SubscribeChange ").concat(e.getId(),": ").concat(JSON.stringify(e.subscribeOptions))),I._adjustPCMuteStatus(e);var i={stream_id:e.getId(),audio:e.subscribeOptions.audio,video:e.subscribeOptions.video};I.makeRequest({_type:"subscribe_change",_message:i},(function(n){var i=l({type:"stream-subscribe-changed",stream:I.remoteStreams[e.getId()]});s.b.subscribe(I.joinInfo.sid,{lts:r,succ:!0,video:e.subscribeOptions&&e.subscribeOptions.video,audio:e.subscribeOptions&&e.subscribeOptions.audio,peerid:e.getId(),ec:null}),I.dispatchEvent(i),t&&t()}),(function(t,r){a.default.error("[".concat(I.clientId,"] Subscribe Change Failed ").concat(e.getId()),t,r),n&&n(t,r)}))},I.processPublishFailure=function(e){e.publishLTS=null,e.p2pId&&I.p2ps.get(e.p2pId)===e&&I.p2ps.delete(e.p2pId),I.localStreams[e.getUserId()]===e&&delete I.localStreams[e.getUserId()],I.localStreams[e.getId()]===e&&delete I.localStreams[e.getId()],e.pc&&(e.pc.processSignalingMessage=function(){},e.pc.oniceconnectionstatechange=function(){},e.pc.close(),delete e.pc),delete e.onClose,delete e._onAudioUnmute,delete e._onVideoUnmute,delete e._onAudioMute,delete e._onVideoMute,delete e._onAudioUnmute},I.processSubscribeFailure=function(e){e.p2pId&&I.p2ps.get(e.p2pId)===e&&I.p2ps.delete(e.p2pId),I.remoteStreams[e.getId()]===e&&delete I.remoteStreams[e.getId()],I.remoteStreams[e.getId()]===e&&delete I.remoteStreams[e.getId()],e.pc&&(e.pc.onaddstream=function(){},e.pc.processSignalingMessage=function(){},e.pc.oniceconnectionstatechange=function(){},e.pc.close(),delete e.pc),delete e.onClose,delete e._onAudioUnmute,delete e._onVideoUnmute,delete e._onAudioMute,delete e._onVideoMute,delete e._onAudioUnmute},I._adjustPCMuteStatus=function(e){!e.local&&e.pc&&e.pc.peerConnection.getReceivers&&e.pc.peerConnection.getReceivers().forEach((function(t){if(t&&t.track&&"audio"===t.track.kind){var n=!e.userMuteAudio&&!e.peerMuteAudio;e.subscribeOptions&&!e.subscribeOptions.audio&&(n=!1),t.track.enabled=!!n}else if(t&&t.track&&"video"===t.track.kind){var r=!e.userMuteVideo&&!e.peerMuteVideo;e.subscribeOptions&&!e.subscribeOptions.video&&(r=!1),t.track.enabled=!!r}}))},I.unsubscribe=function(e,t,n){if("object"!==ve()(e)||null===e)return a.default.error("[".concat(I.clientId,"] Invalid remote stream")),void T(n,S.default.INVALID_REMOTE_STREAM);if(I.state!==b)return a.default.error("[".concat(I.clientId,"] User is not in the session")),void T(n,S.default.INVALID_OPERATION);if(null!=I.timers[e.getId()]&&(clearInterval(I.timers[e.getId()]),clearInterval(I.timers[e.getId()]+"audio")),null!=I.audioLevel[e.getId()]&&delete I.audioLevel[e.getId()],null!=I.timer_counter[e.getId()]&&delete I.timer_counter[e.getId()],I.remoteStreams.hasOwnProperty(e.getId())){if(!I.socket)return a.default.error("[".concat(I.clientId,"] User is not in the session")),void T(n,S.default.INVALID_OPERATION);if(e.local)return a.default.error("[".concat(I.clientId,"] Invalid remote stream")),void T(n,S.default.INVALID_REMOTE_STREAM);e.close();var r={stream_id:e.getId()};I.makeRequest({_type:"unsubscribe",_message:r}),void 0!==e.pc&&(e.pc.close(),e.pc=void 0),e.onClose=void 0,e._onAudioMute=void 0,e._onAudioUnute=void 0,e._onVideoMute=void 0,e._onVideoUnmute=void 0,delete e.subscribeOptions,I.p2ps.delete(e.p2pId),a.default.info("[".concat(I.clientId,"] Unsubscribe stream success")),t&&t()}else T(n,S.default.NO_SUCH_REMOTE_STREAM)},I.setRemoteVideoStreamType=function(e,t){if(a.default.debug("[".concat(I.clientId,"] Switching remote video stream ").concat(e.getId()," to ").concat(t)),"object"===ve()(e)&&null!==e)if(I.state===b){if(!e.local){switch(t){case I.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_HIGH:case I.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_LOW:case I.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_MEDIUM:break;default:return}var n={stream_id:e.getId(),stream_type:t};I.makeRequest({_type:"switch_video_stream",_message:n},(function(){a.default.debug("SwitchVideoStream Success ".concat(n.stream_id," ").concat(n.stream_type))}),(function(e,t){a.default.error("SwitchVideoStream Error ".concat(e," ").concat(n.stream_id," ").concat(n.stream_type),t)}))}}else a.default.error("[".concat(I.clientId,"] User is not in the session"));else a.default.error("[".concat(I.clientId,"] Invalid remote stream"))},I.renewToken=function(e,t,n){e?I.key?I.state!==b?(a.default.debug("[".concat(I.clientId,"] Client is not connected. Trying to rejoin")),I.key=e,I.rejoin(),t&&t()):(a.default.debug("[".concat(I.clientId,"] renewToken from ").concat(I.key," to ").concat(e)),I.makeRequest({_type:"renew_token",_message:{token:e}},t,n)):(a.default.error("[".concat(I.clientId,"] Client is previously joined without token")),n&&n(S.default.INVALID_PARAMETER)):(a.default.error("[".concat(I.clientId,"] Invalid Token ").concat(e)),n&&n(S.default.INVALID_PARAMETER))},I.setStreamFallbackOption=function(e,t){if(a.default.debug("[".concat(I.clientId,"] Set stream fallback option ").concat(e.getId()," to ").concat(t)),"object"===ve()(e)&&null!==e)if(I.state===b){if(!e.local){switch(t){case I.streamFallbackTypes.STREAM_FALLBACK_OPTION_DISABLED:case I.streamFallbackTypes.STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:case I.streamFallbackTypes.STREAM_FALLBACK_OPTION_AUDIO_ONLY:break;default:return}var n={stream_id:e.getId(),fallback_type:t};I.makeRequest({_type:"set_fallback_option",_message:n},(function(){a.default.debug("SetStreamFallbackOption success ".concat(n.stream_id," ").concat(t))}),(function(e,r){a.default.error("Failed to SetStreamFallbackOption ".concat(n.stream_id," ").concat(t," ").concat(e),r)}))}}else a.default.error("[".concat(I.clientId,"] User is not in the session"));else a.default.error("[".concat(I.clientId,"] Invalid remote stream"))},I.enableAudioVolumeIndicator=function(e,t){I.audioVolumeIndication.enabled=!0,I.audioVolumeIndication.interval=e,I.audioVolumeIndication.smooth=t,I.resetAudioVolumeIndication()},I.resetAudioVolumeIndication=function(){if(clearInterval(I.timers.audioVolumeIndication),clearInterval(I.timers.audioVolumeSampling),I.audioVolumeIndication.enabled&&I.audioVolumeIndication.interval){var e=Math.floor(1e3*I.audioVolumeIndication.smooth/100);clearInterval(I.timers.audioVolumeSampling),I.timers.audioVolumeSampling=setInterval((function(){I.audioVolumeSampling||(I.audioVolumeSampling={});var t={};for(var n in I.remoteStreams){var r=I.remoteStreams[n];if(r.stream&&r.hasAudio()){var i=r.getAudioLevel();i>0&&i<1&&(i*=100);var o=I.audioVolumeSampling[n]||[];for(o.push(i);o.length>e;)o.shift();t[n]=o}}I.audioVolumeSampling=t}),100),clearInterval(I.timers.audioVolumeIndication),I.timers.audioVolumeIndication=setInterval((function(){if(I.socket&&I.socket.signal&&I.socket.signal.connection&&I.socket.signal.connection.readyState===WebSocket.OPEN){var e=[];for(var t in I.remoteStreams)if(I.audioVolumeSampling&&I.audioVolumeSampling[t]){var n=I.audioVolumeSampling[t],r=0;n.forEach((function(e){r+=e}));var i={uid:t,level:Math.floor(r/n.length)};i.level&&e.push(i)}var o=e.sort((function(e,t){return e.level-t.level}));a.default.debug("[".concat(I.clientId,"] volume-indicator "),JSON.stringify(o)),I.audioVolumeIndication.sortedAudioVolumes=o;var s=d({type:"volume-indicator",attr:o});I.dispatchEvent(s)}}),I.audioVolumeIndication.interval)}},I.closeGateway=function(){a.default.debug("[".concat(I.clientId,"] close gateway")),I.state=v,I.socket.close(),x()},I.startChannelMediaRelay=function(){var e=G()(F.a.mark((function e(t){var n,r,i,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!I.channelMediaRelayController){e.next=2;break}throw new we.ChannelMediaError("RELAY_ALREADY_START","",we.CHANNEL_MEDIA_RELAY_ERROR.RELAY_ALREADY_START);case 2:return n=function(e){I.dispatchEvent({type:"channel-media-relay-event",code:e})},r=function(e,t,n){e===we.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE&&t===we.CHANNEL_MEDIA_RELAY_ERROR.SERVER_CONNECTION_LOST&&(I.channelMediaRelayController.dispose(),I.channelMediaRelayController=null),I.dispatchEvent({type:"channel-media-relay-state",state:e,code:t,data:n})},I.channelMediaRelayController=new Ie.a(I.joinInfo,I.clientId),I.channelMediaRelayController.on("event",n),I.channelMediaRelayController.on("state",r),e.prev=7,e.next=10,I.channelMediaRelayController.startChannelMediaRelay(t);case 10:e.next=22;break;case 12:throw e.prev=12,e.t0=e.catch(7),a.default.debug("[".concat(I.clientId,"] startChannelMediaRelay exception: ").concat(JSON.stringify(e.t0))),i=we.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,"",o=e.t0 instanceof we.ChannelMediaError?"SetSourceChannelStatus"===e.t0.data||e.t0.data&&e.t0.data.serverResponse&&"SetSourceChannel"===e.t0.data.serverResponse.command?"FAILED_JOIN_SRC":"SetDestChannelStatus"===e.t0.data||e.t0.data&&e.t0.data.serverResponse&&"SetDestChannel"===e.t0.data.serverResponse.command?"FAILED_JOIN_DEST":e.t0.data&&e.t0.data.serverResponse&&"StartPacketTransfer"===e.t0.data.serverResponse.command?"FAILED_PACKET_SENT_TO_DEST":e.t0.message===we.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.t0.message===we.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.t0.message===we.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.t0.message===we.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":e.t0.message===we.CHANNEL_MEDIA_ERROR.AP_REQUEST_TIMEOUT?"NO_RESOURCE_AVAILABLE":e.t0.message===we.CHANNEL_MEDIA_ERROR.WS_ABORT||e.t0.message===we.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT?"OPERATION_ABORT":"INTERNAL_ERROR":"INTERNAL_ERROR",I.dispatchEvent({type:"channel-media-relay-state",state:i,code:we.CHANNEL_MEDIA_RELAY_ERROR[o]}),I.channelMediaRelayController&&(I.channelMediaRelayController.dispose(),I.channelMediaConfig=null,I.channelMediaRelayController=null),I.dispatchEvent({type:"channel-media-relay-state",state:we.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new we.ChannelMediaError(o,null,we.CHANNEL_MEDIA_RELAY_ERROR[o]);case 22:I.dispatchEvent({type:"channel-media-relay-state",state:we.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_RUNNING,code:we.CHANNEL_MEDIA_RELAY_ERROR.RELAY_OK}),I.channelMediaConfig=t;case 24:case"end":return e.stop()}}),e,this,[[7,12]])})));return function(t){return e.apply(this,arguments)}}(),I.updateChannelMediaRelay=function(){var t=G()(F.a.mark((function t(n){var r,i;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(I.channelMediaRelayController){t.next=2;break}throw new we.ChannelMediaError("RELAY_NOT_START",null,we.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);case 2:return t.prev=2,t.next=5,I.channelMediaRelayController.updateChannelMediaRelay(n);case 5:t.next=18;break;case 7:throw t.prev=7,t.t0=t.catch(2),a.default.debug("[".concat(I.clientId,"] updateChannelMediaRelay exception: ").concat(JSON.stringify(e))),r=we.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,"",i=e instanceof we.ChannelMediaError?e.message===we.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.message===we.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.message===we.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.message===we.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":e.message===we.CHANNEL_MEDIA_ERROR.WS_ABORT||e.message===we.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT?"OPERATION_ABORT":"INTERNAL_ERROR":"INTERNAL_ERROR",I.dispatchEvent({type:"channel-media-relay-event",code:we.CHANNEL_MEDIA_RELAY_EVENT.PACKET_UPDATE_DEST_CHANNEL_REFUSED}),I.dispatchEvent({type:"channel-media-relay-state",state:r,code:we.CHANNEL_MEDIA_RELAY_ERROR[i]}),I.channelMediaRelayController&&(I.channelMediaRelayController.dispose(),I.channelMediaConfig=null,I.channelMediaRelayController=null),I.dispatchEvent({type:"channel-media-relay-state",state:we.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new we.ChannelMediaError(i,null,we.CHANNEL_MEDIA_RELAY_ERROR[i]);case 18:I.channelMediaConfig=n;case 19:case"end":return t.stop()}}),t,this,[[2,7]])})));return function(e){return t.apply(this,arguments)}}(),I.stopChannelMediaRelay=G()(F.a.mark((function t(){var n,r;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(I.channelMediaRelayController){t.next=2;break}throw new we.ChannelMediaError("RELAY_NOT_START",null,we.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);case 2:return t.prev=2,t.next=5,I.channelMediaRelayController.stopChannelMediaRelay();case 5:t.next=17;break;case 7:throw t.prev=7,t.t0=t.catch(2),a.default.debug("[".concat(I.clientId,"] stopChannelMediaRelay exception: ").concat(JSON.stringify(e))),n=we.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,"",r=e instanceof we.ChannelMediaError?e.message===we.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.message===we.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.message===we.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.message===we.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":"INTERNAL_ERROR":"INTERNAL_ERROR",I.dispatchEvent({type:"channel-media-relay-state",state:n,code:we.CHANNEL_MEDIA_RELAY_ERROR[r]}),I.channelMediaRelayController&&(I.channelMediaRelayController.dispose(),I.channelMediaConfig=null,I.channelMediaRelayController=null),I.dispatchEvent({type:"channel-media-relay-state",state:we.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new we.ChannelMediaError(r,null,we.CHANNEL_MEDIA_RELAY_ERROR[r]);case 17:I.channelMediaConfig=null,I.channelMediaRelayController=null;case 19:case"end":return t.stop()}}),t,this,[[2,7]])})));var O=function(){a.default.debug("[".concat(I.clientId,"] Reconnect gateway")),I.state=v,I.socket.close(),x(),I.reconnectMode="recover",I.state=_,R()};I.recover=O;var x=function(){for(var e in I.dispatchEvent({type:"before-clear-connection"}),I.timers)I.timers.hasOwnProperty(e)&&clearInterval(I.timers[e]);for(var e in I.remoteStreams)if(I.remoteStreams.hasOwnProperty(e)){var t=I.remoteStreams[e],n=d({type:"stream-removed",uid:t.getId(),stream:t});I.dispatchEvent(n)}I.p2ps.clear(),N(),C(),clearInterval(I.pingTimer)};I.rejoin=function(){I.socket&&(clearInterval(I.pingTimer),I.socket.close(),I.socket=void 0),I.state=_,R()};var R=function(e,t){I.dispatchEvent(d({type:"rejoin-start"})),e=e||function(e){a.default.info("[".concat(I.clientId,"] User ").concat(e," is re-joined to ").concat(I.joinInfo.cname)),I.dispatchEvent(d({type:"rejoin"})),I.channelMediaConfig&&I.startChannelMediaRelay(I.channelMediaConfig).then((function(){a.default.debug("[".concat(I.clientId,"] restartChannelMediaRelay success"))})).catch((function(e){a.default.debug("[".concat(I.clientId,"] restartChannelMediaRelay failed: ").concat(JSON.stringify(e)))})),I.liveStreams&&I.liveStreams.size&&I.liveStreams.forEach((function(e,t){e&&I.setLiveTranscoding(I.transcoding),I.startLiveStreaming(t,e)})),I.injectLiveStreams&&I.injectLiveStreams.size&&I.injectLiveStreams.forEach((function(e,t){I.addInjectStreamUrl(t,e)}))},t=t||function(e){a.default.error("[".concat(I.clientId,"] Re-join to channel failed "),e),I.dispatchEvent(l({type:"error",reason:e}))},I.key?(++I.rejoinAttempt,I.join(I.joinInfo,I.key,e,t)):a.default.error("[".concat(I.clientId,"] Connection recover failed [Invalid channel key]"))},A=function(e,t,n){if(I.onConnect=t,I.socket){if(I.dispatchEvent({type:"reconnect"}),"retry"===I.reconnectMode)a.default.debug("[".concat(I.clientId,"] Retry current gateway")),I.socket.reconnect();else if("tryNext"===I.reconnectMode)a.default.debug("[".concat(I.clientId,"] Try next gateway")),I.socket.connectNext();else if("recover"===I.reconnectMode){a.default.debug("[".concat(I.clientId,"] Recover gateway")),a.default.debug("[".concat(I.clientId,"] Try to reconnect choose server and get gateway list again ")),I.reconnectingCS=!0;var i=I.joinInfo&&I.joinInfo.sid;Ue(I.joinInfo,(function(e){a.default.debug("[".concat(I.clientId,"] session:  ").concat(i," get gateway list success")),I.joinInfo.apResponse=e.res,I.reconnectingCS?I.socket.replaceHost(e.gateway_addr):a.default.debug("[".concat(I.clientId,"] session:  ").concat(i," already leave"))}))}}else u=e.gatewayAddr,I.socket=Ne(u,{sid:I.joinInfo.sid,clientId:I.clientId}),I.socket.on("start-connection",(function(e){I.ticket=e&&e.msg&&e.msg.ticket})),I.socket.on("on_uplink_stats",(function(e){var t={};for(var n in e)t[We(n)]=e[n];if(I.OutgoingAvailableBandwidth=t.uplink_available_bandwidth,I.localStreams[I.uid]){var r=I.localStreams[I.uid].uplinkStats;r&&r.period_fir===t.period_fir||a.default.debug("[".concat(I.clientId,"]: Period fir change to: ").concat(t.period_fir)),I.localStreams[I.uid].uplinkStats=t}})),I.socket.on("connect",(function(){I.dispatchEvent({type:"connected"}),I.attemps=1,I.onConnect()})),I.socket.on("recover",(function(){I.state=_,a.default.debug("[".concat(I.clientId,"] Try to reconnect choose server and get gateway list again ")),I.reconnectingCS=!0;var e=I.joinInfo&&I.joinInfo.sid;Ue(I.joinInfo,(function(t){a.default.debug("[".concat(I.clientId,"] session:  ").concat(e," get gateway list success")),I.reconnectingCS?I.socket.replaceHost(t.gateway_addr):a.default.debug("[".concat(I.clientId,"] session:  ").concat(e," already leave"))}))})),I.socket.on("disconnect",(function(e){if(a.default.debug("[".concat(I.clientId,"] Receive disconnect message")),I.state!==v){I.state=v;var t=l({type:"error",reason:S.default.SOCKET_DISCONNECTED});try{I.dispatchEvent(t,!0)}catch(e){a.default.debug("[".concat(I.clientId,"] Error in SOCKET_DISCONNECTED event"),e)}if(0===I.p2ps.size?I.reconnectMode="tryNext":I.reconnectMode="retry",x(),I.channelMediaRelayController&&I.channelMediaRelayController.dispose(),I.channelMediaRelayController=null,1!=r){var n,i=(n=I.attemps,1e3*Math.min(30,Math.pow(2,n)-1));if(a.default.error("[".concat(I.clientId,"] Disconnect from server [").concat(JSON.stringify(e),"], attempt to recover [#").concat(I.attemps,"] after ").concat(i/1e3," seconds")),I.hasInvokeLeave)return a.default.debug("[".concat(I.clientId,"] No reconnection because Client.leave has been invoked")),void(I.hasInvokeLeave=!1);setTimeout((function(){I.attemps++,I.state=_,I.inChannelInfo&&Date.now()-I.inChannelInfo.joinAt>Object(o.getParameter)("TICKET_RENEW_TIMEOUT")?(a.default.debug("Recovering to renew ticket"),O()):R()}),i)}}})),I.socket.on("on_add_audio_stream",(function(e){if(a.default.info("[".concat(I.clientId,"] Newly added audio stream with uid ").concat(e.uid)),I.joinInfo.stringUid&&"string"!=typeof e.uid&&a.default.error("StringUID is Mixed with UintUID"),I.remoteStreamsInChannel.has(e.uid)||I.remoteStreamsInChannel.add(e.uid),void 0===I.remoteStreams[e.uid]){var t=Se({streamID:e.uid,local:!1,audio:e.audio,video:e.video});t.peerMuteVideo=!0,I.remoteStreams[e.uid]=t;var n=l({type:"stream-added",stream:t});I.dispatchEvent(n);var r=I.remoteMuteState[e.uid];r&&r.audio&&(n=d({type:"mute-audio",uid:e.uid}),I.dispatchEvent(n)),r&&r.video&&(n=d({type:"mute-video",uid:e.uid}),I.dispatchEvent(n))}s.b.reportApiInvoke(I.joinInfo.sid,{name:"on_add_audio_stream"})()})),I.socket.on("on_update_stream",(function(e){var t=I.remoteStreams[e.uid];if(I.joinInfo.stringUid&&"string"!=typeof e.uid&&a.default.error("StringUID is Mixed with UintUID"),t){t.audio=e.audio,t.video=e.video,t.screen=e.screen,t.pc&&I._adjustPCMuteStatus(t);var n=l({type:"stream-updated",stream:t});I.dispatchEvent(n)}else a.default.debug("[".concat(I.clientId,"] Ignoring onUpdateStream event before onAddStream for uid ").concat(e.uid))})),I.socket.on("on_add_video_stream",(function(e){if(a.default.info("[".concat(I.clientId,"] Newly added remote stream with uid ").concat(e.uid,".")),I.joinInfo.stringUid&&"string"!=typeof e.uid&&a.default.error("StringUID is Mixed with UintUID"),I.remoteStreamsInChannel.has(e.uid)||I.remoteStreamsInChannel.add(e.uid),void 0===I.remoteStreams[e.uid]){var t=Se({streamID:e.uid,local:!1,audio:e.audio,video:e.video});I.remoteStreams[e.uid]=t;var n=l({type:"stream-added",stream:t});I.dispatchEvent(n);var r=I.remoteMuteState[e.uid];r&&r.audio&&(n=d({type:"mute-audio",uid:e.uid}),I.dispatchEvent(n)),r&&r.video&&(n=d({type:"mute-video",uid:e.uid}),I.dispatchEvent(n))}else{var i=I.remoteStreams[e.uid];if(void 0!==i.stream){if((t=I.remoteStreams[e.uid]).video=!0,t.peerMuteVideo=!1,t.pc&&I._adjustPCMuteStatus(t),a.default.info("[".concat(I.clientId,"] Stream changed: enable video ").concat(e.uid)),t.isPlaying()){var o=t.player.elementID;t.stop(),t.play(o,t.playOptions)}}else i.p2pId?I.remoteStreams[e.uid].video=!0:(t=Se({streamID:e.uid,local:!1,audio:!0,video:!0}),I.remoteStreams[e.uid]=t,a.default.info("[".concat(I.clientId,"] Stream changed: modify video ").concat(e.uid)))}s.b.reportApiInvoke(I.joinInfo.sid,{name:"on_add_video_stream"})()})),I.socket.on("on_remove_stream",(function(e){I.remoteStreamsInChannel.has(e.uid)&&I.remoteStreamsInChannel.delete(e.uid);var t=I.remoteStreams[e.uid];if(t){delete I.remoteStreams[e.uid],delete I.remoteMuteState[e.uid];var n=l({type:"stream-removed",stream:t});I.dispatchEvent(n),t.close(),void 0!==t.pc&&(t.pc.close(),t.pc=void 0,I.p2ps.delete(t.p2pId)),s.b.reportApiInvoke(I.joinInfo.sid,{name:"on_remove_stream"})()}else a.default.error("ERROR stream ",e.uid," not found onRemoveStream ",e)})),I.socket.on("on_publish_stream",(function(e){var t=I.localStreams[e.uid],n=l({type:"streamPublished",stream:t});I.dispatchEvent(n)})),I.socket.on("mute_audio",(function(e){a.default.info("[".concat(I.clientId,"] rcv peer mute audio: ").concat(e.uid)),I.remoteMuteState[e.uid]=I.remoteMuteState[e.uid]||{audio:!1,video:!1},I.remoteMuteState[e.uid].audio=!0;var t=d({type:"mute-audio",uid:e.uid}),n=I.remoteStreams[e.uid];n?(n.peerMuteAudio=!0,n.pc&&I._adjustPCMuteStatus(n),I.dispatchEvent(t)):a.default.debug("Ignoring event ".concat(e.type),e)})),I.socket.on("unmute_audio",(function(e){a.default.info("[".concat(I.clientId,"] rcv peer unmute audio: ").concat(e.uid)),I.remoteMuteState[e.uid]=I.remoteMuteState[e.uid]||{audio:!1,video:!1},I.remoteMuteState[e.uid].audio=!1;var t=d({type:"unmute-audio",uid:e.uid}),n=I.remoteStreams[e.uid];n?(n.peerMuteAudio=!1,n.pc&&I._adjustPCMuteStatus(n),I.dispatchEvent(t)):a.default.debug("Ignoring event ".concat(e.type),e)})),I.socket.on("mute_video",(function(e){a.default.info("[".concat(I.clientId,"] rcv peer mute video: ").concat(e.uid)),I.remoteMuteState[e.uid]=I.remoteMuteState[e.uid]||{audio:!1,video:!1},I.remoteMuteState[e.uid].video=!0;var t=d({type:"mute-video",uid:e.uid}),n=I.remoteStreams[e.uid];n?(n.peerMuteVideo=!0,n.pc&&I._adjustPCMuteStatus(n),I.dispatchEvent(t)):a.default.debug("Ignoring event ".concat(e.type),e)})),I.socket.on("unmute_video",(function(e){a.default.info("[".concat(I.clientId,"] rcv peer unmute video: ").concat(e.uid)),I.remoteMuteState[e.uid]=I.remoteMuteState[e.uid]||{audio:!1,video:!1},I.remoteMuteState[e.uid].video=!1;var t=d({type:"unmute-video",uid:e.uid}),n=I.remoteStreams[e.uid];n?(n.peerMuteVideo=!1,n.pc&&I._adjustPCMuteStatus(n),I.dispatchEvent(t)):a.default.debug("Ignoring event ".concat(e.type),e)})),I.socket.on("on_crypt_error",(function(e){a.default.warning("[".concat(I.clientId,"] stream crypt error"));var t=d({type:"crypt-error",cryptType:e.crypt_type});I.dispatchEvent(t)})),I.socket.on("on_user_banned",(function(e){a.default.info("[".concat(I.clientId,"] user banned uid: ").concat(e.uid," error: ").concat(e.error_code));var t=d({type:"client-banned",uid:e.uid,attr:e.error_code});I.dispatchEvent(t),r=!0})),I.socket.on("on_stream_fallback_update",(function(e){a.default.info("[".concat(I.clientId,"] stream fallback peerId: ").concat(e.stream_id," type: ").concat(e.stream_type));var t=d({type:"stream-fallback",uid:e.stream_id,stream:e.stream_id,attr:e.stream_type});I.dispatchEvent(t)})),I.socket.on("stream_recover",(function(e){a.default.info("[".concat(I.clientId,"] stream recover uid: ").concat(e.id," peerId: ").concat(e.peerid," type: ").concat(e.type));var t=d({type:"stream-recover",uid:e.id,stream:e.peerid,attr:e.type});I.dispatchEvent(t)})),I.socket.on("on_p2p_lost",(function(e){a.default.debug("[".concat(I.clientId,"] p2plost: "),e,"p2ps:",I.p2ps);var t,n="DTLS failed";(t=I.localStreams[e.uid]||I.remoteStreams[e.uid])?(t.pc&&t.pc.offerCandidates&&0===t.pc.offerCandidates.length&&(n="NO_CANDIDATES_IN_OFFER"),"publish"===e.event&&s.b.publish(I.joinInfo.sid,{lts:t.publishLTS,succ:!1,audioName:t.hasAudio()&&t.audioName,videoName:t.hasVideo()&&t.videoName,screenName:t.hasScreen()&&t.screenName,ec:n}),"subscribe"===e.event&&s.b.subscribe(I.joinInfo.sid,{lts:t.subscribeLTS,succ:!1,video:t.subscribeOptions&&t.subscribeOptions.video,audio:t.subscribeOptions&&t.subscribeOptions.audio,peerid:e.uid+"",ec:n})):a.default.warning("P2PLost Stream Not found",e),a.default.debug("[".concat(I.clientId,"] p2plost:"),e.p2pid),(t=I.p2ps.get(e.p2pid))&&(I.p2ps.delete(e.p2pid),t.local?I.dispatchEvent(d({type:"pubP2PLost",stream:t,attr:n})):I.remoteStreams[t.getId()]&&I.dispatchEvent(d({type:"subP2PLost",stream:t,attr:n})))})),I.socket.on("on_token_privilege_will_expire",(function(e){a.default.debug("[".concat(I.clientId,"] Received Message onTokenPrivilegeWillExpire")),I.dispatchEvent(d({type:"onTokenPrivilegeWillExpire"}))})),I.socket.on("on_token_privilege_did_expire",(function(){a.default.warning("[".concat(I.clientId,"] Received Message onTokenPrivilegeDidExpire, please get new token and join again")),I.closeGateway(),I.dispatchEvent(d({type:"onTokenPrivilegeDidExpire"}))})),I.socket.on("enable_local_video",(function(e){I.dispatchEvent(d({type:"enable-local-video",uid:e.uid}))})),I.socket.on("disable_local_video",(function(e){I.dispatchEvent(d({type:"disable-local-video",uid:e.uid}))})),I._doWithAction=function(e,t,n){"tryNext"===e?function(e,t){a.default.debug("[".concat(I.clientId,"] Connect next gateway")),I.state=v,I.socket.close(),x(),I.reconnectMode="tryNext",R(e,t)}(t,n):"retry"===e?function(e,t){a.default.debug("[".concat(I.clientId,"] Reconnect gateway")),I.state=v,I.socket.close(),x(),I.reconnectMode="retry",R(e,t)}(t,n):"quit"===e?(a.default.debug("[".concat(I.clientId,"] quit gateway")),I.state=v,I.socket.close(),x()):"recover"===e&&O()},I.socket.on("on_notification",(function(e){if(a.default.debug("[".concat(I.clientId,"] Receive notification: "),e),"ERR_JOIN_BY_MULTI_IP"===S.GatewayErrorCode[e.code])return I.dispatchEvent({type:"onMultiIP",option:e.option});e.detail?I._doWithAction(Fe[S.GatewayErrorCode[e.code]]):e.action&&I._doWithAction(e.action)})),I.socket.on("on_user_offline",(function(e){var t=d({type:"peer-leave",uid:e.uid});if(I.remoteStreamsInChannel.has(e.uid)&&I.remoteStreamsInChannel.delete(e.uid),I.remoteStreams.hasOwnProperty(e.uid)&&(t.stream=I.remoteStreams[e.uid]),t.reason=e.reason,I.dispatchEvent(t),I.remoteStreams.hasOwnProperty(e.uid)){a.default.info("[".concat(I.clientId,"] closing stream on peer leave"),e.uid);var n=I.remoteStreams[e.uid];n.close(),delete I.remoteStreams[e.uid],void 0!==n.pc&&(n.pc.close(),n.pc=void 0,I.p2ps.delete(n.p2pId))}I.timers.hasOwnProperty(e.uid)&&(clearInterval(I.timers[e.uid]),clearInterval(I.timers[e.uid]+"_RelatedStats"),delete I.timers[e.uid]),null!=I.audioLevel[e.uid]&&delete I.audioLevel[e.uid],null!=I.timer_counter[e.uid]&&delete I.timer_counter[e.uid]})),I.socket.on("onUplinkStats",(function(e){})),I.socket.on("liveStreamingStarted",(function(e){var t=f({type:"liveStreamingStarted",url:e.url});I.dispatchEvent(t)})),I.socket.on("liveStreamingFailed",(function(e){var t=f({type:"liveStreamingFailed",url:e.url});I.dispatchEvent(t)})),I.socket.on("liveStreamingStopped",(function(e){var t=f({type:"liveStreamingStopped",url:e.url});I.dispatchEvent(t)})),I.socket.on("liveTranscodingUpdated",(function(e){var t=f({type:"liveTranscodingUpdated",reason:e.reason});I.dispatchEvent(t)})),I.socket.on("streamInjectedStatus",(function(e){var t=f({type:"streamInjectedStatus",url:e.url,uid:e.uid,status:e.status});I.dispatchEvent(t)})),I.socket.on("on_user_online",(function(e){I.joinInfo.stringUid&&"string"!=typeof e.uid&&a.default.error("StringUID is Mixed with UintUID"),I.dispatchEvent({type:"peer-online",uid:e.uid})}));var u},L=function(e,t){if(void 0!==I.socket)try{I.socket.emitSimpleMessage(e,(function(e,n){t&&t(e,n)}))}catch(e){a.default.error("[".concat(I.clientId,"] Error in sendSimpleSdp [").concat(e,"]"))}else a.default.error("[".concat(I.clientId,"] Error in sendSimpleSdp [socket not ready]"))},C=function(){for(var e in I.localStreams)if(void 0!==I.localStreams[e]){var t=I.localStreams[e];delete I.localStreams[e],void 0!==t.pc&&(t.pc.close(),t.pc=void 0)}},N=function(){for(var e in I.remoteStreamsInChannel.clear(),I.remoteStreams)if(I.remoteStreams.hasOwnProperty(e)){var t=I.remoteStreams[e];t.isPlaying()&&t.stop(),t.close(),delete I.remoteStreams[e],void 0!==t.pc&&(t.pc.close(),t.pc=void 0)}};return I},Ye={_gatewayClients:{},register:function(e,t){if(!t.uid){var n="NO_UID_PROVIDED";return a.default.error("[".concat(e.clientId,"] "),n,t),n}if(t.cname)return this._gatewayClients[t.cname]&&this._gatewayClients[t.cname][t.uid]&&this._gatewayClients[t.cname][t.uid]!==e?(n="UID_CONFLICT",a.default.error("[".concat(e.clientId,"] "),n,t),n):(a.default.debug("[".concat(e.clientId,"] register client Channel"),t.cname,"Uid",t.uid),this._gatewayClients[t.cname]||(this._gatewayClients[t.cname]={}),this._gatewayClients[t.cname][t.uid]=e,null);n="NO_CHANNEL_PROVIDED";return a.default.error("[".concat(e.clientId,"] "),n,t),n},unregister:function(e){var t=e&&e.uid,n=e.joinInfo&&e.joinInfo.cname;if(!t||!n){var r="INVALID_GATEWAYCLIENT";return a.default.error("[".concat(e.clientId,"] "),r),r}if(this._gatewayClients[n]&&this._gatewayClients[n][t])return this._gatewayClients[n][t]!==e?(r="GATEWAYCLIENT_UID_CONFLICT",a.default.error("[".concat(e.clientId,"] "),r),r):(a.default.debug("[".concat(e.clientId,"] unregister client "),e.uid),delete this._gatewayClients[n][t],null);r="GATEWEAY_CLIENT_UNREGISTERED";a.default.error("[".concat(e.clientId,"] "),r)}};Je.DISCONNECTED=0,Je.CONNECTING=1,Je.CONNECTED=2,Je.DISCONNECTING=3,Je.connetionStateMap={0:"DISCONNECTED",1:"CONNECTING",2:"CONNECTED",3:"DISCONNECTING"};var Ke=Je,Xe=function(e){var t;switch(e){case"120p":case"120p_1":t=["120p_1","120p_1","120p_1"];break;case"120p_3":t=["120p_3","120p_3","120p_3"];break;case"180p":case"180p_1":t=["90p_1","90p_1","180p_1"];break;case"180p_3":t=["120p_3","120p_3","180p_3"];break;case"180p_4":t=["120p_1","120p_1","180p_4"];break;case"240p":case"240p_1":t=["120p_1","120p_1","240p_1"];break;case"240p_3":t=["120p_3","120p_3","240p_3"];break;case"240p_4":t=["120p_4","120p_4","240p_4"];break;case"360p":case"360p_1":case"360p_4":case"360p_9":case"360p_10":case"360p_11":t=["90p_1","90p_1","360p_1"];break;case"360p_3":case"360p_6":t=["120p_3","120p_3","360p_3"];break;case"360p_7":case"360p_8":t=["120p_1","120p_1","360p_7"];break;case"480p":case"480p_1":case"480p_2":case"480p_4":case"480p_10":t=["120p_1","120p_1","480p_1"];break;case"480p_3":case"480p_6":t=["120p_3","120p_3","480p_3"];break;case"480p_8":case"480p_9":t=["120p_4","120p_4","480p_8"];break;case"720p":case"720p_1":case"720p_2":case"720p_3":t=["90p_1","90p_1","720p_1"];break;case"720p_5":case"720p_6":t=["120p_1","120p_1","720p_5"];break;case"1080p":case"1080p_1":case"1080p_2":case"1080p_3":case"1080p_5":t=["90p_1","90p_1","1080p_1"];break;case"1440p":case"1440p_1":case"1440p_2":t=["90p_1","90p_1","1440p_1"];break;case"4k":case"4k_1":case"4k_3":t=["90p_1","90p_1","4k_1"];break;default:t=["120p_1","120p_1","360p_7"]}return Object(h.isOpera)()?[e,15,50]:Object(h.isFireFox)()?[t[1],15,100]:Object(h.isSafari)()?[t[2],15,50]:[t[0],15,50]},Ze={1001:"FRAMERATE_INPUT_TOO_LOW",1002:"FRAMERATE_SENT_TOO_LOW",1003:"SEND_VIDEO_BITRATE_TOO_LOW",1005:"RECV_VIDEO_DECODE_FAILED",2001:"AUDIO_INPUT_LEVEL_TOO_LOW",2002:"AUDIO_OUTPUT_LEVEL_TOO_LOW",2003:"SEND_AUDIO_BITRATE_TOO_LOW",2005:"RECV_AUDIO_DECODE_FAILED",3001:"FRAMERATE_INPUT_TOO_LOW_RECOVER",3002:"FRAMERATE_SENT_TOO_LOW_RECOVER",3003:"SEND_VIDEO_BITRATE_TOO_LOW_RECOVER",3005:"RECV_VIDEO_DECODE_FAILED_RECOVER",4001:"AUDIO_INPUT_LEVEL_TOO_LOW_RECOVER",4002:"AUDIO_OUTPUT_LEVEL_TOO_LOW_RECOVER",4003:"SEND_AUDIO_BITRATE_TOO_LOW_RECOVER",4005:"RECV_AUDIO_DECODE_FAILED_RECOVER"},Qe={FramerateInput:1001,FramerateSent:1002,SendVideoBitrate:1003,VideoDecode:1005,AudioIntputLevel:2001,AudioOutputLevel:2002,SendAudioBitrate:2003,AudioDecode:2005},et=function(e){var t={remoteStreamStorage:{},localStreamStorage:{}};return t.gatewayClient=e,t.checkAudioOutputLevel=function(e){return!(e&&parseInt(e.audioRecvBytesDelta)>0&&parseInt(e.audioDecodingNormalDelta)>0&&0===parseInt(e.audioOutputLevel))},t.checkAudioIntputLevel=function(e){return!e||0!==parseInt(e.audioInputLevel)},t.checkFramerateInput=function(e,t){if(!e||!t.attributes)return!0;var n=parseInt(t.attributes.maxFrameRate),r=parseInt(e.googFrameRateInput);return!n||!r||!(n>10&&r<5||n<10&&n>=5&&r<=1)},t.checkFramerateSent=function(e){return!(e&&parseInt(e.googFrameRateInput)>5&&parseInt(e.googFrameRateSent)<=1)},t.checkSendVideoBitrate=function(e){return!e||0!==parseInt(e.videoSendBytesDelta)},t.checkSendAudioBitrate=function(e){return!e||0!==parseInt(e.audioSendBytesDelta)},t.checkVideoDecode=function(e){return!e||0===parseInt(e.videoRecvBytesDelta)||0!==parseInt(e.googFrameRateDecoded)},t.checkAudioDecode=function(e){return!e||0===parseInt(e.audioRecvBytesDelta)||0!==parseInt(e.audioDecodingNormalDelta)},t.record=function(e,n,r,i,o){r[e]||(r[e]={isPrevNormal:!0,record:[]});var a=r[e],s=t["check"+e](n,o);if(a.record.push(s),a.record.length>=5){a.isCurNormal=-1!==a.record.indexOf(!0);var u=Qe[e];a.isPrevNormal&&!a.isCurNormal&&t.gatewayClient.dispatchEvent({type:"exception",code:u,msg:Ze[u],uid:i}),!a.isPrevNormal&&a.isCurNormal&&t.gatewayClient.dispatchEvent({type:"exception",code:u+2e3,msg:Ze[u+2e3],uid:i}),a.isPrevNormal=a.isCurNormal,a.record=[]}},t.setLocalStats=function(e){var n={};Object.keys(e).map((function(r){var i=e[r],o=t.gatewayClient.localStreams[parseInt(r)],a=t.localStreamStorage[r]||{};o&&o.hasVideo()&&(t.record("SendVideoBitrate",i.videoStats,a,r),t.record("FramerateInput",i.videoStats,a,r,o),t.record("FramerateSent",i.videoStats,a,r)),o&&o.hasAudio()&&(t.record("AudioIntputLevel",i.audioStats,a,r),t.record("SendAudioBitrate",i.audioStats,a,r)),n[r]=a})),t.localStreamStorage=n},t.setRemoteStats=function(n){var r={};Object.keys(n).map((function(i){var o=n[i],a=e.remoteStreams[i],s=t.remoteStreamStorage[i]||{};a&&a.hasVideo()&&a.isPlaying()&&t.record("VideoDecode",o.videoStats,s,i),a&&a.hasAudio()&&a.isPlaying()&&(t.record("AudioOutputLevel",o.audioStats,s,i),t.record("AudioDecode",o.audioStats,s,i)),r[i]=s})),t.remoteStreamStorage=r},t},tt=new function(){var e=u();return e.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},e.state=e.states.UNINIT,e.type=null,e.lastConnectedAt=null,e.lastDisconnectedAt=null,e.lastTypeChangedAt=null,e.networkChangeTimer=null,e._init=function(t,n){if(e.state=e.states.INITING,navigator.connection&&navigator.connection.addEventListener){var r=e._getNetworkInfo();e.type=r&&r.type,e.state=e.states.INITED,t&&t()}else e.state=e.states.UNINIT,n&&n("DO_NOT_SUPPORT")},e._getNetworkInfo=function(){return navigator.connection},e._reloadNetworkInfo=function(){var t=e._getNetworkInfo(),n=t&&t.type||"UNSUPPORTED",r=Date.now();if(n!==e.type){e.lastTypeChangedAt=r,"none"==n?e.lastDisconnectedAt=r:"none"==e.type&&(e.lastConnectedAt=r),e.type=n;var i={type:"networkTypeChanged",networkType:n};e.dispatchEvent(i)}},e.getStats=function(t,n){var r={},i=e._getNetworkInfo();i&&(r.NetworkType=i.type||"UNSUPPORTED"),setTimeout((function(){t(r)}),0)},e._init((function(){navigator.connection.addEventListener("change",(function(){e._reloadNetworkInfo()})),e.networkChangeTimer=setInterval((function(){e._reloadNetworkInfo()}),5e3)}),(function(e){})),e},nt="DISCONNECTING",rt="CONNECTED",it="INIT",ot=[],at=(setInterval((function(){Date.now(),ot.forEach((function(e){for(var t=e.requests.length-1;t>=0;t--){var n=e.requests[t];n.timeoutCnt++,n.timeoutCnt>=15&&(e.requests.splice(t,1),n.promises.reject({reason:"TIMEOUT",code:499}))}}))}),1e3),1),st=1,ut=1,ct=function(){var e=G()(F.a.mark((function e(t){var n,r,i,s,u,c,l;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.uid,r=t.url,i=t.serviceName,s=t.sid,u=t.appId,c=t.cname,l=t.timeout,e.abrupt("return",new Promise((function(e,t){var d=!1,p=new XMLHttpRequest;p.open("POST",r,!0),p.setRequestHeader("Content-Type","application/json; charset=utf-8"),p.setRequestHeader("X-Packet-Service-Type","0"),p.setRequestHeader("X-Packet-URI","61"),p.onload=function(){if(!d){var n=null,r=null;try{n=JSON.parse(p.responseText)}catch(e){var i="Invalid text ".concat(p.responseText);return a.default.error(i),d=!0,t(i)}if(n.code){var o="AP_ERR_".concat(n.code);return a.default.error(o,n),d=!0,t(o)}try{r=JSON.parse(n.json_body||n.json)}catch(e){var s="Invalid json_body ".concat(p.responseText);return a.default.error(s),d=!0,t(s)}if(200!==r.code){var u="APPCENTER_CODE_".concat(r.code);return a.default.error(u,r),d=!0,t(u)}return r.servers&&r.servers.length>0?(d=!0,e(r)):(a.default.error("APPCENTER_EMPTY_SERVER",r),d=!0,t("APPCENTER_EMPTY_SERVER"))}},p.onerror=function(e){var n="AP_REUEST_".concat(e.type);a.default.error(n,r,e),d||(d=!0,t(n))},p.ontimeout=function(e){a.default.error("AP_REUEST_TIMEOUT",r,e),d||(d=!0,t("AP_REUEST_TIMEOUT"))},l&&(p.timeout=l),p.send(JSON.stringify({service_name:i,json_body:JSON.stringify({command:"convergeAllocateEdge",sid:s,uid:n+"",appId:u,ts:Math.floor(Date.now()/1e3),seq:at++,cname:c,version:o.VERSION,requestId:st++})}))})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),lt=function(){var e=G()(F.a.mark((function e(t){var n,r,i,s,u,c,l,d,p,f,h,g;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.serviceName,r=t.sid,i=t.appId,s=t.cname,u=t.uid,c=null,e.t0=F.a.keys(Object(o.getParameter)("UAP_AP"));case 3:if((e.t1=e.t0()).done){e.next=34;break}return l=e.t1.value,d="https://".concat(Object(o.getParameter)("UAP_AP")[l],"/api/v1?action=uap"),p=void 0,e.prev=7,e.next=10,ct({uid:u,url:d,appId:i,sid:r,serviceName:n,cname:s,timeout:Object(o.getParameter)("HTTP_CONNECT_TIMEOUT")});case 10:p=e.sent,e.next=18;break;case 13:return e.prev=13,e.t2=e.catch(7),a.default.error(e.t2),c=e.t2,e.abrupt("continue",3);case 18:f=F.a.mark((function e(t){var r,i,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p.servers[t],i="wss://".concat(r.address.replace(/\./g,"-"),".edge.").concat(t%2==0?"agora.io":"agoraio.cn",":").concat(r.wss,"?serviceName=").concat(encodeURIComponent(n)),r.wss){e.next=5;break}return a.default.error("Invalid server response",r),e.abrupt("return","continue");case 5:return e.prev=5,e.next=8,new Promise((function(e,t){var n=new WebSocket(i),r=!1;n.addEventListener("open",(function(){r||(r=!0,e(n))})),n.addEventListener("error",(function(e){r||(r=!0,t(e))}))}));case 8:return(o=e.sent).workerToken=p.workerToken,e.abrupt("return",{v:o});case 13:e.prev=13,e.t0=e.catch(5),a.default.error(e.t0),c=e.t0;case 17:case"end":return e.stop()}}),e,this,[[5,13]])})),h=0;case 20:if(!(h<p.servers.length)){e.next=32;break}return e.delegateYield(f(h),"t3",22);case 22:g=e.t3,e.t4=g,e.next="continue"===e.t4?26:27;break;case 26:return e.abrupt("continue",29);case 27:if("object"!==ve()(g)){e.next=29;break}return e.abrupt("return",g.v);case 29:h++,e.next=20;break;case 32:e.next=3;break;case 34:throw c;case 35:case"end":return e.stop()}}),e,this,[[7,13]])})));return function(t){return e.apply(this,arguments)}}(),dt={},pt=function(e){return dt[e]?(dt[e]+=1,dt[e]):(dt[e]=1,dt[e])},ft={},ht=function(e){return ft[e]?(ft[e]+=1,ft[e]):(ft[e]=1,ft[e])},gt=function(e){var t=e.appId,n=e.cname,r=e.uid,i=e.sid,s=u();return s.status=it,s.pingpongTimer=null,s.connection=null,s.requests=[],s.appId=t,s.cname=n,s.uid=r,s.sid=i,s.connection=null,s.connectionId=ut++,s.connect=function(){var e=G()(F.a.mark((function e(t){var n;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.wsClient,s.status===it){e.next=4;break}return a.default.debug("Ignored UapConnection.connect: ".concat(s.status)),e.abrupt("return");case 4:s.connection=n,s.status=rt,s._flush(),s.startPingpong(),n.addEventListener("close",(function(e){if(console.log("Weboskcet closed",e),n===s.connection){var t={type:"close",evt:e};s.dispatchEvent(t)}})),n.addEventListener("message",(function(e){if(e.data){var t=null;try{t=JSON.parse(e.data)}catch(e){return void a.default.error("Invalid data from worker manager",t)}if(t.requestId)for(var n=s.requests.length-1;n>=0;n--){var r=s.requests[n];if(r.reqData.requestId===t.requestId){s.requests.splice(n,1),t.code<400&&t.code>=200?r.promises.resolve(t):r.promises.reject(t);break}}else t.type="notification",s.dispatchEvent(t)}}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.disconnect=G()(F.a.mark((function e(){var t;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t in s.status=nt,clearInterval(s.pingpongTimer),s.pingpongTimer=null,s.requests)s.requests[t].promises.reject("DISCONNECTED");return s.requests=[],s.connection&&(s.connection.close(),s.connection=null),s.status="DISCONNECTED",e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)}))),s.request=function(){var e=G()(F.a.mark((function e(t){var n,r,i,u;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=y()({command:"request",sdkVersion:o.VERSION,seq:ht(s.sid),appId:s.appId,cname:s.cname,uid:""+s.uid,sid:s.sid,requestId:pt(s.sid),ts:Math.floor(Date.now()/1e3)},t),"INIT"!==s.status){e.next=5;break}return e.abrupt("return",new Promise((function(e,t){var r={reqData:n,stalledTs:Date.now(),timeoutCnt:0,promises:{resolve:e,reject:t}};s.requests.push(r)})));case 5:if(s.connection){e.next=11;break}throw r="NO_WEBSOCKET_CONNECTION",a.default.error(r),new Error(r);case 11:if(s.status!==nt||t.clientRequest&&"DestroyWorker"===t.clientRequest.command){e.next=17;break}throw i="WEBSOCKET_DISCONNECTING",a.default.error(i),new Error(i);case 17:if("DISCONNECTED"!==s.status){e.next=23;break}throw u="WEBSOCKET_DISCONNECTED",a.default.error(u),new Error(u);case 23:return e.abrupt("return",new Promise((function(e,t){var r={reqData:n,stalledTs:Date.now(),timeoutCnt:0,promises:{resolve:e,reject:t}};s.requests.push(r),s._flush()})));case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s._flush=function(){s.connection&&s.status===rt&&s.requests.forEach((function(e){e.sentTs||(e.sentTs=Date.now(),e.reqData.clientRequest&&(e.reqData.clientRequest.workerToken=s.connection.workerToken),s.connection.send(JSON.stringify(e.reqData)))}))},s.startPingpong=function(){clearInterval(s.pingpongTimer),s.pingpongTimer=setInterval(G()(F.a.mark((function e(){return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.status!==rt||!s.connection||1!==s.connection.readyState){e.next=9;break}return e.prev=1,e.next=4,s.request({command:"ping"});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error("pingpong",e.t0);case 9:case"end":return e.stop()}}),e,this,[[1,6]])}))),6e3)},s._flush(),s.startPingpong(),ot.push(s),s},mt=function(e){e.disconnect();var t=ot.find((function(t){return e.connectionId===t.connectionId}));ot.splice(t,1)},vt=function(e){return"number"==typeof e&&0<=e&&e<=4294967295},yt=function(e){var t=e;if(Object(o.getParameter)("LIVESTREAMING_ALIGN"))switch(e){case 200:t=S.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_SUCCESS;break;case 451:t=S.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_ALREADY_EXISTS;break;case 453:t=S.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_UNAUTHORIZED;break;case 470:t=S.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_BROKEN;break;case 499:t=S.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_TIMEDOUT;break;default:t=S.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_FAILED}return t},_t=function(e){var t=e;if(Object(o.getParameter)("LIVESTREAMING_ALIGN"))switch(e){case 200:t=S.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_SUCCESS;break;case 404:case 452:t=S.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_NOT_FOUND;break;case 453:t=S.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED;break;case 499:t=S.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_TIMEDOUT;break;default:t=S.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_FAILED}return t},bt=r(22),St=r.n(bt),Et=function(e){var t={key:void 0,highStream:null,lowStream:null,lowStreamParameter:null,isDualStream:!1,highStreamState:2,lowStreamState:2,proxyServer:null};return t.turnServer={mode:"auto",username:"test",credential:"111111",forceturn:Object(o.getParameter)("FORCE_TURN")},t.useProxyServer=!1,t.mode=e.mode,t.codec=e.codec,t.clientId=Object($.generateSessionId)().slice(0,5),t.uintUid=null,e=y()({},e),t.aespassword=null,t.aesmode="none",t.hasPublished=!1,t.getSessionId=function(){return e.sessionId},t.startChannelMediaRelay=function(n,r){var i=s.b.reportApiInvoke(e.sessionId,{callback:function(e){if(e)return r&&r(e);r&&r()},name:"Client.startChannelMediaRelay",options:arguments,tag:"tracer"});if(!(n instanceof we.ChannelMediaRelayConfiguration))throw"Configration should be instance of [ChannelMediaRelayConfiguration]";var o=n.getSrcChannelMediaInfo(),a=n.getDestChannelMediaInfos();if(Object(U.isEmpty)(o))throw"srcChannelMediaInfo should not be empty";if(Object(U.isEmpty)(a)||0===a.length)throw"destChannelMediaInfos should not be empty";if(!Object($.is32Uint)(o.uid))throw"Invalid uid in srcChannelMediaInfo";if(!Object(U.isValidChannelName)(o.channelName))throw"Invalid channelName in srcChannelMediaInfo";if(o.token&&!Object(U.isValidToken)(o.token))throw"Invalid token in srcChannelMediaInfo";if(a.forEach((function(e){if(!Object($.is32Uint)(e.uid))throw"Invalid uid in destChannelMediaInfo";if(!Object(U.isValidChannelName)(e.channelName))throw"Invalid channelName in destChannelMediaInfo";if(e.token&&!Object(U.isValidToken)(e.token))throw"Invalid token in destChannelMediaInfo"})),t.gatewayClient.state!==Ke.CONNECTED)throw"startChannelMediaRelay should be used after join";t.gatewayClient.startChannelMediaRelay(n).then((function(){i&&i()})).catch((function(e){i&&i(e)}))},t.updateChannelMediaRelay=function(n,r){var i=s.b.reportApiInvoke(e.sessionId,{callback:function(e){if(e)return r&&r(e);r&&r()},name:"Client.updateChannelMediaRelay",options:arguments,tag:"tracer"});if(!(n instanceof we.ChannelMediaRelayConfiguration))throw"Configration should be instance of [ChannelMediaRelayConfiguration]";var o=n.getSrcChannelMediaInfo(),a=n.getDestChannelMediaInfos();if(Object(U.isEmpty)(o))throw"srcChannelMediaInfo should not be empty";if(Object(U.isEmpty)(a)||0===a.length)throw"destChannelMediaInfos should not be empty";if(!Object($.is32Uint)(o.uid))throw"Invalid uid in srcChannelMediaInfo";if(!Object(U.isValidChannelName)(o.channelName))throw"Invalid channelName in srcChannelMediaInfo";if(o.token&&!Object(U.isValidToken)(o.token))throw"Invalid token in srcChannelMediaInfo";if(a.forEach((function(e){if(!Object($.is32Uint)(e.uid))throw"Invalid uid in destChannelMediaInfo";if(!Object(U.isValidChannelName)(e.channelName))throw"Invalid channelName in destChannelMediaInfo";if(e.token&&!Object(U.isValidToken)(e.token))throw"Invalid token in destChannelMediaInfo"})),t.gatewayClient.state!==Ke.CONNECTED)throw"updateChannelMediaRelay should be used after join";t.gatewayClient.updateChannelMediaRelay(n).then((function(){i&&i()})).catch((function(e){i&&i(e)}))},t.stopChannelMediaRelay=function(n){var r=s.b.reportApiInvoke(e.sessionId,{callback:function(e){if(e)return n&&n(e);n&&n()},name:"Client.stopChannelMediaRelay",options:arguments,tag:"tracer"});t.gatewayClient.stopChannelMediaRelay().then((function(){r&&r()})).catch((function(e){r&&r(e)}))},t.getConnectionState=function(){var n=s.b.reportApiInvoke(e.sessionId,{name:"Client.getConnectionState",options:arguments,tag:"tracer"}),r=Ke.connetionStateMap[t.gatewayClient.state];return n(),r},t.setClientRole=function(n,r){var i=s.b.reportApiInvoke(e.sessionId,{callback:r,name:"Client.setClientRole",options:arguments,tag:"tracer"});if(Object(U.checkValidEnum)(n,"setClientRole",["host","audience"]),"rtc"===t.mode){var o="RTC mode can not use setClientRole";return a.default.warning("[".concat(t.clientId,"] ").concat(o)),i&&i(o)}t.gatewayClient&&t.gatewayClient.state===Ke.CONNECTED?("audience"===n&&(0===this.highStreamState?this._unpublish(this.highStream,(function(){i&&i(null,{role:n})}),(function(e){i&&i(e)})):t.gatewayClient.setClientRole("audience",i)),"host"===n&&t.gatewayClient.setClientRole("host",i)):(t.gatewayClient.role=n,i&&i(null,{role:n}))},t.getGatewayInfo=function(e){if(t.gatewayClient.state!==Ke.CONNECTED){var n="Client is not in connected state";return a.default.error("[".concat(t.clientId,"] ").concat(n)),void e(n)}t.gatewayClient.getGatewayInfo((function(t){e(null,t)}),e)},t.renewToken=function(n,r,i){var o=s.b.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return a.default.error("Failed to renew token ".concat(e),t),i&&i(e);r&&r(t)},name:"Client.renewToken",options:arguments,tag:"tracer"});if(!Object(U.isValidToken)(n))throw new Error("Invalid token: Token is of the string type .Length of the string: [1,255]. ASCII characters only.");return t.gatewayClient?t.key?(t.key=n,void t.gatewayClient.renewToken(n,(function(e){return o(null,e)}),o)):(a.default.error("[".concat(t.clientId,"] renewToken should not be called before user join")),o(S.default.INVALID_OPERATION)):(a.default.error("[".concat(t.clientId,"] renewToken Failed. GatewayClient not Exist")),o(S.default.INVALID_OPERATION))},t.setLowStreamParameter=function(n){var r=s.b.reportApiInvoke(e.sessionId,{name:"Client.setLowStreamParameter",options:arguments,tag:"tracer"});Object(U.checkValidObject)(n,"param");var i=n.width,o=n.height,u=n.framerate,c=n.bitrate;Object(U.isEmpty)(i)||Object(U.checkValidNumber)(i,"width"),Object(U.isEmpty)(o)||Object(U.checkValidNumber)(o,"height"),Object(U.isEmpty)(u)||Object(U.checkValidNumber)(u,"framerate"),Object(U.isEmpty)(c)||Object(U.checkValidNumber)(c,"bitrate",1,1e7),(!i&&o||i&&!o)&&a.default.warning("[".concat(t.clientId,"] The width and height parameters take effect only when both are set")),t.lowStreamParameter=n,r()},t.init=function(n,r,i){var o=s.b.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return i&&i(e);r&&r(t)},name:"Client.init",options:arguments,tag:"tracer"});Object(U.checkValidString)(n),Object(h.isChromeKernel)()&&Object(h.getChromeKernelVersion)()<=48?i?o(S.default.BAD_ENVIRONMENT):Object($.popBanTip)():(a.default.info("[".concat(t.clientId,"] Initializing AgoraRTC client, appId: ").concat(n,".")),e.appId=n,e.sessionId=Object($.generateSessionId)(),o())},t.setTurnServer=function(n){var r=s.b.reportApiInvoke(e.sessionId,{name:"Client.setTurnServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==Ke.DISCONNECTED)throw new Error("Set turn server before join channel");if(t.useProxyServer)throw new Error("You have already set the proxy");Object(U.checkValidObject)(n,"turnServer");var i=n.turnServerURL,o=n.username,u=n.password,c=n.udpport,l=n.forceturn,d=n.tcpport;Object(U.checkValidString)(i,"turnServerURL"),Object(U.checkValidString)(o,"username"),Object(U.checkValidString)(u,"password"),Object(U.checkValidString)(c,"udpport"),Object(U.isEmpty)(l)||Object(U.checkValidBoolean)(l,"forceturn"),t.turnServer.mode="manual",t.turnServer.url=i,t.turnServer.udpport=c,t.turnServer.username=o,t.turnServer.credential=u,t.turnServer.forceturn=l||!1,Object(U.isEmpty)(d)||(Object(U.checkValidString)(d,"tcpport"),t.turnServer.tcpport=d,a.default.info("[".concat(t.clientId,"] Set turnserver tcpurl. ").concat(t.turnServer.url,":").concat(t.turnServer.tcpport))),a.default.info("[".concat(t.clientId,"] Set turnserver udpurl. ").concat(t.turnServer.url,":").concat(t.turnServer.udpport,",username: ").concat(t.turnServer.uername,",password: ").concat(t.turnServer.credential)),r()},t.setProxyServer=function(n){var r=s.b.reportApiInvoke(e.sessionId,{name:"Client.setProxyServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==Ke.DISCONNECTED)throw new Error("Set proxy server before join channel");if(!n)throw new Error("Do not set the proxyServer parameter as empty");if(t.useProxyServer)throw new Error("You have already set the proxy");Object(U.checkValidString)(n,"proxyServer"),t.proxyServer=n,s.b.setProxyServer(n),a.default.setProxyServer(n),r()},t.startProxyServer=function(){var n=s.b.reportApiInvoke(e.sessionId,{name:"Client.startProxyServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==Ke.DISCONNECTED)throw new Error("Start proxy server before join channel");if(t.proxyServer||t.turnServer.url)throw new Error("You have already set the proxy");t.useProxyServer=!0,n()},t.stopProxyServer=function(){var n=s.b.reportApiInvoke(e.sessionId,{name:"Client.stopProxyServer",options:arguments,tag:"tracer"});if(t.gatewayClient&&t.gatewayClient.state!==Ke.DISCONNECTED)throw new Error("Stop proxy server after leave channel");s.b.setProxyServer(),a.default.setProxyServer(),t.turnServer={},t.proxyServer=null,t.useProxyServer=!1,n()},t.setEncryptionSecret=function(n){var r=s.b.reportApiInvoke(e.sessionId,{name:"Client.setEncryptionSecret",options:arguments,tag:"tracer"});Object(U.checkValidString)(n,"password"),t.aespassword=n,r()},t.setEncryptionMode=function(n){var r=s.b.reportApiInvoke(e.sessionId,{name:"Client.setEncryptionMode",options:arguments,tag:"tracer"});if(Object(U.checkValidString)(n,"encryptionMode"),-1===xe.indexOf(n))throw new Error('Invalid encryptionMode: encryptionMode should be "aes-128-xts" | "aes-256-xts" | "aes-128-ecb"');t.aesmode=n,r()},t.configPublisher=function(n){var r=s.b.reportApiInvoke(e.sessionId,{name:"Client.configPublisher",options:arguments,tag:"tracer"});Object(U.checkValidObject)(n,"config");var i=n.width,o=n.height,a=n.framerate,u=n.bitrate,c=n.publisherUrl;Object(U.checkValidNumber)(i,"width"),Object(U.checkValidNumber)(o,"height"),Object(U.checkValidNumber)(a,"framerate"),Object(U.checkValidNumber)(u,"bitrate",1,1e7),c&&Object(U.checkValidString)(c,"publisherUrl"),t.gatewayClient.configPublisher(n),r()},t.enableDualStream=function(n,r){var i=s.b.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e);n&&n(t)},name:"Client.enableDualStream",options:arguments,tag:"tracer"});return"iOS"===Object(h.getBrowserOS)()?(s.b.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!1}),i(S.default.IOS_NOT_SUPPORT)):Object(h.isWeChatBrowser)()?(s.b.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!1}),i(S.default.WECHAT_NOT_SUPPORT)):(s.b.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!0}),t.isDualStream=!0,t.highStream&&(t.highStream.isDualStream=!0),void(0===t.highStreamState?t._publishLowStream((function(e){return i(null,e)}),(function(e){a.default.warning("[".concat(t.clientId,"]"),e),i(S.default.ENABLE_DUALSTREAM_FAILED)})):1===t.highStreamState?i(S.default.STILL_ON_PUBLISHING):i(null)))},t.disableDualStream=function(n,r){var i=s.b.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e);n&&n(t)},name:"Client.disableDualStream",options:arguments,tag:"tracer"});s.b.streamSwitch(e.sessionId,{lts:(new Date).getTime(),isdual:!1,succ:!0}),t.isDualStream=!1,t.highStream&&(t.highStream.isDualStream=!1),0===t.highStreamState?t._unpublishLowStream((function(){t.highStream.lowStream=null,i()}),(function(e){a.default.warning("[".concat(t.clientId,"]"),e),i(S.default.DISABLE_DUALSTREAM_FAILED)})):1===t.highStreamState?i(S.default.STILL_ON_PUBLISHING):i()},t._createLowStream=function(e,n){if(t.highStream&&t.highStream.stream){var r=y()({},t.highStream.params);if(r.streamID+=1,r.audio=!1,r.video){var i=t.highStream.stream.getVideoTracks()[0];i?D.getVideoCameraIdByLabel(i.label,(function(i){r.cameraId=i;var s=new Se(r);if(s.isLowStream=!0,s.streamId=t.highStream.getId()+1,t.lowStreamParameter){var u=y()({},t.lowStreamParameter);if(!u.width||!u.height){var c=Xe(t.highStream.profile),l=o.SUPPORT_RESOLUTION_LIST[c[0]];u.width=l[0],u.height=l[1]}u.framerate=u.framerate||5,u.bitrate=u.bitrate||50,(Object(h.isSafari)()||Object(h.isOpera)())&&(a.default.debug("[".concat(t.clientId,"] Shimming lowStreamParameter")),l=o.SUPPORT_RESOLUTION_LIST[t.highStream.profile],u.width=l[0],u.height=l[1]),s.setVideoProfileCustomPlus(u)}else s.setVideoProfileCustom(Xe(t.highStream.profile));s.init((function(){t.highStream.lowStream=s,t.highStream.userMuteVideo&&s.muteVideo(),e&&e(s)}),n)}),n):n&&n(S.default.HIGH_STREAM_NOT_VIDEO_TRACE)}else n&&n(S.default.HIGH_STREAM_NOT_VIDEO_TRACE)}else n&&n(S.default.HIGH_STREAM_NOT_VIDEO_TRACE)},t._getLowStream=function(e,n){t.lowStream?e(t.lowStream):t.highStream.videoSource?t._createSourceLowStream((function(n){t.lowStream=n,e(t.lowStream)}),n):t._createLowStream((function(n){t.lowStream=n,e(t.lowStream)}),n)},t._createSourceLowStream=function(e,n){var r=y()({},t.highStream.params);r.streamID+=1,r.audio=!1;var i=new Se(r);if(i.isLowStream=!0,i.streamId=t.highStream.getId()+1,!t.lowStreamParameter)return a.default.debug("NOT_SET_LOW_STREAM_PARAMETER"),n&&n("NOT_SET_LOW_STREAM_PARAMETER");var o=y()({},t.lowStreamParameter);o.width&&o.height||(o.width=320,o.height=240),o.framerate=o.framerate||15,o.bitrate=o.bitrate||200,i.setVideoProfileCustomPlus(o);try{var s=St()(t.highStream.stream,{width:o.width,height:o.height,framerate:o.framerate});return i.stream=s,t.highStream.lowStream=i,t.highStream.userMuteVideo&&i.muteVideo(),e&&e(i)}catch(e){return n&&n(e)}},t._publishLowStream=function(e,n){return 2!==t.lowStreamState?n&&n(S.default.LOW_STREAM_ALREADY_PUBLISHED):t.highStream&&t.highStream.hasScreen()?n&&n(S.default.SHARING_SCREEN_NOT_SUPPORT):void t._getLowStream((function(r){t.lowStreamState=1,t.gatewayClient.publish(r,{streamType:1},(function(){t.lowStreamState=0,e&&e()}),(function(e){1===t.lowStreamState&&(t.lowStreamState=2),a.default.debug("[".concat(t.clientId,"] publish low stream failed")),n&&n(e)}))}),n)},t._unpublishLowStream=function(e,n){if(0!==t.lowStreamState)return n&&n(S.default.LOW_STREAM_NOT_YET_PUBLISHED);t.lowStream&&(t.gatewayClient.unpublish(t.lowStream,{streamType:1},(function(){}),(function(e){a.default.debug("[".concat(t.clientId,"] unpublish low stream failed")),n&&n(e)})),t.lowStream.close(),t.lowStream=null,t.lowStreamState=2,e&&e())},t.join=function(n,r,i,o,u){var c=s.b.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return u&&u(e);o&&o(t)},name:"Client.join",options:arguments,tag:"tracer"});if(n&&!Object(U.isValidToken)(n))return a.default.warning("[".concat(t.clientId,"] Param channelKey should be string")),c(S.default.INVALID_PARAMETER);if(!Object(U.isValidChannelName)(r))return a.default.error("Invalid Channel Name ".concat(r)),a.default.warning("[".concat(t.clientId,"] The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")),c(S.default.INVALID_PARAMETER);if("string"==typeof r&&""===r)return a.default.warning("[".concat(t.clientId,"] Param channel should not be empty")),c(S.default.INVALID_PARAMETER);if(i&&!Object($.is32Uint)(i)&&!Object(U.isValidString)(i,1,255))return a.default.error("Invalid UID ".concat(i," ").concat(ve()(i))),a.default.warning("[".concat(t.clientId,"] [String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]")),c(S.default.INVALID_PARAMETER);if("string"==typeof i&&0==i.length)return a.default.warning("[".concat(t.clientId,"] String uid should not be empty")),c(S.default.INVALID_PARAMETER);if("string"==typeof i&&i.length>256)return a.default.warning("[".concat(t.clientId,"] Length of string uid should be less than 255")),c(S.default.INVALID_PARAMETER);t.highStream=null,t.lowStream=null,t.lowStreamParameter=null,t.isDualStream=!1,t.highStreamState=2,t.lowStreamState=2;var l={clientId:t.clientId,appId:e.appId,sid:e.sessionId,cname:r,uid:i,turnServer:t.turnServer,proxyServer:t.proxyServer,token:n||e.appId,useProxyServer:t.useProxyServer};if("string"==typeof i&&(l.stringUid=i,t.uintUid?(l.uid=t.uintUid,delete t.uintUid):l.uid=0),t.aespassword&&"none"!==t.aesmode&&y()(l,{aespassword:t.aespassword,aesmode:t.aesmode}),s.b.sessionInit(e.sessionId,{lts:(new Date).getTime(),cname:r,appid:e.appId,mode:e.mode,succ:!0}),t.onSuccess=function(e){t.rtcStatsCollector.startNetworkQualityTimer(),t.onSuccess=null,c(null,e)},t.onFailure=function(e){return c(e)},t.channel=r,t.gatewayClient.state!==Ke.DISCONNECTED)return a.default.error("[".concat(t.clientId,"] Client already in connecting/connected state")),c(S.default.INVALID_OPERATION),void s.b.joinGateway(e.sessionId,{lts:Date.now(),succ:!1,ec:S.default.INVALID_OPERATION,addr:null});t.gatewayClient.state=Ke.CONNECTING;var d=function(i,o){a.default.info("[".concat(t.clientId,"] Joining channel: ").concat(r)),t.gatewayClient.dispatchEvent({type:"config-distribute",config:o,joinInfo:l}),t.key=n||e.appId,l.cid=i.cid,l.uid||(l.uid=i.uid),l.vid=i.vid,l.clientId=t.clientId,l.apResponse=i.res,i.uni_lbs_ip&&i.uni_lbs_ip[1]&&(l.uni_lbs_ip=i.uni_lbs_ip[1]),l.gatewayAddr=i.gateway_addr,t.joinInfo=l,t.gatewayClient.join(l,t.key,(function(e){a.default.info("[".concat(t.clientId,"] Join channel ").concat(r," success, join with uid: ").concat(e,".")),t.onSuccess=null,t.rtcStatsCollector.startNetworkQualityTimer(),c(null,e)}),(function(e){return c(e)}))};l.stringUid&&!l.uid?(t.userAccountReq&&!t.userAccountReq.isFinished()&&t.userAccountReq.cancel(),t.userAccountReq=Be(l,t.gatewayClient),t.userAccountReq.then((function(e){a.default.debug("getUserAccount Success ".concat(e.url," ").concat(l.stringUid," => ").concat(e.uid)),l.uid=e.uid,Ue(l,d,(function(e){return c(e)}))})).catch((function(e){a.default.error("getUserAccount rejected",e),c(e)}))):Ue(l,d,(function(e){return c(e)}))},t.renewChannelKey=function(n,r,i){var o=s.b.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return i&&i(e);r&&r(t)},name:"Client.renewChannelKey",options:arguments,tag:"tracer"});Object(U.checkValidString)(n,"key",1,2047),void 0===t.key?(a.default.error("[".concat(t.clientId,"] renewChannelKey should not be called before user join")),o(S.default.INVALID_OPERATION)):(t.key=n,t.gatewayClient.joinInfo.token=n,t.gatewayClient.key=n,t.gatewayClient.recover(),o())},t.leave=function(n,r){t.gatewayClient.hasInvokeLeave=!0;var i=!1,u=s.b.reportApiInvoke(e.sessionId,{callback:function(e,i){if(e)return r&&r(e);var o;t.gatewayClient.reconnectingCS=!1,t.gatewayClient.state=Ke.DISCONNECTED,clearTimeout((o=t.clientId,$e[o])),t._renewSession(),t.rtcStatsCollector.clearNetworkQualityTimer(),n&&n(i)},name:"Client.leave",options:arguments,tag:"tracer"});a.default.info("[".concat(t.clientId,"] Leaving channel")),t.userAccountReq&&!t.userAccountReq.isFinished()&&(t.userAccountReq.cancel(),t.gatewayClient.state===Ke.CONNECTING&&(t.gatewayClient.state=Ke.DISCONNECTED)),t.gatewayClient.leave((function(e){i=!0,u(null,e)}),u),setTimeout((function(){i||(t.gatewayClient.socket&&(t.gatewayClient.socket.close(),t.gatewayClient.socket=null),t.gatewayClient.state=Ke.DISCONNECTED,u(null,"LEAVE_MSG_TIMEOUT"))}),Object(o.getParameter)("LEAVE_MSG_TIMEOUT"))},t._renewSession=function(){var n=Object($.generateSessionId)();if(a.default.debug("renewSession ".concat(e.sessionId," => ").concat(n)),e.sessionId=n,t.joinInfo&&(t.joinInfo.sid=n),t.gatewayClient&&(t.gatewayClient.joinInfo&&(t.gatewayClient.joinInfo.sid=n),t.gatewayClient.localStreams))for(var r in t.gatewayClient.localStreams){var i=t.gatewayClient.localStreams[r];i&&(i.sid=n)}},t._publish=function(n,r,i,s){if(2!==t.highStreamState)return a.default.warning("[".concat(t.clientId,"] Can't publish stream when stream already publish ").concat(n.getId())),i&&i(S.default.STREAM_ALREADY_PUBLISHED);if("auto"===t.turnServer.mode&&Object(o.getParameter)("FORCE_TURN")&&!Object(o.getParameter)("TURN_ENABLE_TCP")&&!Object(o.getParameter)("TURN_ENABLE_UDP"))throw new Error("force TURN With No TURN Configuration");a.default.info("[".concat(t.clientId,"] Publishing stream, uid ").concat(n.getId())),t.highStream=n,t.highStreamState=1,t.highStream.streamId=t.joinInfo.stringUid||t.joinInfo.uid,t.hasPublished=!1;var u=function(n,r,i){t.gatewayClient.publish(n,{streamType:0},(function(){n.sid=e.sessionId,t.highStreamState=0,a.default.info("[".concat(t.clientId,"] Publish success, uid: ").concat(n.getId())),t.highStream&&(t.highStream.isDualStream=t.isDualStream),t.isDualStream?t._publishLowStream((function(){r&&r()}),(function(e){a.default.warning("[".concat(t.clientId,"] "),e),he(n),r&&r()})):(he(n),r&&r())}),i)};"audience"!==t.gatewayClient.role||"live"!==t.mode||s?u(n,r,i):t.gatewayClient.setClientRole("host",(function(e){if(e)return i&&i(e);u(n,r,i)}))},t._unpublish=function(e,n,r,i){if(0!==t.highStreamState)return a.default.warning("[".concat(t.clientId,"] Can't unpublish stream when stream not publish")),r&&r(S.default.STREAM_NOT_YET_PUBLISHED);a.default.info("[".concat(t.clientId,"] Unpublish stream, uid ").concat(e.getId()));var o=function(e,n,r){t.isDualStream&&t.lowStream&&t._unpublishLowStream(null,r),t.gatewayClient.unpublish(e,{streamType:0},(function(){t.highStreamState=2,a.default.info("[".concat(t.clientId,"] Unpublish stream success, uid: ").concat(e.getId())),n&&n()}),(function(n){a.default.info("[".concat(t.clientId,"] Unpublish stream fail, uid: ").concat(e.getId())),r&&r(n)}))};"host"!==t.gatewayClient.role||"live"!==t.mode||i?o(e,n,r):t.gatewayClient.setClientRole("audience",(function(t){if(t)return r&&r(t);o(e,n,r)}))},t.publish=function(n,r){var i=s.b.reportApiInvoke(e.sessionId,{callback:function(e,n){if(e)return 1===t.highStreamState&&(t.highStreamState=2),r&&r(e)},name:"Client.publish",tag:"tracer",options:{stream:"too long to show",onFailure:!!r}});2===t.highStreamState?n._hasVideoTracks()||n._hasAudioTracks()?t._publish(n,(function(e){return i(null,e)}),(function(e){return i(e)})):i(S.default.NO_TRACK_IN_STREAM):i(S.default.STREAM_ALREADY_PUBLISHED)},t.unpublish=function(n,r,i){var o=s.b.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e);i&&i(t)},name:"Client.unpublish",tag:"tracer",options:{stream:"too long to show",onFailure:!!r}});0===t.highStreamState?t._unpublish(n,(function(e){return o(null,e)}),(function(e){return o(e)})):o(S.default.STREAM_NOT_YET_PUBLISHED)},t.subscribe=function(n,r,i){var o=s.b.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return i&&i(e)},name:"Client.subscribe",tag:"tracer",options:{stream:"too long to show",options:r,onFailure:!!i}});"function"==typeof r&&(i=r,r=null),Object(U.checkValidObject)(n,"stream"),Object(U.isEmpty)(r)||(Object(U.checkValidObject)(r,"options"),Object(U.isEmpty)(r.video)||Object(U.checkValidBoolean)(r.video,"options.video"),Object(U.isEmpty)(r.audio)||Object(U.checkValidBoolean)(r.audio,"options.audio"));var u={video:!0,audio:!0};if(!Object(U.isEmpty)(r)){if(Object(h.isSafari)()&&(!r.video||!r.audio)){var c="SAFARI_NOT_SUPPORTED_FOR_TRACK_SUBSCRIPTION";return a.default.error("[".concat(t.clientId,"] "),c),void o(c)}if(!Object(U.isEmpty)(r.video)&&!Object(U.isValidBoolean)(r.video)||!Object(U.isEmpty)(r.audio)&&!Object(U.isValidBoolean)(r.audio)||!1===r.audio&&!1===r.video)return c="INVALID_PARAMETER ".concat(JSON.stringify(r)),a.default.error("[".concat(t.clientId,"] "),c),void o(c)}n.subscribeOptions?(y()(n.subscribeOptions,u,r),t.gatewayClient.subscribeChange(n,(function(e){return o(null,e)}),o)):(n.subscribeOptions=y()({},u,r),t.gatewayClient.subscribe(n,(function(e){return o(null,e)}),o))},t.unsubscribe=function(n,r){var i=s.b.reportApiInvoke(e.sessionId,{callback:function(e,t){if(e)return r&&r(e)},name:"Client.unsubscribe",tag:"tracer",options:{stream:"too long to show",onFailure:!!r}});a.default.info("[".concat(t.clientId,"] Unsubscribe stream, uid: ").concat(n.getId())),t.gatewayClient.unsubscribe(n,(function(e){return i(null,e)}),i)},t.setRemoteVideoStreamType=function(n,r){var i=s.b.reportApiInvoke(e.sessionId,{name:"Client.setRemoteVideoStreamType",tag:"tracer",options:{stream:"too long to show",streamType:r}});Object(U.checkValidEnum)(r,"streamType",[0,1]),t.gatewayClient.setRemoteVideoStreamType(n,r),i()},t.setStreamFallbackOption=function(n,r){var i=s.b.reportApiInvoke(e.sessionId,{name:"Client.setStreamFallbackOption",tag:"tracer",options:{stream:"too long to show",fallbackType:r}});Object(U.checkValidEnum)(r,"fallbackType",[0,1,2]),t.gatewayClient.setStreamFallbackOption(n,r),i()},t.enableAudioVolumeIndicator=function(n,r){var i=s.b.reportApiInvoke(e.sessionId,{name:"Client.enableAudioVolumeIndicator",options:arguments,tag:"tracer"});n=n||2e3,r=r||3,Object(U.checkValidNumber)(r,"smooth",1,100),Object(U.checkValidNumber)(n,"interval",50,1e5),t.audioVolumeIndication=t.audioVolumeIndication||{enabled:!0},t.audioVolumeIndication.interval=n,t.audioVolumeIndication.smooth=r,t.audioVolumeIndication={interval:n,smooth:r},a.default.info("[".concat(t.clientId,"] enableAudioVolumeIndicator interval ").concat(n," smooth ").concat(r)),t.gatewayClient.enableAudioVolumeIndicator(n,r),i()},t.getNetworkStats=function(e,n){return a.default.deprecate("[".concat(t.clientId,"] client.getNetworkStats is deprecated. Use client.getTransportStats instead.")),tt.getStats(e,n)},t.getSystemStats=function(e,t){return m.getStats(e,t)},t.getRecordingDevices=function(e,t){return D.getRecordingDevices(e,t)},t.getPlayoutDevices=function(e,t){return D.getPlayoutDevices(e,t)},t.getCameras=function(e,t){return D.getCameras(e,t)},t.getRemoteAudioStats=function(e,n){return t.rtcStatsCollector.getRemoteAudioStats(e,n)},t.getLocalAudioStats=function(e,n){return t.rtcStatsCollector.getLocalAudioStats(e,n)},t.getRemoteVideoStats=function(e,n){return t.rtcStatsCollector.getRemoteVideoStats(e,n)},t.getLocalVideoStats=function(e,n){return t.rtcStatsCollector.getLocalVideoStats(e,n)},t._getRemoteVideoQualityStats=function(e,n){return t.rtcStatsCollector.getRemoteVideoQualityStats(e,n)},t._getRemoteAudioQualityStats=function(e,n){return t.rtcStatsCollector.getRemoteAudioQualityStats(e,n)},t.getTransportStats=function(e,n){return t.rtcStatsCollector.getTransportStats((function(t){return tt.getStats((function(n){var r=y()({},t,n);e&&e(r)}),n)}),n)},t.getSessionStats=function(e,n){return t.rtcStatsCollector.getSessionStats(e,n)},t.onNetworkQuality=function(){return t.rtcStatsCollector.onNetworkQuality(onSuccess,onFailure)},e.clientId=t.clientId,t.gatewayClient=Ke(e),t.listenerLoggerTimer=null,t.listenerLoggerCache=[],t.on=function(e,n){t.gatewayClient.on(e,n),t.listenerLoggerCache.push("".concat(e).concat(n.name?":"+n.name:"")),t.listenerLoggerTimer?clearTimeout(t.listenerLoggerTimer):a.default.info("[".concat(t.clientId,"] Adding event handler on ").concat(e)),t.listenerLoggerTimer=setTimeout((function(){t.listenerLoggerCache.length&&(t.listenerLoggerTimer=null,a.default.info("[".concat(t.clientId,"] Added event handler on ").concat(t.listenerLoggerCache.join(", "))),t.listenerLoggerCache=[])}),0)},t.off=function(e,n){a.default.info("remove event handler from [".concat(e,"]")),t.gatewayClient.removeEventListener(e,n)},t.rtcStatsCollector=function(e){var t=u();return t.gatewayClient=e,t.exceptionMonitor=new et(e),t.localStats={},t.remoteStats={},t.session={sendBytes:0,recvBytes:0,WSSendBytes:0,WSSendBytesDelta:0,WSRecvBytes:0,WSRecvBytesDelta:0,HTTPSendBytes:0,HTTPSendBytesDelta:0,HTTPRecvBytes:0,HTTPRecvBytesDelta:0},t.getRemoteAudioStats=function(e){var n={};for(var r in t.remoteStats){var i={},o=t.remoteStats[r];k(i,"End2EndDelay",o.peer_delay&&o.peer_delay.audio_delay),k(i,"TransportDelay",o.peer_delay&&o.peer_delay.e2e_delay),k(i,"PacketLossRate",o.peer_delay&&o.peer_delay.e2e_audio_lost_ratio_400ms),k(i,"RecvLevel",o.audioStats&&o.audioStats.audioOutputLevel),k(i,"RecvBitrate",o.audioRecvBitrate),k(i,"CodecType",o.audioStats&&o.audioStats.googCodecName),k(i,"MuteState",o.audioDisabled),k(i,"TotalFreezeTime",o.audioStats&&o.audioStats.audioTotalFreezeTime),k(i,"TotalPlayDuration",o.audioStats&&o.audioStats.audioTotalPlayDuration),n[r]=i}e&&e(n)},t.getLocalAudioStats=function(e){var n={};for(var r in t.localStats){var i={},o=t.localStats[r];k(i,"RecordingLevel",o.audioStats&&o.audioStats.audioInputLevel),k(i,"SendLevel",o.audioStats&&o.audioStats.totalAudioEnergy),k(i,"SamplingRate",o.audioStats&&o.audioStats.totalSamplesDuration),k(i,"SendBitrate",o.audioSendBitrate),k(i,"CodecType",o.audioStats&&o.audioStats.googCodecName),k(i,"MuteState",o.audioDisabled);var a=t.gatewayClient.localStreams[r];a&&a.isPlaying()&&k(i,"MuteState",a.userMuteAudio?"1":"0"),n[r]=i}e&&e(n)},t.getRemoteVideoStats=function(e){var n={};for(var r in t.remoteStats){var i={},o=t.remoteStats[r];k(i,"End2EndDelay",o.peer_delay&&o.peer_delay.video_delay),k(i,"TransportDelay",o.peer_delay&&o.peer_delay.e2e_delay),k(i,"PacketLossRate",o.peer_delay&&o.peer_delay.e2e_video_lost_ratio_400ms),k(i,"RecvBitrate",o.videoRecvBitrate),k(i,"RecvResolutionWidth",o.videoStats&&o.videoStats.googFrameWidthReceived),k(i,"RecvResolutionHeight",o.videoStats&&o.videoStats.googFrameHeightReceived),k(i,"RenderResolutionWidth",o.videoStats&&o.videoStats.renderRemoteWidth),k(i,"RenderResolutionHeight",o.videoStats&&o.videoStats.renderRemoteHeight),k(i,"RenderFrameRate",o.videoStats&&o.videoStats.googFrameRateOutput),k(i,"MuteState",o.videoDisabled),k(i,"TotalFreezeTime",o.videoStats&&o.videoStats.videoTotalFreezeTime),k(i,"TotalPlayDuration",o.videoStats&&o.videoStats.videoTotalPlayDuration),n[r]=i}e&&e(n)},t.getLocalVideoStats=function(e){var n={};for(var r in t.localStats){var i={},o=t.localStats[r];k(i,"TargetSendBitrate",o.videoTargetSendBitrate),k(i,"SendFrameRate",o.videoStats&&o.videoStats.googFrameRateSent),k(i,"SendBitrate",o.videoSendBitrate),k(i,"SendResolutionWidth",o.videoStats&&o.videoStats.googFrameWidthSent),k(i,"SendResolutionHeight",o.videoStats&&o.videoStats.googFrameHeightSent),k(i,"CaptureResolutionWidth",o.videoStats&&o.videoStats.googFrameWidthInput),k(i,"CaptureResolutionHeight",o.videoStats&&o.videoStats.googFrameHeightInput),k(i,"EncodeDelay",o.videoStats&&o.videoStats.googAvgEncodeMs),k(i,"MuteState",o.videoDisabled),k(i,"TotalFreezeTime",o.videoStats&&o.videoStats.videoTotalFreezeTime),k(i,"TotalDuration",o.videoStats&&o.videoStats.videoTotalPlayDuration),k(i,"CaptureFrameRate",o.videoStats&&o.videoStats.googFrameRateSent),o.videoStats&&!o.videoStats.googFrameWidthInput&&k(i,"CaptureResolutionWidth",o.videoStats&&o.videoStats.renderLocalWidth),o.videoStats&&!o.videoStats.googFrameHeightInput&&k(i,"CaptureResolutionHeight",o.videoStats&&o.videoStats.renderLocalHeight),n[r]=i,e&&e(n)}},t.getRemoteVideoQualityStats=function(e){var n={};for(var r in t.remoteStats){var i={},o=t.remoteStats[r];k(i,"videoReceiveDelay",o.videoStats&&o.videoStats.googCurrentDelayMs),k(i,"VideoFreezeRate",o.videoStats&&o.videoStats.videoFreezeRate),k(i,"FirstFrameTime",o.firstFrameTime),n[r]=i}e&&e(n)},t.getRemoteAudioQualityStats=function(e){var n={};for(var r in t.remoteStats){var i={},o=t.remoteStats[r];k(i,"audioReceiveDelay",o.audioStats&&o.audioStats.googCurrentDelayMs),k(i,"AudioFreezeRate",o.videoStats&&o.videoStats.videoFreezeRate),n[r]=i}e&&e(n)},t.getTransportStats=function(e){var n={},r={},i=t.gatewayClient.traffic_stats,o=i.peer_delay;if(k(n,"OutgoingAvailableBandwidth",t.gatewayClient.OutgoingAvailableBandwidth/1e3),k(n,"RTT",i&&i.access_delay),o){var a=!0,s=!1,u=void 0;try{for(var c,l=o[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var d=c.value;d.downlink_estimate_bandwidth&&(r[d.peer_uid]=d.downlink_estimate_bandwidth/1e3+"")}}catch(e){s=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}}n.IncomingAvailableBandwidth=r,e&&e(n)},t.getSessionStats=function(e){var n={},r=t.gatewayClient.traffic_stats,i=t.gatewayClient.socket,o=0,a=0;for(var s in t.remoteStats)(u=t.remoteStats[s])&&u.videoStats&&u.videoStats.videoRecvBytesDelta&&(a+=parseInt(u.videoStats.videoRecvBytesDelta)),u&&u.audioStats&&u.audioStats.audioRecvBytesDelta&&(a+=parseInt(u.audioStats.audioRecvBytesDelta));for(var s in t.localStats){var u;(u=t.localStats[s])&&u.videoStats&&u.videoStats.videoSendBytesDelta&&(o+=parseInt(u.videoStats.videoSendBytesDelta)),u&&u.audioStats&&u.audioStats.audioSendBytesDelta&&(o+=parseInt(u.audioStats.audioSendBytesDelta))}var c=o+t.session.WSSendBytesDelta+t.session.HTTPSendBytesDelta,l=a+t.session.WSRecvBytesDelta+t.session.HTTPRecvBytesDelta,d=t.session.sendBytes+Object(Ce.getHTTPSendBytes)(),p=t.session.recvBytes+Object(Ce.getHTTPRecvBytes)();t.gatewayClient.socket&&t.gatewayClient.socket.state===t.gatewayClient.CONNECTED&&(d+=i.getSendBytes(),p+=i.getRecvBytes());var f=1;r.peer_delay&&(f=r.peer_delay.length,f+=1),k(n,"Duration",i.getDuration()),k(n,"UserCount",f),k(n,"SendBytes",d),k(n,"RecvBytes",p),k(n,"SendBitrate",8*c/1e3),k(n,"RecvBitrate",8*l/1e3),e&&e(n)},t.isLocalVideoFreeze=function(e,t){var n=0,r=0;if(!e||!t)return!1;if(Object(h.isChrome)()||Object(h.isOpera)())n=e.googFrameRateInput,r=e.googFrameRateSent;else if(Object(h.isSafari)())n=parseInt(e.framerateMean),r=parseInt(e.framesEncoded)-parseInt(t.framesEncoded);else{if(!Object(h.isFireFox)())return!1;n=parseInt(e.framerateMean),r=parseInt(e.framesEncoded)-parseInt(t.framesEncoded)}return n>5&&r<3},t.isRemoteVideoFreeze=function(e,t){var n=0,r=0;if(!e||!t)return!1;if(Object(h.isChrome)()||Object(h.isOpera)())n=e.googFrameRateReceived,r=e.googFrameRateDecoded;else if(Object(h.isSafari)())n=e.framerateMean,r=parseInt(e.framesDecoded)-parseInt(t.framesDecoded);else{if(!Object(h.isFireFox)())return!1;n=parseInt(e.framesReceived)-parseInt(t.framesReceived),r=parseInt(e.framesDecoded)-parseInt(t.framesDecoded)}return n>5&&n<10&&r<3||n>10&&n<20&&r<4||n>20&&r<5},t.isAudioFreeze=function(e){if(Object(h.isChrome)()&&e){if(e.googDecodingPLC&&e.googDecodingPLCCNG&&e.googDecodingCTN)return(parseInt(e.googDecodingPLC)+parseInt(e.googDecodingPLCCNG))/parseInt(e.googDecodingCTN)>.2}else if((Object(h.isSafari)()||Object(h.isFireFox)())&&e.packetsLost&&e.packetsReceived)return parseInt(e.packetsLost)/(parseInt(e.packetsLost)+parseInt(e.packetsReceived))>.2;return!1},t.isAudioDecodeFailed=function(e){return!!((Object(h.isChrome)()||Object(h.isOpera)())&&e&&parseInt(e.bytesReceived)>0&&0===parseInt(e.googDecodingNormal))},t.startNetworkQualityTimer=function(){t.clearNetworkQualityTimer(),t.networkQualityTimer=setInterval((function(){if(t.gatewayClient.state!==Ke.CONNECTED)t.gatewayClient.dispatchEvent({type:"network-quality",uplinkNetworkQuality:0,downlinkNetworkQuality:0});else{var e=t.gatewayClient.traffic_stats;t.gatewayClient.dispatchEvent({type:"network-quality",uplinkNetworkQuality:t.networkQualityTrans(e.uplink_network_quality),downlinkNetworkQuality:t.networkQualityTrans(e.downlink_network_quality)})}}),2e3)},t.clearNetworkQualityTimer=function(){t.networkQualityTimer&&clearInterval(t.networkQualityTimer)},t.networkQualityTrans=function(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0},t.getStatsTimer=setInterval((function(){var e=t.gatewayClient.traffic_stats,n=Date.now();t.gatewayClient.dispatchEvent({type:"_testException"}),Object.keys(t.localStats).length&&t.exceptionMonitor.setLocalStats(t.localStats),Object.keys(t.remoteStats).length&&t.exceptionMonitor.setRemoteStats(t.remoteStats);var r={};Object.keys(t.gatewayClient.remoteStreams).forEach((function(i){var o=t.gatewayClient.remoteStreams[i],a=t.remoteStats[i],s={id:i,updatedAt:n};r[i]=s,s.firstFrameTime=o.firstFrameTime,a?(s.audioTotalPlayDuration=a.audioTotalPlayDuration+1,s.audioTotalFreezeTime=a.audioTotalFreezeTime,s.isAudioFreeze=!1,s.isAudioDecodeFailed=!1,s.videoTotalPlayDuration=a.videoTotalPlayDuration+1,s.videoTotalFreezeTime=a.videoTotalFreezeTime,s.isVideoFreeze=!1):(s.audioTotalPlayDuration=1,s.audioTotalFreezeTime=0,s.videoTotalPlayDuration=1,s.videoTotalFreezeTime=0);var u=e&&e.peer_delay&&e.peer_delay.find((function(e){return e.peer_uid==i}));u&&(s.peer_delay=u),o&&(o.isPlaying()&&(s.audioDisabled=o.userMuteAudio||o.peerMuteAudio?"1":"0",s.videoDisabled=o.userMuteVideo||o.peerMuteVideo?"1":"0"),a&&a.peer_delay&&u&&a.peer_delay.stream_type!==u.stream_type&&t.gatewayClient.dispatchEvent({type:"streamTypeChange",uid:i,streamType:u.stream_type}),o.pc&&"established"==o.pc.state&&o.pc.getStats((function(e){if(s.pcStats=e,s.audioStats=e.find((function(e){return"audio"==e.mediaType&&(e.id.indexOf("_recv")>-1||e.id.toLowerCase().indexOf("inbound")>-1)})),s.videoStats=e.find((function(e){return"video"==e.mediaType&&(e.id.indexOf("_recv")>-1||e.id.toLowerCase().indexOf("inbound")>-1)})),a&&a.audioStats&&s.audioStats){var n=parseInt(s.audioStats.bytesReceived)-parseInt(a.audioStats.bytesReceived),r=parseInt(s.audioStats.googDecodingNormal)-parseInt(a.audioStats.googDecodingNormal);if(s.audioStats.audioRecvBytesDelta=n,s.audioStats.audioDecodingNormalDelta=r,t.session.recvBytes+=n,isFinite(n)&&s.audioStats.timestamp){var i=s.audioStats.timestamp.getTime()-a.audioStats.timestamp.getTime();s.audioRecvBitrate=Math.floor(8*n/i)}t.isAudioFreeze(s.audioStats)&&s.audioTotalPlayDuration>10&&(s.audioTotalFreezeTime++,s.isAudioFreeze=!0),t.isAudioDecodeFailed(s.audioStats)&&s.audioTotalPlayDuration>10&&(s.isAudioDecodeFailed=!0),s.audioStats.audioTotalFreezeTime=s.audioTotalFreezeTime,s.audioStats.audioTotalPlayDuration=s.audioTotalPlayDuration,s.audioStats.audioFreezeRate=Math.ceil(100*s.audioTotalFreezeTime/s.audioTotalPlayDuration)}if(a&&a.videoStats&&s.videoStats){var u=parseInt(s.videoStats.bytesReceived)-parseInt(a.videoStats.bytesReceived);s.videoStats.videoRecvBytesDelta=u,t.session.recvBytes+=u,isFinite(u)&&s.videoStats.timestamp&&(i=s.videoStats.timestamp.getTime()-a.videoStats.timestamp.getTime(),s.videoRecvBitrate=Math.floor(8*u/i)),t.isRemoteVideoFreeze(s.videoStats,a.videoStats)&&(s.videoTotalFreezeTime++,s.isVideoFreeze=!0),s.videoStats.videoTotalFreezeTime=s.videoTotalFreezeTime,s.videoStats.videoTotalPlayDuration=s.videoTotalPlayDuration,s.videoStats.videoFreezeRate=Math.ceil(100*s.videoTotalFreezeTime/s.videoTotalPlayDuration),o.player&&o.player.video&&o.player.video.videoWidth&&o.player.video.videoHeight?(s.videoStats.renderRemoteWidth=o.player.video.videoWidth,s.videoStats.renderRemoteHeight=o.player.video.videoHeight):(s.videoStats.renderRemoteWidth=o.videoWidth||s.videoStats.googFrameWidthReceived,s.videoStats.renderRemoteHeight=o.videoHeight||s.videoStats.googFrameHeightReceived)}})))})),t.remoteStats=r;var i={};if(Object.keys(t.gatewayClient.localStreams).forEach((function(e){var r=t.gatewayClient.localStreams[e],o=t.localStats[e],a={id:e,updatedAt:n};i[e]=a,o?(a.videoTotalPlayDuration=o.videoTotalPlayDuration+1,a.videoTotalFreezeTime=o.videoTotalFreezeTime,a.isVideoFreeze=!1):(a.videoTotalPlayDuration=1,a.videoTotalFreezeTime=0),r&&(r.isPlaying()&&(a.audioDisabled=r.userMuteAudio?"1":"0",a.videoDisabled=r.userMuteVideo?"1":"0"),r.video&&r.attributes.maxVideoBW?a.videoTargetSendBitrate=r.attributes.maxVideoBW:r.video&&r.screenAttributes&&(a.videoTargetSendBitrate=r.screenAttributes.maxVideoBW),r.pc&&"established"==r.pc.state&&r.pc.getStats((function(e){if(a.pcStats=e.reverse(),a.audioStats=e.find((function(e){return"audio"==e.mediaType&&(e.id.indexOf("_send")>-1||e.id.toLowerCase().indexOf("outbound")>-1)})),a.videoStats=e.find((function(e){return"video"==e.mediaType&&(e.id.indexOf("_send")>-1||e.id.toLowerCase().indexOf("outbound")>-1)})),a.audioStats&&o&&o.audioStats){var n=parseInt(a.audioStats.bytesSent)-parseInt(o.audioStats.bytesSent);if(a.audioStats.audioSendBytesDelta=n,t.session.sendBytes+=n,isFinite(n)&&a.audioStats.timestamp){var i=a.audioStats.timestamp.getTime()-o.audioStats.timestamp.getTime();a.audioSendBitrate=Math.floor(8*n/i)}}if(a.videoStats&&o&&o.videoStats){var s=parseInt(a.videoStats.bytesSent)-parseInt(o.videoStats.bytesSent);a.videoStats.videoSendBytesDelta=s,t.session.sendBytes+=s,isFinite(s)&&a.videoStats.timestamp&&(i=a.videoStats.timestamp.getTime()-o.videoStats.timestamp.getTime(),a.videoSendBitrate=Math.floor(8*s/i)),t.isLocalVideoFreeze(a.videoStats,o.videoStats)&&(a.videoTotalFreezeTime++,a.isVideoFreeze=!0),a.videoStats.videoTotalFreezeTime=a.videoTotalFreezeTime,a.videoStats.videoTotalPlayDuration=a.videoTotalPlayDuration,a.videoStats.videoFreezeRate=Math.ceil(100*a.videoTotalFreezeTime/a.videoTotalPlayDuration),a.videoStats.renderLocalWidth=r.videoWidth||a.videoStats.googFrameWidthSent,a.videoStats.renderLocalHeight=r.videoHeight||a.videoStats.googFrameHeightSent}})))})),t.localStats=i,t.session.HTTPSendBytesDelta=Object(Ce.getHTTPSendBytes)()-t.session.HTTPSendBytes,t.session.HTTPSendBytes=Object(Ce.getHTTPSendBytes)(),t.session.HTTPRecvBytesDelta=Object(Ce.getHTTPRecvBytes)()-t.session.HTTPRecvBytes,t.session.HTTPRecvBytes=Object(Ce.getHTTPRecvBytes)(),t.gatewayClient.socket&&t.gatewayClient.socket.state===t.gatewayClient.CONNECTED){var o=t.gatewayClient.socket;t.session.WSSendBytesDelta=o.getSendBytes()-t.session.WSSendBytes,t.session.WSSendBytes=o.getSendBytes(),t.session.WSRecvBytesDelta=o.getRecvBytes()-t.session.WSRecvBytes,t.session.WSRecvBytes=o.getRecvBytes()}}),1e3),t.gatewayClient.on("join",(function(){t.session={sendBytes:0,recvBytes:0,WSSendBytes:0,WSSendBytesDelta:0,WSRecvBytes:0,WSRecvBytesDelta:0,HTTPSendBytes:0,HTTPSendBytesDelta:0,HTTPRecvBytes:0,HTTPRecvBytesDelta:0}})),t}(t.gatewayClient),t.configDistributManager=function(e){var t={};return t.client=e,t.client.gatewayClient&&t.client.gatewayClient.on("config-distribute",(function(n){var r=n.joinInfo,i=n.config;if(i){Object(U.isEmpty)(i.uploadLog)||(Object(o.setParameter)("UPLOAD_LOG",i.uploadLog),s.b.reportApiInvoke(r.sid,{name:"_configDistribute",options:{feature:"uploadLog",value:i.uploadLog}})()),Object(U.isEmpty)(i.dualStream)||(e.isDualStream=i.dualStream,s.b.reportApiInvoke(r.sid,{name:"_configDistribute",options:{feature:"dualStream",value:i.dualStream}})()),Object(U.isEmpty)(i.streamFallbackOption)||t.client.gatewayClient&&t.client.gatewayClient.on("stream-subscribed",(function(e){var n=e.stream;n?(t.client.gatewayClient.setStreamFallbackOption(n,i.streamFallbackOption),s.b.reportApiInvoke(r.sid,{name:"_configDistribute",options:{feature:"streamFallbackOption",value:i.streamFallbackOption,streamId:n.getId()}})()):s.b.reportApiInvoke(r.sid,{name:"_configDistribute",options:{feature:"streamFallbackOption",value:i.streamFallbackOption,streamId:n.getId(),err:"invalid stream"}})()}));try{a.default.debug("[".concat(e.clientId,"] setParameter in distribution: ").concat(JSON.stringify(i))),Object.keys(i).map((function(e){return Object(o.setParameter)(e,i[e])}))}catch(t){a.default.debug("[".concat(e.clientId,"] setParameter in distribution failed: ").concat(JSON.stringify(i)))}}})),t}(t),function(e,t){var n,r,i,o,c,l,d,p,f,h=arguments;e.liveStreaming=u(),e.liveStreaming.connections={inject_streaming:null,mix_streaming:null,raw_streaming:null},e.liveStreaming.connectionTypes={inject_streaming:"pull",mix_streaming:"push",raw_streaming:"push"},e.liveStreaming.pushStates={},e.liveStreaming.pullStates={},e.gatewayClient.addEventListener("join",(function(t){e.liveStreaming.resumeStates("pull")})),e.gatewayClient.addEventListener("stream-unpublished",(function(t){if(t.options&&0===t.options.streamType)for(var n in e.liveStreaming.pushStates){var r=e.liveStreaming.pushStates[n];r.url&&e._stopLiveStreaming(r.url,r.transcodingEnabled,!0)}})),e.gatewayClient.addEventListener("stream-published",(function(t){e.liveStreaming.resumeStates("push")})),e.liveStreaming.connect=(f=G()(F.a.mark((function n(r){var i,o;return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.joinInfo&&e.joinInfo.uid&&parseInt(e.joinInfo.vid,10)){n.next=3;break}throw new Error("CLIENT_NOT_JOINED");case 3:return i=new gt({appId:t.appId,cname:e.channel,sid:t.sessionId,uid:e.joinInfo.uid}),e.liveStreaming.connections[r]=i,n.next=7,lt({appId:t.appId,cname:e.channel,serviceName:r,sid:t.sessionId,uid:e.joinInfo.uid});case 7:return o=n.sent,n.next=10,i.connect({wsClient:o});case 10:return i.on("notification",(function(t){if(t.serviceName=r,e.liveStreaming.dispatchEvent(t),503===t.code);else switch(t.serviceName){case"inject_streaming":var n={reason:t&&t.reason,status:yt(t&&t.code),type:"streamInjectedStatus",uid:t&&t.serverStatus&&t.serverStatus.inject_uid,url:t&&t.serverStatus&&t.serverStatus.url};e.gatewayClient.dispatchEvent(n);break;case"raw_streaming":case"mix_streaming":var i={reason:t&&t.reason,status:t&&t.code,type:t&&200===t.code?"liveStreamingStarted":"liveStreamingFailed",uid:t&&t.serverStatus&&t.uid,url:t&&t.serverStatus&&t.serverStatus.url};e.gatewayClient.dispatchEvent(i)}})),i.on("close",(function(t){mt(i),a.default.debug("Reconnect ".concat(r)),e.liveStreaming.connect(r).catch((function(t){e.liveStreaming.connections[r]=null,e.gatewayClient.dispatchEvent({type:"".concat(r.replace("_","-"),"-disconnected")})}))})),a.default.debug("".concat(r," connected")),n.abrupt("return",i);case 14:case"end":return n.stop()}}),n,this)}))),function(e){return f.apply(this,arguments)}),e.liveStreaming.disconnect=(p=G()(F.a.mark((function t(n){var r,i;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=F.a.keys(e.liveStreaming.connections);case 1:if((t.t1=t.t0()).done){t.next=13;break}if(r=t.t1.value,!e.liveStreaming.connections.hasOwnProperty(r)){t.next=11;break}if(!(i=e.liveStreaming.connections[r])||n&&n!==r){t.next=11;break}return a.default.info("Disconnecting liveStreaming ".concat(r)),t.next=9,i.disconnect();case 9:t.sent,e.liveStreaming.connections[r]=null;case 11:t.next=1;break;case 13:case"end":return t.stop()}}),t,this)}))),function(e){return p.apply(this,arguments)}),e.liveStreaming.resumeStates=(d=G()(F.a.mark((function t(n){var r,i,o,s,u,c,l,d;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=F.a.keys(e.liveStreaming.connections);case 1:if((t.t1=t.t0()).done){t.next=8;break}if(r=t.t1.value,!n||e.liveStreaming.connectionTypes[r]===n){t.next=5;break}return t.abrupt("continue",1);case 5:e.liveStreaming.connections.hasOwnProperty(r)&&(i=e.liveStreaming.connections[r])&&(a.default.info("LiveStreaming closing connection ".concat(r)),i.disconnect(),e.liveStreaming.connections[r]=null),t.next=1;break;case 8:t.t2=F.a.keys(e.liveStreaming.pushStates);case 9:if((t.t3=t.t2()).done){t.next=37;break}if(o=t.t3.value,!n||"push"===n){t.next=13;break}return t.abrupt("continue",9);case 13:if(!e.liveStreaming.pushStates.hasOwnProperty(o)){t.next=35;break}if(s=e.liveStreaming.pushStates[o],"audience"!==e.gatewayClient.role){t.next=19;break}a.default.warning("Cannot resume LiveStreaming in audience mode. ".concat(s.url),s),t.next=35;break;case 19:if(!s){t.next=35;break}return a.default.debug("Resuming LiveStreaming ".concat(s.url),s),t.prev=21,t.next=24,e._startLiveStreaming(s.url,s.transcodingEnabled);case 24:u=t.sent,a.default.debug("Resumed LiveStreaming ".concat(s.url,": ").concat(u.reason)),t.next=35;break;case 28:if(t.prev=28,t.t4=t.catch(21),454!==t.t4.code){t.next=34;break}a.default.debug("Resumed LiveStreaming ".concat(s.url,": ").concat(t.t4.reason)),t.next=35;break;case 34:throw t.t4;case 35:t.next=9;break;case 37:t.t5=F.a.keys(e.liveStreaming.pullStates);case 38:if((t.t6=t.t5()).done){t.next=62;break}if(c=t.t6.value,!n||"pull"===n){t.next=42;break}return t.abrupt("continue",38);case 42:if(!e.liveStreaming.pullStates.hasOwnProperty(c)){t.next=60;break}if(l=e.liveStreaming.pullStates[c],"audience"!==e.gatewayClient.role){t.next=48;break}a.default.warning("Cannot resume addInjectStreamUrl in audience mode. ".concat(l.url),l),t.next=60;break;case 48:if(!l){t.next=60;break}return a.default.debug("Resuming LiveStreaming pullStream ".concat(l.url),l),t.prev=50,t.next=53,e._addInjectStreamUrl(l.url,l.transcodingConfig);case 53:d=t.sent,a.default.debug("Resumed LiveStreaming pullStream ".concat(l.url,": ").concat(d.reason)),t.next=60;break;case 57:t.prev=57,t.t7=t.catch(50),451===t.t7.code&&a.default.debug("Resumed LiveStreaming pullStream ".concat(l.url,": ").concat(t.t7.reason));case 60:t.next=38;break;case 62:case"end":return t.stop()}}),t,this,[[21,28],[50,57]])}))),function(e){return d.apply(this,arguments)}),e.liveStreaming.startOptions={autoDestroyTime:30},e.liveStreaming.transcodingConfig={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,images:[],lowLatency:!1,metadata:"",userConfigExtraInfo:"",userConfigs:[],videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFramerate:15,videoGop:30,width:640},e.startLiveStreaming=function(n,r){Object(U.isEmpty)(r)||Object(U.checkValidBoolean)(r,"transcodingEnabled"),Object(U.checkValidString)(n,"url",1,1024);var i=s.b.reportApiInvoke(t.sessionId,{name:"Client.startLiveStreaming",options:arguments,tag:"tracer"});if(e.gatewayClient&&"audience"===e.gatewayClient.role){var o={code:403,reason:"AUDIENCE_STREAMING_FORBIDDEN"};throw i(o),o}var a=e._startLiveStreaming(n,r);return a.then((function(e){i(null,e)})).catch((function(e){i(e)})),a},e._startLiveStreaming=(l=G()(F.a.mark((function n(r,i){var o,s,u,c;return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=y()({allocate:!0,clientRequest:{command:"PublishStream"},command:"request"}),a.default.debug("startLiveStreaming ".concat(r,", ").concat(i)),y()(o.clientRequest,e.liveStreaming.startOptions,{ts:Date.now(),url:r,vid:parseInt(e.joinInfo.vid,10)}),s=null,i?(e.liveStreaming.connections.mix_streaming||e.liveStreaming.connect("mix_streaming"),o.clientRequest.transcodingConfig=JSON.parse(JSON.stringify(e.liveStreaming.transcodingConfig)),s=e.liveStreaming.connections.mix_streaming):("vp8"===t.codec&&a.default.warning("VP8 is not supported by raw_streaming. Subscriber side will suffer"),"rtc"===t.mode&&a.default.warning("RTC mode is not supported by raw_streaming. Subscriber side will suffer"),e.liveStreaming.connections.raw_streaming||e.liveStreaming.connect("raw_streaming"),s=e.liveStreaming.connections.raw_streaming),u=null,c={},n.prev=7,n.next=10,s.request(o);case 10:u=n.sent,c.type="liveStreamingStarted",c.reason=u&&u.reason,c.status=u&&u.code,c.url=u&&u.serverResponse&&u.serverResponse.url,e.gatewayClient.dispatchEvent(c),n.next=26;break;case 18:throw n.prev=18,n.t0=n.catch(7),c.type="liveStreamingFailed",c.reason=n.t0&&n.t0.reason,c.status=n.t0&&n.t0.code,c.url=n.t0&&n.t0.serverResponse&&n.t0.serverResponse.url,e.gatewayClient.dispatchEvent(c),n.t0;case 26:return e.liveStreaming.pushStates[r]={transcodingEnabled:i,url:r},n.abrupt("return",u);case 28:case"end":return n.stop()}}),n,this,[[7,18]])}))),function(e,t){return l.apply(this,arguments)}),e.setLiveTranscoding=function(n,r){a.default.debug("setLiveTranscoding: ".concat(JSON.stringify(n))),Object(U.checkValidObject)(n,"transcoding");var i=n,o=i.width,u=i.height,c=i.videoBitrate,l=i.videoFramerate,d=i.lowLatency,p=i.audioSampleRate,f=i.audioBitrate,h=i.audioChannels,g=i.videoGop,m=i.images,v=i.videoCodecProfile,y=i.userCount,_=i.backgroundColor,b=i.transcodingUsers;if(b||(b=n.userConfigs),Object(U.isEmpty)(o)||Object(U.checkValidNumber)(o,"width"),Object(U.isEmpty)(u)||Object(U.checkValidNumber)(u,"height"),Object(U.isEmpty)(c)||Object(U.checkValidNumber)(c,"videoBitrate",1,1e6),Object(U.isEmpty)(l)||Object(U.checkValidNumber)(l,"videoFramerate"),Object(U.isEmpty)(d)||Object(U.checkValidBoolean)(d,"lowLatency"),Object(U.isEmpty)(p)||Object(U.checkValidEnum)(p,"audioSampleRate",[32e3,44100,48e3]),Object(U.isEmpty)(f)||Object(U.checkValidNumber)(f,"audioBitrate",1,128),Object(U.isEmpty)(h)||Object(U.checkValidEnum)(h,"audioChannels",[1,2,3,4,5]),Object(U.isEmpty)(g)||Object(U.checkValidNumber)(g,"videoGop"),Object(U.isEmpty)(v)||Object(U.checkValidEnum)(v,"videoCodecProfile",[66,77,100]),Object(U.isEmpty)(y)||Object(U.checkValidNumber)(y,"userCount",0,17),Object(U.isEmpty)(_)||Object(U.checkValidNumber)(_,"backgroundColor",0,16777215),!Object(U.isEmpty)(b)){if(!Object(U.isArray)(b))throw new Error("[transcodingUsers]: transcodingUsers should be Array");if(b.length>17)throw new Error("The length of transcodingUsers cannot greater than 17");b.map((function(e,t){if(!Object(U.isEmpty)(e.uid)&&!vt(e.uid)&&!Object(U.isValidString)(e.uid,1,255))throw new Error("[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");if(Object(U.isEmpty)(e.x)||Object(U.checkValidNumber)(e.x,"transcodingUser[".concat(t,"].x"),0,1e4),Object(U.isEmpty)(e.y)||Object(U.checkValidNumber)(e.y,"transcodingUser[".concat(t,"].y"),0,1e4),Object(U.isEmpty)(e.width)||Object(U.checkValidNumber)(e.width,"transcodingUser[".concat(t,"].width"),0,1e4),Object(U.isEmpty)(e.height)||Object(U.checkValidNumber)(e.height,"transcodingUser[".concat(t,"].height"),0,1e4),Object(U.isEmpty)(e.zOrder)||Object(U.checkValidNumber)(e.zOrder,"transcodingUser[".concat(t,"].zOrder"),0,100),!(Object(U.isEmpty)(e.alpha)||Object(U.isNumber)(e.alpha)&&e.alpha<=1&&e.alpha>=0))throw new Error("transcodingUser[${index}].alpha: The value range is [0, 1]")}))}if(!Object(U.isEmpty)(m)){if(!Object(U.isArray)(m))throw new Error("[images]: images should be Array");m.map((function(e,t){if(Object(U.checkValidString)(e.url,"images[".concat(t,"].url"),1,1024),Object(U.isEmpty)(e.x)?e.x=0:Object(U.checkValidNumber)(e.x,"images[".concat(t,"].x"),0,1e4),Object(U.isEmpty)(e.y)?e.y=0:Object(U.checkValidNumber)(e.y,"images[".concat(t,"].y"),0,1e4),Object(U.isEmpty)(e.width)?e.width=160:Object(U.checkValidNumber)(e.width,"images[".concat(t,"].width"),0,1e4),Object(U.isEmpty)(e.height)?e.height=160:Object(U.checkValidNumber)(e.height,"images[".concat(t,"].height"),0,1e4),Object(U.isEmpty)(e.zOrder)?e.zOrder=0:Object(U.checkValidNumber)(e.zOrder,"images[".concat(t,"].zOrder"),0,100),Object(U.isEmpty)(e.alpha))e.alpha=1;else if(!(Object(U.isNumber)(e.alpha)&&e.alpha<=1&&e.alpha>=0))throw new Error("image[${index}].alpha: The value range is [0, 1]")}))}var S=s.b.reportApiInvoke(t.sessionId,{name:"Client.setLiveTranscoding",options:arguments,tag:"tracer"});if((n=JSON.parse(JSON.stringify(n))).transcodingUsers&&(n.userConfigs=n.transcodingUsers,delete n.transcodingUsers),e.joinInfo.stringUid&&n.userConfigs&&n.userConfigs.length){var E=[];n.userConfigs.forEach((function(t){E.push(Be(e.joinInfo,e.gatewayClient,t.uid).then((function(e){t.uid=e.uid})))}));var w=Promise.all(E).then((function(){return e._setLiveTranscoding(n,r)}));return w.then((function(e){S(null,e)})).catch((function(e){S(e)})),w}var I=e._setLiveTranscoding(n,r);return I.then((function(e){S(null,e)})).catch((function(e){S(e)})),I},e._setLiveTranscoding=(c=G()(F.a.mark((function t(n,r){var i,o,a;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.liveStreaming.transcodingConfig=y()(e.liveStreaming.transcodingConfig,n),"boolean"!=typeof r&&(r=!!e.liveStreaming.connections.mix_streaming),i=JSON.parse(JSON.stringify({allocate:!1,clientRequest:{command:"UpdateTranscoding",transcodingConfig:e.liveStreaming.transcodingConfig},command:"request"})),o={},!r){t.next=16;break}return e.liveStreaming.connections.mix_streaming||e.liveStreaming.connect("mix_streaming"),t.next=8,e.liveStreaming.connections.mix_streaming.request(i);case 8:return a=t.sent,o.type="liveTranscodingUpdated",o.reason=a.reason,o.status=a.code,e.gatewayClient.dispatchEvent(o),t.abrupt("return",a);case 16:return t.abrupt("return",{code:200,reason:"success"});case 17:case"end":return t.stop()}}),t,this)}))),function(e,t){return c.apply(this,arguments)}),e.stopLiveStreaming=function(n,r){Object(U.checkValidString)(n,"url",1,1024);var i=s.b.reportApiInvoke(t.sessionId,{name:"Client.stopLiveStreaming",options:arguments,tag:"tracer"}),o=e._stopLiveStreaming(n,r);return o.then((function(e){i(null,e)})).catch((function(e){i(e)})),o},e._stopLiveStreaming=(o=G()(F.a.mark((function t(n,r,i){var o,a,s,u,c,l;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null,a=e.liveStreaming.pushStates[n],o=a?a.transcodingEnabled?"mix_streaming":"raw_streaming":r?"mix_streaming":"raw_streaming",s={allocate:!1,clientRequest:{command:"UnpublishStream",url:n},command:"request"},e.liveStreaming.connections[o]||e.liveStreaming.connect(o),u=null,t.prev=6,t.next=9,e.liveStreaming.connections[o].request(s);case 9:u=t.sent,(c={}).type="liveStreamingStopped",c.reason=u&&u.reason,c.status=u&&u.code,c.url=u&&u.serverResponse&&u.serverResponse.url,e.gatewayClient.dispatchEvent(c),t.next=27;break;case 18:throw t.prev=18,t.t0=t.catch(6),(l={}).type="liveStreamingStopped",l.reason=t.t0&&t.t0.reason,l.status=t.t0&&t.t0.code,l.url=t.t0&&t.t0.serverResponse&&t.t0.serverResponse.url,e.gatewayClient.dispatchEvent(l),t.t0;case 27:return i||delete e.liveStreaming.pushStates[n],t.abrupt("return",u);case 29:case"end":return t.stop()}}),t,this,[[6,18]])}))),function(e,t,n){return o.apply(this,arguments)}),e.liveStreaming.injectStreamTranscodingConfig={autoDestroyTime:30,audioBitrate:48,audioChannels:1,audioSampleRate:44100,height:0,videoBitrate:400,videoFramerate:15,videoGop:30,width:0},e.addInjectStreamUrl=function(n,r){Object(U.checkValidString)(n,"url",1,1024),Object(U.checkValidObject)(r,"config"),!Object(U.isEmpty)(r&&r.width)&&Object(U.checkValidNumber)(r.width,"config.width",0,1e4),!Object(U.isEmpty)(r&&r.height)&&Object(U.checkValidNumber)(r.height,"config.height",0,1e4),!Object(U.isEmpty)(r&&r.videoGop)&&Object(U.checkValidNumber)(r.videoGop,"config.videoGop",1,1e4),!Object(U.isEmpty)(r&&r.videoFramerate)&&Object(U.checkValidNumber)(r.videoFramerate,"config.videoFramerate",1,1e4),!Object(U.isEmpty)(r&&r.videoBitrate)&&Object(U.checkValidNumber)(r.videoBitrate,"config.videoBitrate",1,1e4),!Object(U.isEmpty)(r&&r.audioSampleRate)&&Object(U.checkValidEnum)(r.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),!Object(U.isEmpty)(r&&r.audioBitrate)&&Object(U.checkValidNumber)(r.audioBitrate,"config.audioBitrate",1,1e4),!Object(U.isEmpty)(r&&r.audioChannels)&&Object(U.checkValidNumber)(r.audioChannels,"config.audioChannels",1,2);var i=s.b.reportApiInvoke(t.sessionId,{name:"Client.addInjectStreamUrl",options:h,tag:"tracer"});if("audience"===e.gatewayClient.role){var o={code:403,reason:"AUDIENCE_INJECTING_FORBIDDEN"};throw i(o),o}var a=e._addInjectStreamUrl(n,r);return a.then((function(e){i(null,e)})).catch((function(e){i(e)})),a},e._addInjectStreamUrl=(i=G()(F.a.mark((function n(r,i){var o,a,s,u,c;return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=y()({},e.liveStreaming.injectStreamTranscodingConfig,i),a={allocate:!0,clientRequest:{cname:e.channel,command:"InjectStream",sid:t.sessionId,transcodingConfig:o,ts:Date.now(),url:r,vid:parseInt(e.joinInfo.vid,10)},command:"request"},e.liveStreaming.connections.inject_streaming||e.liveStreaming.connect("inject_streaming"),s=null,n.prev=4,n.next=7,e.liveStreaming.connections.inject_streaming.request(a);case 7:s=n.sent,u={reason:s&&s.reason,status:yt(s&&s.code),type:"streamInjectedStatus",uid:s&&s.serverResponse&&s.serverResponse.inject_uid,url:s&&s.serverResponse&&s.serverResponse.url},e.gatewayClient.dispatchEvent(u),n.next=17;break;case 12:throw n.prev=12,n.t0=n.catch(4),c={reason:n.t0&&n.t0.reason,status:yt(n.t0&&n.t0.code),type:"streamInjectedStatus",uid:n.t0&&n.t0.serverResponse&&n.t0.serverResponse.inject_uid,url:n.t0&&n.t0.serverResponse&&n.t0.serverResponse.url},e.gatewayClient.dispatchEvent(c),n.t0;case 17:return e.liveStreaming.pullStates[r]={transcodingConfig:o,url:r},n.abrupt("return",s);case 19:case"end":return n.stop()}}),n,this,[[4,12]])}))),function(e,t){return i.apply(this,arguments)}),e.removeInjectStreamUrl=(r=G()(F.a.mark((function n(r){var i,o,a=arguments;return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Object(U.checkValidString)(r,"url",1,255),i=s.b.reportApiInvoke(t.sessionId,{name:"Client.removeInjectStreamUrl",options:a,tag:"tracer"}),(o=e._removeInjectStreamUrl(r)).then((function(e){i(null,e)})).catch((function(e){i(e)})),n.abrupt("return",o);case 5:case"end":return n.stop()}}),n,this)}))),function(e){return r.apply(this,arguments)}),e._removeInjectStreamUrl=(n=G()(F.a.mark((function t(n){var r,i,o,a;return F.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={allocate:!1,clientRequest:{command:"UninjectStream",url:n},command:"request"},e.liveStreaming.connections.inject_streaming||e.liveStreaming.connect("inject_streaming"),i=null,t.prev=3,t.next=6,e.liveStreaming.connections.inject_streaming.request(r);case 6:i=t.sent,o={reason:i&&i.reason,status:_t(i&&i.code),type:"streamInjectedStatus",uid:i&&i.serverResponse&&i.serverResponse.inject_uid,url:i&&i.serverResponse&&i.serverResponse.url},e.gatewayClient.dispatchEvent(o),t.next=16;break;case 11:throw t.prev=11,t.t0=t.catch(3),a={reason:t.t0&&t.t0.reason,status:_t(t.t0&&t.t0.code),type:"streamInjectedStatus",uid:t.t0&&t.t0.serverResponse&&t.t0.serverResponse.inject_uid,url:t.t0&&t.t0.serverResponse&&t.t0.serverResponse.url},e.gatewayClient.dispatchEvent(a),t.t0;case 16:return delete e.liveStreaming.pullStates[n],t.abrupt("return",i);case 18:case"end":return t.stop()}}),t,this,[[3,11]])}))),function(e){return n.apply(this,arguments)})}(t,e),Object(U.isEmpty)(e.turnServer)||t.setTurnServer(e.turnServer),Object(U.isEmpty)(e.proxyServer)||t.setProxyServer(e.proxyServer),"live"===t.mode&&(t.gatewayClient.role="audience"),"rtc"===t.mode&&(t.gatewayClient.role="host"),t.gatewayClient.on("onMultiIP",(function(e){t.gatewayClient.closeGateway(),t.gatewayClient.socket=void 0,t.gatewayClient.hasChangeBGPAddress=!0,t.joinInfo.multiIP=e.option,t.gatewayClient.state=Ke.CONNECTING;var n=function(e){a.default.info("[".concat(t.clientId,"] Joining channel: ").concat(t.channel)),t.joinInfo.cid=e.cid,t.joinInfo.uid||(t.joinInfo.uid=e.uid),t.joinInfo.uni_lbs_ip=e.uni_lbs_ip,t.joinInfo.gatewayAddr=e.gateway_addr,t.onSuccess?t.gatewayClient.join(t.joinInfo,t.key,(function(e){a.default.info("[".concat(t.clientId,"] Join channel ").concat(t.channel," success"));var n=t.onSuccess;t.onSuccess=null,t.onFailure=null,n(e)}),t.onFailure):(t.gatewayClient.joinInfo=y()({},t.joinInfo),t.gatewayClient.rejoin())};t.joinInfo.stringUid&&!t.joinInfo.uid?(t.userAccountReq&&!t.userAccountReq.isFinished()&&t.userAccountReq.cancel(),t.userAccountReq=Be(joinInfo,t.gatewayClient),t.userAccountReq.then((function(e){a.default.error("getUserAccount Success ".concat(e.url," ").concat(joinInfo.stringUid," => ").concat(e.uid)),t.joinInfo.uid=e.uid,Ue(t.joinInfo,n,t.onFailure)})).catch((function(e){a.default.error("getUserAccount rejected",e),t.onFailure(e)}))):Ue(t.joinInfo,n,t.onFailure)})),t.gatewayClient.on("rejoin-start",(function(){t._renewSession(),s.b.sessionInit(e.sessionId,{lts:(new Date).getTime(),extend:{rejoin:!0},cname:t.channel,appid:e.appId,mode:e.mode,succ:!0})})),t.gatewayClient.on("recover",(function(){t._renewSession(),console.log("recover",e.sessionId),s.b.sessionInit(e.sessionId,{lts:(new Date).getTime(),extend:{recover:!0},cname:t.channel,appid:e.appId,mode:e.mode,succ:!0})})),t.gatewayClient.on("rejoin",(function(){var e=t.highStreamState;if(a.default.debug("[".concat(t.clientId,"] Client local stream preState: ").concat(e)),t.onSuccess){var n=t.onSuccess;t.onSuccess=null,t.onFailure=null,n()}!t.highStream||0!==e&&1!==e||(a.default.info("[".concat(t.clientId,"] publish after rejoin")),t.highStreamState=2,t.lowStreamState=2,t.publish(t.highStream,(function(e){e&&a.default.info("[".concat(t.clientId,"] "),e)})))})),t.gatewayClient.on("streamPublished",(function(e){t.hasPublished||(t.hasPublished=!0,t.gatewayClient.dispatchEvent(l({type:"stream-published",stream:e.stream})))})),t.gatewayClient.on("pubP2PLost",(function(e){a.default.debug("[".concat(t.clientId,"] Start reconnect local peerConnection: ").concat(t.highStream.getId())),t.gatewayClient.dispatchEvent({type:"stream-reconnect-start",uid:t.highStream.getId()}),1===t.highStreamState&&(t.highStreamState=0,t.lowStreamState=0),t._unpublish(t.highStream,(function(){t._publish(t.highStream,(function(){a.default.debug("[".concat(t.clientId,"] Reconnect local peerConnection success: ").concat(t.highStream.getId())),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:t.highStream.getId(),success:!0,reason:""})}),(function(e){a.default.debug("[".concat(t.clientId,"] Reconnect local peerConnection failed: ").concat(e)),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:t.highStream.getId(),success:!1,reason:e})}),!0)}),(function(e){a.default.debug("[".concat(t.clientId,"] Reconnect local peerConnection failed: ").concat(e)),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:t.highStream.getId(),success:!1,reason:e})}),!0)})),t.gatewayClient.on("subP2PLost",(function(e){a.default.debug("[".concat(t.clientId,"] Start reconnect remote peerConnection: ").concat(e.stream.getId()," ").concat(e.stream.subscribeOptions)),t.gatewayClient.dispatchEvent({type:"stream-reconnect-start",uid:e.stream.getId()});var n=e.stream.subscribeOptions;console.log("Re-subscribe stream",n,e.stream),t.gatewayClient.unsubscribe(e.stream,(function(){e.stream.subscribeOptions=n,t.gatewayClient.subscribe(e.stream,(function(){a.default.debug("[".concat(t.clientId,"] Reconnect remote peerConnection success: ").concat(e.stream.getId())),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:e.stream.getId(),success:!1,reason:""})}),(function(n){a.default.debug("[".concat(t.clientId,"] Reconnect remote peerConnection failed: "),n),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:e.stream.getId(),success:!1,reason:n})}))}),(function(n){a.default.debug("[".concat(t.clientId,"] Reconnect remote peerConnection failed: "),n),t.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:e.stream.getId(),success:!1,reason:n})}))})),tt.on("networkTypeChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=y()({},e,{type:"network-type-changed"});t.gatewayClient.dispatchEvent(n)})),D.on("recordingDeviceChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=y()({},e,{type:"recording-device-changed"});t.gatewayClient.dispatchEvent(n)})),D.on("playoutDeviceChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=y()({},e,{type:"playout-device-changed"});t.gatewayClient.dispatchEvent(n)})),D.on("cameraChanged",(function(e){t.gatewayClient&&t.gatewayClient.dispatchEvent(e);var n=y()({},e,{type:"camera-changed"});t.gatewayClient.dispatchEvent(n)})),t.gatewayClient.on("streamTypeChange",(function(n){var r=y()({},n,{type:"stream-type-changed"});t.gatewayClient.dispatchEvent(r),s.b.reportApiInvoke(e.sessionId,{name:"streamTypeChange"})(null,JSON.stringify(n))})),t},wt=D.getDevices,It=L,Tt=JSON.parse(JSON.stringify(o.SUPPORT_RESOLUTION_LIST));n.default={TranscodingUser:{uid:0,x:0,y:0,width:0,height:0,zOrder:0,alpha:1},LiveTranscoding:{width:640,height:360,videoBitrate:400,videoFramerate:15,lowLatency:!1,audioSampleRate:48e3,audioBitrate:48,audioChannels:1,videoGop:30,videoCodecProfile:100,userCount:0,userConfigExtraInfo:{},backgroundColor:0,transcodingUsers:[]},createClient:function(e){var t=s.b.reportApiInvoke(null,{name:"createClient",options:arguments,tag:"tracer"});(e=y()({},e||{})).codec||(e.codec=function(e){switch(e){case"h264_interop":return"h264";default:return"vp8"}}(e.mode));var n=function(e){return-1===Te.indexOf(e.mode)?S.default.INVALID_CLIENT_MODE:-1===Oe.indexOf(e.codec)?S.default.INVALID_CLIENT_CODEC:"h264_interop"==e.mode&&"h264"!==e.codec&&S.default.CLIENT_MODE_CODEC_MISMATCH}(e);if(n)throw a.default.error("Invalid parameter setting MODE: ".concat(e.mode," CODEC: ").concat(e.codec," ERROR ").concat(n)),t(n),new Error(n);return a.default.info("Creating client, MODE: ".concat(e.mode," CODEC: ").concat(e.codec)),function(e){switch(e.mode){case"interop":case"h264_interop":e.mode="live";break;case"web-only":e.mode="rtc"}}(e),t(null,e),Et(e)},createStream:function(e){var t=s.b.reportApiInvoke(null,{name:"createStream",options:arguments,tag:"tracer",getStates:function(){return{audioTrackEnable:e&&e.audioSource?e.audioSource.enabled:null,videoTrackEnable:e&&e.videoSource?e.videoSource.enabled:null}}});Object(U.checkValidObject)(e,"StreamSpec");var n=e.streamID,r=e.audio,i=e.video,o=e.screen,u=e.screenAudio,c=(e.audioSource,e.videoSource,e.cameraId),l=e.facingMode,d=e.microphoneId,p=e.mirror,f=e.extensionId,h=e.mediaSource,g=e.audioProcessing;if(!Object(U.isEmpty)(n)&&!Object($.is32Uint)(n)&&!Object(U.isValidString)(n,1,255))throw new Error("[String streamID] Length of the string: [1,255]. ASCII characters only. [Number streamID] The value range is Uint32");if(Object(U.checkValidBoolean)(r,"audio"),Object(U.checkValidBoolean)(i,"video"),Object(U.isEmpty)(o)||Object(U.checkValidBoolean)(o,"screen"),Object(U.isEmpty)(u)||Object(U.checkValidBoolean)(u,"screenAudio"),Object(U.isEmpty)(c)||Object(U.checkValidString)(c,"cameraId",0,255,!1),Object(U.isEmpty)(l)||Object(U.checkValidEnum)(l,"facingMode",["user","environment","left","right"]),Object(U.isEmpty)(d)||Object(U.checkValidString)(d,"microphoneId",0,255,!1),Object(U.isEmpty)(f)||Object(U.checkValidString)(f,"extensionId"),Object(U.isEmpty)(h)||Object(U.checkValidEnum)(h,"mediaSource",["screen","application","window"]),Object(U.isEmpty)(p)||Object(U.checkValidBoolean)(p,"mirror"),!Object(U.isEmpty)(g)){var m=g.AGC,v=g.AEC,y=g.ANS;Object(U.isEmpty)(m)||Object(U.checkValidBoolean)(m,"AGC"),Object(U.isEmpty)(v)||Object(U.checkValidBoolean)(v,"AEC"),Object(U.isEmpty)(y)||Object(U.checkValidBoolean)(y,"ANS")}a.default.debug("Create stream"),!0===u&&!0===r&&a.default.warning("Do not set both 'screenAudio' and 'audio' to true at the same time");var _=Se(e);return t(),_},Logger:a.default,report:s.b,getDevices:wt,getScreenSources:It,getParameter:o.getParameter,setParameter:o.setParameter,checkSystemRequirements:function(){var e=s.b.reportApiInvoke(null,{name:"checkSystemRequirements",options:arguments,tag:"tracer"}),t=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,n=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,r=window.WebSocket,i=!!t&&!!n&&!!r,o=!1;a.default.debug(h.getBrowserInfo(),"isAPISupport:"+i),h.isChrome()&&h.getBrowserVersion()>=58&&"iOS"!==h.getBrowserOS()&&(o=!0),h.isFireFox()&&h.getBrowserVersion()>=56&&(o=!0),h.isOpera()&&h.getBrowserVersion()>=45&&(o=!0),h.isSafari()&&h.getBrowserVersion()>=11&&(o=!0),h.isEdge()&&(o=!0),(h.isWeChatBrowser()||h.isQQBrowser())&&"iOS"!==h.getBrowserOS()&&(o=!0),h.isSupportedPC()||h.isSupportedMobile()||(o=!1);var u=i&&o;return e(null,u),u},getSupportedCodec:Ee.getSupportedCodec,ChannelMediaRelayConfiguration:we.ChannelMediaRelayConfiguration,VERSION:o.VERSION,BUILD:o.BUILD,PROFILE_TABLE:Tt,AUDIO_SAMPLE_RATE_32000:32e3,AUDIO_SAMPLE_RATE_44100:44100,AUDIO_SAMPLE_RATE_48000:48e3,VIDEO_CODEC_PROFILE_BASELINE:66,VIDEO_CODEC_PROFILE_MAIN:77,VIDEO_CODEC_PROFILE_HIGH:100,REMOTE_VIDEO_STREAM_HIGH:0,REMOTE_VIDEO_STREAM_LOW:1,REMOTE_VIDEO_STREAM_MEDIUM:2}}]).default})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).AgoraRTM=t()}(this,(function(){"use strict";var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var _global=createCommonjsModule((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),_core=createCommonjsModule((function(e){var t=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=t)})),_core_1=_core.version,_isObject=function(e){return"object"==typeof e?null!==e:"function"==typeof e},_anObject=function(e){if(!_isObject(e))throw TypeError(e+" is not an object!");return e},_fails=function(e){try{return!!e()}catch(e){return!0}},_descriptors=!_fails((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),document$1=_global.document,is=_isObject(document$1)&&_isObject(document$1.createElement),_domCreate=function(e){return is?document$1.createElement(e):{}},_ie8DomDefine=!_descriptors&&!_fails((function(){return 7!=Object.defineProperty(_domCreate("div"),"a",{get:function(){return 7}}).a})),_toPrimitive=function(e,t){if(!_isObject(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!_isObject(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!_isObject(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!_isObject(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},dP=Object.defineProperty,f=_descriptors?Object.defineProperty:function(e,t,n){if(_anObject(e),t=_toPrimitive(t,!0),_anObject(n),_ie8DomDefine)try{return dP(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e},_objectDp={f:f},_propertyDesc=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},_hide=_descriptors?function(e,t,n){return _objectDp.f(e,t,_propertyDesc(1,n))}:function(e,t,n){return e[t]=n,e},hasOwnProperty={}.hasOwnProperty,_has=function(e,t){return hasOwnProperty.call(e,t)},id=0,px=Math.random(),_uid=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++id+px).toString(36))},_library=!1,_shared=createCommonjsModule((function(e){var t=_global["__core-js_shared__"]||(_global["__core-js_shared__"]={});(e.exports=function(e,n){return t[e]||(t[e]=void 0!==n?n:{})})("versions",[]).push({version:_core.version,mode:"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})})),_functionToString=_shared("native-function-to-string",Function.toString),_redefine=createCommonjsModule((function(e){var t=_uid("src"),n=(""+_functionToString).split("toString");_core.inspectSource=function(e){return _functionToString.call(e)},(e.exports=function(e,r,i,o){var a="function"==typeof i;a&&(_has(i,"name")||_hide(i,"name",r)),e[r]!==i&&(a&&(_has(i,t)||_hide(i,t,e[r]?""+e[r]:n.join(String(r)))),e===_global?e[r]=i:o?e[r]?e[r]=i:_hide(e,r,i):(delete e[r],_hide(e,r,i)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[t]||_functionToString.call(this)}))})),_aFunction=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},_ctx=function(e,t,n){if(_aFunction(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},PROTOTYPE="prototype",$export=function(e,t,n){var r,i,o,a,s=e&$export.F,u=e&$export.G,c=e&$export.S,l=e&$export.P,d=e&$export.B,p=u?_global:c?_global[t]||(_global[t]={}):(_global[t]||{})[PROTOTYPE],f=u?_core:_core[t]||(_core[t]={}),h=f[PROTOTYPE]||(f[PROTOTYPE]={});for(r in u&&(n=t),n)o=((i=!s&&p&&void 0!==p[r])?p:n)[r],a=d&&i?_ctx(o,_global):l&&"function"==typeof o?_ctx(Function.call,o):o,p&&_redefine(p,r,o,e&$export.U),f[r]!=o&&_hide(f,r,a),l&&h[r]!=o&&(h[r]=o)};_global.core=_core,$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128;var _export=$export,toString={}.toString,_cof=function(e){return toString.call(e).slice(8,-1)},_iobject=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==_cof(e)?e.split(""):Object(e)},_defined=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},_toIobject=function(e){return _iobject(_defined(e))},ceil=Math.ceil,floor=Math.floor,_toInteger=function(e){return isNaN(e=+e)?0:(e>0?floor:ceil)(e)},min=Math.min,_toLength=function(e){return e>0?min(_toInteger(e),9007199254740991):0},max=Math.max,min$1=Math.min,_toAbsoluteIndex=function(e,t){return(e=_toInteger(e))<0?max(e+t,0):min$1(e,t)},_arrayIncludes=function(e){return function(t,n,r){var i,o=_toIobject(t),a=_toLength(o.length),s=_toAbsoluteIndex(r,a);if(e&&n!=n){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===n)return e||s||0;return!e&&-1}},shared=_shared("keys"),_sharedKey=function(e){return shared[e]||(shared[e]=_uid(e))},arrayIndexOf=_arrayIncludes(!1),IE_PROTO=_sharedKey("IE_PROTO"),_objectKeysInternal=function(e,t){var n,r=_toIobject(e),i=0,o=[];for(n in r)n!=IE_PROTO&&_has(r,n)&&o.push(n);for(;t.length>i;)_has(r,n=t[i++])&&(~arrayIndexOf(o,n)||o.push(n));return o},_enumBugKeys="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),_objectKeys=Object.keys||function(e){return _objectKeysInternal(e,_enumBugKeys)},f$1={}.propertyIsEnumerable,_objectPie={f:f$1},isEnum=_objectPie.f,_objectToArray=function(e){return function(t){for(var n,r=_toIobject(t),i=_objectKeys(r),o=i.length,a=0,s=[];o>a;)n=i[a++],_descriptors&&!isEnum.call(r,n)||s.push(e?[n,r[n]]:r[n]);return s}},$entries=_objectToArray(!0);_export(_export.S,"Object",{entries:function(e){return $entries(e)}});var _stringRepeat=function(e){var t=String(_defined(this)),n="",r=_toInteger(e);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n},_stringPad=function(e,t,n,r){var i=String(_defined(e)),o=i.length,a=void 0===n?" ":String(n),s=_toLength(t);if(s<=o||""==a)return i;var u=s-o,c=_stringRepeat.call(a,Math.ceil(u/a.length));return c.length>u&&(c=c.slice(0,u)),r?c+i:i+c},navigator$1=_global.navigator,_userAgent=navigator$1&&navigator$1.userAgent||"",WEBKIT_BUG=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(_userAgent);_export(_export.P+_export.F*WEBKIT_BUG,"String",{padEnd:function(e){return _stringPad(this,e,arguments.length>1?arguments[1]:void 0,!1)}});var WEBKIT_BUG$1=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(_userAgent);_export(_export.P+_export.F*WEBKIT_BUG$1,"String",{padStart:function(e){return _stringPad(this,e,arguments.length>1?arguments[1]:void 0,!0)}});var _wks=createCommonjsModule((function(e){var t=_shared("wks"),n=_global.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:_uid)("Symbol."+e))}).store=t})),MATCH=_wks("match"),_isRegexp=function(e){var t;return _isObject(e)&&(void 0!==(t=e[MATCH])?!!t:"RegExp"==_cof(e))},_stringContext=function(e,t,n){if(_isRegexp(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(_defined(e))},MATCH$1=_wks("match"),_failsIsRegexp=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[MATCH$1]=!1,!"/./"[e](t)}catch(e){}}return!0},STARTS_WITH="startsWith",$startsWith=""[STARTS_WITH];_export(_export.P+_export.F*_failsIsRegexp(STARTS_WITH),"String",{startsWith:function(e){var t=_stringContext(this,e,STARTS_WITH),n=_toLength(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return $startsWith?$startsWith.call(t,r,n):t.slice(n,n+r.length)===r}});var ENDS_WITH="endsWith",$endsWith=""[ENDS_WITH];_export(_export.P+_export.F*_failsIsRegexp(ENDS_WITH),"String",{endsWith:function(e){var t=_stringContext(this,e,ENDS_WITH),n=arguments.length>1?arguments[1]:void 0,r=_toLength(t.length),i=void 0===n?r:Math.min(_toLength(n),r),o=String(e);return $endsWith?$endsWith.call(t,o,i):t.slice(i-o.length,i)===o}});var UNSCOPABLES=_wks("unscopables"),ArrayProto=Array.prototype;null==ArrayProto[UNSCOPABLES]&&_hide(ArrayProto,UNSCOPABLES,{});var _addToUnscopables=function(e){ArrayProto[UNSCOPABLES][e]=!0},$includes=_arrayIncludes(!0);_export(_export.P,"Array",{includes:function(e){return $includes(this,e,arguments.length>1?arguments[1]:void 0)}}),_addToUnscopables("includes");var _toObject=function(e){return Object(_defined(e))},_iterCall=function(e,t,n,r){try{return r?t(_anObject(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&_anObject(i.call(e)),t}},_iterators={},ITERATOR=_wks("iterator"),ArrayProto$1=Array.prototype,_isArrayIter=function(e){return void 0!==e&&(_iterators.Array===e||ArrayProto$1[ITERATOR]===e)},_createProperty=function(e,t,n){t in e?_objectDp.f(e,t,_propertyDesc(0,n)):e[t]=n},TAG=_wks("toStringTag"),ARG="Arguments"==_cof(function(){return arguments}()),tryGet=function(e,t){try{return e[t]}catch(e){}},_classof=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=tryGet(t=Object(e),TAG))?n:ARG?_cof(t):"Object"==(r=_cof(t))&&"function"==typeof t.callee?"Arguments":r},ITERATOR$1=_wks("iterator"),core_getIteratorMethod=_core.getIteratorMethod=function(e){if(null!=e)return e[ITERATOR$1]||e["@@iterator"]||_iterators[_classof(e)]},ITERATOR$2=_wks("iterator"),SAFE_CLOSING=!1;try{var riter=[7][ITERATOR$2]();riter.return=function(){SAFE_CLOSING=!0},Array.from(riter,(function(){throw 2}))}catch(e){}var _iterDetect=function(e,t){if(!t&&!SAFE_CLOSING)return!1;var n=!1;try{var r=[7],i=r[ITERATOR$2]();i.next=function(){return{done:n=!0}},r[ITERATOR$2]=function(){return i},e(r)}catch(e){}return n};_export(_export.S+_export.F*!_iterDetect((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,r,i,o=_toObject(e),a="function"==typeof this?this:Array,s=arguments.length,u=s>1?arguments[1]:void 0,c=void 0!==u,l=0,d=core_getIteratorMethod(o);if(c&&(u=_ctx(u,s>2?arguments[2]:void 0,2)),null==d||a==Array&&_isArrayIter(d))for(n=new a(t=_toLength(o.length));t>l;l++)_createProperty(n,l,c?u(o[l],l):o[l]);else for(i=d.call(o),n=new a;!(r=i.next()).done;l++)_createProperty(n,l,c?_iterCall(i,u,[r.value,l],!0):r.value);return n.length=l,n}});var INCLUDES="includes";_export(_export.P+_export.F*_failsIsRegexp(INCLUDES),"String",{includes:function(e){return!!~_stringContext(this,e,INCLUDES).indexOf(e,arguments.length>1?arguments[1]:void 0)}});var _sameValue=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t},builtinExec=RegExp.prototype.exec,_regexpExecAbstract=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==_classof(e))throw new TypeError("RegExp#exec called on incompatible receiver");return builtinExec.call(e,t)},_flags=function(){var e=_anObject(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},nativeExec=RegExp.prototype.exec,nativeReplace=String.prototype.replace,patchedExec=nativeExec,LAST_INDEX="lastIndex",UPDATES_LAST_INDEX_WRONG=function(){var e=/a/,t=/b*/g;return nativeExec.call(e,"a"),nativeExec.call(t,"a"),0!==e[LAST_INDEX]||0!==t[LAST_INDEX]}(),NPCG_INCLUDED=void 0!==/()??/.exec("")[1],PATCH=UPDATES_LAST_INDEX_WRONG||NPCG_INCLUDED;PATCH&&(patchedExec=function(e){var t,n,r,i,o=this;return NPCG_INCLUDED&&(n=new RegExp("^"+o.source+"$(?!\\s)",_flags.call(o))),UPDATES_LAST_INDEX_WRONG&&(t=o[LAST_INDEX]),r=nativeExec.call(o,e),UPDATES_LAST_INDEX_WRONG&&r&&(o[LAST_INDEX]=o.global?r.index+r[0].length:t),NPCG_INCLUDED&&r&&r.length>1&&nativeReplace.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r});var _regexpExec=patchedExec;_export({target:"RegExp",proto:!0,forced:_regexpExec!==/./.exec},{exec:_regexpExec});var SPECIES=_wks("species"),REPLACE_SUPPORTS_NAMED_GROUPS=!_fails((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),SPLIT_WORKS_WITH_OVERWRITTEN_EXEC=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}(),_fixReWks=function(e,t,n){var r=_wks(e),i=!_fails((function(){var t={};return t[r]=function(){return 7},7!=""[e](t)})),o=i?!_fails((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[SPECIES]=function(){return n}),n[r](""),!t})):void 0;if(!i||!o||"replace"===e&&!REPLACE_SUPPORTS_NAMED_GROUPS||"split"===e&&!SPLIT_WORKS_WITH_OVERWRITTEN_EXEC){var a=/./[r],s=n(_defined,r,""[e],(function(e,t,n,r,o){return t.exec===_regexpExec?i&&!o?{done:!0,value:a.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),u=s[0],c=s[1];_redefine(String.prototype,e,u),_hide(RegExp.prototype,r,2==t?function(e,t){return c.call(e,this,t)}:function(e){return c.call(e,this)})}};_fixReWks("search",1,(function(e,t,n,r){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=r(n,e,this);if(t.done)return t.value;var i=_anObject(e),o=String(this),a=i.lastIndex;_sameValue(a,0)||(i.lastIndex=0);var s=_regexpExecAbstract(i,o);return _sameValue(i.lastIndex,a)||(i.lastIndex=a),null===s?-1:s.index}]}));var SPECIES$1=_wks("species"),_speciesConstructor=function(e,t){var n,r=_anObject(e).constructor;return void 0===r||null==(n=_anObject(r)[SPECIES$1])?t:_aFunction(n)},_stringAt=function(e){return function(t,n){var r,i,o=String(_defined(t)),a=_toInteger(n),s=o.length;return a<0||a>=s?e?"":void 0:(r=o.charCodeAt(a))<55296||r>56319||a+1===s||(i=o.charCodeAt(a+1))<56320||i>57343?e?o.charAt(a):r:e?o.slice(a,a+2):i-56320+(r-55296<<10)+65536}},at=_stringAt(!0),_advanceStringIndex=function(e,t,n){return t+(n?at(e,t).length:1)},$min=Math.min,$push=[].push,$SPLIT="split",LENGTH="length",LAST_INDEX$1="lastIndex",MAX_UINT32=4294967295,SUPPORTS_Y=!_fails((function(){RegExp(MAX_UINT32,"y")}));_fixReWks("split",2,(function(e,t,n,r){var i;return i="c"=="abbc"[$SPLIT](/(b)*/)[1]||4!="test"[$SPLIT](/(?:)/,-1)[LENGTH]||2!="ab"[$SPLIT](/(?:ab)*/)[LENGTH]||4!="."[$SPLIT](/(.?)(.?)/)[LENGTH]||"."[$SPLIT](/()()/)[LENGTH]>1||""[$SPLIT](/.?/)[LENGTH]?function(e,t){var r=String(this);if(void 0===e&&0===t)return[];if(!_isRegexp(e))return n.call(r,e,t);for(var i,o,a,s=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),c=0,l=void 0===t?MAX_UINT32:t>>>0,d=new RegExp(e.source,u+"g");(i=_regexpExec.call(d,r))&&!((o=d[LAST_INDEX$1])>c&&(s.push(r.slice(c,i.index)),i[LENGTH]>1&&i.index<r[LENGTH]&&$push.apply(s,i.slice(1)),a=i[0][LENGTH],c=o,s[LENGTH]>=l));)d[LAST_INDEX$1]===i.index&&d[LAST_INDEX$1]++;return c===r[LENGTH]?!a&&d.test("")||s.push(""):s.push(r.slice(c)),s[LENGTH]>l?s.slice(0,l):s}:"0"[$SPLIT](void 0,0)[LENGTH]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,r){var o=e(this),a=null==n?void 0:n[t];return void 0!==a?a.call(n,o,r):i.call(String(o),n,r)},function(e,t){var o=r(i,e,this,t,i!==n);if(o.done)return o.value;var a=_anObject(e),s=String(this),u=_speciesConstructor(a,RegExp),c=a.unicode,l=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(SUPPORTS_Y?"y":"g"),d=new u(SUPPORTS_Y?a:"^(?:"+a.source+")",l),p=void 0===t?MAX_UINT32:t>>>0;if(0===p)return[];if(0===s.length)return null===_regexpExecAbstract(d,s)?[s]:[];for(var f=0,h=0,g=[];h<s.length;){d.lastIndex=SUPPORTS_Y?h:0;var m,v=_regexpExecAbstract(d,SUPPORTS_Y?s:s.slice(h));if(null===v||(m=$min(_toLength(d.lastIndex+(SUPPORTS_Y?0:h)),s.length))===f)h=_advanceStringIndex(s,h,c);else{if(g.push(s.slice(f,h)),g.length===p)return g;for(var y=1;y<=v.length-1;y++)if(g.push(v[y]),g.length===p)return g;h=f=m}}return g.push(s.slice(f)),g}]}));var _strictMethod=function(e,t){return!!e&&_fails((function(){t?e.call(null,(function(){}),1):e.call(null)}))},$sort=[].sort,test=[1,2,3];_export(_export.P+_export.F*(_fails((function(){test.sort(void 0)}))||!_fails((function(){test.sort(null)}))||!_strictMethod($sort)),"Array",{sort:function(e){return void 0===e?$sort.call(_toObject(this)):$sort.call(_toObject(this),_aFunction(e))}});var _iterStep=function(e,t){return{value:t,done:!!e}},_objectDps=_descriptors?Object.defineProperties:function(e,t){_anObject(e);for(var n,r=_objectKeys(t),i=r.length,o=0;i>o;)_objectDp.f(e,n=r[o++],t[n]);return e},document$2=_global.document,_html=document$2&&document$2.documentElement,IE_PROTO$1=_sharedKey("IE_PROTO"),Empty=function(){},PROTOTYPE$1="prototype",createDict=function(){var e,t=_domCreate("iframe"),n=_enumBugKeys.length;for(t.style.display="none",_html.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),createDict=e.F;n--;)delete createDict[PROTOTYPE$1][_enumBugKeys[n]];return createDict()},_objectCreate=Object.create||function(e,t){var n;return null!==e?(Empty[PROTOTYPE$1]=_anObject(e),n=new Empty,Empty[PROTOTYPE$1]=null,n[IE_PROTO$1]=e):n=createDict(),void 0===t?n:_objectDps(n,t)},def=_objectDp.f,TAG$1=_wks("toStringTag"),_setToStringTag=function(e,t,n){e&&!_has(e=n?e:e.prototype,TAG$1)&&def(e,TAG$1,{configurable:!0,value:t})},IteratorPrototype={};_hide(IteratorPrototype,_wks("iterator"),(function(){return this}));var _iterCreate=function(e,t,n){e.prototype=_objectCreate(IteratorPrototype,{next:_propertyDesc(1,n)}),_setToStringTag(e,t+" Iterator")},IE_PROTO$2=_sharedKey("IE_PROTO"),ObjectProto=Object.prototype,_objectGpo=Object.getPrototypeOf||function(e){return e=_toObject(e),_has(e,IE_PROTO$2)?e[IE_PROTO$2]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?ObjectProto:null},ITERATOR$3=_wks("iterator"),BUGGY=!([].keys&&"next"in[].keys()),FF_ITERATOR="@@iterator",KEYS="keys",VALUES="values",returnThis=function(){return this},_iterDefine=function(e,t,n,r,i,o,a){_iterCreate(n,t,r);var s,u,c,l=function(e){if(!BUGGY&&e in h)return h[e];switch(e){case KEYS:case VALUES:return function(){return new n(this,e)}}return function(){return new n(this,e)}},d=t+" Iterator",p=i==VALUES,f=!1,h=e.prototype,g=h[ITERATOR$3]||h[FF_ITERATOR]||i&&h[i],m=g||l(i),v=i?p?l("entries"):m:void 0,y="Array"==t&&h.entries||g;if(y&&(c=_objectGpo(y.call(new e)))!==Object.prototype&&c.next&&(_setToStringTag(c,d,!0),"function"!=typeof c[ITERATOR$3]&&_hide(c,ITERATOR$3,returnThis)),p&&g&&g.name!==VALUES&&(f=!0,m=function(){return g.call(this)}),(BUGGY||f||!h[ITERATOR$3])&&_hide(h,ITERATOR$3,m),_iterators[t]=m,_iterators[d]=returnThis,i)if(s={values:p?m:l(VALUES),keys:o?m:l(KEYS),entries:v},a)for(u in s)u in h||_redefine(h,u,s[u]);else _export(_export.P+_export.F*(BUGGY||f),t,s);return s},es6_array_iterator=_iterDefine(Array,"Array",(function(e,t){this._t=_toIobject(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,_iterStep(1)):_iterStep(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values");_iterators.Arguments=_iterators.Array,_addToUnscopables("keys"),_addToUnscopables("values"),_addToUnscopables("entries");for(var ITERATOR$4=_wks("iterator"),TO_STRING_TAG=_wks("toStringTag"),ArrayValues=_iterators.Array,DOMIterables={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},collections=_objectKeys(DOMIterables),i=0;i<collections.length;i++){var NAME=collections[i],explicit=DOMIterables[NAME],Collection=_global[NAME],proto=Collection&&Collection.prototype,key;if(proto&&(proto[ITERATOR$4]||_hide(proto,ITERATOR$4,ArrayValues),proto[TO_STRING_TAG]||_hide(proto,TO_STRING_TAG,NAME),_iterators[NAME]=ArrayValues,explicit))for(key in es6_array_iterator)proto[key]||_redefine(proto,key,es6_array_iterator[key],!0)}var dP$1=_objectDp.f,FProto=Function.prototype,nameRE=/^\s*function ([^ (]*)/,NAME$1="name";NAME$1 in FProto||_descriptors&&dP$1(FProto,NAME$1,{configurable:!0,get:function(){try{return(""+this).match(nameRE)[1]}catch(e){return""}}}),_descriptors&&"g"!=/./g.flags&&_objectDp.f(RegExp.prototype,"flags",{configurable:!0,get:_flags});var TO_STRING="toString",$toString=/./[TO_STRING],define=function(e){_redefine(RegExp.prototype,TO_STRING,e,!0)};_fails((function(){return"/a/b"!=$toString.call({source:"a",flags:"b"})}))?define((function(){var e=_anObject(this);return"/".concat(e.source,"/","flags"in e?e.flags:!_descriptors&&e instanceof RegExp?_flags.call(e):void 0)})):$toString.name!=TO_STRING&&define((function(){return $toString.call(this)}));var test$1={};function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep(o,r,i,a,s,"throw",e)}a(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(n,!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _construct(e,t,n){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&_setPrototypeOf(i,n.prototype),i}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,e)})(e)}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}function _objectWithoutProperties(e,t){if(null==e)return{};var n,r,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _iterableToArrayLimit(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}test$1[_wks("toStringTag")]="z",test$1+""!="[object z]"&&_redefine(Object.prototype,"toString",(function(){return"[object "+_classof(this)+"]"}),!0);var max$1=Math.max,min$2=Math.min,floor$1=Math.floor,SUBSTITUTION_SYMBOLS=/\$([$&`']|\d\d?|<[^>]*>)/g,SUBSTITUTION_SYMBOLS_NO_NAMED=/\$([$&`']|\d\d?)/g,maybeToString=function(e){return void 0===e?e:String(e)};_fixReWks("replace",2,(function(e,t,n,r){return[function(r,i){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(e,t){var o=r(n,e,this,t);if(o.done)return o.value;var a=_anObject(e),s=String(this),u="function"==typeof t;u||(t=String(t));var c=a.global;if(c){var l=a.unicode;a.lastIndex=0}for(var d=[];;){var p=_regexpExecAbstract(a,s);if(null===p)break;if(d.push(p),!c)break;""===String(p[0])&&(a.lastIndex=_advanceStringIndex(s,_toLength(a.lastIndex),l))}for(var f="",h=0,g=0;g<d.length;g++){p=d[g];for(var m=String(p[0]),v=max$1(min$2(_toInteger(p.index),s.length),0),y=[],_=1;_<p.length;_++)y.push(maybeToString(p[_]));var b=p.groups;if(u){var S=[m].concat(y,v,s);void 0!==b&&S.push(b);var E=String(t.apply(void 0,S))}else E=i(m,s,v,y,b,t);v>=h&&(f+=s.slice(h,v)+E,h=v+m.length)}return f+s.slice(h)}];function i(e,t,r,i,o,a){var s=r+e.length,u=i.length,c=SUBSTITUTION_SYMBOLS_NO_NAMED;return void 0!==o&&(o=_toObject(o),c=SUBSTITUTION_SYMBOLS),n.call(a,c,(function(n,a){var c;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(s);case"<":c=o[a.slice(1,-1)];break;default:var l=+a;if(0===l)return n;if(l>u){var d=floor$1(l/10);return 0===d?n:d<=u?void 0===i[d-1]?a.charAt(1):i[d-1]+a.charAt(1):n}c=i[l-1]}return void 0===c?"":c}))}}));var f$2=_wks,_wksExt={f:f$2},defineProperty=_objectDp.f,_wksDefine=function(e){var t=_core.Symbol||(_core.Symbol=_global.Symbol||{});"_"==e.charAt(0)||e in t||defineProperty(t,e,{value:_wksExt.f(e)})};_wksDefine("asyncIterator");var _meta=createCommonjsModule((function(e){var t=_uid("meta"),n=_objectDp.f,r=0,i=Object.isExtensible||function(){return!0},o=!_fails((function(){return i(Object.preventExtensions({}))})),a=function(e){n(e,t,{value:{i:"O"+ ++r,w:{}}})},s=e.exports={KEY:t,NEED:!1,fastKey:function(e,n){if(!_isObject(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!_has(e,t)){if(!i(e))return"F";if(!n)return"E";a(e)}return e[t].i},getWeak:function(e,n){if(!_has(e,t)){if(!i(e))return!0;if(!n)return!1;a(e)}return e[t].w},onFreeze:function(e){return o&&s.NEED&&i(e)&&!_has(e,t)&&a(e),e}}})),_meta_1=_meta.KEY,_meta_2=_meta.NEED,_meta_3=_meta.fastKey,_meta_4=_meta.getWeak,_meta_5=_meta.onFreeze,f$3=Object.getOwnPropertySymbols,_objectGops={f:f$3},_enumKeys=function(e){var t=_objectKeys(e),n=_objectGops.f;if(n)for(var r,i=n(e),o=_objectPie.f,a=0;i.length>a;)o.call(e,r=i[a++])&&t.push(r);return t},_isArray=Array.isArray||function(e){return"Array"==_cof(e)},hiddenKeys=_enumBugKeys.concat("length","prototype"),f$4=Object.getOwnPropertyNames||function(e){return _objectKeysInternal(e,hiddenKeys)},_objectGopn={f:f$4},gOPN=_objectGopn.f,toString$1={}.toString,windowNames="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(e){try{return gOPN(e)}catch(e){return windowNames.slice()}},f$5=function(e){return windowNames&&"[object Window]"==toString$1.call(e)?getWindowNames(e):gOPN(_toIobject(e))},_objectGopnExt={f:f$5},gOPD=Object.getOwnPropertyDescriptor,f$6=_descriptors?gOPD:function(e,t){if(e=_toIobject(e),t=_toPrimitive(t,!0),_ie8DomDefine)try{return gOPD(e,t)}catch(e){}if(_has(e,t))return _propertyDesc(!_objectPie.f.call(e,t),e[t])},_objectGopd={f:f$6},META=_meta.KEY,gOPD$1=_objectGopd.f,dP$2=_objectDp.f,gOPN$1=_objectGopnExt.f,$Symbol=_global.Symbol,$JSON=_global.JSON,_stringify=$JSON&&$JSON.stringify,PROTOTYPE$2="prototype",HIDDEN=_wks("_hidden"),TO_PRIMITIVE=_wks("toPrimitive"),isEnum$1={}.propertyIsEnumerable,SymbolRegistry=_shared("symbol-registry"),AllSymbols=_shared("symbols"),OPSymbols=_shared("op-symbols"),ObjectProto$1=Object[PROTOTYPE$2],USE_NATIVE="function"==typeof $Symbol&&!!_objectGops.f,QObject=_global.QObject,setter=!QObject||!QObject[PROTOTYPE$2]||!QObject[PROTOTYPE$2].findChild,setSymbolDesc=_descriptors&&_fails((function(){return 7!=_objectCreate(dP$2({},"a",{get:function(){return dP$2(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=gOPD$1(ObjectProto$1,t);r&&delete ObjectProto$1[t],dP$2(e,t,n),r&&e!==ObjectProto$1&&dP$2(ObjectProto$1,t,r)}:dP$2,wrap=function(e){var t=AllSymbols[e]=_objectCreate($Symbol[PROTOTYPE$2]);return t._k=e,t},isSymbol=USE_NATIVE&&"symbol"==typeof $Symbol.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof $Symbol},$defineProperty=function(e,t,n){return e===ObjectProto$1&&$defineProperty(OPSymbols,t,n),_anObject(e),t=_toPrimitive(t,!0),_anObject(n),_has(AllSymbols,t)?(n.enumerable?(_has(e,HIDDEN)&&e[HIDDEN][t]&&(e[HIDDEN][t]=!1),n=_objectCreate(n,{enumerable:_propertyDesc(0,!1)})):(_has(e,HIDDEN)||dP$2(e,HIDDEN,_propertyDesc(1,{})),e[HIDDEN][t]=!0),setSymbolDesc(e,t,n)):dP$2(e,t,n)},$defineProperties=function(e,t){_anObject(e);for(var n,r=_enumKeys(t=_toIobject(t)),i=0,o=r.length;o>i;)$defineProperty(e,n=r[i++],t[n]);return e},$create=function(e,t){return void 0===t?_objectCreate(e):$defineProperties(_objectCreate(e),t)},$propertyIsEnumerable=function(e){var t=isEnum$1.call(this,e=_toPrimitive(e,!0));return!(this===ObjectProto$1&&_has(AllSymbols,e)&&!_has(OPSymbols,e))&&(!(t||!_has(this,e)||!_has(AllSymbols,e)||_has(this,HIDDEN)&&this[HIDDEN][e])||t)},$getOwnPropertyDescriptor=function(e,t){if(e=_toIobject(e),t=_toPrimitive(t,!0),e!==ObjectProto$1||!_has(AllSymbols,t)||_has(OPSymbols,t)){var n=gOPD$1(e,t);return!n||!_has(AllSymbols,t)||_has(e,HIDDEN)&&e[HIDDEN][t]||(n.enumerable=!0),n}},$getOwnPropertyNames=function(e){for(var t,n=gOPN$1(_toIobject(e)),r=[],i=0;n.length>i;)_has(AllSymbols,t=n[i++])||t==HIDDEN||t==META||r.push(t);return r},$getOwnPropertySymbols=function(e){for(var t,n=e===ObjectProto$1,r=gOPN$1(n?OPSymbols:_toIobject(e)),i=[],o=0;r.length>o;)!_has(AllSymbols,t=r[o++])||n&&!_has(ObjectProto$1,t)||i.push(AllSymbols[t]);return i};USE_NATIVE||($Symbol=function(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor!");var e=_uid(arguments.length>0?arguments[0]:void 0),t=function(n){this===ObjectProto$1&&t.call(OPSymbols,n),_has(this,HIDDEN)&&_has(this[HIDDEN],e)&&(this[HIDDEN][e]=!1),setSymbolDesc(this,e,_propertyDesc(1,n))};return _descriptors&&setter&&setSymbolDesc(ObjectProto$1,e,{configurable:!0,set:t}),wrap(e)},_redefine($Symbol[PROTOTYPE$2],"toString",(function(){return this._k})),_objectGopd.f=$getOwnPropertyDescriptor,_objectDp.f=$defineProperty,_objectGopn.f=_objectGopnExt.f=$getOwnPropertyNames,_objectPie.f=$propertyIsEnumerable,_objectGops.f=$getOwnPropertySymbols,_descriptors&&!_library&&_redefine(ObjectProto$1,"propertyIsEnumerable",$propertyIsEnumerable,!0),_wksExt.f=function(e){return wrap(_wks(e))}),_export(_export.G+_export.W+_export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),j=0;es6Symbols.length>j;)_wks(es6Symbols[j++]);for(var wellKnownSymbols=_objectKeys(_wks.store),k=0;wellKnownSymbols.length>k;)_wksDefine(wellKnownSymbols[k++]);_export(_export.S+_export.F*!USE_NATIVE,"Symbol",{for:function(e){return _has(SymbolRegistry,e+="")?SymbolRegistry[e]:SymbolRegistry[e]=$Symbol(e)},keyFor:function(e){if(!isSymbol(e))throw TypeError(e+" is not a symbol!");for(var t in SymbolRegistry)if(SymbolRegistry[t]===e)return t},useSetter:function(){setter=!0},useSimple:function(){setter=!1}}),_export(_export.S+_export.F*!USE_NATIVE,"Object",{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols});var FAILS_ON_PRIMITIVES=_fails((function(){_objectGops.f(1)}));_export(_export.S+_export.F*FAILS_ON_PRIMITIVES,"Object",{getOwnPropertySymbols:function(e){return _objectGops.f(_toObject(e))}}),$JSON&&_export(_export.S+_export.F*(!USE_NATIVE||_fails((function(){var e=$Symbol();return"[null]"!=_stringify([e])||"{}"!=_stringify({a:e})||"{}"!=_stringify(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(_isObject(t)||void 0!==e)&&!isSymbol(e))return _isArray(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!isSymbol(t))return t}),r[1]=t,_stringify.apply($JSON,r)}}),$Symbol[PROTOTYPE$2][TO_PRIMITIVE]||_hide($Symbol[PROTOTYPE$2],TO_PRIMITIVE,$Symbol[PROTOTYPE$2].valueOf),_setToStringTag($Symbol,"Symbol"),_setToStringTag(Math,"Math",!0),_setToStringTag(_global.JSON,"JSON",!0),function(e){var t=function(){try{return!!Symbol.iterator}catch(e){return!1}}(),n=function(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t&&(n[Symbol.iterator]=function(){return n}),n},r=function(e){return encodeURIComponent(e).replace(/%20/g,"+")},i=function(e){return decodeURIComponent(String(e).replace(/\+/g," "))};(function(){try{var t=e.URLSearchParams;return"a=1"===new t("?a=1").toString()&&"function"==typeof t.prototype.set}catch(e){return!1}})()||function(){var i=function e(t){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var n=_typeof(t);if("undefined"===n);else if("string"===n)""!==t&&this._fromString(t);else if(t instanceof e){var r=this;t.forEach((function(e,t){r.append(t,e)}))}else{if(null===t||"object"!==n)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(t))for(var i=0;i<t.length;i++){var o=t[i];if("[object Array]"!==Object.prototype.toString.call(o)&&2===o.length)throw new TypeError("Expected [string, any] as entry at index "+i+" of URLSearchParams's input");this.append(o[0],o[1])}else for(var a in t)t.hasOwnProperty(a)&&this.append(a,t[a])}},o=i.prototype;o.append=function(e,t){e in this._entries?this._entries[e].push(String(t)):this._entries[e]=[String(t)]},o.delete=function(e){delete this._entries[e]},o.get=function(e){return e in this._entries?this._entries[e][0]:null},o.getAll=function(e){return e in this._entries?this._entries[e].slice(0):[]},o.has=function(e){return e in this._entries},o.set=function(e,t){this._entries[e]=[String(t)]},o.forEach=function(e,t){var n;for(var r in this._entries)if(this._entries.hasOwnProperty(r)){n=this._entries[r];for(var i=0;i<n.length;i++)e.call(t,n[i],r,this)}},o.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),n(e)},o.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),n(e)},o.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),n(e)},t&&(o[Symbol.iterator]=o.entries),o.toString=function(){var e=[];return this.forEach((function(t,n){e.push(r(n)+"="+r(t))})),e.join("&")},e.URLSearchParams=i}();var o=e.URLSearchParams.prototype;"function"!=typeof o.sort&&(o.sort=function(){var e=this,t=[];this.forEach((function(n,r){t.push([r,n]),e._entries||e.delete(r)})),t.sort((function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0})),e._entries&&(e._entries={});for(var n=0;n<t.length;n++)this.append(t[n][0],t[n][1])}),"function"!=typeof o._fromString&&Object.defineProperty(o,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(e){if(this._entries)this._entries={};else{var t=[];this.forEach((function(e,n){t.push(n)}));for(var n=0;n<t.length;n++)this.delete(t[n])}var r,o=(e=e.replace(/^\?/,"")).split("&");for(n=0;n<o.length;n++)r=o[n].split("="),this.append(i(r[0]),r.length>1?i(r[1]):"")}})}(void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof window?window:"undefined"!=typeof self?self:commonjsGlobal),function(e){var t,n,r;if(function(){try{var t=new e.URL("b","http://a");return t.pathname="c%20d","http://a/c%20d"===t.href&&t.searchParams}catch(e){return!1}}()||(t=e.URL,r=(n=function(t,n){"string"!=typeof t&&(t=String(t));var r,i=document;if(n&&(void 0===e.location||n!==e.location.href)){(r=(i=document.implementation.createHTMLDocument("")).createElement("base")).href=n,i.head.appendChild(r);try{if(0!==r.href.indexOf(n))throw new Error(r.href)}catch(e){throw new Error("URL unable to set base "+n+" due to "+e)}}var o=i.createElement("a");if(o.href=t,r&&(i.body.appendChild(o),o.href=o.href),":"===o.protocol||!/:/.test(o.href))throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:o});var a=new e.URLSearchParams(this.search),s=!0,u=!0,c=this;["append","delete","set"].forEach((function(e){var t=a[e];a[e]=function(){t.apply(a,arguments),s&&(u=!1,c.search=a.toString(),u=!0)}})),Object.defineProperty(this,"searchParams",{value:a,enumerable:!0});var l=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==l&&(l=this.search,u&&(s=!1,this.searchParams._fromString(this.search),s=!0))}})}).prototype,["hash","host","hostname","port","protocol"].forEach((function(e){!function(e){Object.defineProperty(r,e,{get:function(){return this._anchorElement[e]},set:function(t){this._anchorElement[e]=t},enumerable:!0})}(e)})),Object.defineProperty(r,"search",{get:function(){return this._anchorElement.search},set:function(e){this._anchorElement.search=e,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(r,{toString:{get:function(){var e=this;return function(){return e.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(e){this._anchorElement.href=e,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(e){this._anchorElement.pathname=e},enumerable:!0},origin:{get:function(){var e={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],t=this._anchorElement.port!=e&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(t?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(e){},enumerable:!0},username:{get:function(){return""},set:function(e){},enumerable:!0}}),n.createObjectURL=function(e){return t.createObjectURL.apply(t,arguments)},n.revokeObjectURL=function(e){return t.revokeObjectURL.apply(t,arguments)},e.URL=n),void 0!==e.location&&!("origin"in e.location)){var i=function(){return e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")};try{Object.defineProperty(e.location,"origin",{get:i,enumerable:!0})}catch(t){setInterval((function(){e.location.origin=i()}),100)}}}(void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof window?window:"undefined"!=typeof self?self:commonjsGlobal);for(var TYPED=_uid("typed_array"),VIEW=_uid("view"),ABV=!(!_global.ArrayBuffer||!_global.DataView),CONSTR=ABV,i$1=0,l=9,Typed,TypedArrayConstructors="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");i$1<l;)(Typed=_global[TypedArrayConstructors[i$1++]])?(_hide(Typed.prototype,TYPED,!0),_hide(Typed.prototype,VIEW,!0)):CONSTR=!1;var _typed={ABV:ABV,CONSTR:CONSTR,TYPED:TYPED,VIEW:VIEW},_redefineAll=function(e,t,n){for(var r in t)_redefine(e,r,t[r],n);return e},_anInstance=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e},_toIndex=function(e){if(void 0===e)return 0;var t=_toInteger(e),n=_toLength(t);if(t!==n)throw RangeError("Wrong length!");return n},_arrayFill=function(e){for(var t=_toObject(this),n=_toLength(t.length),r=arguments.length,i=_toAbsoluteIndex(r>1?arguments[1]:void 0,n),o=r>2?arguments[2]:void 0,a=void 0===o?n:_toAbsoluteIndex(o,n);a>i;)t[i++]=e;return t},_typedBuffer=createCommonjsModule((function(e,t){var n=_objectGopn.f,r=_objectDp.f,i="prototype",o="Wrong index!",a=_global.ArrayBuffer,s=_global.DataView,u=_global.Math,c=_global.RangeError,l=_global.Infinity,d=a,p=u.abs,f=u.pow,h=u.floor,g=u.log,m=u.LN2,v=_descriptors?"_b":"buffer",y=_descriptors?"_l":"byteLength",_=_descriptors?"_o":"byteOffset";function b(e,t,n){var r,i,o,a=new Array(n),s=8*n-t-1,u=(1<<s)-1,c=u>>1,d=23===t?f(2,-24)-f(2,-77):0,v=0,y=e<0||0===e&&1/e<0?1:0;for((e=p(e))!=e||e===l?(i=e!=e?1:0,r=u):(r=h(g(e)/m),e*(o=f(2,-r))<1&&(r--,o*=2),(e+=r+c>=1?d/o:d*f(2,1-c))*o>=2&&(r++,o/=2),r+c>=u?(i=0,r=u):r+c>=1?(i=(e*o-1)*f(2,t),r+=c):(i=e*f(2,c-1)*f(2,t),r=0));t>=8;a[v++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;s>0;a[v++]=255&r,r/=256,s-=8);return a[--v]|=128*y,a}function S(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,c=e[u--],d=127&c;for(c>>=7;s>0;d=256*d+e[u],u--,s-=8);for(r=d&(1<<-s)-1,d>>=-s,s+=t;s>0;r=256*r+e[u],u--,s-=8);if(0===d)d=1-a;else{if(d===o)return r?NaN:c?-l:l;r+=f(2,t),d-=a}return(c?-1:1)*r*f(2,d-t)}function E(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function w(e){return[255&e]}function I(e){return[255&e,e>>8&255]}function T(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function O(e){return b(e,52,8)}function x(e){return b(e,23,4)}function R(e,t,n){r(e[i],t,{get:function(){return this[n]}})}function A(e,t,n,r){var i=_toIndex(+n);if(i+t>e[y])throw c(o);var a=e[v]._b,s=i+e[_],u=a.slice(s,s+t);return r?u:u.reverse()}function L(e,t,n,r,i,a){var s=_toIndex(+n);if(s+t>e[y])throw c(o);for(var u=e[v]._b,l=s+e[_],d=r(+i),p=0;p<t;p++)u[l+p]=d[a?p:t-p-1]}if(_typed.ABV){if(!_fails((function(){a(1)}))||!_fails((function(){new a(-1)}))||_fails((function(){return new a,new a(1.5),new a(NaN),"ArrayBuffer"!=a.name}))){for(var C,N=(a=function(e){return _anInstance(this,a),new d(_toIndex(e))})[i]=d[i],M=n(d),P=0;M.length>P;)(C=M[P++])in a||_hide(a,C,d[C]);N.constructor=a}var $=new s(new a(2)),k=s[i].setInt8;$.setInt8(0,2147483648),$.setInt8(1,2147483649),!$.getInt8(0)&&$.getInt8(1)||_redefineAll(s[i],{setInt8:function(e,t){k.call(this,e,t<<24>>24)},setUint8:function(e,t){k.call(this,e,t<<24>>24)}},!0)}else a=function(e){_anInstance(this,a,"ArrayBuffer");var t=_toIndex(e);this._b=_arrayFill.call(new Array(t),0),this[y]=t},s=function(e,t,n){_anInstance(this,s,"DataView"),_anInstance(e,a,"DataView");var r=e[y],i=_toInteger(t);if(i<0||i>r)throw c("Wrong offset!");if(i+(n=void 0===n?r-i:_toLength(n))>r)throw c("Wrong length!");this[v]=e,this[_]=i,this[y]=n},_descriptors&&(R(a,"byteLength","_l"),R(s,"buffer","_b"),R(s,"byteLength","_l"),R(s,"byteOffset","_o")),_redefineAll(s[i],{getInt8:function(e){return A(this,1,e)[0]<<24>>24},getUint8:function(e){return A(this,1,e)[0]},getInt16:function(e){var t=A(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=A(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return E(A(this,4,e,arguments[1]))},getUint32:function(e){return E(A(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return S(A(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return S(A(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){L(this,1,e,w,t)},setUint8:function(e,t){L(this,1,e,w,t)},setInt16:function(e,t){L(this,2,e,I,t,arguments[2])},setUint16:function(e,t){L(this,2,e,I,t,arguments[2])},setInt32:function(e,t){L(this,4,e,T,t,arguments[2])},setUint32:function(e,t){L(this,4,e,T,t,arguments[2])},setFloat32:function(e,t){L(this,4,e,x,t,arguments[2])},setFloat64:function(e,t){L(this,8,e,O,t,arguments[2])}});_setToStringTag(a,"ArrayBuffer"),_setToStringTag(s,"DataView"),_hide(s[i],_typed.VIEW,!0),t.ArrayBuffer=a,t.DataView=s})),SPECIES$2=_wks("species"),_arraySpeciesConstructor=function(e){var t;return _isArray(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!_isArray(t.prototype)||(t=void 0),_isObject(t)&&null===(t=t[SPECIES$2])&&(t=void 0)),void 0===t?Array:t},_arraySpeciesCreate=function(e,t){return new(_arraySpeciesConstructor(e))(t)},_arrayMethods=function(e,t){var n=1==e,r=2==e,i=3==e,o=4==e,a=6==e,s=5==e||a,u=t||_arraySpeciesCreate;return function(t,c,l){for(var d,p,f=_toObject(t),h=_iobject(f),g=_ctx(c,l,3),m=_toLength(h.length),v=0,y=n?u(t,m):r?u(t,0):void 0;m>v;v++)if((s||v in h)&&(p=g(d=h[v],v,f),e))if(n)y[v]=p;else if(p)switch(e){case 3:return!0;case 5:return d;case 6:return v;case 2:y.push(d)}else if(o)return!1;return a?-1:i||o?o:y}},SPECIES$3=_wks("species"),_setSpecies=function(e){var t=_global[e];_descriptors&&t&&!t[SPECIES$3]&&_objectDp.f(t,SPECIES$3,{configurable:!0,get:function(){return this}})},_arrayCopyWithin=[].copyWithin||function(e,t){var n=_toObject(this),r=_toLength(n.length),i=_toAbsoluteIndex(e,r),o=_toAbsoluteIndex(t,r),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?r:_toAbsoluteIndex(a,r))-o,r-i),u=1;for(o<i&&i<o+s&&(u=-1,o+=s-1,i+=s-1);s-- >0;)o in n?n[i]=n[o]:delete n[i],i+=u,o+=u;return n},_typedArray=createCommonjsModule((function(e){if(_descriptors){var t=_library,n=_global,r=_fails,i=_export,o=_typed,a=_typedBuffer,s=_ctx,u=_anInstance,c=_propertyDesc,l=_hide,d=_redefineAll,p=_toInteger,f=_toLength,h=_toIndex,g=_toAbsoluteIndex,m=_toPrimitive,v=_has,y=_classof,_=_isObject,b=_toObject,S=_isArrayIter,E=_objectCreate,w=_objectGpo,I=_objectGopn.f,T=core_getIteratorMethod,O=_uid,x=_wks,R=_arrayMethods,A=_arrayIncludes,L=_speciesConstructor,C=es6_array_iterator,N=_iterators,M=_iterDetect,P=_setSpecies,$=_arrayFill,k=_arrayCopyWithin,D=_objectDp,U=_objectGopd,j=D.f,B=U.f,F=n.RangeError,q=n.TypeError,G=n.Uint8Array,V=Array.prototype,H=a.ArrayBuffer,z=a.DataView,W=R(0),J=R(2),Y=R(3),K=R(4),X=R(5),Z=R(6),Q=A(!0),ee=A(!1),te=C.values,ne=C.keys,re=C.entries,ie=V.lastIndexOf,oe=V.reduce,ae=V.reduceRight,se=V.join,ue=V.sort,ce=V.slice,le=V.toString,de=V.toLocaleString,pe=x("iterator"),fe=x("toStringTag"),he=O("typed_constructor"),ge=O("def_constructor"),me=o.CONSTR,ve=o.TYPED,ye=o.VIEW,_e=R(1,(function(e,t){return Ie(L(e,e[ge]),t)})),be=r((function(){return 1===new G(new Uint16Array([1]).buffer)[0]})),Se=!!G&&!!G.prototype.set&&r((function(){new G(1).set({})})),Ee=function(e,t){var n=p(e);if(n<0||n%t)throw F("Wrong offset!");return n},we=function(e){if(_(e)&&ve in e)return e;throw q(e+" is not a typed array!")},Ie=function(e,t){if(!_(e)||!(he in e))throw q("It is not a typed array constructor!");return new e(t)},Te=function(e,t){return Oe(L(e,e[ge]),t)},Oe=function(e,t){for(var n=0,r=t.length,i=Ie(e,r);r>n;)i[n]=t[n++];return i},xe=function(e,t,n){j(e,t,{get:function(){return this._d[n]}})},Re=function(e){var t,n,r,i,o,a,u=b(e),c=arguments.length,l=c>1?arguments[1]:void 0,d=void 0!==l,p=T(u);if(null!=p&&!S(p)){for(a=p.call(u),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);u=r}for(d&&c>2&&(l=s(l,arguments[2],2)),t=0,n=f(u.length),i=Ie(this,n);n>t;t++)i[t]=d?l(u[t],t):u[t];return i},Ae=function(){for(var e=0,t=arguments.length,n=Ie(this,t);t>e;)n[e]=arguments[e++];return n},Le=!!G&&r((function(){de.call(new G(1))})),Ce=function(){return de.apply(Le?ce.call(we(this)):we(this),arguments)},Ne={copyWithin:function(e,t){return k.call(we(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return K(we(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return $.apply(we(this),arguments)},filter:function(e){return Te(this,J(we(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return X(we(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return Z(we(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){W(we(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ee(we(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return Q(we(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return se.apply(we(this),arguments)},lastIndexOf:function(e){return ie.apply(we(this),arguments)},map:function(e){return _e(we(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return oe.apply(we(this),arguments)},reduceRight:function(e){return ae.apply(we(this),arguments)},reverse:function(){for(var e,t=we(this).length,n=Math.floor(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this},some:function(e){return Y(we(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return ue.call(we(this),e)},subarray:function(e,t){var n=we(this),r=n.length,i=g(e,r);return new(L(n,n[ge]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,f((void 0===t?r:g(t,r))-i))}},Me=function(e,t){return Te(this,ce.call(we(this),e,t))},Pe=function(e){we(this);var t=Ee(arguments[1],1),n=this.length,r=b(e),i=f(r.length),o=0;if(i+t>n)throw F("Wrong length!");for(;o<i;)this[t+o]=r[o++]},$e={entries:function(){return re.call(we(this))},keys:function(){return ne.call(we(this))},values:function(){return te.call(we(this))}},ke=function(e,t){return _(e)&&e[ve]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},De=function(e,t){return ke(e,t=m(t,!0))?c(2,e[t]):B(e,t)},Ue=function(e,t,n){return!(ke(e,t=m(t,!0))&&_(n)&&v(n,"value"))||v(n,"get")||v(n,"set")||n.configurable||v(n,"writable")&&!n.writable||v(n,"enumerable")&&!n.enumerable?j(e,t,n):(e[t]=n.value,e)};me||(U.f=De,D.f=Ue),i(i.S+i.F*!me,"Object",{getOwnPropertyDescriptor:De,defineProperty:Ue}),r((function(){le.call({})}))&&(le=de=function(){return se.call(this)});var je=d({},Ne);d(je,$e),l(je,pe,$e.values),d(je,{slice:Me,set:Pe,constructor:function(){},toString:le,toLocaleString:Ce}),xe(je,"buffer","b"),xe(je,"byteOffset","o"),xe(je,"byteLength","l"),xe(je,"length","e"),j(je,fe,{get:function(){return this[ve]}}),e.exports=function(e,a,s,c){var d=e+((c=!!c)?"Clamped":"")+"Array",p="get"+e,g="set"+e,m=n[d],v=m||{},b=m&&w(m),S=!m||!o.ABV,T={},O=m&&m.prototype,x=function(e,t){j(e,t,{get:function(){return function(e,t){var n=e._d;return n.v[p](t*a+n.o,be)}(this,t)},set:function(e){return function(e,t,n){var r=e._d;c&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),r.v[g](t*a+r.o,n,be)}(this,t,e)},enumerable:!0})};S?(m=s((function(e,t,n,r){u(e,m,d,"_d");var i,o,s,c,p=0,g=0;if(_(t)){if(!(t instanceof H||"ArrayBuffer"==(c=y(t))||"SharedArrayBuffer"==c))return ve in t?Oe(m,t):Re.call(m,t);i=t,g=Ee(n,a);var v=t.byteLength;if(void 0===r){if(v%a)throw F("Wrong length!");if((o=v-g)<0)throw F("Wrong length!")}else if((o=f(r)*a)+g>v)throw F("Wrong length!");s=o/a}else s=h(t),i=new H(o=s*a);for(l(e,"_d",{b:i,o:g,l:o,e:s,v:new z(i)});p<s;)x(e,p++)})),O=m.prototype=E(je),l(O,"constructor",m)):r((function(){m(1)}))&&r((function(){new m(-1)}))&&M((function(e){new m,new m(null),new m(1.5),new m(e)}),!0)||(m=s((function(e,t,n,r){var i;return u(e,m,d),_(t)?t instanceof H||"ArrayBuffer"==(i=y(t))||"SharedArrayBuffer"==i?void 0!==r?new v(t,Ee(n,a),r):void 0!==n?new v(t,Ee(n,a)):new v(t):ve in t?Oe(m,t):Re.call(m,t):new v(h(t))})),W(b!==Function.prototype?I(v).concat(I(b)):I(v),(function(e){e in m||l(m,e,v[e])})),m.prototype=O,t||(O.constructor=m));var R=O[pe],A=!!R&&("values"==R.name||null==R.name),L=$e.values;l(m,he,!0),l(O,ve,d),l(O,ye,!0),l(O,ge,m),(c?new m(1)[fe]==d:fe in O)||j(O,fe,{get:function(){return d}}),T[d]=m,i(i.G+i.W+i.F*(m!=v),T),i(i.S,d,{BYTES_PER_ELEMENT:a}),i(i.S+i.F*r((function(){v.of.call(m,1)})),d,{from:Re,of:Ae}),"BYTES_PER_ELEMENT"in O||l(O,"BYTES_PER_ELEMENT",a),i(i.P,d,Ne),P(d),i(i.P+i.F*Se,d,{set:Pe}),i(i.P+i.F*!A,d,$e),t||O.toString==le||(O.toString=le),i(i.P+i.F*r((function(){new m(1).slice()})),d,{slice:Me}),i(i.P+i.F*(r((function(){return[1,2].toLocaleString()!=new m([1,2]).toLocaleString()}))||!r((function(){O.toLocaleString.call([1,2])}))),d,{toLocaleString:Ce}),N[d]=A?R:L,t||A||l(O,pe,L)}}else e.exports=function(){}}));_typedArray("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}));var _forOf=createCommonjsModule((function(e){var t={},n={},r=e.exports=function(e,r,i,o,a){var s,u,c,l,d=a?function(){return e}:core_getIteratorMethod(e),p=_ctx(i,o,r?2:1),f=0;if("function"!=typeof d)throw TypeError(e+" is not iterable!");if(_isArrayIter(d)){for(s=_toLength(e.length);s>f;f++)if((l=r?p(_anObject(u=e[f])[0],u[1]):p(e[f]))===t||l===n)return l}else for(c=d.call(e);!(u=c.next()).done;)if((l=_iterCall(c,p,u.value,r))===t||l===n)return l};r.BREAK=t,r.RETURN=n})),_invoke=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)},process$1=_global.process,setTask=_global.setImmediate,clearTask=_global.clearImmediate,MessageChannel=_global.MessageChannel,Dispatch=_global.Dispatch,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",defer,channel,port,run=function(){var e=+this;if(queue.hasOwnProperty(e)){var t=queue[e];delete queue[e],t()}},listener=function(e){run.call(e.data)};setTask&&clearTask||(setTask=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return queue[++counter]=function(){_invoke("function"==typeof e?e:Function(e),t)},defer(counter),counter},clearTask=function(e){delete queue[e]},"process"==_cof(process$1)?defer=function(e){process$1.nextTick(_ctx(run,e,1))}:Dispatch&&Dispatch.now?defer=function(e){Dispatch.now(_ctx(run,e,1))}:MessageChannel?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listener,defer=_ctx(port.postMessage,port,1)):_global.addEventListener&&"function"==typeof postMessage&&!_global.importScripts?(defer=function(e){_global.postMessage(e+"","*")},_global.addEventListener("message",listener,!1)):defer=ONREADYSTATECHANGE in _domCreate("script")?function(e){_html.appendChild(_domCreate("script"))[ONREADYSTATECHANGE]=function(){_html.removeChild(this),run.call(e)}}:function(e){setTimeout(_ctx(run,e,1),0)});var _task={set:setTask,clear:clearTask},macrotask=_task.set,Observer=_global.MutationObserver||_global.WebKitMutationObserver,process$2=_global.process,Promise$1=_global.Promise,isNode="process"==_cof(process$2),_microtask=function(){var e,t,n,r=function(){var r,i;for(isNode&&(r=process$2.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(isNode)n=function(){process$2.nextTick(r)};else if(!Observer||_global.navigator&&_global.navigator.standalone)if(Promise$1&&Promise$1.resolve){var i=Promise$1.resolve(void 0);n=function(){i.then(r)}}else n=function(){macrotask.call(_global,r)};else{var o=!0,a=document.createTextNode("");new Observer(r).observe(a,{characterData:!0}),n=function(){a.data=o=!o}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}};function PromiseCapability(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=_aFunction(t),this.reject=_aFunction(n)}var f$7=function(e){return new PromiseCapability(e)},_newPromiseCapability={f:f$7},_perform=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},_promiseResolve=function(e,t){if(_anObject(e),_isObject(t)&&t.constructor===e)return t;var n=_newPromiseCapability.f(e);return(0,n.resolve)(t),n.promise},task=_task.set,microtask=_microtask(),PROMISE="Promise",TypeError$1=_global.TypeError,process$3=_global.process,versions=process$3&&process$3.versions,v8=versions&&versions.v8||"",$Promise=_global[PROMISE],isNode$1="process"==_classof(process$3),empty=function(){},Internal,newGenericPromiseCapability,OwnPromiseCapability,Wrapper,newPromiseCapability=newGenericPromiseCapability=_newPromiseCapability.f,USE_NATIVE$1=!!function(){try{var e=$Promise.resolve(1),t=(e.constructor={})[_wks("species")]=function(e){e(empty,empty)};return(isNode$1||"function"==typeof PromiseRejectionEvent)&&e.then(empty)instanceof t&&0!==v8.indexOf("6.6")&&-1===_userAgent.indexOf("Chrome/66")}catch(e){}}(),isThenable=function(e){var t;return!(!_isObject(e)||"function"!=typeof(t=e.then))&&t},notify=function(e,t){if(!e._n){e._n=!0;var n=e._c;microtask((function(){for(var r=e._v,i=1==e._s,o=0,a=function(t){var n,o,a,s=i?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(i||(2==e._h&&onHandleUnhandled(e),e._h=1),!0===s?n=r:(l&&l.enter(),n=s(r),l&&(l.exit(),a=!0)),n===t.promise?c(TypeError$1("Promise-chain cycle")):(o=isThenable(n))?o.call(n,u,c):u(n)):c(r)}catch(e){l&&!a&&l.exit(),c(e)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&onUnhandled(e)}))}},onUnhandled=function(e){task.call(_global,(function(){var t,n,r,i=e._v,o=isUnhandled(e);if(o&&(t=_perform((function(){isNode$1?process$3.emit("unhandledRejection",i,e):(n=_global.onunhandledrejection)?n({promise:e,reason:i}):(r=_global.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=isNode$1||isUnhandled(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},isUnhandled=function(e){return 1!==e._h&&0===(e._a||e._c).length},onHandleUnhandled=function(e){task.call(_global,(function(){var t;isNode$1?process$3.emit("rejectionHandled",e):(t=_global.onrejectionhandled)&&t({promise:e,reason:e._v})}))},$reject=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),notify(t,!0))},$resolve=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw TypeError$1("Promise can't be resolved itself");(t=isThenable(e))?microtask((function(){var r={_w:n,_d:!1};try{t.call(e,_ctx($resolve,r,1),_ctx($reject,r,1))}catch(e){$reject.call(r,e)}})):(n._v=e,n._s=1,notify(n,!1))}catch(e){$reject.call({_w:n,_d:!1},e)}}};USE_NATIVE$1||($Promise=function(e){_anInstance(this,$Promise,PROMISE,"_h"),_aFunction(e),Internal.call(this);try{e(_ctx($resolve,this,1),_ctx($reject,this,1))}catch(e){$reject.call(this,e)}},Internal=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},Internal.prototype=_redefineAll($Promise.prototype,{then:function(e,t){var n=newPromiseCapability(_speciesConstructor(this,$Promise));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=isNode$1?process$3.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&notify(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),OwnPromiseCapability=function(){var e=new Internal;this.promise=e,this.resolve=_ctx($resolve,e,1),this.reject=_ctx($reject,e,1)},_newPromiseCapability.f=newPromiseCapability=function(e){return e===$Promise||e===Wrapper?new OwnPromiseCapability(e):newGenericPromiseCapability(e)}),_export(_export.G+_export.W+_export.F*!USE_NATIVE$1,{Promise:$Promise}),_setToStringTag($Promise,PROMISE),_setSpecies(PROMISE),Wrapper=_core[PROMISE],_export(_export.S+_export.F*!USE_NATIVE$1,PROMISE,{reject:function(e){var t=newPromiseCapability(this);return(0,t.reject)(e),t.promise}}),_export(_export.S+_export.F*!USE_NATIVE$1,PROMISE,{resolve:function(e){return _promiseResolve(this,e)}}),_export(_export.S+_export.F*!(USE_NATIVE$1&&_iterDetect((function(e){$Promise.all(e).catch(empty)}))),PROMISE,{all:function(e){var t=this,n=newPromiseCapability(t),r=n.resolve,i=n.reject,o=_perform((function(){var n=[],o=0,a=1;_forOf(e,!1,(function(e){var s=o++,u=!1;n.push(void 0),a++,t.resolve(e).then((function(e){u||(u=!0,n[s]=e,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=newPromiseCapability(t),r=n.reject,i=_perform((function(){_forOf(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}});var support={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};function isDataView(e){return e&&DataView.prototype.isPrototypeOf(e)}if(support.arrayBuffer)var viewClasses=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],isArrayBufferView=ArrayBuffer.isView||function(e){return e&&viewClasses.indexOf(Object.prototype.toString.call(e))>-1};function normalizeName(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function normalizeValue(e){return"string"!=typeof e&&(e=String(e)),e}function iteratorFor(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return support.iterable&&(t[Symbol.iterator]=function(){return t}),t}function Headers(e){this.map={},e instanceof Headers?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function consumed(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function fileReaderReady(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function readBlobAsArrayBuffer(e){var t=new FileReader,n=fileReaderReady(t);return t.readAsArrayBuffer(e),n}function readBlobAsText(e){var t=new FileReader,n=fileReaderReady(t);return t.readAsText(e),n}function readArrayBufferAsText(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function bufferClone(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:support.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:support.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:support.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():support.arrayBuffer&&support.blob&&isDataView(e)?(this._bodyArrayBuffer=bufferClone(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):support.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||isArrayBufferView(e))?this._bodyArrayBuffer=bufferClone(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):support.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},support.blob&&(this.blob=function(){var e=consumed(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var e=consumed(this);if(e)return e;if(this._bodyBlob)return readBlobAsText(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},support.formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}Headers.prototype.append=function(e,t){e=normalizeName(e),t=normalizeValue(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},Headers.prototype.delete=function(e){delete this.map[normalizeName(e)]},Headers.prototype.get=function(e){return e=normalizeName(e),this.has(e)?this.map[e]:null},Headers.prototype.has=function(e){return this.map.hasOwnProperty(normalizeName(e))},Headers.prototype.set=function(e,t){this.map[normalizeName(e)]=normalizeValue(t)},Headers.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},Headers.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),iteratorFor(e)},Headers.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),iteratorFor(e)},Headers.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),iteratorFor(e)},support.iterable&&(Headers.prototype[Symbol.iterator]=Headers.prototype.entries);var methods=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function normalizeMethod(e){var t=e.toUpperCase();return methods.indexOf(t)>-1?t:e}function Request(e,t){var n=(t=t||{}).body;if(e instanceof Request){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new Headers(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new Headers(t.headers)),this.method=normalizeMethod(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function decode(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function parseHeaders(e){var t=new Headers;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t}function Response(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new Headers(t.headers),this.url=t.url||"",this._initBody(e)}Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var e=new Response(null,{status:0,statusText:""});return e.type="error",e};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(e,t){if(-1===redirectStatuses.indexOf(t))throw new RangeError("Invalid status code");return new Response(null,{status:t,headers:{location:e}})};var DOMException$1=self.DOMException;try{new DOMException$1}catch(err){DOMException$1=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},DOMException$1.prototype=Object.create(Error.prototype),DOMException$1.prototype.constructor=DOMException$1}function fetch(e,t){return new Promise((function(n,r){var i=new Request(e,t);if(i.signal&&i.signal.aborted)return r(new DOMException$1("Aborted","AbortError"));var o=new XMLHttpRequest;function a(){o.abort()}o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:parseHeaders(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;n(new Response(t,e))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.onabort=function(){r(new DOMException$1("Aborted","AbortError"))},o.open(i.method,i.url,!0),"include"===i.credentials?o.withCredentials=!0:"omit"===i.credentials&&(o.withCredentials=!1),"responseType"in o&&support.blob&&(o.responseType="blob"),i.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),i.signal&&(i.signal.addEventListener("abort",a),o.onreadystatechange=function(){4===o.readyState&&i.signal.removeEventListener("abort",a)}),o.send(void 0===i._bodyInit?null:i._bodyInit)}))}function get(e,t){var n,r,i=arguments.length<3?e:arguments[2];return _anObject(e)===i?e[t]:(n=_objectGopd.f(e,t))?_has(n,"value")?n.value:void 0!==n.get?n.get.call(i):void 0:_isObject(r=_objectGpo(e))?get(r,t,i):void 0}fetch.polyfill=!0,self.fetch||(self.fetch=fetch,self.Headers=Headers,self.Request=Request,self.Response=Response),_export(_export.S,"Reflect",{get:get});var check=function(e,t){if(_anObject(e),!_isObject(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},_setProto={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=_ctx(Function.call,_objectGopd.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return check(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:check};_export(_export.S,"Object",{setPrototypeOf:_setProto.set}),function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}var s=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return n(t,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,i=n.length;r<i;r++)if(n[r]===t)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(e){var t=this;if(e.type in this.listeners){for(var n=function(n){setTimeout((function(){return n.call(t,e)}))},r=this.listeners[e.type],i=0,o=r.length;i<o;i++)n(r[i]);return!e.defaultPrevented}}}]),t}(),u=function(t){function u(){var t,n;return e(this,u),(this,n=r(u).call(this),t=!n||"object"!==_typeof(n)&&"function"!=typeof n?o(this):n).listeners||s.call(o(t)),Object.defineProperty(o(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(o(t),"onabort",{value:null,writable:!0,configurable:!0}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(u,t),n(u,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),a(r(u.prototype),"dispatchEvent",this).call(this,e)}}]),u}(s),c=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new u,writable:!0,configurable:!0})}return n(t,[{key:"abort",value:function(){var e;try{e=new Event("abort")}catch(t){"undefined"!=typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(c.prototype[Symbol.toStringTag]="AbortController",u.prototype[Symbol.toStringTag]="AbortSignal"),function(e){(function(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController})(e)&&(e.AbortController=c,e.AbortSignal=u)}("undefined"!=typeof self?self:commonjsGlobal)}(),_export(_export.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}});var log=Math.log,LN2=Math.LN2,clz32=Math.clz32||function(e){return 31-log(e>>>0)/LN2|0},fromCharCode=String.fromCharCode,Object_prototype_toString={}.toString,NativeUint8Array=window.Uint8Array,patchedU8Array=NativeUint8Array||Array,ArrayBufferString=Object_prototype_toString.call((window.ArrayBuffer||patchedU8Array).prototype),RtmStatusCode;function decoderReplacer(e){var t=e.charCodeAt(0)<<24,n=0|clz32(~t),r=0,i=0|e.length,o="";if(n<5&&i>=n){for(t=t<<n>>>24+n,r=1;r<n;r=r+1|0)t=t<<6|63&e.charCodeAt(r);t<=65535?o+=fromCharCode(t):t<=1114111?o+=fromCharCode(55296+((t=t-65536|0)>>10)|0,56320+(1023&t)|0):r=0}for(;r<i;r=r+1|0)o+="";return o}function TextDecoder$1(){}function encoderReplacer(e){var t=0|e.charCodeAt(0);if(t>=55296&&t<=56319){var n=0|e.charCodeAt(1);if(n!=n)return fromCharCode(239,191,189);if(!(n>=56320&&n<=57343))return fromCharCode(239,191,189);if((t=(t-55296<<10)+n-56320+65536|0)>65535)return fromCharCode(240|t>>>18,128|t>>>12&63,128|t>>>6&63,128|63&t)}return t<=127?e:t<=2047?fromCharCode(192|t>>>6,128|63&t):fromCharCode(224|t>>>12,128|t>>>6&63,128|63&t)}function TextEncoder$1(){}TextDecoder$1.prototype.decode=function(e){var t=e&&e.buffer||e;if(Object_prototype_toString.call(t)!==ArrayBufferString)throw Error("Failed to execute 'decode' on 'TextDecoder': The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");for(var n=NativeUint8Array?new patchedU8Array(t):t,r="",i=0,o=0|n.length;i<o;i=i+32768|0)r+=fromCharCode.apply(0,n[NativeUint8Array?"slice":"subarray"](i,i+32768|0));return r.replace(/[\xc0-\xff][\x80-\xbf]*/g,decoderReplacer)},window.TextDecoder||(window.TextDecoder=TextDecoder$1),TextEncoder$1.prototype.encode=function(e){for(var t=void 0===e?"":(""+e).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,encoderReplacer),n=0|t.length,r=new patchedU8Array(n),i=0;i<n;i=i+1|0)r[i]=t.charCodeAt(i);return r},window.TextEncoder||(window.TextEncoder=TextEncoder$1),function(e){var t,n,r,i,o,a,s,u,c;!function(e){e.LOGIN="LOGIN",e.LOGIN_SUCCESS="LOGIN_SUCCESS",e.LOGIN_FAILURE="LOGIN_FAILURE",e.LOGIN_TIMEOUT="LOGIN_TIMEOUT",e.INTERRUPTED="INTERRUPTED",e.LOGOUT="LOGOUT",e.BANNED_BY_SERVER="BANNED_BY_SERVER",e.REMOTE_LOGIN="REMOTE_LOGIN"}(t||(t={})),e.ConnectionChangeReason=t,function(e){e.DISCONNECTED="DISCONNECTED",e.CONNECTING="CONNECTING",e.CONNECTED="CONNECTED",e.RECONNECTING="RECONNECTING",e.ABORTED="ABORTED"}(n||(n={})),e.ConnectionState=n,function(e){e.IDLE="IDLE",e.SENT_TO_REMOTE="SENT_TO_REMOTE",e.RECEIVED_BY_REMOTE="RECEIVED_BY_REMOTE",e.ACCEPTED_BY_REMOTE="ACCEPTED_BY_REMOTE",e.REFUSED_BY_REMOTE="REFUSED_BY_REMOTE",e.CANCELED="CANCELED",e.FAILURE="FAILURE"}(r||(r={})),e.LocalInvitationState=r,function(e){e.INVITATION_RECEIVED="INVITATION_RECEIVED",e.ACCEPT_SENT_TO_LOCAL="ACCEPT_SENT_TO_LOCAL",e.REFUSED="REFUSED",e.ACCEPTED="ACCEPTED",e.CANCELED="CANCELED",e.FAILURE="FAILURE"}(i||(i={})),e.RemoteInvitationState=i,function(e){e.UNKNOWN="UNKNOWN",e.PEER_NO_RESPONSE="PEER_NO_RESPONSE",e.INVITATION_EXPIRE="INVITATION_EXPIRE",e.PEER_OFFLINE="PEER_OFFLINE",e.NOT_LOGGEDIN="NOT_LOGGEDIN"}(o||(o={})),e.LocalInvitationFailureReason=o,function(e){e.UNKNOWN="UNKNOWN",e.PEER_OFFLINE="PEER_OFFLINE",e.ACCEPT_FAILURE="ACCEPT_FAILURE",e.INVITATION_EXPIRE="INVITATION_EXPIRE"}(a||(a={})),e.RemoteInvitationFailureReason=a,function(e){e.ONLINE="ONLINE",e.UNREACHABLE="UNREACHABLE",e.OFFLINE="OFFLINE"}(s||(s={})),e.PeerOnlineState=s,function(e){e.ONLINE_STATUS="ONLINE_STATUS"}(u||(u={})),e.PeerSubscriptionOption=u,function(e){e.TEXT="TEXT",e.RAW="RAW"}(c||(c={})),e.MessageType=c}(RtmStatusCode||(RtmStatusCode={}));for(var RtmStatusCode$1=RtmStatusCode,rngBrowser=createCommonjsModule((function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}})),byteToHex=[],i$2=0;i$2<256;++i$2)byteToHex[i$2]=(i$2+256).toString(16).substr(1);function bytesToUuid(e,t){var n=t||0,r=byteToHex;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}var bytesToUuid_1=bytesToUuid;function v4(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||rngBrowser)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[r+o]=i[o];return t||bytesToUuid_1(i)}var v4_1=v4,version="1.2.2",BUILD="v1.2.2-0-gb428acc",processId=v4_1(),WEB_PLATFORM_TYPE=7,VERSION_NO=3,SUBVERSION=1,END_CALL_PREFIX="AgoraRTMLegacyEndcallCompatibleMessagePrefix";const AttributeOperationError={ATTRIBUTE_OPERATION_ERR_FAILURE:2,ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT:3,ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW:4,ATTRIBUTE_OPERATION_ERR_TOO_OFTEN:5,ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND:6,ATTRIBUTE_OPERATION_ERR_TIMEOUT:7,ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN:102},ChannelMessageError={CHANNEL_MESSAGE_ERR_FAILURE:1,CHANNEL_MESSAGE_ERR_TIMEOUT:2,CHANNEL_MESSAGE_ERR_TOO_OFTEN:3,CHANNEL_MESSAGE_ERR_INVALID_MESSAGE:4,CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL:5,CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN:102},CreateChannelError={CREATE_CHANNEL_ERR_INVALID_ARGUMENT:1},CreateInstanceError={CREATE_INSTANCE_ERR_INVALID_ARGUMENT:1},GetMembersError={GET_MEMBERS_ERR_FAILURE:1,GET_MEMBERS_ERR_REJECTED:2,GET_MEMBERS_ERR_TIMEOUT:3,GET_MEMBERS_ERR_TOO_OFTEN:4,GET_MEMBERS_ERR_NOT_IN_CHANNEL:5,GET_MEMBERS_ERR_USER_NOT_LOGGED_IN:102},InvitationApiCallError={INVITATION_API_CALL_ERR_INVALID_ARGUMENT:1,INVITATION_API_CALL_ERR_NOT_STARTED:2,INVITATION_API_CALL_ERR_ALREADY_END:3,INVITATION_API_CALL_ERR_ALREADY_ACCEPT:4,INVITATION_API_CALL_ERR_ALREADY_SENT:5},JoinChannelError={JOIN_CHANNEL_ERR_FAILURE:1,JOIN_CHANNEL_ERR_REJECTED:2,JOIN_CHANNEL_ERR_INVALID_ARGUMENT:3,JOIN_CHANNEL_TIMEOUT:4,JOIN_CHANNEL_ERR_EXCEED_LIMIT:5,JOIN_CHANNEL_ERR_ALREADY_JOINED:6,JOIN_CHANNEL_ERR_TOO_OFTEN:7,JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN:8,JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN:102,JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE:201,JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID:202},LeaveChannelError={LEAVE_CHANNEL_ERR_FAILURE:1,LEAVE_CHANNEL_ERR_REJECTED:2,LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL:3,LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN:102},LoginError={LOGIN_ERR_UNKNOWN:1,LOGIN_ERR_REJECTED:2,LOGIN_ERR_INVALID_ARGUMENT:3,LOGIN_ERR_INVALID_APP_ID:4,LOGIN_ERR_INVALID_TOKEN:5,LOGIN_ERR_TOKEN_EXPIRED:6,LOGIN_ERR_NOT_AUTHORIZED:7,LOGIN_ERR_ALREADY_LOGIN:8,LOGIN_ERR_TIMEOUT:9,LOGIN_ERR_TOO_OFTEN:10,LOGIN_ERR_ABORTED_BY_LOGOUT:201},LogoutError={LOGOUT_ERR_USER_NOT_LOGGED_IN:102},PeerMessageError={PEER_MESSAGE_ERR_FAILURE:1,PEER_MESSAGE_ERR_TIMEOUT:2,PEER_MESSAGE_ERR_TOO_OFTEN:5,PEER_MESSAGE_ERR_INVALID_USERID:6,PEER_MESSAGE_ERR_INVALID_MESSAGE:7,PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN:102},QueryPeersOnlineStatusError={QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT:2,QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED:3,QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT:4,QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN:5,QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN:102},RenewTokenError={RENEW_TOKEN_ERR_FAILURE:1,RENEW_TOKEN_ERR_INVALID_ARGUMENT:2,RENEW_TOKEN_ERR_REJECTED:3,RENEW_TOKEN_ERR_TOO_OFTEN:4,RENEW_TOKEN_ERR_TOKEN_EXPIRED:5,RENEW_TOKEN_ERR_INVALID_TOKEN:6,RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN:102,RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT:201},GetChannelMemberCountErrCode={GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE:1,GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT:2,GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN:3,GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT:4,GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT:5,GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED:101,GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN:102},PeerSubscriptionStatusError={PEER_SUBSCRIPTION_STATUS_ERR_FAILURE:1,PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT:2,PEER_SUBSCRIPTION_STATUS_ERR_REJECTED:3,PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT:4,PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN:5,PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW:6,PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN:102};var ATTRIBUTE_OPERATION_ERR_FAILURE=AttributeOperationError.ATTRIBUTE_OPERATION_ERR_FAILURE,ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=AttributeOperationError.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW,ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND=AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND,ATTRIBUTE_OPERATION_ERR_TIMEOUT=AttributeOperationError.ATTRIBUTE_OPERATION_ERR_TIMEOUT,ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,CHANNEL_MESSAGE_ERR_FAILURE=ChannelMessageError.CHANNEL_MESSAGE_ERR_FAILURE,CHANNEL_MESSAGE_ERR_TIMEOUT=ChannelMessageError.CHANNEL_MESSAGE_ERR_TIMEOUT,CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=ChannelMessageError.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE,CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=ChannelMessageError.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,CREATE_CHANNEL_ERR_INVALID_ARGUMENT=CreateChannelError.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,CREATE_INSTANCE_ERR_INVALID_ARGUMENT=CreateInstanceError.CREATE_INSTANCE_ERR_INVALID_ARGUMENT,GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT=GetChannelMemberCountErrCode.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT,GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT=GetChannelMemberCountErrCode.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT,GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT=GetChannelMemberCountErrCode.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT,GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN=GetChannelMemberCountErrCode.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN,GET_MEMBERS_ERR_FAILURE=GetMembersError.GET_MEMBERS_ERR_FAILURE,GET_MEMBERS_ERR_REJECTED=GetMembersError.GET_MEMBERS_ERR_REJECTED,GET_MEMBERS_ERR_NOT_IN_CHANNEL=GetMembersError.GET_MEMBERS_ERR_NOT_IN_CHANNEL,GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=GetMembersError.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN,INVITATION_API_CALL_ERR_INVALID_ARGUMENT=InvitationApiCallError.INVITATION_API_CALL_ERR_INVALID_ARGUMENT,INVITATION_API_CALL_ERR_NOT_STARTED=InvitationApiCallError.INVITATION_API_CALL_ERR_NOT_STARTED,INVITATION_API_CALL_ERR_ALREADY_END=InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_END,INVITATION_API_CALL_ERR_ALREADY_ACCEPT=InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,INVITATION_API_CALL_ERR_ALREADY_SENT=InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_SENT,JOIN_CHANNEL_ERR_FAILURE=JoinChannelError.JOIN_CHANNEL_ERR_FAILURE,JOIN_CHANNEL_ERR_INVALID_ARGUMENT=JoinChannelError.JOIN_CHANNEL_ERR_INVALID_ARGUMENT,JOIN_CHANNEL_TIMEOUT=JoinChannelError.JOIN_CHANNEL_TIMEOUT,JOIN_CHANNEL_ERR_EXCEED_LIMIT=JoinChannelError.JOIN_CHANNEL_ERR_EXCEED_LIMIT,JOIN_CHANNEL_ERR_ALREADY_JOINED=JoinChannelError.JOIN_CHANNEL_ERR_ALREADY_JOINED,JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=JoinChannelError.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=JoinChannelError.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,LEAVE_CHANNEL_ERR_FAILURE=LeaveChannelError.LEAVE_CHANNEL_ERR_FAILURE,LEAVE_CHANNEL_ERR_REJECTED=LeaveChannelError.LEAVE_CHANNEL_ERR_REJECTED,LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=LeaveChannelError.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=LeaveChannelError.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN,LOGIN_ERR_UNKNOWN=LoginError.LOGIN_ERR_UNKNOWN,LOGIN_ERR_REJECTED=LoginError.LOGIN_ERR_REJECTED,LOGIN_ERR_INVALID_ARGUMENT=LoginError.LOGIN_ERR_INVALID_ARGUMENT,LOGIN_ERR_INVALID_APP_ID=LoginError.LOGIN_ERR_INVALID_APP_ID,LOGIN_ERR_INVALID_TOKEN=LoginError.LOGIN_ERR_INVALID_TOKEN,LOGIN_ERR_TOKEN_EXPIRED=LoginError.LOGIN_ERR_TOKEN_EXPIRED,LOGIN_ERR_ALREADY_LOGIN=LoginError.LOGIN_ERR_ALREADY_LOGIN,LOGIN_ERR_TIMEOUT=LoginError.LOGIN_ERR_TIMEOUT,LOGIN_ERR_TOO_OFTEN=LoginError.LOGIN_ERR_TOO_OFTEN,LOGOUT_ERR_USER_NOT_LOGGED_IN=LogoutError.LOGOUT_ERR_USER_NOT_LOGGED_IN,PEER_MESSAGE_ERR_FAILURE=PeerMessageError.PEER_MESSAGE_ERR_FAILURE,PEER_MESSAGE_ERR_TIMEOUT=PeerMessageError.PEER_MESSAGE_ERR_TIMEOUT,PEER_MESSAGE_ERR_INVALID_USERID=PeerMessageError.PEER_MESSAGE_ERR_INVALID_USERID,PEER_MESSAGE_ERR_INVALID_MESSAGE=PeerMessageError.PEER_MESSAGE_ERR_INVALID_MESSAGE,PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=PeerMessageError.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT=QueryPeersOnlineStatusError.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT,QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT=QueryPeersOnlineStatusError.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT,QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN=QueryPeersOnlineStatusError.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN,RENEW_TOKEN_ERR_FAILURE=RenewTokenError.RENEW_TOKEN_ERR_FAILURE,RENEW_TOKEN_ERR_INVALID_ARGUMENT=RenewTokenError.RENEW_TOKEN_ERR_INVALID_ARGUMENT,RENEW_TOKEN_ERR_TOKEN_EXPIRED=RenewTokenError.RENEW_TOKEN_ERR_TOKEN_EXPIRED,RENEW_TOKEN_ERR_INVALID_TOKEN=RenewTokenError.RENEW_TOKEN_ERR_INVALID_TOKEN,RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=RenewTokenError.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN,PEER_SUBSCRIPTION_STATUS_ERR_FAILURE=PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE,PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT=PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT,PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT=PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT,PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW=PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW,PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN=PeerSubscriptionStatusError.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN,runtime_1=createCommonjsModule((function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),a=new x(r||[]);return o._invoke=function(e,t,n){var r=l;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw o;return A()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=I(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var u=c(e,t,n);if("normal"===u.type){if(r=n.done?f:d,u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=f,n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var l="suspendedStart",d="suspendedYield",p="executing",f="completed",h={};function g(){}function m(){}function v(){}var y={};y[o]=function(){return this};var _=Object.getPrototypeOf,b=_&&_(_(R([])));b&&b!==n&&r.call(b,o)&&(y=b);var S=v.prototype=g.prototype=Object.create(y);function E(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function w(e){var t;this._invoke=function(n,i){function o(){return new Promise((function(t,o){!function t(n,i,o,a){var s=c(e[n],e,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"===_typeof(l)&&r.call(l,"__await")?Promise.resolve(l.__await).then((function(e){t("next",e,o,a)}),(function(e){t("throw",e,o,a)})):Promise.resolve(l).then((function(e){u.value=e,o(u)}),(function(e){return t("throw",e,o,a)}))}a(s.arg)}(n,i,t,o)}))}return t=t?t.then(o,o):o()}}function I(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method))return h;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=c(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function R(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:A}}function A(){return{value:t,done:!0}}return m.prototype=S.constructor=v,v.constructor=m,v[s]=m.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},E(w.prototype),w.prototype[a]=function(){return this},e.AsyncIterator=w,e.async=function(t,n,r,i){var o=new w(u(t,n,r,i));return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(S),S[s]="Generator",S[o]=function(){return this},S.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=R,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:R(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),h}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}})),regenerator=runtime_1,setPrototypeOf=_setProto.set,_inheritIfRequired=function(e,t,n){var r,i=t.constructor;return i!==n&&"function"==typeof i&&(r=i.prototype)!==n.prototype&&_isObject(r)&&setPrototypeOf&&setPrototypeOf(e,r),e},dP$3=_objectDp.f,gOPN$2=_objectGopn.f,$RegExp=_global.RegExp,Base=$RegExp,proto$1=$RegExp.prototype,re1=/a/g,re2=/a/g,CORRECT_NEW=new $RegExp(re1)!==re1;if(_descriptors&&(!CORRECT_NEW||_fails((function(){return re2[_wks("match")]=!1,$RegExp(re1)!=re1||$RegExp(re2)==re2||"/a/i"!=$RegExp(re1,"i")})))){$RegExp=function(e,t){var n=this instanceof $RegExp,r=_isRegexp(e),i=void 0===t;return!n&&r&&e.constructor===$RegExp&&i?e:_inheritIfRequired(CORRECT_NEW?new Base(r&&!i?e.source:e,t):Base((r=e instanceof $RegExp)?e.source:e,r&&i?_flags.call(e):t),n?this:proto$1,$RegExp)};for(var proxy=function(e){e in $RegExp||dP$3($RegExp,e,{configurable:!0,get:function(){return Base[e]},set:function(t){Base[e]=t}})},keys=gOPN$2(Base),i$3=0;keys.length>i$3;)proxy(keys[i$3++]);proto$1.constructor=$RegExp,$RegExp.prototype=proto$1,_redefine(_global,"RegExp",$RegExp)}_setSpecies("RegExp");var freeGlobal="object"==_typeof(commonjsGlobal)&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal,freeSelf="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,root=_freeGlobal||freeSelf||Function("return this")(),_root=root,_Symbol2=_root.Symbol,_Symbol=_Symbol2,objectProto=Object.prototype,hasOwnProperty$1=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty$1.call(e,symToStringTag),n=e[symToStringTag];try{e[symToStringTag]=void 0;var r=!0}catch(e){}var i=nativeObjectToString.call(e);return r&&(t?e[symToStringTag]=n:delete e[symToStringTag]),i}var _getRawTag=getRawTag,objectProto$1=Object.prototype,nativeObjectToString$1=objectProto$1.toString;function objectToString(e){return nativeObjectToString$1.call(e)}var _objectToString=objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag$1=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag$1&&symToStringTag$1 in Object(e)?_getRawTag(e):_objectToString(e)}var _baseGetTag=baseGetTag;function isObject(e){var t=_typeof(e);return null!=e&&("object"==t||"function"==t)}var isObject_1=isObject,asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){if(!isObject_1(e))return!1;var t=_baseGetTag(e);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}var isFunction_1=isFunction,coreJsData=_root["__core-js_shared__"],_coreJsData=coreJsData,maskSrcKey=(uid=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||""),uid?"Symbol(src)_1."+uid:""),uid;function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var _isMasked=isMasked,funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(e){if(null!=e){try{return funcToString.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var _toSource=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$2=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$2=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$2).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject_1(e)||_isMasked(e))&&(isFunction_1(e)?reIsNative:reIsHostCtor).test(_toSource(e))}var _baseIsNative=baseIsNative;function getValue(e,t){return null==e?void 0:e[t]}var _getValue=getValue;function getNative(e,t){var n=_getValue(e,t);return _baseIsNative(n)?n:void 0}var _getNative=getNative,nativeCreate=_getNative(Object,"create"),_nativeCreate=nativeCreate;function hashClear(){this.__data__=_nativeCreate?_nativeCreate(null):{},this.size=0}var _hashClear=hashClear;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _hashDelete=hashDelete,HASH_UNDEFINED="__lodash_hash_undefined__",objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function hashGet(e){var t=this.__data__;if(_nativeCreate){var n=t[e];return n===HASH_UNDEFINED?void 0:n}return hasOwnProperty$3.call(t,e)?t[e]:void 0}var _hashGet=hashGet,objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty;function hashHas(e){var t=this.__data__;return _nativeCreate?void 0!==t[e]:hasOwnProperty$4.call(t,e)}var _hashHas=hashHas,HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=_nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}var _hashSet=hashSet;function Hash(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Hash.prototype.clear=_hashClear,Hash.prototype.delete=_hashDelete,Hash.prototype.get=_hashGet,Hash.prototype.has=_hashHas,Hash.prototype.set=_hashSet;var _Hash=Hash;function listCacheClear(){this.__data__=[],this.size=0}var _listCacheClear=listCacheClear;function eq(e,t){return e===t||e!=e&&t!=t}var eq_1=eq;function assocIndexOf(e,t){for(var n=e.length;n--;)if(eq_1(e[n][0],t))return n;return-1}var _assocIndexOf=assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,n=_assocIndexOf(t,e);return!(n<0||(n==t.length-1?t.pop():splice.call(t,n,1),--this.size,0))}var _listCacheDelete=listCacheDelete;function listCacheGet(e){var t=this.__data__,n=_assocIndexOf(t,e);return n<0?void 0:t[n][1]}var _listCacheGet=listCacheGet;function listCacheHas(e){return _assocIndexOf(this.__data__,e)>-1}var _listCacheHas=listCacheHas;function listCacheSet(e,t){var n=this.__data__,r=_assocIndexOf(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var _listCacheSet=listCacheSet;function ListCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ListCache.prototype.clear=_listCacheClear,ListCache.prototype.delete=_listCacheDelete,ListCache.prototype.get=_listCacheGet,ListCache.prototype.has=_listCacheHas,ListCache.prototype.set=_listCacheSet;var _ListCache=ListCache,Map$1=_getNative(_root,"Map"),_Map=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash,map:new(_Map||_ListCache),string:new _Hash}}var _mapCacheClear=mapCacheClear;function isKeyable(e){var t=_typeof(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var _isKeyable=isKeyable;function getMapData(e,t){var n=e.__data__;return _isKeyable(t)?n["string"==typeof t?"string":"hash"]:n.map}var _getMapData=getMapData;function mapCacheDelete(e){var t=_getMapData(this,e).delete(e);return this.size-=t?1:0,t}var _mapCacheDelete=mapCacheDelete;function mapCacheGet(e){return _getMapData(this,e).get(e)}var _mapCacheGet=mapCacheGet;function mapCacheHas(e){return _getMapData(this,e).has(e)}var _mapCacheHas=mapCacheHas;function mapCacheSet(e,t){var n=_getMapData(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var _mapCacheSet=mapCacheSet;function MapCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}MapCache.prototype.clear=_mapCacheClear,MapCache.prototype.delete=_mapCacheDelete,MapCache.prototype.get=_mapCacheGet,MapCache.prototype.has=_mapCacheHas,MapCache.prototype.set=_mapCacheSet;var _MapCache=MapCache,HASH_UNDEFINED$2="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED$2),this}var _setCacheAdd=setCacheAdd;function setCacheHas(e){return this.__data__.has(e)}var _setCacheHas=setCacheHas;function SetCache(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new _MapCache;++t<n;)this.add(e[t])}SetCache.prototype.add=SetCache.prototype.push=_setCacheAdd,SetCache.prototype.has=_setCacheHas;var _SetCache=SetCache;function baseFindIndex(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}var _baseFindIndex=baseFindIndex;function baseIsNaN(e){return e!=e}var _baseIsNaN=baseIsNaN;function strictIndexOf(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}var _strictIndexOf=strictIndexOf;function baseIndexOf(e,t,n){return t==t?_strictIndexOf(e,t,n):_baseFindIndex(e,_baseIsNaN,n)}var _baseIndexOf=baseIndexOf;function arrayIncludes(e,t){return!(null==e||!e.length)&&_baseIndexOf(e,t,0)>-1}var _arrayIncludes$1=arrayIncludes;function arrayIncludesWith(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}var _arrayIncludesWith=arrayIncludesWith;function cacheHas(e,t){return e.has(t)}var _cacheHas=cacheHas,Set$1=_getNative(_root,"Set"),_Set=Set$1;function noop(){}var noop_1=noop;function setToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var _setToArray=setToArray,INFINITY=1/0,createSet=_Set&&1/_setToArray(new _Set([,-0]))[1]==INFINITY?function(e){return new _Set(e)}:noop_1,_createSet=createSet,LARGE_ARRAY_SIZE=200;function baseUniq(e,t,n){var r=-1,i=_arrayIncludes$1,o=e.length,a=!0,s=[],u=s;if(n)a=!1,i=_arrayIncludesWith;else if(o>=LARGE_ARRAY_SIZE){var c=t?null:_createSet(e);if(c)return _setToArray(c);a=!1,i=_cacheHas,u=new _SetCache}else u=t?[]:s;e:for(;++r<o;){var l=e[r],d=t?t(l):l;if(l=n||0!==l?l:0,a&&d==d){for(var p=u.length;p--;)if(u[p]===d)continue e;t&&u.push(d),s.push(l)}else i(u,d,n)||(u!==s&&u.push(d),s.push(l))}return s}var _baseUniq=baseUniq;function uniq(e){return e&&e.length?_baseUniq(e):[]}var uniq_1=uniq;function fromPairs(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r}var fromPairs_1=fromPairs;function arrayMap(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var _arrayMap=arrayMap;function stackClear(){this.__data__=new _ListCache,this.size=0}var _stackClear=stackClear;function stackDelete(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var _stackDelete=stackDelete;function stackGet(e){return this.__data__.get(e)}var _stackGet=stackGet;function stackHas(e){return this.__data__.has(e)}var _stackHas=stackHas,LARGE_ARRAY_SIZE$1=200;function stackSet(e,t){var n=this.__data__;if(n instanceof _ListCache){var r=n.__data__;if(!_Map||r.length<LARGE_ARRAY_SIZE$1-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new _MapCache(r)}return n.set(e,t),this.size=n.size,this}var _stackSet=stackSet;function Stack(e){var t=this.__data__=new _ListCache(e);this.size=t.size}Stack.prototype.clear=_stackClear,Stack.prototype.delete=_stackDelete,Stack.prototype.get=_stackGet,Stack.prototype.has=_stackHas,Stack.prototype.set=_stackSet;var _Stack=Stack;function arrayEach(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}var _arrayEach=arrayEach,defineProperty$1=function(){try{var e=_getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),_defineProperty$1=defineProperty$1;function baseAssignValue(e,t,n){"__proto__"==t&&_defineProperty$1?_defineProperty$1(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var _baseAssignValue=baseAssignValue,objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty;function assignValue(e,t,n){var r=e[t];hasOwnProperty$5.call(e,t)&&eq_1(r,n)&&(void 0!==n||t in e)||_baseAssignValue(e,t,n)}var _assignValue=assignValue;function copyObject(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],u=r?r(n[s],e[s],s,n,e):void 0;void 0===u&&(u=e[s]),i?_baseAssignValue(n,s,u):_assignValue(n,s,u)}return n}var _copyObject=copyObject;function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var _baseTimes=baseTimes;function isObjectLike(e){return null!=e&&"object"==_typeof(e)}var isObjectLike_1=isObjectLike,argsTag="[object Arguments]";function baseIsArguments(e){return isObjectLike_1(e)&&_baseGetTag(e)==argsTag}var _baseIsArguments=baseIsArguments,objectProto$6=Object.prototype,hasOwnProperty$6=objectProto$6.hasOwnProperty,propertyIsEnumerable=objectProto$6.propertyIsEnumerable,isArguments=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(e){return isObjectLike_1(e)&&hasOwnProperty$6.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")},isArguments_1=isArguments,isArray=Array.isArray,isArray_1=isArray;function stubFalse(){return!1}var stubFalse_1=stubFalse,isBuffer_1=createCommonjsModule((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?_root.Buffer:void 0,o=(i?i.isBuffer:void 0)||stubFalse_1;e.exports=o})),MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var n=_typeof(e);return!!(t=null==t?MAX_SAFE_INTEGER:t)&&("number"==n||"symbol"!=n&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}var _isIndex=isIndex,MAX_SAFE_INTEGER$1=9007199254740991;function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER$1}var isLength_1=isLength,argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike_1(e)&&isLength_1(e.length)&&!!typedArrayTags[_baseGetTag(e)]}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var _baseIsTypedArray=baseIsTypedArray;function baseUnary(e){return function(t){return e(t)}}var _baseUnary=baseUnary,_nodeUtil=createCommonjsModule((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n&&_freeGlobal.process,o=function(){try{return r&&r.require&&r.require("util").types||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o})),nodeIsTypedArray=_nodeUtil&&_nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?_baseUnary(nodeIsTypedArray):_baseIsTypedArray,isTypedArray_1=isTypedArray,objectProto$7=Object.prototype,hasOwnProperty$7=objectProto$7.hasOwnProperty;function arrayLikeKeys(e,t){var n=isArray_1(e),r=!n&&isArguments_1(e),i=!n&&!r&&isBuffer_1(e),o=!n&&!r&&!i&&isTypedArray_1(e),a=n||r||i||o,s=a?_baseTimes(e.length,String):[],u=s.length;for(var c in e)!t&&!hasOwnProperty$7.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||_isIndex(c,u))||s.push(c);return s}var _arrayLikeKeys=arrayLikeKeys,objectProto$8=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$8)}var _isPrototype=isPrototype,_objectSap=function(e,t){var n=(_core.Object||{})[e]||Object[e],r={};r[e]=t(n),_export(_export.S+_export.F*_fails((function(){n(1)})),"Object",r)};function overArg(e,t){return function(n){return e(t(n))}}_objectSap("keys",(function(){return function(e){return _objectKeys(_toObject(e))}}));var _overArg=overArg,nativeKeys=_overArg(Object.keys,Object),_nativeKeys=nativeKeys,objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty;function baseKeys(e){if(!_isPrototype(e))return _nativeKeys(e);var t=[];for(var n in Object(e))hasOwnProperty$8.call(e,n)&&"constructor"!=n&&t.push(n);return t}var _baseKeys=baseKeys;function isArrayLike(e){return null!=e&&isLength_1(e.length)&&!isFunction_1(e)}var isArrayLike_1=isArrayLike;function keys$1(e){return isArrayLike_1(e)?_arrayLikeKeys(e):_baseKeys(e)}var keys_1=keys$1;function baseAssign(e,t){return e&&_copyObject(t,keys_1(t),e)}var _baseAssign=baseAssign;function nativeKeysIn(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}var _nativeKeysIn=nativeKeysIn,objectProto$a=Object.prototype,hasOwnProperty$9=objectProto$a.hasOwnProperty;function baseKeysIn(e){if(!isObject_1(e))return _nativeKeysIn(e);var t=_isPrototype(e),n=[];for(var r in e)("constructor"!=r||!t&&hasOwnProperty$9.call(e,r))&&n.push(r);return n}var _baseKeysIn=baseKeysIn;function keysIn$1(e){return isArrayLike_1(e)?_arrayLikeKeys(e,!0):_baseKeysIn(e)}var keysIn_1=keysIn$1;function baseAssignIn(e,t){return e&&_copyObject(t,keysIn_1(t),e)}var _baseAssignIn=baseAssignIn,_cloneBuffer=createCommonjsModule((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?_root.Buffer:void 0,o=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=o?o(n):new e.constructor(n);return e.copy(r),r}}));function copyArray(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var _copyArray=copyArray;function arrayFilter(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}var _arrayFilter=arrayFilter;function stubArray(){return[]}var stubArray_1=stubArray,objectProto$b=Object.prototype,propertyIsEnumerable$1=objectProto$b.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(e){return null==e?[]:(e=Object(e),_arrayFilter(nativeGetSymbols(e),(function(t){return propertyIsEnumerable$1.call(e,t)})))}:stubArray_1,_getSymbols=getSymbols;function copySymbols(e,t){return _copyObject(e,_getSymbols(e),t)}var _copySymbols=copySymbols;function arrayPush(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var _arrayPush=arrayPush,getPrototype=_overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols$1?function(e){for(var t=[];e;)_arrayPush(t,_getSymbols(e)),e=_getPrototype(e);return t}:stubArray_1,_getSymbolsIn=getSymbolsIn;function copySymbolsIn(e,t){return _copyObject(e,_getSymbolsIn(e),t)}var _copySymbolsIn=copySymbolsIn;function baseGetAllKeys(e,t,n){var r=t(e);return isArray_1(e)?r:_arrayPush(r,n(e))}var _baseGetAllKeys=baseGetAllKeys;function getAllKeys(e){return _baseGetAllKeys(e,keys_1,_getSymbols)}var _getAllKeys=getAllKeys;function getAllKeysIn(e){return _baseGetAllKeys(e,keysIn_1,_getSymbolsIn)}var _getAllKeysIn=getAllKeysIn,DataView$1=_getNative(_root,"DataView"),_DataView=DataView$1,Promise$2=_getNative(_root,"Promise"),_Promise=Promise$2,WeakMap=_getNative(_root,"WeakMap"),_WeakMap=WeakMap,mapTag$1="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$1="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$1="[object DataView]",dataViewCtorString=_toSource(_DataView),mapCtorString=_toSource(_Map),promiseCtorString=_toSource(_Promise),setCtorString=_toSource(_Set),weakMapCtorString=_toSource(_WeakMap),getTag=_baseGetTag;(_DataView&&getTag(new _DataView(new ArrayBuffer(1)))!=dataViewTag$1||_Map&&getTag(new _Map)!=mapTag$1||_Promise&&getTag(_Promise.resolve())!=promiseTag||_Set&&getTag(new _Set)!=setTag$1||_WeakMap&&getTag(new _WeakMap)!=weakMapTag$1)&&(getTag=function(e){var t=_baseGetTag(e),n=t==objectTag$1?e.constructor:void 0,r=n?_toSource(n):"";if(r)switch(r){case dataViewCtorString:return dataViewTag$1;case mapCtorString:return mapTag$1;case promiseCtorString:return promiseTag;case setCtorString:return setTag$1;case weakMapCtorString:return weakMapTag$1}return t});var _getTag=getTag,objectProto$c=Object.prototype,hasOwnProperty$a=objectProto$c.hasOwnProperty;function initCloneArray(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty$a.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var _initCloneArray=initCloneArray,Uint8Array$1=_root.Uint8Array,_Uint8Array=Uint8Array$1;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new _Uint8Array(t).set(new _Uint8Array(e)),t}var _cloneArrayBuffer=cloneArrayBuffer;function cloneDataView(e,t){var n=t?_cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var _cloneDataView=cloneDataView,reFlags=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,reFlags.exec(e));return t.lastIndex=e.lastIndex,t}var _cloneRegExp=cloneRegExp,symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function cloneSymbol(e){return symbolValueOf?Object(symbolValueOf.call(e)):{}}var _cloneSymbol=cloneSymbol;function cloneTypedArray(e,t){var n=t?_cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var _cloneTypedArray=cloneTypedArray,boolTag$1="[object Boolean]",dateTag$1="[object Date]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(e,t,n){var r=e.constructor;switch(t){case arrayBufferTag$1:return _cloneArrayBuffer(e);case boolTag$1:case dateTag$1:return new r(+e);case dataViewTag$2:return _cloneDataView(e,n);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return _cloneTypedArray(e,n);case mapTag$2:return new r;case numberTag$1:case stringTag$1:return new r(e);case regexpTag$1:return _cloneRegExp(e);case setTag$2:return new r;case symbolTag:return _cloneSymbol(e)}}var _initCloneByTag=initCloneByTag,objectCreate=Object.create,baseCreate=function(){function e(){}return function(t){if(!isObject_1(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),_baseCreate=baseCreate;function initCloneObject(e){return"function"!=typeof e.constructor||_isPrototype(e)?{}:_baseCreate(_getPrototype(e))}var _initCloneObject=initCloneObject,mapTag$3="[object Map]";function baseIsMap(e){return isObjectLike_1(e)&&_getTag(e)==mapTag$3}var _baseIsMap=baseIsMap,nodeIsMap=_nodeUtil&&_nodeUtil.isMap,isMap=nodeIsMap?_baseUnary(nodeIsMap):_baseIsMap,isMap_1=isMap,setTag$3="[object Set]";function baseIsSet(e){return isObjectLike_1(e)&&_getTag(e)==setTag$3}var _baseIsSet=baseIsSet,nodeIsSet=_nodeUtil&&_nodeUtil.isSet,isSet=nodeIsSet?_baseUnary(nodeIsSet):_baseIsSet,isSet_1=isSet,CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,argsTag$2="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",mapTag$4="[object Map]",numberTag$2="[object Number]",objectTag$2="[object Object]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",symbolTag$1="[object Symbol]",weakMapTag$2="[object WeakMap]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",cloneableTags={};function baseClone(e,t,n,r,i,o){var a,s=t&CLONE_DEEP_FLAG,u=t&CLONE_FLAT_FLAG,c=t&CLONE_SYMBOLS_FLAG;if(n&&(a=i?n(e,r,i,o):n(e)),void 0!==a)return a;if(!isObject_1(e))return e;var l=isArray_1(e);if(l){if(a=_initCloneArray(e),!s)return _copyArray(e,a)}else{var d=_getTag(e),p=d==funcTag$2||d==genTag$1;if(isBuffer_1(e))return _cloneBuffer(e,s);if(d==objectTag$2||d==argsTag$2||p&&!i){if(a=u||p?{}:_initCloneObject(e),!s)return u?_copySymbolsIn(e,_baseAssignIn(a,e)):_copySymbols(e,_baseAssign(a,e))}else{if(!cloneableTags[d])return i?e:{};a=_initCloneByTag(e,d,s)}}o||(o=new _Stack);var f=o.get(e);if(f)return f;o.set(e,a),isSet_1(e)?e.forEach((function(r){a.add(baseClone(r,t,n,r,e,o))})):isMap_1(e)&&e.forEach((function(r,i){a.set(i,baseClone(r,t,n,i,e,o))}));var h=c?u?_getAllKeysIn:_getAllKeys:u?keysIn:keys_1,g=l?void 0:h(e);return _arrayEach(g||e,(function(r,i){g&&(r=e[i=r]),_assignValue(a,i,baseClone(r,t,n,i,e,o))})),a}cloneableTags[argsTag$2]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$2]=cloneableTags[dataViewTag$3]=cloneableTags[boolTag$2]=cloneableTags[dateTag$2]=cloneableTags[float32Tag$2]=cloneableTags[float64Tag$2]=cloneableTags[int8Tag$2]=cloneableTags[int16Tag$2]=cloneableTags[int32Tag$2]=cloneableTags[mapTag$4]=cloneableTags[numberTag$2]=cloneableTags[objectTag$2]=cloneableTags[regexpTag$2]=cloneableTags[setTag$4]=cloneableTags[stringTag$2]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag$2]=cloneableTags[uint8ClampedTag$2]=cloneableTags[uint16Tag$2]=cloneableTags[uint32Tag$2]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag$2]=cloneableTags[weakMapTag$2]=!1;var _baseClone=baseClone,symbolTag$2="[object Symbol]";function isSymbol$1(e){return"symbol"==_typeof(e)||isObjectLike_1(e)&&_baseGetTag(e)==symbolTag$2}var isSymbol_1=isSymbol$1,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){if(isArray_1(e))return!1;var n=_typeof(e);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!isSymbol_1(e))||reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t)}var _isKey=isKey,FUNC_ERROR_TEXT="Expected a function";function memoize(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT);var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(memoize.Cache||_MapCache),n}memoize.Cache=_MapCache;var memoize_1=memoize,MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var t=memoize_1(e,(function(e){return n.size===MAX_MEMOIZE_SIZE&&n.clear(),e})),n=t.cache;return t}var _memoizeCapped=memoizeCapped,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=_memoizeCapped((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rePropName,(function(e,n,r,i){t.push(r?i.replace(reEscapeChar,"$1"):n||e)})),t})),_stringToPath=stringToPath,INFINITY$1=1/0,symbolProto$1=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto$1?symbolProto$1.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(isArray_1(e))return _arrayMap(e,baseToString)+"";if(isSymbol_1(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY$1?"-0":t}var _baseToString=baseToString;function toString$2(e){return null==e?"":_baseToString(e)}var toString_1=toString$2;function castPath(e,t){return isArray_1(e)?e:_isKey(e,t)?[e]:_stringToPath(toString_1(e))}var _castPath=castPath;function last(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var last_1=last,INFINITY$2=1/0;function toKey(e){if("string"==typeof e||isSymbol_1(e))return e;var t=e+"";return"0"==t&&1/e==-INFINITY$2?"-0":t}var _toKey=toKey;function baseGet(e,t){for(var n=0,r=(t=_castPath(t,e)).length;null!=e&&n<r;)e=e[_toKey(t[n++])];return n&&n==r?e:void 0}var _baseGet=baseGet;function baseSlice(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}var _baseSlice=baseSlice;function parent(e,t){return t.length<2?e:_baseGet(e,_baseSlice(t,0,-1))}var _parent=parent;function baseUnset(e,t){return t=_castPath(t,e),null==(e=_parent(e,t))||delete e[_toKey(last_1(t))]}var _baseUnset=baseUnset,objectTag$3="[object Object]",funcProto$2=Function.prototype,objectProto$d=Object.prototype,funcToString$2=funcProto$2.toString,hasOwnProperty$b=objectProto$d.hasOwnProperty,objectCtorString=funcToString$2.call(Object);function isPlainObject(e){if(!isObjectLike_1(e)||_baseGetTag(e)!=objectTag$3)return!1;var t=_getPrototype(e);if(null===t)return!0;var n=hasOwnProperty$b.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&funcToString$2.call(n)==objectCtorString}var isPlainObject_1=isPlainObject;function customOmitClone(e){return isPlainObject_1(e)?void 0:e}var _customOmitClone=customOmitClone,spreadableSymbol=_Symbol?_Symbol.isConcatSpreadable:void 0;function isFlattenable(e){return isArray_1(e)||isArguments_1(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}var _isFlattenable=isFlattenable;function baseFlatten(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=_isFlattenable),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?baseFlatten(s,t-1,n,r,i):_arrayPush(i,s):r||(i[i.length]=s)}return i}var _baseFlatten=baseFlatten;function flatten(e){return null!=e&&e.length?_baseFlatten(e,1):[]}var flatten_1=flatten;function apply(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var _apply=apply,nativeMax=Math.max;function overRest(e,t,n){return t=nativeMax(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=nativeMax(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),_apply(e,this,s)}}var _overRest=overRest;function constant(e){return function(){return e}}var constant_1=constant;function identity(e){return e}var identity_1=identity,baseSetToString=_defineProperty$1?function(e,t){return _defineProperty$1(e,"toString",{configurable:!0,enumerable:!1,value:constant_1(t),writable:!0})}:identity_1,_baseSetToString=baseSetToString,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(e){var t=0,n=0;return function(){var r=nativeNow(),i=HOT_SPAN-(r-n);if(n=r,i>0){if(++t>=HOT_COUNT)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var _shortOut=shortOut,setToString=_shortOut(_baseSetToString),_setToString=setToString;function flatRest(e){return _setToString(_overRest(e,void 0,flatten_1),e+"")}var _flatRest=flatRest,CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$1=4,omit=_flatRest((function(e,t){var n={};if(null==e)return n;var r=!1;t=_arrayMap(t,(function(t){return t=_castPath(t,e),r||(r=t.length>1),t})),_copyObject(e,_getAllKeysIn(e),n),r&&(n=_baseClone(n,CLONE_DEEP_FLAG$1|CLONE_FLAT_FLAG$1|CLONE_SYMBOLS_FLAG$1,_customOmitClone));for(var i=t.length;i--;)_baseUnset(n,t[i]);return n})),omit_1=omit;function arrayAggregator(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}var _arrayAggregator=arrayAggregator;function createBaseFor(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var u=a[e?s:++i];if(!1===n(o[u],u,o))break}return t}}var _createBaseFor=createBaseFor,baseFor=_createBaseFor(),_baseFor=baseFor;function baseForOwn(e,t){return e&&_baseFor(e,t,keys_1)}var _baseForOwn=baseForOwn;function createBaseEach(e,t){return function(n,r){if(null==n)return n;if(!isArrayLike_1(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Object(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}var _createBaseEach=createBaseEach,baseEach=_createBaseEach(_baseForOwn),_baseEach=baseEach;function baseAggregator(e,t,n,r){return _baseEach(e,(function(e,i,o){t(r,e,n(e),o)})),r}var _baseAggregator=baseAggregator;function arraySome(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var _arraySome=arraySome,COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function equalArrays(e,t,n,r,i,o){var a=n&COMPARE_PARTIAL_FLAG,s=e.length,u=t.length;if(s!=u&&!(a&&u>s))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var l=-1,d=!0,p=n&COMPARE_UNORDERED_FLAG?new _SetCache:void 0;for(o.set(e,t),o.set(t,e);++l<s;){var f=e[l],h=t[l];if(r)var g=a?r(h,f,l,t,e,o):r(f,h,l,e,t,o);if(void 0!==g){if(g)continue;d=!1;break}if(p){if(!_arraySome(t,(function(e,t){if(!_cacheHas(p,t)&&(f===e||i(f,e,n,r,o)))return p.push(t)}))){d=!1;break}}else if(f!==h&&!i(f,h,n,r,o)){d=!1;break}}return o.delete(e),o.delete(t),d}var _equalArrays=equalArrays;function mapToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}var _mapToArray=mapToArray,COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2,boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",mapTag$5="[object Map]",numberTag$3="[object Number]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",symbolTag$3="[object Symbol]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",symbolProto$2=_Symbol?_Symbol.prototype:void 0,symbolValueOf$1=symbolProto$2?symbolProto$2.valueOf:void 0;function equalByTag(e,t,n,r,i,o,a){switch(n){case dataViewTag$4:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag$3:return!(e.byteLength!=t.byteLength||!o(new _Uint8Array(e),new _Uint8Array(t)));case boolTag$3:case dateTag$3:case numberTag$3:return eq_1(+e,+t);case errorTag$2:return e.name==t.name&&e.message==t.message;case regexpTag$3:case stringTag$3:return e==t+"";case mapTag$5:var s=_mapToArray;case setTag$5:var u=r&COMPARE_PARTIAL_FLAG$1;if(s||(s=_setToArray),e.size!=t.size&&!u)return!1;var c=a.get(e);if(c)return c==t;r|=COMPARE_UNORDERED_FLAG$1,a.set(e,t);var l=_equalArrays(s(e),s(t),r,i,o,a);return a.delete(e),l;case symbolTag$3:if(symbolValueOf$1)return symbolValueOf$1.call(e)==symbolValueOf$1.call(t)}return!1}var _equalByTag=equalByTag,COMPARE_PARTIAL_FLAG$2=1,objectProto$e=Object.prototype,hasOwnProperty$c=objectProto$e.hasOwnProperty;function equalObjects(e,t,n,r,i,o){var a=n&COMPARE_PARTIAL_FLAG$2,s=_getAllKeys(e),u=s.length;if(u!=_getAllKeys(t).length&&!a)return!1;for(var c=u;c--;){var l=s[c];if(!(a?l in t:hasOwnProperty$c.call(t,l)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var p=!0;o.set(e,t),o.set(t,e);for(var f=a;++c<u;){var h=e[l=s[c]],g=t[l];if(r)var m=a?r(g,h,l,t,e,o):r(h,g,l,e,t,o);if(!(void 0===m?h===g||i(h,g,n,r,o):m)){p=!1;break}f||(f="constructor"==l)}if(p&&!f){var v=e.constructor,y=t.constructor;v!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y)&&(p=!1)}return o.delete(e),o.delete(t),p}var _equalObjects=equalObjects,COMPARE_PARTIAL_FLAG$3=1,argsTag$3="[object Arguments]",arrayTag$2="[object Array]",objectTag$4="[object Object]",objectProto$f=Object.prototype,hasOwnProperty$d=objectProto$f.hasOwnProperty;function baseIsEqualDeep(e,t,n,r,i,o){var a=isArray_1(e),s=isArray_1(t),u=a?arrayTag$2:_getTag(e),c=s?arrayTag$2:_getTag(t),l=(u=u==argsTag$3?objectTag$4:u)==objectTag$4,d=(c=c==argsTag$3?objectTag$4:c)==objectTag$4,p=u==c;if(p&&isBuffer_1(e)){if(!isBuffer_1(t))return!1;a=!0,l=!1}if(p&&!l)return o||(o=new _Stack),a||isTypedArray_1(e)?_equalArrays(e,t,n,r,i,o):_equalByTag(e,t,u,n,r,i,o);if(!(n&COMPARE_PARTIAL_FLAG$3)){var f=l&&hasOwnProperty$d.call(e,"__wrapped__"),h=d&&hasOwnProperty$d.call(t,"__wrapped__");if(f||h){var g=f?e.value():e,m=h?t.value():t;return o||(o=new _Stack),i(g,m,n,r,o)}}return!!p&&(o||(o=new _Stack),_equalObjects(e,t,n,r,i,o))}var _baseIsEqualDeep=baseIsEqualDeep;function baseIsEqual(e,t,n,r,i){return e===t||(null==e||null==t||!isObjectLike_1(e)&&!isObjectLike_1(t)?e!=e&&t!=t:_baseIsEqualDeep(e,t,n,r,baseIsEqual,i))}var _baseIsEqual=baseIsEqual,COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2;function baseIsMatch(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Object(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var u=(s=n[i])[0],c=e[u],l=s[1];if(a&&s[2]){if(void 0===c&&!(u in e))return!1}else{var d=new _Stack;if(r)var p=r(c,l,u,e,t,d);if(!(void 0===p?_baseIsEqual(l,c,COMPARE_PARTIAL_FLAG$4|COMPARE_UNORDERED_FLAG$2,r,d):p))return!1}}return!0}var _baseIsMatch=baseIsMatch;function isStrictComparable(e){return e==e&&!isObject_1(e)}var _isStrictComparable=isStrictComparable;function getMatchData(e){for(var t=keys_1(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,_isStrictComparable(i)]}return t}var _getMatchData=getMatchData;function matchesStrictComparable(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}var _matchesStrictComparable=matchesStrictComparable;function baseMatches(e){var t=_getMatchData(e);return 1==t.length&&t[0][2]?_matchesStrictComparable(t[0][0],t[0][1]):function(n){return n===e||_baseIsMatch(n,e,t)}}var _baseMatches=baseMatches;function get$1(e,t,n){var r=null==e?void 0:_baseGet(e,t);return void 0===r?n:r}var get_1=get$1;function baseHasIn(e,t){return null!=e&&t in Object(e)}var _baseHasIn=baseHasIn;function hasPath(e,t,n){for(var r=-1,i=(t=_castPath(t,e)).length,o=!1;++r<i;){var a=_toKey(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&isLength_1(i)&&_isIndex(a,i)&&(isArray_1(e)||isArguments_1(e))}var _hasPath=hasPath;function hasIn(e,t){return null!=e&&_hasPath(e,t,_baseHasIn)}var hasIn_1=hasIn,COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function baseMatchesProperty(e,t){return _isKey(e)&&_isStrictComparable(t)?_matchesStrictComparable(_toKey(e),t):function(n){var r=get_1(n,e);return void 0===r&&r===t?hasIn_1(n,e):_baseIsEqual(t,r,COMPARE_PARTIAL_FLAG$5|COMPARE_UNORDERED_FLAG$3)}}var _baseMatchesProperty=baseMatchesProperty;function baseProperty(e){return function(t){return null==t?void 0:t[e]}}var _baseProperty=baseProperty;function basePropertyDeep(e){return function(t){return _baseGet(t,e)}}var _basePropertyDeep=basePropertyDeep;function property(e){return _isKey(e)?_baseProperty(_toKey(e)):_basePropertyDeep(e)}var property_1=property;function baseIteratee(e){return"function"==typeof e?e:null==e?identity_1:"object"==_typeof(e)?isArray_1(e)?_baseMatchesProperty(e[0],e[1]):_baseMatches(e):property_1(e)}var _baseIteratee=baseIteratee;function createAggregator(e,t){return function(n,r){var i=isArray_1(n)?_arrayAggregator:_baseAggregator,o=t?t():{};return i(n,e,_baseIteratee(r),o)}}var _createAggregator=createAggregator,keyBy=_createAggregator((function(e,t,n){_baseAssignValue(e,n,t)})),keyBy_1=keyBy;function mapValues(e,t){var n={};return t=_baseIteratee(t),_baseForOwn(e,(function(e,r,i){_baseAssignValue(n,r,t(e,r,i))})),n}var mapValues_1=mapValues,$at=_stringAt(!0);_iterDefine(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=$at(t,n),this._i+=e.length,{value:e,done:!1})}));var _validateCollection=function(e,t){if(!_isObject(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e},dP$4=_objectDp.f,fastKey=_meta.fastKey,SIZE=_descriptors?"_s":"size",getEntry=function(e,t){var n,r=fastKey(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n},_collectionStrong={getConstructor:function(e,t,n,r){var i=e((function(e,o){_anInstance(e,i,t,"_i"),e._t=t,e._i=_objectCreate(null),e._f=void 0,e._l=void 0,e[SIZE]=0,null!=o&&_forOf(o,n,e[r],e)}));return _redefineAll(i.prototype,{clear:function(){for(var e=_validateCollection(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[SIZE]=0},delete:function(e){var n=_validateCollection(this,t),r=getEntry(n,e);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[SIZE]--}return!!r},forEach:function(e){_validateCollection(this,t);for(var n,r=_ctx(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!getEntry(_validateCollection(this,t),e)}}),_descriptors&&dP$4(i.prototype,"size",{get:function(){return _validateCollection(this,t)[SIZE]}}),i},def:function(e,t,n){var r,i,o=getEntry(e,t);return o?o.v=n:(e._l=o={i:i=fastKey(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[SIZE]++,"F"!==i&&(e._i[i]=o)),e},getEntry:getEntry,setStrong:function(e,t,n){_iterDefine(e,t,(function(e,n){this._t=_validateCollection(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?_iterStep(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,_iterStep(1))}),n?"entries":"values",!n,!0),_setSpecies(t)}},_collection=function(e,t,n,r,i,o){var a=_global[e],s=a,u=i?"set":"add",c=s&&s.prototype,l={},d=function(e){var t=c[e];_redefine(c,e,"delete"==e||"has"==e?function(e){return!(o&&!_isObject(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!_isObject(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof s&&(o||c.forEach&&!_fails((function(){(new s).entries().next()})))){var p=new s,f=p[u](o?{}:-0,1)!=p,h=_fails((function(){p.has(1)})),g=_iterDetect((function(e){new s(e)})),m=!o&&_fails((function(){for(var e=new s,t=5;t--;)e[u](t,t);return!e.has(-0)}));g||((s=t((function(t,n){_anInstance(t,s,e);var r=_inheritIfRequired(new a,t,s);return null!=n&&_forOf(n,i,r[u],r),r}))).prototype=c,c.constructor=s),(h||m)&&(d("delete"),d("has"),i&&d("get")),(m||f)&&d(u),o&&c.clear&&delete c.clear}else s=r.getConstructor(t,e,i,u),_redefineAll(s.prototype,n),_meta.NEED=!0;return _setToStringTag(s,e),l[e]=s,_export(_export.G+_export.W+_export.F*(s!=a),l),o||r.setStrong(s,e,i),s},MAP="Map",es6_map=_collection(MAP,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=_collectionStrong.getEntry(_validateCollection(this,MAP),e);return t&&t.v},set:function(e,t){return _collectionStrong.def(_validateCollection(this,MAP),0===e?0:e,t)}},_collectionStrong,!0),$assign=Object.assign,_objectAssign=!$assign||_fails((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=$assign({},e)[n]||Object.keys($assign({},t)).join("")!=r}))?function(e,t){for(var n=_toObject(e),r=arguments.length,i=1,o=_objectGops.f,a=_objectPie.f;r>i;)for(var s,u=_iobject(arguments[i++]),c=o?_objectKeys(u).concat(o(u)):_objectKeys(u),l=c.length,d=0;l>d;)s=c[d++],_descriptors&&!a.call(u,s)||(n[s]=u[s]);return n}:$assign,_SIZEOF;_export(_export.S+_export.F,"Object",{assign:_objectAssign});var EVENT_ALL="*",EVENT_ENABLE="enable",EVENT_DISABLE="disable",SEMAPHORE=Symbol(),NO_OP=function(){},Type;!function(e){e[e.U8=0]="U8",e[e.U8C=1]="U8C",e[e.I8=2]="I8",e[e.U16=3]="U16",e[e.I16=4]="I16",e[e.U32=5]="U32",e[e.I32=6]="I32",e[e.F32=7]="F32",e[e.F64=8]="F64"}(Type||(Type={}));var SIZEOF=(_SIZEOF={},_defineProperty(_SIZEOF,0,1),_defineProperty(_SIZEOF,1,1),_defineProperty(_SIZEOF,2,1),_defineProperty(_SIZEOF,3,2),_defineProperty(_SIZEOF,4,2),_defineProperty(_SIZEOF,5,4),_defineProperty(_SIZEOF,6,4),_defineProperty(_SIZEOF,7,4),_defineProperty(_SIZEOF,8,8),_SIZEOF),LogLevel;!function(e){e[e.FINE=0]="FINE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.SEVERE=4]="SEVERE",e[e.NONE=5]="NONE"}(LogLevel||(LogLevel={}));var assert="undefined"==typeof process||"1"===process.env.UMBRELLA_ASSERTS?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"assertion failed";if("function"==typeof e&&!e()||!e)throw new Error("function"==typeof t?t():t)}:NO_OP,meta=_meta.onFreeze;_objectSap("freeze",(function(e){return function(t){return e&&_isObject(t)?e(meta(t)):t}}));var NULL_LOGGER=Object.freeze({level:LogLevel.NONE,fine:function(){},debug:function(){},info:function(){},warn:function(){},severe:function(){}}),Reflect$1=_global.Reflect,_ownKeys=Reflect$1&&Reflect$1.ownKeys||function(e){var t=_objectGopn.f(_anObject(e)),n=_objectGops.f;return n?t.concat(n(e)):t};_export(_export.S,"Reflect",{ownKeys:_ownKeys});var mixin=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Reflect.ownKeys(e),r=Reflect.ownKeys(t),i=Symbol("isa");function o(t){var r=n,o=Array.isArray(r),a=0;for(r=o?r:r[Symbol.iterator]();;){var s;if(o){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var u=s,c=Object.getOwnPropertyDescriptor(t.prototype,u);!c||c.configurable?Object.defineProperty(t.prototype,u,{value:e[u],writable:!0}):console.log("not patching: ".concat(t.name,".").concat(u.toString()))}return Object.defineProperty(t.prototype,i,{value:!0}),t}var a=r,s=Array.isArray(a),u=0;for(a=s?a:a[Symbol.iterator]();;){var c;if(s){if(u>=a.length)break;c=a[u++]}else{if((u=a.next()).done)break;c=u.value}var l=c;Object.defineProperty(o,l,{value:t[l],enumerable:t.propertyIsEnumerable(l)})}return Object.defineProperty(o,Symbol.hasInstance,{value:function(e){return!!e[i]}}),o},IllegalArgumentError=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,"illegal argument(s)"+(void 0!==e?": "+e:"")))}return _inherits(t,_wrapNativeSuper(Error)),t}(),illegalArgs=function(e){throw new IllegalArgumentError(e)},IllegalArityError=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,"illegal arity: ".concat(e)))}return _inherits(t,_wrapNativeSuper(Error)),t}(),IllegalStateError=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,"illegal state"+(void 0!==e?": "+e:"")))}return _inherits(t,_wrapNativeSuper(Error)),t}(),UnsupportedOperationError=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,"unsupported operation"+(void 0!==e?": "+e:"")))}return _inherits(t,_wrapNativeSuper(Error)),t}(),meta$1=_meta.onFreeze;_objectSap("seal",(function(e){return function(t){return e&&_isObject(t)?e(meta$1(t)):t}}));var IEnableMixin=mixin({_enabled:!0,isEnabled:function(){return this._enabled},enable:function(){this._enabled=!0,this.notify&&this.notify({id:EVENT_ENABLE,target:this})},disable:function(){this._enabled=!1,this.notify&&this.notify({id:EVENT_DISABLE,target:this})},toggle:function(){return this._enabled?this.disable():this.enable(),this._enabled}}),inotify_dispatch=function(e,t){if(e)for(var n,r=0,i=e.length;r<i;r++)if((n=e[r])[0].call(n[1],t),t.canceled)return},INotifyMixin=mixin({addListener:function(e,t,n){var r=(this._listeners=this._listeners||{})[e];return r||(r=this._listeners[e]=[]),-1===this.__listener(r,t,n)&&(r.push([t,n]),!0)},removeListener:function(e,t,n){if(!this._listeners)return!1;var r=this._listeners[e];if(r){var i=this.__listener(r,t,n);if(-1!==i)return r.splice(i,1),!0}return!1},notify:function(e){this._listeners&&(void 0===e.target&&(e.target=this),inotify_dispatch(this._listeners[e.id],e),inotify_dispatch(this._listeners[EVENT_ALL],e))},__listener:function(e,t,n){for(var r=e.length;--r>=0;){var i=e[r];if(i[0]===t&&i[1]===n)break}return r}}),IWatchMixin=mixin({addWatch:function(e,t){return this._watches=this._watches||{},!this._watches[e]&&(this._watches[e]=t,!0)},removeWatch:function(e){if(this._watches)return!!this._watches[e]&&(delete this._watches[e],!0)},notifyWatches:function(e,t){if(this._watches){var n=this._watches;for(var r in n)n[r](r,e,t)}}}),isArrayLike$1=function(e){return null!=e&&"function"!=typeof e&&void 0!==e.length},SET="Set",es6_set=_collection(SET,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return _collectionStrong.def(_validateCollection(this,SET),e=0===e?0:e,e)}},_collectionStrong);_typedArray("Float64",8,(function(e){return function(t,n,r){return e(this,t,n,r)}})),_typedArray("Int32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}})),_typedArray("Int16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}})),_typedArray("Uint16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}})),_typedArray("Int8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}})),_typedArray("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0),_typedArray("Uint32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}})),_typedArray("Float32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}));var compare=function(e,t){return e===t?0:null==e?null==t?0:-1:null==t?null==e?0:1:"function"==typeof e.compare?e.compare(t):"function"==typeof t.compare?-t.compare(e):e<t?-1:e>t?1:0},OBJP=Object.getPrototypeOf({}),FN="function",STR="string",equiv=function(e,t){var n;return e===t||(null==e?e==t:_typeof(e.equiv)===FN?e.equiv(t):null==t?e==t:_typeof(t.equiv)===FN?t.equiv(e):_typeof(e)!==STR&&_typeof(t)!==STR&&(null!=(n=Object.getPrototypeOf(e))&&n!==OBJP||null!=(n=Object.getPrototypeOf(t))&&n!==OBJP?_typeof(e)!==FN&&void 0!==e.length&&_typeof(t)!==FN&&void 0!==t.length?equivArrayLike(e,t):e instanceof Set&&t instanceof Set?equivSet(e,t):e instanceof Map&&t instanceof Map?equivMap(e,t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:equivObject(e,t)))},equivArrayLike=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:equiv,r=e.length;if(r===t.length)for(;--r>=0&&n(e[r],t[r]););return r<0},equivSet=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:equiv;return e.size===t.size&&n(_toConsumableArray(e.keys()).sort(),_toConsumableArray(t.keys()).sort())},equivMap=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:equiv;return e.size===t.size&&n(_toConsumableArray(e).sort(),_toConsumableArray(t).sort())},equivObject=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:equiv;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in e)if(!t.hasOwnProperty(r)||!n(e[r],t[r]))return!1;return!0},Reduced=function(){function e(t){_classCallCheck(this,e),this.value=t}return _createClass(e,[{key:"deref",value:function(){return this.value}}]),e}(),isReduced=function(e){return e instanceof Reduced},unreduced=function(e){return e instanceof Reduced?e.deref():e},_marked2=regenerator.mark(iterator1);function iterator1(e,t){var n,r,i,o,a,s;return regenerator.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:n=e([NO_OP,NO_OP,function(e,t){return t}])[2],r=t,i=Array.isArray(r),o=0,r=i?r:r[Symbol.iterator]();case 2:if(!i){u.next=8;break}if(!(o>=r.length)){u.next=5;break}return u.abrupt("break",25);case 5:a=r[o++],u.next=12;break;case 8:if(!(o=r.next()).done){u.next=11;break}return u.abrupt("break",25);case 11:a=o.value;case 12:if(s=n(SEMAPHORE,a),!isReduced(s)){u.next=20;break}if((s=unreduced(s.deref()))===SEMAPHORE){u.next=19;break}return u.next=19,s;case 19:return u.abrupt("return");case 20:if(s===SEMAPHORE){u.next=23;break}return u.next=23,s;case 23:u.next=2;break;case 25:case"end":return u.stop()}}),_marked2)}var compR=function(e,t){return[e[0],e[1],t]};function map(e,t){return t?iterator1(map(e),t):function(t){var n=t[2];return compR(t,(function(t,r){return n(t,e(r))}))}}function partial(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],c=n[5],l=n[6],d=n[7];switch(n.length){case 1:return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,[i].concat(n))};case 2:return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,[i,o].concat(n))};case 3:return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,[i,o,a].concat(n))};case 4:return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,[i,o,a,s].concat(n))};case 5:return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,[i,o,a,s,u].concat(n))};case 6:return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,[i,o,a,s,u,c].concat(n))};case 7:return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,[i,o,a,s,u,c,l].concat(n))};case 8:return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,[i,o,a,s,u,c,l,d].concat(n))};default:illegalArgs()}}var foo=partial((function(e,t){return e+t}),"a"),INV_MAX=1/4294967295,ARandom=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"float",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.int()*INV_MAX*e}},{key:"norm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.int()*INV_MAX*e*2-e}},{key:"minmax",value:function(e,t){return this.float()*(t-e)+e}},{key:"gaussian",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=0,i=e;i-- >0;)r+=this.float(n);return r/e+t}}]),e}(),random=Math.random,SystemRandom=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,ARandom),_createClass(t,[{key:"int",value:function(){return 4294967295*random()>>>0}},{key:"float",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return random()*e}}]),t}(),SYSTEM=new SystemRandom;_export(_export.P,"Array",{fill:_arrayFill}),_addToUnscopables("fill");var DCons=function(){function e(t){_classCallCheck(this,e),this._length=0,t&&this.into(t)}return _createClass(e,[{key:"copy",value:function(){return new e(this)}},{key:"empty",value:function(){return new e}},{key:"clear",value:function(){this.release()}},{key:"release",value:function(){for(var e,t=this.head;t;)e=t.next,delete t.value,delete t.prev,delete t.next,t=e;return delete this.head,delete this.tail,this._length=0,!0}},{key:"compare",value:function(e){var t=this._length;if(t<e._length)return-1;if(t>e._length)return 1;if(0===t)return 0;for(var n=this.head,r=e.head,i=0;n&&0==i;)i=compare(n.value,r.value),n=n.next,r=r.next;return i}},{key:"equiv",value:function(t){if((t instanceof e||isArrayLike$1(t))&&this._length===t.length){if(0===this._length)return!0;var n=this.head,r=t,i=Array.isArray(r),o=0;for(r=i?r:r[Symbol.iterator]();;){var a;if(i){if(o>=r.length)break;a=r[o++]}else{if((o=r.next()).done)break;a=o.value}var s=a;if(!equiv(n.value,s))return!1;n=n.next}return!0}return!1}},{key:Symbol.iterator,value:regenerator.mark((function e(){var t;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=7;break}return e.next=4,t.value;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"cycle",value:regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this,"t0",2);case 2:e.next=0;break;case 4:case"end":return e.stop()}}),e,this)}))},{key:"$reduce",value:function(e,t){for(var n=this.head;n&&!isReduced(t);)t=e(t,n.value),n=n.next;return t}},{key:"drop",value:function(){var e=this.head;if(e)return this.head=e.next,this.head?delete this.head.prev:delete this.tail,this._length--,e.value}},{key:"cons",value:function(e){var t={value:e,next:this.head};return this.head?this.head.prev=t:this.tail=t,this.head=t,this._length++,this}},{key:"insertBefore",value:function(e,t){e||illegalArgs("cell is undefined");var n={value:t,next:e,prev:e.prev};return e.prev?e.prev.next=n:this.head=n,e.prev=n,this._length++,this}},{key:"insertAfter",value:function(e,t){e||illegalArgs("cell is undefined");var n={value:t,next:e.next,prev:e};return e.next?e.next.prev=n:this.tail=n,e.next=n,this._length++,this}},{key:"insertBeforeNth",value:function(e,t){return e<0&&(e+=this._length),e<=0?this.cons(t):(this.ensureIndex(e),this.insertBefore(this.nthCellUnsafe(e),t))}},{key:"insertAfterNth",value:function(e,t){return e<0&&(e+=this._length),e>=this._length-1?this.push(t):(this.ensureIndex(e),this.insertAfter(this.nthCellUnsafe(e),t))}},{key:"insertSorted",value:function(e,t){t=t||compare;for(var n=this.head;n;){if(t(e,n.value)<=0)return this.insertBefore(n,e);n=n.next}return this.push(e)}},{key:"find",value:function(e){for(var t=this.head;t;){if(t.value===e)return t;t=t.next}}},{key:"findWith",value:function(e){for(var t=this.head;t;){if(e(t.value))return t;t=t.next}}},{key:"concat",value:function(){for(var e=this.copy(),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];e.into(a)}return e}},{key:"into",value:function(e){var t=e,n=Array.isArray(t),r=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}var o=i;this.push(o)}}},{key:"slice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,r=t<0?t+this._length:t,i=n<0?n+this._length:n;(r<0||i<0)&&illegalArgs("invalid indices: ${from} / ${to}");for(var o=new e,a=this.nthCell(r);a&&++r<=i;)o.push(a.value),a=a.next;return o}},{key:"splice",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;"number"==typeof t?(t<0&&(t+=this._length),this.ensureIndex(t),n=this.nthCellUnsafe(t)):n=t;var o=new e;if(r>0)for(;n&&r-- >0;)this.remove(n),o.push(n.value),n=n.next;else n&&(n=n.next);if(i)if(n){var a=i,s=Array.isArray(a),u=0;for(a=s?a:a[Symbol.iterator]();;){var c;if(s){if(u>=a.length)break;c=a[u++]}else{if((u=a.next()).done)break;c=u.value}var l=c;this.insertBefore(n,l)}}else{var d=i,p=Array.isArray(d),f=0;for(d=p?d:d[Symbol.iterator]();;){var h;if(p){if(f>=d.length)break;h=d[f++]}else{if((f=d.next()).done)break;h=f.value}var g=h;this.push(g)}}return o}},{key:"remove",value:function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,this._length--,this}},{key:"swap",value:function(e,t){if(e!==t){var n=e.value;e.value=t.value,t.value=n}return this}},{key:"push",value:function(e){if(this.tail){var t={value:e,prev:this.tail};return this.tail.next=t,this.tail=t,this._length++,this}return this.cons(e)}},{key:"pop",value:function(){var e=this.tail;if(e)return this.tail=e.prev,this.tail?delete this.tail.next:delete this.head,this._length--,e.value}},{key:"first",value:function(){return this.head&&this.head.value}},{key:"peek",value:function(){return this.tail&&this.tail.value}},{key:"setHead",value:function(e){return this.head?(this.head.value=e,this):this.cons(e)}},{key:"setTail",value:function(e){return this.tail?(this.tail.value=e,this):this.push(e)}},{key:"setNth",value:function(e,t){var n=this.nthCell(e);return!n&&illegalArgs("index out of bounds: ".concat(e)),n.value=t,this}},{key:"nth",value:function(e,t){var n=this.nthCell(e);return n?n.value:t}},{key:"nthCell",value:function(e){if(e<0&&(e+=this._length),!(e<0||e>=this._length))return this.nthCellUnsafe(e)}},{key:"rotateLeft",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:return this.push(this.drop())}}},{key:"rotateRight",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:var e=this.peek();return this.pop(),this.cons(e)}}},{key:"map",value:function(t){for(var n=new e,r=this.head;r;)n.push(t(r.value)),r=r.next;return n}},{key:"filter",value:function(t){for(var n=new e,r=this.head;r;)t(r.value)&&n.push(r.value),r=r.next;return n}},{key:"reduce",value:function(e,t){for(var n=t,r=this.head;r;)n=e(n,r.value),r=r.next;return n}},{key:"shuffle",value:function(){for(var e=this._length,t=this.tail;e>1;){var n=Math.floor(Math.random()*e);this.swap(this.nthCell(n),t),t=t.prev,e--}return this}},{key:"reverse",value:function(){for(var e=this.head,t=this.tail,n=(this._length>>>1)+(1&this._length);e&&t&&n>0;){var r=e.value;e.value=t.value,t.value=r,e=e.next,t=t.prev,n--}return this}},{key:"asHead",value:function(e){return e===this.head||(this.remove(e),this.head.prev=e,e.next=this.head,e.prev=void 0,this.head=e,this._length++),this}},{key:"asTail",value:function(e){return e===this.tail||(this.remove(e),this.tail.next=e,e.prev=this.tail,e.next=void 0,this.tail=e,this._length++),this}},{key:"toString",value:function(){for(var e=[],t=this.head;t;)e.push(null!=t.value?String(t.value):void 0===t.value?"undefined":"null"),t=t.next;return e.join(", ")}},{key:"toJSON",value:function(){return _toConsumableArray(this)}},{key:"ensureIndex",value:function(e){assert(e>=0&&e<this._length,"index out of range: ".concat(e))}},{key:"nthCellUnsafe",value:function(e){var t,n;for(e<=this._length>>1?(t=this.head,n="next"):(t=this.tail,n="prev",e=this._length-e-1);e-- >0&&t;)t=t[n];return t}},{key:"length",get:function(){return this._length}}]),e}(),LRUCache=function(){function e(t,n){_classCallCheck(this,e);var r=Object.assign({maxlen:1/0,maxsize:1/0,map:function(){return new Map},ksize:function(){return 0},vsize:function(){return 0}},n);this.map=r.map(),this.items=new DCons,this._size=0,this.opts=r,t&&this.into(t)}return _createClass(e,[{key:Symbol.iterator,value:function(){return this.entries()}},{key:"entries",value:function(){return map((function(e){return[e.k,e]}),this.items)}},{key:"keys",value:function(){return map((function(e){return e.k}),this.items)}},{key:"values",value:function(){return map((function(e){return e.v}),this.items)}},{key:"copy",value:function(){var e=this.empty();e.items=this.items.copy();for(var t=e.items.head;t;)e.map.set(t.value.k,t),t=t.next;return e}},{key:"empty",value:function(){return new e(null,this.opts)}},{key:"release",value:function(){this._size=0,this.map.clear();var e=this.opts.release;if(e){for(var t;t=this.items.drop();)e(t.k,t.v);return!0}return this.items.release()}},{key:"has",value:function(e){return this.map.has(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?this.resetEntry(n):t}},{key:"set",value:function(e,t){var n=this.opts.ksize(e)+this.opts.vsize(t),r=this.map.get(e);return r&&(this._size-=r.value.s),this._size+=n,this.ensureSize()&&(r?(r.value.v=t,r.value.s=n,this.items.asTail(r)):(this.items.push({k:e,v:t,s:n}),this.map.set(e,this.items.tail))),t}},{key:"into",value:function(e){var t=e,n=Array.isArray(t),r=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}var o=i;this.set(o[0],o[1])}return this}},{key:"getSet",value:function(e,t){var n=this,r=this.map.get(e);return r?Promise.resolve(this.resetEntry(r)):t().then((function(t){return n.set(e,t)}))}},{key:"delete",value:function(e){var t=this.map.get(e);return!!t&&(this.removeEntry(t),!0)}},{key:"resetEntry",value:function(e){return this.items.asTail(e),e.value.v}},{key:"ensureSize",value:function(){for(var e=this.opts.release,t=this.opts.maxsize,n=this.opts.maxlen;this._size>t||this.length>=n;){var r=this.items.drop();if(!r)return!1;this.map.delete(r.k),e&&e(r.k,r.v),this._size-=r.s}return!0}},{key:"removeEntry",value:function(e){var t=e.value;this.map.delete(t.k),this.items.remove(e),this.opts.release&&this.opts.release(t.k,t.v),this._size-=t.s}},{key:"length",get:function(){return this.items.length}},{key:"size",get:function(){return this._size}}]),e}(),TLRUCache=function(e){function t(e,n){return _classCallCheck(this,t),n=Object.assign({ttl:36e5},n),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))}return _inherits(t,LRUCache),_createClass(t,[{key:"empty",value:function(){return new t(null,this.opts)}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);if(n){if(n.value.t>=Date.now())return this.resetEntry(n);this.removeEntry(n)}return t}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.opts.ttl,r=this.opts.ksize(e)+this.opts.vsize(t),i=this.map.get(e);if(i&&(this._size-=i.value.s),this._size+=r,this.ensureSize()){var o=Date.now()+n;i?(i.value.v=t,i.value.s=r,i.value.t=o,this.items.asTail(i)):(this.items.push({k:e,v:t,s:r,t:o}),this.map.set(e,this.items.tail))}return t}},{key:"getSet",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.opts.ttl,i=this.get(e);return i?Promise.resolve(i):t().then((function(t){return n.set(e,t,r)}))}},{key:"prune",value:function(){for(var e=Date.now(),t=this.items.head;t;)t.value.t<e&&this.removeEntry(t),t=t.next}},{key:"ensureSize",value:function(){for(var e=this.opts.maxsize,n=this.opts.maxlen,r=Date.now(),i=this.items.head;i&&(this._size>e||this.length>=n);)i.value.t<r&&this.removeEntry(i),i=i.next;return _get(_getPrototypeOf(t.prototype),"ensureSize",this).call(this)}}]),t}(),_stringWs="\t\n\v\f\r \u2028\u2029\ufeff",space="["+_stringWs+"]",non="",ltrim=RegExp("^"+space+space+"*"),rtrim=RegExp(space+space+"*$"),exporter=function(e,t,n){var r={},i=_fails((function(){return!!_stringWs[e]()||non[e]()!=non})),o=r[e]=i?t(trim):_stringWs[e];n&&(r[n]=o),_export(_export.P+_export.F*i,"String",r)},trim=exporter.trim=function(e,t){return e=String(_defined(e)),1&t&&(e=e.replace(ltrim,"")),2&t&&(e=e.replace(rtrim,"")),e},_stringTrim=exporter,gOPN$3=_objectGopn.f,gOPD$2=_objectGopd.f,dP$5=_objectDp.f,$trim=_stringTrim.trim,NUMBER="Number",$Number=_global[NUMBER],Base$1=$Number,proto$2=$Number.prototype,BROKEN_COF=_cof(_objectCreate(proto$2))==NUMBER,TRIM="trim"in String.prototype,toNumber=function(e){var t=_toPrimitive(e,!1);if("string"==typeof t&&t.length>2){var n,r,i,o=(t=TRIM?t.trim():$trim(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var a,s=t.slice(2),u=0,c=s.length;u<c;u++)if((a=s.charCodeAt(u))<48||a>i)return NaN;return parseInt(s,r)}}return+t};if(!$Number(" 0o1")||!$Number("0b1")||$Number("+0x1")){$Number=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof $Number&&(BROKEN_COF?_fails((function(){proto$2.valueOf.call(n)})):_cof(n)!=NUMBER)?_inheritIfRequired(new Base$1(toNumber(t)),n,$Number):toNumber(t)};for(var keys$2=_descriptors?gOPN$3(Base$1):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),j$1=0,key$1;keys$2.length>j$1;j$1++)_has(Base$1,key$1=keys$2[j$1])&&!_has($Number,key$1)&&dP$5($Number,key$1,gOPD$2(Base$1,key$1));$Number.prototype=proto$2,proto$2.constructor=$Number,_redefine(_global,NUMBER,$Number)}_export(_export.S,"Number",{isNaN:function(e){return e!=e}});var rApply=(_global.Reflect||{}).apply,fApply=Function.apply;_export(_export.S+_export.F*!_fails((function(){rApply((function(){}))})),"Reflect",{apply:function(e,t,n){var r=_aFunction(e),i=_anObject(n);return rApply?rApply(r,t,i):fApply.call(r,t,i)}});var R="object"===("undefined"==typeof Reflect?"undefined":_typeof(Reflect))?Reflect:null,ReflectApply=R&&"function"==typeof R.apply?R.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},ReflectOwnKeys;function ProcessEmitWarning(e){console&&console.warn&&console.warn(e)}ReflectOwnKeys=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var NumberIsNaN=Number.isNaN||function(e){return e!=e};function EventEmitter(){EventEmitter.init.call(this)}var events=EventEmitter;EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function $getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function _addListener(e,t,n,r){var i,o,a;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+_typeof(n));if(void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=$getMaxListeners(e))>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,ProcessEmitWarning(s)}return e}function onceWrapper(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,ReflectApply(this.listener,this.target,e))}function _onceWrap(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=onceWrapper.bind(r);return i.listener=n,r.wrapFn=i,i}function _listeners(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?unwrapListeners(i):arrayClone(i,i.length)}function listenerCount(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function arrayClone(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function unwrapListeners(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function getType(e){return Object.prototype.toString.call(e).slice(8,-1)}function isPlainObject$1(e){return"Object"===getType(e)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function isNil(e){return null==e}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");defaultMaxListeners=e}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},EventEmitter.prototype.getMaxListeners=function(){return $getMaxListeners(this)},EventEmitter.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var s=i[e];if(void 0===s)return!1;if("function"==typeof s)ReflectApply(s,this,t);else{var u=s.length,c=arrayClone(s,u);for(n=0;n<u;++n)ReflectApply(c[n],this,t)}return!0},EventEmitter.prototype.addListener=function(e,t){return _addListener(this,e,t,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(e,t){return _addListener(this,e,t,!0)},EventEmitter.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+_typeof(t));return this.on(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+_typeof(t));return this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.removeListener=function(e,t){var n,r,i,o,a;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+_typeof(t));if(void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():spliceOne(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},EventEmitter.prototype.listeners=function(e){return _listeners(this,e,!0)},EventEmitter.prototype.rawListeners=function(e){return _listeners(this,e,!1)},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};var isNil_1=isNil,quot=/"/g,createHTML=function(e,t,n,r){var i=String(_defined(e)),o="<"+t;return""!==n&&(o+=" "+n+'="'+String(r).replace(quot,"&quot;")+'"'),o+">"+i+"</"+t+">"},_stringHtml=function(e,t){var n={};n[e]=t(createHTML),_export(_export.P+_export.F*_fails((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)};_stringHtml("sub",(function(e){return function(){return e(this,"sub","","")}}));var long_1=Long,wasm=null;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Long(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function isLong(e){return!0===(e&&e.__isLong__)}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=UINT_CACHE[e])?r:(n=fromBits(e,(0|e)<0?-1:0,!0),i&&(UINT_CACHE[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=INT_CACHE[e])?r:(n=fromBits(e,e<0?-1:0,!1),i&&(INT_CACHE[e]=n),n)}function fromNumber(e,t){if(isNaN(e))return t?UZERO:ZERO;if(t){if(e<0)return UZERO;if(e>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(e<=-TWO_PWR_63_DBL)return MIN_VALUE;if(e+1>=TWO_PWR_63_DBL)return MAX_VALUE}return e<0?fromNumber(-e,t).neg():fromBits(e%TWO_PWR_32_DBL|0,e/TWO_PWR_32_DBL|0,t)}function fromBits(e,t,n){return new Long(e,t,n)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var pow_dbl=Math.pow;function fromString(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return ZERO;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return fromString(e.substring(1),t,n).neg();for(var i=fromNumber(pow_dbl(n,8)),o=ZERO,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+s),n);if(s<8){var c=fromNumber(pow_dbl(n,s));o=o.mul(c).add(fromNumber(u))}else o=(o=o.mul(i)).add(fromNumber(u))}return o.unsigned=t,o}function fromValue(e,t){return"number"==typeof e?fromNumber(e,t):"string"==typeof e?fromString(e,t):fromBits(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}Long.fromString=fromString,Long.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype;LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(MIN_VALUE)){var t=fromNumber(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=fromNumber(pow_dbl(e,6),this.unsigned),o=this,a="";;){var s=o.div(i),u=(o.sub(s.mul(i)).toInt()>>>0).toString(e);if((o=s).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},LongPrototype.getHighBits=function(){return this.high},LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0},LongPrototype.getLowBits=function(){return this.low},LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0},LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},LongPrototype.isZero=function(){return 0===this.high&&0===this.low},LongPrototype.eqz=LongPrototype.isZero,LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function(){return this.unsigned||this.high>=0},LongPrototype.isOdd=function(){return 1==(1&this.low)},LongPrototype.isEven=function(){return 0==(1&this.low)},LongPrototype.equals=function(e){return isLong(e)||(e=fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function(e){return!this.eq(e)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.ne=LongPrototype.notEquals,LongPrototype.lessThan=function(e){return this.comp(e)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function(e){return this.comp(e)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.le=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function(e){return this.comp(e)>0},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function(e){return this.comp(e)>=0},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.ge=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function(e){isLong(e)||(e=fromValue(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=0,c=0,l=0,d=0;return l+=(d+=i+(65535&e.low))>>>16,c+=(l+=r+s)>>>16,u+=(c+=n+a)>>>16,u+=t+o,fromBits((l&=65535)<<16|(d&=65535),(u&=65535)<<16|(c&=65535),this.unsigned)},LongPrototype.subtract=function(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function(e){if(this.isZero())return ZERO;if(isLong(e)||(e=fromValue(e)),wasm)return fromBits(wasm.mul(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned);if(e.isZero())return ZERO;if(this.eq(MIN_VALUE))return e.isOdd()?MIN_VALUE:ZERO;if(e.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TWO_PWR_24)&&e.lt(TWO_PWR_24))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=65535&e.low,c=0,l=0,d=0,p=0;return d+=(p+=i*u)>>>16,l+=(d+=r*u)>>>16,d&=65535,l+=(d+=i*s)>>>16,c+=(l+=n*u)>>>16,l&=65535,c+=(l+=r*s)>>>16,l&=65535,c+=(l+=i*a)>>>16,c+=t*u+n*s+r*a+i*o,fromBits((d&=65535)<<16|(p&=65535),(c&=65535)<<16|(l&=65535),this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");var t,n,r;if(wasm)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?fromBits((this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?UZERO:ZERO;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return UZERO;if(e.gt(this.shru(1)))return UONE;r=UZERO}else{if(this.eq(MIN_VALUE))return e.eq(ONE)||e.eq(NEG_ONE)?MIN_VALUE:e.eq(MIN_VALUE)?ONE:(t=this.shr(1).div(e).shl(1)).eq(ZERO)?e.isNegative()?ONE:NEG_ONE:(n=this.sub(e.mul(t)),r=t.add(n.div(e)));if(e.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=ZERO}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:pow_dbl(2,i-48),a=fromNumber(t),s=a.mul(e);s.isNegative()||s.gt(n);)s=(a=fromNumber(t-=o,this.unsigned)).mul(e);a.isZero()&&(a=ONE),r=r.add(a),n=n.sub(s)}return r},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function(e){return isLong(e)||(e=fromValue(e)),wasm?fromBits((this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.rem=LongPrototype.modulo,LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.and=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)},LongPrototype.or=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)},LongPrototype.xor=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)},LongPrototype.shiftLeft=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function(e){if(isLong(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?fromBits(this.low>>>e|t<<32-e,t>>>e,this.unsigned):fromBits(32===e?t:t>>>e-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.shr_u=LongPrototype.shiftRightUnsigned,LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},LongPrototype.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Long.fromBytes=function(e,t,n){return n?Long.fromBytesLE(e,t):Long.fromBytesBE(e,t)},Long.fromBytesLE=function(e,t){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Long.fromBytesBE=function(e,t){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var _extendStatics=function(e,t){return(_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function __extends(e,t){function n(){this.constructor=e}_extendStatics(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function isFunction$1(e){return"function"==typeof e}var _enable_super_gross_mode_that_will_cause_bad_things=!1,config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack,_enable_super_gross_mode_that_will_cause_bad_things=e},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things}};function hostReportError(e){setTimeout((function(){throw e}),0)}var empty$1={closed:!0,next:function(e){},error:function(e){if(config.useDeprecatedSynchronousErrorHandling)throw e;hostReportError(e)},complete:function(){}},isArray$1=Array.isArray||function(e){return e&&"number"==typeof e.length};function isObject$1(e){return null!==e&&"object"===_typeof(e)}function UnsubscriptionErrorImpl(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}UnsubscriptionErrorImpl.prototype=Object.create(Error.prototype);var UnsubscriptionError=UnsubscriptionErrorImpl,Subscription=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}var t;return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this._parentOrParents,r=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var o=0;o<n.length;++o)n[o].remove(this);if(isFunction$1(r))try{r.call(this)}catch(e){t=e instanceof UnsubscriptionError?flattenUnsubscriptionErrors(e.errors):[e]}if(isArray$1(i)){o=-1;for(var a=i.length;++o<a;){var s=i[o];if(isObject$1(s))try{s.unsubscribe()}catch(e){t=t||[],e instanceof UnsubscriptionError?t=t.concat(flattenUnsubscriptionErrors(e.errors)):t.push(e)}}}if(t)throw new UnsubscriptionError(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(_typeof(t)){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=((t=new e).closed=!0,t),e}();function flattenUnsubscriptionErrors(e){return e.reduce((function(e,t){return e.concat(t instanceof UnsubscriptionError?t.errors:t)}),[])}var rxSubscriber="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),Subscriber=function(e){function t(n,r,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=empty$1;break;case 1:if(!n){o.destination=empty$1;break}if("object"===_typeof(n)){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new SafeSubscriber(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new SafeSubscriber(o,n,r,i)}return o}return __extends(t,e),t.prototype[rxSubscriber]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(Subscription),SafeSubscriber=function(e){function t(t,n,r,i){var o,a=e.call(this)||this;a._parentSubscriber=t;var s=a;return isFunction$1(n)?o=n:n&&(o=n.next,r=n.error,i=n.complete,n!==empty$1&&(isFunction$1((s=Object.create(n)).unsubscribe)&&a.add(s.unsubscribe.bind(s)),s.unsubscribe=a.unsubscribe.bind(a))),a._context=s,a._next=o,a._error=r,a._complete=i,a}return __extends(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=config.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):hostReportError(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;hostReportError(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),config.useDeprecatedSynchronousErrorHandling)throw e;hostReportError(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return config.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(hostReportError(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Subscriber),OuterSubscriber=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(Subscriber),InnerSubscriber=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return __extends(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(Subscriber),subscribeToArray=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}},subscribeToPromise=function(e){return function(t){return e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,hostReportError),t}};function getSymbolIterator(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var iterator=getSymbolIterator(),subscribeToIterable=function(e){return function(t){for(var n=e[iterator]();;){var r=n.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t}},observable="function"==typeof Symbol&&Symbol.observable||"@@observable",subscribeToObservable=function(e){return function(t){var n=e[observable]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(t)}},isArrayLike$2=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function isPromise(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var subscribeTo=function(e){if(e&&"function"==typeof e[observable])return subscribeToObservable(e);if(isArrayLike$2(e))return subscribeToArray(e);if(isPromise(e))return subscribeToPromise(e);if(e&&"function"==typeof e[iterator])return subscribeToIterable(e);var t=isObject$1(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function canReportError(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof Subscriber?r:null}return!0}function toSubscriber(e,t,n){if(e){if(e instanceof Subscriber)return e;if(e[rxSubscriber])return e[rxSubscriber]()}return e||t||n?new Subscriber(e,t,n):new Subscriber(empty$1)}function noop$1(){}function pipe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pipeFromArray(e)}function pipeFromArray(e){return e?1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}:noop$1}var Observable=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=toSubscriber(e,t,n);if(r?i.add(r.call(i,this.source)):i.add(this.source||config.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),config.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){config.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),canReportError(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=getPromiseCtor(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:pipeFromArray(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=getPromiseCtor(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function getPromiseCtor(e){if(e||(e=Promise),!e)throw new Error("no Promise impl found");return e}function subscribeToResult(e,t,n,r,i){if(void 0===i&&(i=new InnerSubscriber(e,n,r)),!i.closed)return t instanceof Observable?t.subscribe(i):subscribeTo(t)(i)}var Action=function(e){function t(t,n){return e.call(this)||this}return __extends(t,e),t.prototype.schedule=function(e,t){return this},t}(Subscription),AsyncAction=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return __extends(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(Action),Scheduler=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),AsyncScheduler=function(e){function t(n,r){void 0===r&&(r=Scheduler.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return __extends(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Scheduler),async=new AsyncScheduler(AsyncAction);function isNumeric(e){return!isArray$1(e)&&e-parseFloat(e)+1>=0}function isScheduler(e){return e&&"function"==typeof e.schedule}function timer(e,t,n){void 0===e&&(e=0);var r=-1;return isNumeric(t)?r=Number(t)<1?1:Number(t):isScheduler(t)&&(n=t),isScheduler(n)||(n=async),new Observable((function(t){var i=isNumeric(e)?e:+e-n.now();return n.schedule(dispatch,i,{index:0,period:r,subscriber:t})}))}function dispatch(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}function catchError(e){return function(t){var n=new CatchOperator(e),r=t.lift(n);return n.caught=r}}var CatchOperator=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new CatchSubscriber(e,this.selector,this.caught))},e}(),CatchSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.selector=n,i.caught=r,i}return __extends(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=void 0;try{n=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle();var r=new InnerSubscriber(this,void 0,void 0);this.add(r),subscribeToResult(this,n,void 0,void 0,r)}},t}(OuterSubscriber);function scheduleArray(e,t){return new Observable((function(n){var r=new Subscription,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function fromArray(e,t){return t?scheduleArray(e,t):new Observable(subscribeToArray(e))}var NONE={};function combineLatest(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=null,r=null;return isScheduler(e[e.length-1])&&(r=e.pop()),"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&isArray$1(e[0])&&(e=e[0]),fromArray(e,r).lift(new CombineLatestOperator(n))}var CombineLatestOperator=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new CombineLatestSubscriber(e,this.resultSelector))},e}(),CombineLatestSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return __extends(t,e),t.prototype._next=function(e){this.values.push(NONE),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(subscribeToResult(this,r,r,n))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n,r,i){var o=this.values,a=o[n],s=this.toRespond?a===NONE?--this.toRespond:this.toRespond:0;o[n]=t,0===s&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(OuterSubscriber);function scheduleObservable(e,t){return new Observable((function(n){var r=new Subscription;return r.add(t.schedule((function(){var i=e[observable]();r.add(i.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}function schedulePromise(e,t){return new Observable((function(n){var r=new Subscription;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}))}function scheduleIterable(e,t){if(!e)throw new Error("Iterable cannot be null");return new Observable((function(n){var r,i=new Subscription;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(t.schedule((function(){r=e[iterator](),i.add(t.schedule((function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(e){return void n.error(e)}t?n.complete():(n.next(e),this.schedule())}})))}))),i}))}function isInteropObservable(e){return e&&"function"==typeof e[observable]}function isIterable(e){return e&&"function"==typeof e[iterator]}function scheduled(e,t){if(null!=e){if(isInteropObservable(e))return scheduleObservable(e,t);if(isPromise(e))return schedulePromise(e,t);if(isArrayLike$2(e))return scheduleArray(e,t);if(isIterable(e)||"string"==typeof e)return scheduleIterable(e,t)}throw new TypeError((null!==e&&_typeof(e)||e)+" is not observable")}function from(e,t){return t?scheduled(e,t):e instanceof Observable?e:new Observable(subscribeTo(e))}function of(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return isScheduler(n)?(e.pop(),scheduleArray(e,n)):fromArray(e)}function map$1(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new MapOperator(e,t))}}var MapOperator=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new MapSubscriber(e,this.project,this.thisArg))},e}(),MapSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return __extends(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Subscriber);function mergeMap(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(r){return r.pipe(mergeMap((function(n,r){return from(e(n,r)).pipe(map$1((function(e,i){return t(n,e,r,i)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new MergeMapOperator(e,n))})}var MergeMapOperator=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new MergeMapSubscriber(e,this.project,this.concurrent))},e}(),MergeMapSubscriber=function(e){function t(t,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=e.call(this,t)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return __extends(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t,e,n)},t.prototype._innerSub=function(e,t,n){var r=new InnerSubscriber(this,void 0,void 0);this.destination.add(r),subscribeToResult(this,e,t,n,r)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(OuterSubscriber);function identity$1(e){return e}function mergeAll(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),mergeMap(identity$1,e)}function concatAll(){return mergeAll(1)}function concat(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return concatAll()(of.apply(void 0,e))}function concatMap(e,t){return mergeMap(e,t,1)}function defaultIfEmpty(e){return void 0===e&&(e=null),function(t){return t.lift(new DefaultIfEmptyOperator(e))}}var DefaultIfEmptyOperator=function(){function e(e){this.defaultValue=e}return e.prototype.call=function(e,t){return t.subscribe(new DefaultIfEmptySubscriber(e,this.defaultValue))},e}(),DefaultIfEmptySubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.defaultValue=n,r.isEmpty=!0,r}return __extends(t,e),t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(Subscriber);function isDate(e){return e instanceof Date&&!isNaN(+e)}var EMPTY=new Observable((function(e){return e.complete()})),NotificationKind;function empty$2(e){return e?emptyScheduled(e):EMPTY}function emptyScheduled(e){return new Observable((function(t){return e.schedule((function(){return t.complete()}))}))}function throwError(e,t){return new Observable(t?function(n){return t.schedule(dispatch$1,0,{error:e,subscriber:n})}:function(t){return t.error(e)})}function dispatch$1(e){var t=e.error;e.subscriber.error(t)}NotificationKind||(NotificationKind={});var Notification=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){switch(this.kind){case"N":return of(this.value);case"E":return throwError(this.error);case"C":return empty$2()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}();function delay(e,t){void 0===t&&(t=async);var n=isDate(e)?+e-t.now():Math.abs(e);return function(e){return e.lift(new DelayOperator(n,t))}}var DelayOperator=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new DelaySubscriber(e,this.delay,this.scheduler))},e}(),DelaySubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return __extends(t,e),t.dispatch=function(e){for(var t=e.source,n=t.queue,r=e.scheduler,i=e.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var o=Math.max(0,n[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1},t.prototype._schedule=function(e){this.active=!0,this.destination.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},t.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler,n=new DelayMessage(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}},t.prototype._next=function(e){this.scheduleNotification(Notification.createNext(e))},t.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.scheduleNotification(Notification.createComplete()),this.unsubscribe()},t}(Subscriber),DelayMessage=function(e,t){this.time=e,this.notification=t};function distinct(e,t){return function(n){return n.lift(new DistinctOperator(e,t))}}var DistinctOperator=function(){function e(e,t){this.keySelector=e,this.flushes=t}return e.prototype.call=function(e,t){return t.subscribe(new DistinctSubscriber(e,this.keySelector,this.flushes))},e}(),DistinctSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.keySelector=n,i.values=new Set,r&&i.add(subscribeToResult(i,r)),i}return __extends(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.values.clear()},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype._next=function(e){this.keySelector?this._useKeySelector(e):this._finalizeNext(e,e)},t.prototype._useKeySelector=function(e){var t,n=this.destination;try{t=this.keySelector(e)}catch(e){return void n.error(e)}this._finalizeNext(t,e)},t.prototype._finalizeNext=function(e,t){var n=this.values;n.has(e)||(n.add(e),this.destination.next(t))},t}(OuterSubscriber);function ArgumentOutOfRangeErrorImpl(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}ArgumentOutOfRangeErrorImpl.prototype=Object.create(Error.prototype);var ArgumentOutOfRangeError=ArgumentOutOfRangeErrorImpl;function filter(e,t){return function(n){return n.lift(new FilterOperator(e,t))}}var FilterOperator=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new FilterSubscriber(e,this.predicate,this.thisArg))},e}(),FilterSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return __extends(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(Subscriber);function EmptyErrorImpl(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}EmptyErrorImpl.prototype=Object.create(Error.prototype);var EmptyError=EmptyErrorImpl;function throwIfEmpty(e){return void 0===e&&(e=defaultErrorFactory),function(t){return t.lift(new ThrowIfEmptyOperator(e))}}var ThrowIfEmptyOperator=function(){function e(e){this.errorFactory=e}return e.prototype.call=function(e,t){return t.subscribe(new ThrowIfEmptySubscriber(e,this.errorFactory))},e}(),ThrowIfEmptySubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.errorFactory=n,r.hasValue=!1,r}return __extends(t,e),t.prototype._next=function(e){this.hasValue=!0,this.destination.next(e)},t.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var e=void 0;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)},t}(Subscriber);function defaultErrorFactory(){return new EmptyError}function take(e){return function(t){return 0===e?empty$2():t.lift(new TakeOperator(e))}}var TakeOperator=function(){function e(e){if(this.total=e,this.total<0)throw new ArgumentOutOfRangeError}return e.prototype.call=function(e,t){return t.subscribe(new TakeSubscriber(e,this.total))},e}(),TakeSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return __extends(t,e),t.prototype._next=function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))},t}(Subscriber);function finalize(e){return function(t){return t.lift(new FinallyOperator(e))}}var FinallyOperator=function(){function e(e){this.callback=e}return e.prototype.call=function(e,t){return t.subscribe(new FinallySubscriber(e,this.callback))},e}(),FinallySubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.add(new Subscription(n)),r}return __extends(t,e),t}(Subscriber);function first(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?filter((function(t,n){return e(t,n,r)})):identity$1,take(1),n?defaultIfEmpty(t):throwIfEmpty((function(){return new EmptyError})))}}function ObjectUnsubscribedErrorImpl(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}ObjectUnsubscribedErrorImpl.prototype=Object.create(Error.prototype);var ObjectUnsubscribedError=ObjectUnsubscribedErrorImpl,SubjectSubscription=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return __extends(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(Subscription),SubjectSubscriber=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return __extends(t,e),t}(Subscriber),Subject=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return __extends(t,e),t.prototype[rxSubscriber]=function(){return new SubjectSubscriber(this)},t.prototype.lift=function(e){var t=new AnonymousSubject(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new ObjectUnsubscribedError;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new ObjectUnsubscribedError;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new ObjectUnsubscribedError;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new ObjectUnsubscribedError;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new ObjectUnsubscribedError;return this.hasError?(e.error(this.thrownError),Subscription.EMPTY):this.isStopped?(e.complete(),Subscription.EMPTY):(this.observers.push(e),new SubjectSubscription(this,e))},t.prototype.asObservable=function(){var e=new Observable;return e.source=this,e},t.create=function(e,t){return new AnonymousSubject(e,t)},t}(Observable),AnonymousSubject=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return __extends(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):Subscription.EMPTY},t}(Subject),GroupedObservable=function(e){function t(t,n,r){var i=e.call(this)||this;return i.key=t,i.groupSubject=n,i.refCountSubscription=r,i}return __extends(t,e),t.prototype._subscribe=function(e){var t=new Subscription,n=this.refCountSubscription,r=this.groupSubject;return n&&!n.closed&&t.add(new InnerRefCountSubscription(n)),t.add(r.subscribe(e)),t},t}(Observable),InnerRefCountSubscription=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,t.count++,n}return __extends(t,e),t.prototype.unsubscribe=function(){var t=this.parent;t.closed||this.closed||(e.prototype.unsubscribe.call(this),t.count-=1,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())},t}(Subscription);function ignoreElements(){return function(e){return e.lift(new IgnoreElementsOperator)}}var IgnoreElementsOperator=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new IgnoreElementsSubscriber(e))},e}(),IgnoreElementsSubscriber=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._next=function(e){},t}(Subscriber);function takeLast(e){return function(t){return 0===e?empty$2():t.lift(new TakeLastOperator(e))}}var TakeLastOperator=function(){function e(e){if(this.total=e,this.total<0)throw new ArgumentOutOfRangeError}return e.prototype.call=function(e,t){return t.subscribe(new TakeLastSubscriber(e,this.total))},e}(),TakeLastSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.ring=new Array,r.count=0,r}return __extends(t,e),t.prototype._next=function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e},t.prototype._complete=function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=t++%n;e.next(r[o])}e.complete()},t}(Subscriber);function mapTo(e){return function(t){return t.lift(new MapToOperator(e))}}var MapToOperator=function(){function e(e){this.value=e}return e.prototype.call=function(e,t){return t.subscribe(new MapToSubscriber(e,this.value))},e}(),MapToSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.value=n,r}return __extends(t,e),t.prototype._next=function(e){this.destination.next(this.value)},t}(Subscriber);function scan(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new ScanOperator(e,t,n))}}var ScanOperator=function(){function e(e,t,n){void 0===n&&(n=!1),this.accumulator=e,this.seed=t,this.hasSeed=n}return e.prototype.call=function(e,t){return t.subscribe(new ScanSubscriber(e,this.accumulator,this.seed,this.hasSeed))},e}(),ScanSubscriber=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.accumulator=n,o._seed=r,o.hasSeed=i,o.index=0,o}return __extends(t,e),Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),t.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(e){this.destination.error(e)}this.seed=t,this.destination.next(t)},t}(Subscriber);function reduce(e,t){return arguments.length>=2?function(n){return pipe(scan(e,t),takeLast(1),defaultIfEmpty(t))(n)}:function(t){return pipe(scan((function(t,n,r){return e(t,n,r+1)})),takeLast(1))(t)}}function merge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Number.POSITIVE_INFINITY,r=null,i=e[e.length-1];return isScheduler(i)?(r=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(n=e.pop())):"number"==typeof i&&(n=e.pop()),null===r&&1===e.length&&e[0]instanceof Observable?e[0]:mergeAll(n)(fromArray(e,r))}function refCount(){return function(e){return e.lift(new RefCountOperator(e))}}var RefCountOperator=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var n=this.connectable;n._refCount++;var r=new RefCountSubscriber(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i},e}(),RefCountSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return __extends(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},t}(Subscriber),ConnectableObservable=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return __extends(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new Subscription).add(this.source.subscribe(new ConnectableSubscriber(this.getSubject(),this))),e.closed&&(this._connection=null,e=Subscription.EMPTY)),e},t.prototype.refCount=function(){return refCount()(this)},t}(Observable),connectableProto=ConnectableObservable.prototype,connectableObservableDescriptor={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:connectableProto._subscribe},_isComplete:{value:connectableProto._isComplete,writable:!0},getSubject:{value:connectableProto.getSubject},connect:{value:connectableProto.connect},refCount:{value:connectableProto.refCount}},ConnectableSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return __extends(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(SubjectSubscriber);function multicast(e,t){return function(n){var r;if(r="function"==typeof e?e:function(){return e},"function"==typeof t)return n.lift(new MulticastOperator(r,t));var i=Object.create(n,connectableObservableDescriptor);return i.source=n,i.subjectFactory=r,i}}var MulticastOperator=function(){function e(e,t){this.subjectFactory=e,this.selector=t}return e.prototype.call=function(e,t){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(e);return i.add(t.subscribe(r)),i},e}();function observeOn(e,t){return void 0===t&&(t=0),function(n){return n.lift(new ObserveOnOperator(e,t))}}var ObserveOnOperator=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new ObserveOnSubscriber(e,this.scheduler,this.delay))},e}(),ObserveOnSubscriber=function(e){function t(t,n,r){void 0===r&&(r=0);var i=e.call(this,t)||this;return i.scheduler=n,i.delay=r,i}return __extends(t,e),t.dispatch=function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new ObserveOnMessage(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(Notification.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(Notification.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(Notification.createComplete()),this.unsubscribe()},t}(Subscriber),ObserveOnMessage=function(e,t){this.notification=e,this.destination=t};function not(e,t){function n(){return!n.pred.apply(n.thisArg,arguments)}return n.pred=e,n.thisArg=t,n}var BehaviorSubject=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ObjectUnsubscribedError;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Subject),AsyncSubject=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return __extends(t,e),t.prototype._subscribe=function(t){return this.hasError?(t.error(this.thrownError),Subscription.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),Subscription.EMPTY):e.prototype._subscribe.call(this,t)},t.prototype.next=function(e){this.hasCompleted||(this.value=e,this.hasNext=!0)},t.prototype.error=function(t){this.hasCompleted||e.prototype.error.call(this,t)},t.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)},t}(Subject),QueueAction=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return __extends(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(AsyncAction),QueueScheduler=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(AsyncScheduler),queue$1=new QueueScheduler(QueueAction),ReplaySubject=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=e.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=t<1?1:t,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return __extends(t,e),t.prototype.nextInfiniteTimeWindow=function(t){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift(),e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this._events.push(new ReplayEvent(this._getNow(),t)),this._trimBufferThenGetEvents(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new ObjectUnsubscribedError;if(this.isStopped||this.hasError?t=Subscription.EMPTY:(this.observers.push(e),t=new SubjectSubscription(this,e)),i&&e.add(e=new ObserveOnSubscriber(e,i)),n)for(var a=0;a<o&&!e.closed;a++)e.next(r[a]);else for(a=0;a<o&&!e.closed;a++)e.next(r[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||queue$1).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),o>0&&r.splice(0,o),r},t}(Subject),ReplayEvent=function(e,t){this.time=e,this.value=t};function race(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){if(!isArray$1(e[0]))return e[0];e=e[0]}return fromArray(e,void 0).lift(new RaceOperator)}var RaceOperator=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new RaceSubscriber(e))},e}(),RaceSubscriber=function(e){function t(t){var n=e.call(this,t)||this;return n.hasFirst=!1,n.observables=[],n.subscriptions=[],n}return __extends(t,e),t.prototype._next=function(e){this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(var n=0;n<t&&!this.hasFirst;n++){var r=e[n],i=subscribeToResult(this,r,r,n);this.subscriptions&&this.subscriptions.push(i),this.add(i)}this.observables=null}},t.prototype.notifyNext=function(e,t,n,r,i){if(!this.hasFirst){this.hasFirst=!0;for(var o=0;o<this.subscriptions.length;o++)if(o!==n){var a=this.subscriptions[o];a.unsubscribe(),this.remove(a)}this.subscriptions=null}this.destination.next(t)},t}(OuterSubscriber);function retryWhen(e){return function(t){return t.lift(new RetryWhenOperator(e,t))}}var RetryWhenOperator=function(){function e(e,t){this.notifier=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new RetryWhenSubscriber(e,this.notifier,this.source))},e}(),RetryWhenSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.notifier=n,i.source=r,i}return __extends(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=this.errors,r=this.retries,i=this.retriesSubscription;if(r)this.errors=null,this.retriesSubscription=null;else{n=new Subject;try{r=(0,this.notifier)(n)}catch(t){return e.prototype.error.call(this,t)}i=subscribeToResult(this,r)}this._unsubscribeAndRecycle(),this.errors=n,this.retries=r,this.retriesSubscription=i,n.next(t)}},t.prototype._unsubscribe=function(){var e=this.errors,t=this.retriesSubscription;e&&(e.unsubscribe(),this.errors=null),t&&(t.unsubscribe(),this.retriesSubscription=null),this.retries=null},t.prototype.notifyNext=function(e,t,n,r,i){var o=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=o,this.source.subscribe(this)},t}(OuterSubscriber);function shareSubjectFactory(){return new Subject}function share(){return function(e){return refCount()(multicast(shareSubjectFactory)(e))}}function shareReplay(e,t,n){var r;return r=e&&"object"===_typeof(e)?e:{bufferSize:e,windowTime:t,refCount:!1,scheduler:n},function(e){return e.lift(shareReplayOperator(r))}}function shareReplayOperator(e){var t,n,r=e.bufferSize,i=void 0===r?Number.POSITIVE_INFINITY:r,o=e.windowTime,a=void 0===o?Number.POSITIVE_INFINITY:o,s=e.refCount,u=e.scheduler,c=0,l=!1,d=!1;return function(e){c++,t&&!l||(l=!1,t=new ReplaySubject(i,a,u),n=e.subscribe({next:function(e){t.next(e)},error:function(e){l=!0,t.error(e)},complete:function(){d=!0,t.complete()}}));var r=t.subscribe(this);this.add((function(){c--,r.unsubscribe(),n&&!d&&s&&0===c&&(n.unsubscribe(),n=void 0,t=void 0)}))}}function skipLast(e){return function(t){return t.lift(new SkipLastOperator(e))}}var SkipLastOperator=function(){function e(e){if(this._skipCount=e,this._skipCount<0)throw new ArgumentOutOfRangeError}return e.prototype.call=function(e,t){return 0===this._skipCount?t.subscribe(new Subscriber(e)):t.subscribe(new SkipLastSubscriber(e,this._skipCount))},e}(),SkipLastSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r._skipCount=n,r._count=0,r._ring=new Array(n),r}return __extends(t,e),t.prototype._next=function(e){var t=this._skipCount,n=this._count++;if(n<t)this._ring[n]=e;else{var r=n%t,i=this._ring,o=i[r];i[r]=e,this.destination.next(o)}},t}(Subscriber),nextHandle=1,tasksByHandle={};function runIfPresent(e){var t=tasksByHandle[e];t&&t()}var Immediate={setImmediate:function(e){var t=nextHandle++;return tasksByHandle[t]=e,Promise.resolve().then((function(){return runIfPresent(t)})),t},clearImmediate:function(e){delete tasksByHandle[e]}},AsapAction=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return __extends(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=Immediate.setImmediate(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(Immediate.clearImmediate(n),t.scheduled=void 0)},t}(AsyncAction),AsapScheduler=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}},t}(AsyncScheduler),asap=new AsapScheduler(AsapAction),SubscribeOnObservable=function(e){function t(t,n,r){void 0===n&&(n=0),void 0===r&&(r=asap);var i=e.call(this)||this;return i.source=t,i.delayTime=n,i.scheduler=r,(!isNumeric(n)||n<0)&&(i.delayTime=0),r&&"function"==typeof r.schedule||(i.scheduler=asap),i}return __extends(t,e),t.create=function(e,n,r){return void 0===n&&(n=0),void 0===r&&(r=asap),new t(e,n,r)},t.dispatch=function(e){var t=e.source,n=e.subscriber;return this.add(t.subscribe(n))},t.prototype._subscribe=function(e){var n=this.delayTime,r=this.source;return this.scheduler.schedule(t.dispatch,n,{source:r,subscriber:e})},t}(Observable);function subscribeOn(e,t){return void 0===t&&(t=0),function(n){return n.lift(new SubscribeOnOperator(e,t))}}var SubscribeOnOperator=function(){function e(e,t){this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return new SubscribeOnObservable(t,this.delay,this.scheduler).subscribe(e)},e}();function switchMap(e,t){return"function"==typeof t?function(n){return n.pipe(switchMap((function(n,r){return from(e(n,r)).pipe(map$1((function(e,i){return t(n,e,r,i)})))})))}:function(t){return t.lift(new SwitchMapOperator(e))}}var SwitchMapOperator=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new SwitchMapSubscriber(e,this.project))},e}(),SwitchMapSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.index=0,r}return __extends(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this._innerSub(t,e,n)},t.prototype._innerSub=function(e,t,n){var r=this.innerSubscription;r&&r.unsubscribe();var i=new InnerSubscriber(this,void 0,void 0);this.destination.add(i),this.innerSubscription=subscribeToResult(this,e,t,n,i)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=null},t.prototype.notifyComplete=function(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t}(OuterSubscriber);function switchAll(){return switchMap(identity$1)}function takeUntil(e){return function(t){return t.lift(new TakeUntilOperator(e))}}var TakeUntilOperator=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var n=new TakeUntilSubscriber(e),r=subscribeToResult(n,this.notifier);return r&&!n.seenValue?(n.add(r),t.subscribe(n)):n},e}(),TakeUntilSubscriber=function(e){function t(t){var n=e.call(this,t)||this;return n.seenValue=!1,n}return __extends(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(OuterSubscriber);function tap(e,t,n){return function(r){return r.lift(new DoOperator(e,t,n))}}var DoOperator=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new TapSubscriber(e,this.nextOrObserver,this.error,this.complete))},e}(),TapSubscriber=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o._tapNext=noop$1,o._tapError=noop$1,o._tapComplete=noop$1,o._tapError=r||noop$1,o._tapComplete=i||noop$1,isFunction$1(n)?(o._context=o,o._tapNext=n):n&&(o._context=n,o._tapNext=n.next||noop$1,o._tapError=n.error||noop$1,o._tapComplete=n.complete||noop$1),o}return __extends(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(Subscriber);function defer$1(e){return new Observable((function(t){var n;try{n=e()}catch(e){return void t.error(e)}return(n?from(n):empty$2()).subscribe(t)}))}function TimeoutErrorImpl(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}TimeoutErrorImpl.prototype=Object.create(Error.prototype);var TimeoutError=TimeoutErrorImpl;function timeoutWith(e,t,n){return void 0===n&&(n=async),function(r){var i=isDate(e),o=i?+e-n.now():Math.abs(e);return r.lift(new TimeoutWithOperator(o,i,t,n))}}var TimeoutWithOperator=function(){function e(e,t,n,r){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=n,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new TimeoutWithSubscriber(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),TimeoutWithSubscriber=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a.absoluteTimeout=n,a.waitFor=r,a.withObservable=i,a.scheduler=o,a.action=null,a.scheduleTimeout(),a}return __extends(t,e),t.dispatchTimeout=function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(subscribeToResult(e,t))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},t.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.withObservable=null},t}(OuterSubscriber);function timeout(e,t){return void 0===t&&(t=async),timeoutWith(e,throwError(new TimeoutError),t)}function withLatestFrom(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n;"function"==typeof e[e.length-1]&&(n=e.pop());var r=e;return t.lift(new WithLatestFromOperator(r,n))}}var WithLatestFromOperator=function(){function e(e,t){this.observables=e,this.project=t}return e.prototype.call=function(e,t){return t.subscribe(new WithLatestFromSubscriber(e,this.observables,this.project))},e}(),WithLatestFromSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;i.observables=n,i.project=r,i.toRespond=[];var o=n.length;i.values=new Array(o);for(var a=0;a<o;a++)i.toRespond.push(a);for(a=0;a<o;a++){var s=n[a];i.add(subscribeToResult(i,s,s,a))}return i}return __extends(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.values[n]=t;var o=this.toRespond;if(o.length>0){var a=o.indexOf(n);-1!==a&&o.splice(a,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(0===this.toRespond.length){var t=[e].concat(this.values);this.project?this._tryProject(t):this.destination.next(t)}},t.prototype._tryProject=function(e){var t;try{t=this.project.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(OuterSubscriber);function zip(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return"function"==typeof n&&e.pop(),fromArray(e,void 0).lift(new ZipOperator(n))}var ZipOperator=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new ZipSubscriber(e,this.resultSelector))},e}(),ZipSubscriber=function(e){function t(t,n,r){void 0===r&&(r=Object.create(null));var i=e.call(this,t)||this;return i.iterators=[],i.active=0,i.resultSelector="function"==typeof n?n:null,i.values=r,i}return __extends(t,e),t.prototype._next=function(e){var t=this.iterators;isArray$1(e)?t.push(new StaticArrayIterator(e)):"function"==typeof e[iterator]?t.push(new StaticIterator(e[iterator]())):t.push(new ZipBufferIterator(this.destination,this,e))},t.prototype._complete=function(){var e=this.iterators,t=e.length;if(this.unsubscribe(),0!==t){this.active=t;for(var n=0;n<t;n++){var r=e[n];r.stillUnsubscribed?this.destination.add(r.subscribe(r,n)):this.active--}}else this.destination.complete()},t.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},t.prototype.checkIterators=function(){for(var e=this.iterators,t=e.length,n=this.destination,r=0;r<t;r++)if("function"==typeof(a=e[r]).hasValue&&!a.hasValue())return;var i=!1,o=[];for(r=0;r<t;r++){var a,s=(a=e[r]).next();if(a.hasCompleted()&&(i=!0),s.done)return void n.complete();o.push(s.value)}this.resultSelector?this._tryresultSelector(o):n.next(o),i&&n.complete()},t.prototype._tryresultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Subscriber),StaticIterator=function(){function e(e){this.iterator=e,this.nextResult=e.next()}return e.prototype.hasValue=function(){return!0},e.prototype.next=function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e},e.prototype.hasCompleted=function(){var e=this.nextResult;return e&&e.done},e}(),StaticArrayIterator=function(){function e(e){this.array=e,this.index=0,this.length=0,this.length=e.length}return e.prototype[iterator]=function(){return this},e.prototype.next=function(e){var t=this.index++,n=this.array;return t<this.length?{value:n[t],done:!1}:{value:null,done:!0}},e.prototype.hasValue=function(){return this.array.length>this.index},e.prototype.hasCompleted=function(){return this.array.length===this.index},e}(),ZipBufferIterator=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.parent=n,i.observable=r,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return __extends(t,e),t.prototype[iterator]=function(){return this},t.prototype.next=function(){var e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}},t.prototype.hasValue=function(){return this.buffer.length>0},t.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},t.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},t.prototype.notifyNext=function(e,t,n,r,i){this.buffer.push(t),this.parent.checkIterators()},t.prototype.subscribe=function(e,t){return subscribeToResult(this,this.observable,this,t)},t}(OuterSubscriber);function baseSome(e,t){var n;return _baseEach(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}var _baseSome=baseSome;function isIterateeCall(e,t,n){if(!isObject_1(n))return!1;var r=_typeof(t);return!!("number"==r?isArrayLike_1(n)&&_isIndex(t,n.length):"string"==r&&t in n)&&eq_1(n[t],e)}var _isIterateeCall=isIterateeCall;function some(e,t,n){var r=isArray_1(e)?_arraySome:_baseSome;return n&&_isIterateeCall(e,t,n)&&(t=void 0),r(e,_baseIteratee(t))}var some_1=some;function baseMap(e,t){var n=-1,r=isArrayLike_1(e)?Array(e.length):[];return _baseEach(e,(function(e,i,o){r[++n]=t(e,i,o)})),r}var _baseMap=baseMap;function baseSortBy(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var _baseSortBy=baseSortBy;function compareAscending(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=isSymbol_1(e),a=void 0!==t,s=null===t,u=t==t,c=isSymbol_1(t);if(!s&&!c&&!o&&e>t||o&&a&&u&&!s&&!c||r&&a&&u||!n&&u||!i)return 1;if(!r&&!o&&!c&&e<t||c&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!u)return-1}return 0}var _compareAscending=compareAscending;function compareMultiple(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var u=_compareAscending(i[r],o[r]);if(u)return r>=s?u:u*("desc"==n[r]?-1:1)}return e.index-t.index}var _compareMultiple=compareMultiple;function baseOrderBy(e,t,n){var r=-1;t=_arrayMap(t.length?t:[identity_1],_baseUnary(_baseIteratee));var i=_baseMap(e,(function(e,n,i){return{criteria:_arrayMap(t,(function(t){return t(e)})),index:++r,value:e}}));return _baseSortBy(i,(function(e,t){return _compareMultiple(e,t,n)}))}var _baseOrderBy=baseOrderBy;function baseRest(e,t){return _setToString(_overRest(e,t,identity_1),e+"")}var _baseRest=baseRest,sortBy=_baseRest((function(e,t){if(null==e)return[];var n=t.length;return n>1&&_isIterateeCall(e,t[0],t[1])?t=[]:n>2&&_isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),_baseOrderBy(e,_baseFlatten(t,1),[])})),sortBy_1=sortBy,AnimationFrameAction=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return __extends(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame((function(){return t.flush(null)}))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(cancelAnimationFrame(n),t.scheduled=void 0)},t}(AsyncAction),AnimationFrameScheduler=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}},t}(AsyncScheduler),animationFrame=new AnimationFrameScheduler(AnimationFrameAction),VirtualTimeScheduler=function(e){function t(t,n){void 0===t&&(t=VirtualAction),void 0===n&&(n=Number.POSITIVE_INFINITY);var r=e.call(this,t,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}return __extends(t,e),t.prototype.flush=function(){for(var e,t,n=this.actions,r=this.maxFrames;(t=n[0])&&t.delay<=r&&(n.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=n.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10,t}(AsyncScheduler),VirtualAction=function(e){function t(t,n,r){void 0===r&&(r=t.index+=1);var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.index=r,i.active=!0,i.index=t.index=r,i}return __extends(t,e),t.prototype.schedule=function(n,r){if(void 0===r&&(r=0),!this.id)return e.prototype.schedule.call(this,n,r);this.active=!1;var i=new t(this.scheduler,this.work);return this.add(i),i.schedule(n,r)},t.prototype.requestAsyncId=function(e,n,r){void 0===r&&(r=0),this.delay=e.frame+r;var i=e.actions;return i.push(this),i.sort(t.sortActions),!0},t.prototype.recycleAsyncId=function(e,t,n){},t.prototype._execute=function(t,n){if(!0===this.active)return e.prototype._execute.call(this,t,n)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(AsyncAction);function isObservable(e){return!!e&&(e instanceof Observable||"function"==typeof e.lift&&"function"==typeof e.subscribe)}function bindCallback(e,t,n){if(t){if(!isScheduler(t))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return bindCallback(e,n).apply(void 0,r).pipe(map$1((function(e){return isArray$1(e)?t.apply(void 0,e):t(e)})))};n=t}return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i,o=this,a={context:o,subject:i,callbackFunc:e,scheduler:n};return new Observable((function(r){if(n){var s={args:t,subscriber:r,params:a};return n.schedule(dispatch$2,0,s)}if(!i){i=new AsyncSubject;try{e.apply(o,t.concat([function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.next(e.length<=1?e[0]:e),i.complete()}]))}catch(e){canReportError(i)?i.error(e):console.warn(e)}}return i.subscribe(r)}))}}function dispatch$2(e){var t=this,n=e.args,r=e.subscriber,i=e.params,o=i.callbackFunc,a=i.context,s=i.scheduler,u=i.subject;if(!u){u=i.subject=new AsyncSubject;try{o.apply(a,n.concat([function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.length<=1?e[0]:e;t.add(s.schedule(dispatchNext,0,{value:r,subject:u}))}]))}catch(e){u.error(e)}}this.add(u.subscribe(r))}function dispatchNext(e){var t=e.value,n=e.subject;n.next(t),n.complete()}function bindNodeCallback(e,t,n){if(t){if(!isScheduler(t))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return bindNodeCallback(e,n).apply(void 0,r).pipe(map$1((function(e){return isArray$1(e)?t.apply(void 0,e):t(e)})))};n=t}return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i={subject:void 0,args:t,callbackFunc:e,scheduler:n,context:this};return new Observable((function(r){var o=i.context,a=i.subject;if(n)return n.schedule(dispatch$3,0,{params:i,subscriber:r,context:o});if(!a){a=i.subject=new AsyncSubject;try{e.apply(o,t.concat([function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.shift();n?a.error(n):(a.next(e.length<=1?e[0]:e),a.complete())}]))}catch(e){canReportError(a)?a.error(e):console.warn(e)}}return a.subscribe(r)}))}}function dispatch$3(e){var t=this,n=e.params,r=e.subscriber,i=e.context,o=n.callbackFunc,a=n.args,s=n.scheduler,u=n.subject;if(!u){u=n.subject=new AsyncSubject;try{o.apply(i,a.concat([function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.shift();if(r)t.add(s.schedule(dispatchError,0,{err:r,subject:u}));else{var i=e.length<=1?e[0]:e;t.add(s.schedule(dispatchNext$1,0,{value:i,subject:u}))}}]))}catch(e){this.add(s.schedule(dispatchError,0,{err:e,subject:u}))}}this.add(u.subscribe(r))}function dispatchNext$1(e){var t=e.value,n=e.subject;n.next(t),n.complete()}function dispatchError(e){var t=e.err;e.subject.error(t)}function forkJoin(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var n=e[0];if(isArray$1(n))return forkJoinInternal(n,null);if(isObject$1(n)&&Object.getPrototypeOf(n)===Object.prototype){var r=Object.keys(n);return forkJoinInternal(r.map((function(e){return n[e]})),r)}}if("function"==typeof e[e.length-1]){var i=e.pop();return forkJoinInternal(e=1===e.length&&isArray$1(e[0])?e[0]:e,null).pipe(map$1((function(e){return i.apply(void 0,e)})))}return forkJoinInternal(e,null)}function forkJoinInternal(e,t){return new Observable((function(n){var r=e.length;if(0!==r)for(var i=new Array(r),o=0,a=0,s=function(s){var u=from(e[s]),c=!1;n.add(u.subscribe({next:function(e){c||(c=!0,a++),i[s]=e},error:function(e){return n.error(e)},complete:function(){++o!==r&&c||(a===r&&n.next(t?t.reduce((function(e,t,n){return e[t]=i[n],e}),{}):i),n.complete())}}))},u=0;u<r;u++)s(u);else n.complete()}))}function fromEvent(e,t,n,r){return isFunction$1(n)&&(r=n,n=void 0),r?fromEvent(e,t,n).pipe(map$1((function(e){return isArray$1(e)?r.apply(void 0,e):r(e)}))):new Observable((function(r){setupSubscription(e,t,(function(e){arguments.length>1?r.next(Array.prototype.slice.call(arguments)):r.next(e)}),r,n)}))}function setupSubscription(e,t,n,r,i){var o;if(isEventTarget(e)){var a=e;e.addEventListener(t,n,i),o=function(){return a.removeEventListener(t,n,i)}}else if(isJQueryStyleEventEmitter(e)){var s=e;e.on(t,n),o=function(){return s.off(t,n)}}else if(isNodeStyleEventEmitter(e)){var u=e;e.addListener(t,n),o=function(){return u.removeListener(t,n)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var c=0,l=e.length;c<l;c++)setupSubscription(e[c],t,n,r,i)}r.add(o)}function isNodeStyleEventEmitter(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}function isJQueryStyleEventEmitter(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}function isEventTarget(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}function fromEventPattern(e,t,n){return n?fromEventPattern(e,t).pipe(map$1((function(e){return isArray$1(e)?n.apply(void 0,e):n(e)}))):new Observable((function(n){var r,i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.next(1===e.length?e[0]:e)};try{r=e(i)}catch(e){return void n.error(e)}if(isFunction$1(t))return function(){return t(i,r)}}))}function generate(e,t,n,r,i){var o,a;if(1==arguments.length){var s=e;a=s.initialState,t=s.condition,n=s.iterate,o=s.resultSelector||identity$1,i=s.scheduler}else void 0===r||isScheduler(r)?(a=e,o=identity$1,i=r):(a=e,o=r);return new Observable((function(e){var r=a;if(i)return i.schedule(dispatch$4,0,{subscriber:e,iterate:n,condition:t,resultSelector:o,state:r});for(;;){if(t){var s=void 0;try{s=t(r)}catch(t){return void e.error(t)}if(!s){e.complete();break}}var u=void 0;try{u=o(r)}catch(t){return void e.error(t)}if(e.next(u),e.closed)break;try{r=n(r)}catch(t){return void e.error(t)}}}))}function dispatch$4(e){var t=e.subscriber,n=e.condition;if(!t.closed){if(e.needIterate)try{e.state=e.iterate(e.state)}catch(e){return void t.error(e)}else e.needIterate=!0;if(n){var r=void 0;try{r=n(e.state)}catch(e){return void t.error(e)}if(!r)return void t.complete();if(t.closed)return}var i;try{i=e.resultSelector(e.state)}catch(e){return void t.error(e)}if(!t.closed&&(t.next(i),!t.closed))return this.schedule(e)}}function iif(e,t,n){return void 0===t&&(t=EMPTY),void 0===n&&(n=EMPTY),defer$1((function(){return e()?t:n}))}function interval(e,t){return void 0===e&&(e=0),void 0===t&&(t=async),(!isNumeric(e)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=async),new Observable((function(n){return n.add(t.schedule(dispatch$5,e,{subscriber:n,counter:0,period:e})),n}))}function dispatch$5(e){var t=e.subscriber,n=e.counter,r=e.period;t.next(n),this.schedule({subscriber:t,counter:n+1,period:r},r)}var NEVER=new Observable(noop$1);function never(){return NEVER}function onErrorResumeNext(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return EMPTY;var n=e[0],r=e.slice(1);return 1===e.length&&isArray$1(n)?onErrorResumeNext.apply(void 0,n):new Observable((function(e){var t=function(){return e.add(onErrorResumeNext.apply(void 0,r).subscribe(e))};return from(n).subscribe({next:function(t){e.next(t)},error:t,complete:t})}))}function pairs(e,t){return new Observable(t?function(n){var r=Object.keys(e),i=new Subscription;return i.add(t.schedule(dispatch$6,0,{keys:r,index:0,subscriber:n,subscription:i,obj:e})),i}:function(t){for(var n=Object.keys(e),r=0;r<n.length&&!t.closed;r++){var i=n[r];e.hasOwnProperty(i)&&t.next([i,e[i]])}t.complete()})}function dispatch$6(e){var t=e.keys,n=e.index,r=e.subscriber,i=e.subscription,o=e.obj;if(!r.closed)if(n<t.length){var a=t[n];r.next([a,o[a]]),i.add(this.schedule({keys:t,index:n+1,subscriber:r,subscription:i,obj:o}))}else r.complete()}function partition(e,t,n){return[filter(t,n)(new Observable(subscribeTo(e))),filter(not(t,n))(new Observable(subscribeTo(e)))]}function range(e,t,n){return void 0===e&&(e=0),new Observable((function(r){void 0===t&&(t=e,e=0);var i=0,o=e;if(n)return n.schedule(dispatch$7,0,{index:i,count:t,start:e,subscriber:r});for(;;){if(i++>=t){r.complete();break}if(r.next(o++),r.closed)break}}))}function dispatch$7(e){var t=e.start,n=e.index,r=e.count,i=e.subscriber;n>=r?i.complete():(i.next(t),i.closed||(e.index=n+1,e.start=t+1,this.schedule(e)))}function using(e,t){return new Observable((function(n){var r,i;try{r=e()}catch(e){return void n.error(e)}try{i=t(r)}catch(e){return void n.error(e)}var o=(i?from(i):EMPTY).subscribe(n);return function(){o.unsubscribe(),r&&r.unsubscribe()}}))}var _esm5=Object.freeze({Observable:Observable,ConnectableObservable:ConnectableObservable,GroupedObservable:GroupedObservable,observable:observable,Subject:Subject,BehaviorSubject:BehaviorSubject,ReplaySubject:ReplaySubject,AsyncSubject:AsyncSubject,asapScheduler:asap,asyncScheduler:async,queueScheduler:queue$1,animationFrameScheduler:animationFrame,VirtualTimeScheduler:VirtualTimeScheduler,VirtualAction:VirtualAction,Scheduler:Scheduler,Subscription:Subscription,Subscriber:Subscriber,Notification:Notification,get NotificationKind(){return NotificationKind},pipe:pipe,noop:noop$1,identity:identity$1,isObservable:isObservable,ArgumentOutOfRangeError:ArgumentOutOfRangeError,EmptyError:EmptyError,ObjectUnsubscribedError:ObjectUnsubscribedError,UnsubscriptionError:UnsubscriptionError,TimeoutError:TimeoutError,bindCallback:bindCallback,bindNodeCallback:bindNodeCallback,combineLatest:combineLatest,concat:concat,defer:defer$1,empty:empty$2,forkJoin:forkJoin,from:from,fromEvent:fromEvent,fromEventPattern:fromEventPattern,generate:generate,iif:iif,interval:interval,merge:merge,never:never,of:of,onErrorResumeNext:onErrorResumeNext,pairs:pairs,partition:partition,race:race,range:range,throwError:throwError,timer:timer,using:using,zip:zip,scheduled:scheduled,EMPTY:EMPTY,NEVER:NEVER,config:config}),lib_es5=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=[],r=function(e,t){return new WebSocket(e,t)};t.normalClosureMessage="Normal closure",t.default=function(e,i){var o=void 0===i?{protocols:n,makeWebSocket:r}:i,a=o.protocols,s=void 0===a?n:a,u=o.makeWebSocket,c=void 0===u?r:u;return new _esm5.Observable((function(n){var r,i=new _esm5.Subject,o=function(e){if(r){d();var t=new Error("Web socket message factory function called more than once");throw n.error(t),t}return r=e.subscribe((function(e){a.send(e)})),i},a=c(e,s),u=!1,l=!1,d=function(){u=!1};return a.onopen=function(){u=!0,l?a.close():n.next(o)},a.onmessage=function(e){i.next(e.data)},a.onerror=function(e){d(),n.error(new Error(e.message))},a.onclose=function(e){u&&(d(),l?(n.complete(),i.complete()):n.error(new Error(1e3===e.code?t.normalClosureMessage:e.reason)))},function(){l=!0,r&&r.unsubscribe(),u&&(d(),a.close())}}))}}));unwrapExports(lib_es5);var lib_es5_1=lib_es5.normalClosureMessage;function assignMergeValue(e,t,n){(void 0===n||eq_1(e[t],n))&&(void 0!==n||t in e)||_baseAssignValue(e,t,n)}var _assignMergeValue=assignMergeValue;function isArrayLikeObject(e){return isObjectLike_1(e)&&isArrayLike_1(e)}var isArrayLikeObject_1=isArrayLikeObject;function safeGet(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var _safeGet=safeGet;function toPlainObject(e){return _copyObject(e,keysIn_1(e))}var toPlainObject_1=toPlainObject;function baseMergeDeep(e,t,n,r,i,o,a){var s=_safeGet(e,n),u=_safeGet(t,n),c=a.get(u);if(c)_assignMergeValue(e,n,c);else{var l=o?o(s,u,n+"",e,t,a):void 0,d=void 0===l;if(d){var p=isArray_1(u),f=!p&&isBuffer_1(u),h=!p&&!f&&isTypedArray_1(u);l=u,p||f||h?isArray_1(s)?l=s:isArrayLikeObject_1(s)?l=_copyArray(s):f?(d=!1,l=_cloneBuffer(u,!0)):h?(d=!1,l=_cloneTypedArray(u,!0)):l=[]:isPlainObject_1(u)||isArguments_1(u)?(l=s,isArguments_1(s)?l=toPlainObject_1(s):isObject_1(s)&&!isFunction_1(s)||(l=_initCloneObject(u))):d=!1}d&&(a.set(u,l),i(l,u,r,o,a),a.delete(u)),_assignMergeValue(e,n,l)}}var _baseMergeDeep=baseMergeDeep;function baseMerge(e,t,n,r,i){e!==t&&_baseFor(t,(function(o,a){if(i||(i=new _Stack),isObject_1(o))_baseMergeDeep(e,t,a,n,baseMerge,r,i);else{var s=r?r(_safeGet(e,a),o,a+"",e,t,i):void 0;void 0===s&&(s=o),_assignMergeValue(e,a,s)}}),keysIn_1)}var _baseMerge=baseMerge;function createAssigner(e){return _baseRest((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&_isIterateeCall(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t}))}var _createAssigner=createAssigner,mergeWith=_createAssigner((function(e,t,n,r){_baseMerge(e,t,n,r)})),mergeWith_1=mergeWith,__extends$1=window&&window.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),BucketBySubscriber=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;o.count=n,o.hashSelector=r,o.subjectSelector=i,o.index=0;for(var a=o.buckets=new Array(n),s=0;s<n;++s)a[s]=i();return t.next(a.map((function(e){return e.asObservable()}))),o}return __extends$1(t,e),t.prototype._next=function(e){var t=this.buckets,n=this.closed,r=this.count,i=this.hashSelector;if(!n){var o;try{var a=i(e,this.index++);o=Math.abs(Math.floor(a))%r}catch(e){return void this.error(e)}t[o].next(e)}},t.prototype._error=function(e){var t=this.buckets,n=this.closed,r=this.destination;n||(t.forEach((function(t){return t.error(e)})),r.error(e))},t.prototype._complete=function(){var e=this.buckets,t=this.closed,n=this.destination;t||(e.forEach((function(e){return e.complete()})),n.complete())},t}(Subscriber),__extends$2=window&&window.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),DeferFinalizeSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.callback=n,r.kind="U",r.subscription=void 0,r}return __extends$2(t,e),t.prototype.complete=function(){var t=this;this.kind="C",this.defer((function(){return e.prototype.complete.call(t)}))},t.prototype.error=function(t){var n=this;this.kind="E",this.defer((function(){return e.prototype.error.call(n,t)}))},t.prototype.unsubscribe=function(){var t=this;this.defer((function(){return e.prototype.unsubscribe.call(t)}))},t.prototype.defer=function(e){if(this.subscription)this.subscription.add(e);else{var t=new Subscription;this.subscription=t,t.add(e),from(this.callback(this.kind)).pipe(finalize((function(){return t.unsubscribe()}))).subscribe()}},t}(Subscriber),__extends$3=window&&window.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),InexorablySubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.add(new Subscription((function(){return n(r.notification)}))),r}return __extends$3(t,e),t.prototype.complete=function(){this.notification=new Notification("C"),e.prototype.complete.call(this)},t.prototype.error=function(t){this.notification=new Notification("E",void 0,t),e.prototype.error.call(this,t)},t}(Subscriber);function rateLimit(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=1,i=asap;1===t.length?"number"==typeof t[0]?r=t[0]:i=t[0]:2===t.length&&(r=t[0],i=t[1]);var o=r||1;return function(t){return t.pipe(scan((function(t,n){var r=i.now(),a=r-e;if((t=t.filter((function(e){return e.until>a}))).length>=o){var s=t[0],u=t[t.length-1],c=s.until+e*Math.floor(t.length/o);t.push({delay:u.until<r?c-r:c-u.until,until:c,value:n})}else t.push({delay:0,until:r,value:n});return t}),[]),map$1((function(e){return e[e.length-1]})),concatMap((function(e){var t=of(e.value);return e.delay?t.pipe(delay(e.delay,i)):t})))}}var __extends$4=window&&window.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),UnsubscribeOnSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.scheduler=n,i.delay=r,i}return __extends$4(t,e),t.prototype.unsubscribe=function(){var t=this,n=this.delay;this.scheduler.schedule((function(){return e.prototype.unsubscribe.call(t)}),n)},t}(Subscriber),defaultProtocols=[],defaultWebsocketFactory=function(e,t){return new WebSocket(e,t)},normalClosureMessage="Normal closure";function makeWebSocketObservable(e,t){var n=void 0===t?{protocols:defaultProtocols,makeWebSocket:defaultWebsocketFactory}:t,r=n.protocols,i=void 0===r?defaultProtocols:r,o=n.makeWebSocket,a=void 0===o?defaultWebsocketFactory:o;return new Observable((function(t){var n,r=new Subject,o=function(e){if(n){l();var i=new Error("Web socket message factory function called more than once");throw t.error(i),i}return n=e.subscribe((function(e){s.send(e)})),r},s=a(e,i),u=!1,c=!1,l=function(){u=!1};return s.onopen=function(){u=!0,c?s.close():t.next(o)},s.onmessage=function(e){r.next(e.data)},s.onerror=function(e){l(),t.error(new Error(e.message))},s.onclose=function(e){u&&(l(),c?(t.complete(),r.complete()):t.error(new Error(1e3===e.code?normalClosureMessage:e.reason)))},function(){c=!0,n&&n.unsubscribe(),u&&(l(),s.close())}}))}_export(_export.P+_export.F*_fails((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=_toObject(this),n=_toPrimitive(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}});var floor$2=Math.floor,_isInteger=function(e){return!_isObject(e)&&isFinite(e)&&floor$2(e)===e};_export(_export.S,"Number",{isInteger:_isInteger});var aspromise=asPromise;function asPromise(e,t){for(var n=new Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}var base64_1=createCommonjsModule((function(e,t){var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),i=new Array(123),o=0;o<64;)i[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;n.encode=function(e,t,n){for(var i,o=null,a=[],s=0,u=0;t<n;){var c=e[t++];switch(u){case 0:a[s++]=r[c>>2],i=(3&c)<<4,u=1;break;case 1:a[s++]=r[i|c>>4],i=(15&c)<<2,u=2;break;case 2:a[s++]=r[i|c>>6],a[s++]=r[63&c],u=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return u&&(a[s++]=r[i],a[s++]=61,1===u&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))},n.decode=function(e,t,n){for(var r,o=n,a=0,s=0;s<e.length;){var u=e.charCodeAt(s++);if(61===u&&a>1)break;if(void 0===(u=i[u]))throw Error("invalid encoding");switch(a){case 0:r=u,a=1;break;case 1:t[n++]=r<<2|(48&u)>>4,r=u,a=2;break;case 2:t[n++]=(15&r)<<4|(60&u)>>2,r=u,a=3;break;case 3:t[n++]=(3&r)<<6|u,a=0}}if(1===a)throw Error("invalid encoding");return n-o},n.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)}})),eventemitter=EventEmitter$1;function EventEmitter$1(){this._listeners={}}EventEmitter$1.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},EventEmitter$1.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},EventEmitter$1.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this};var float_1=factory(factory);function factory(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE),e.readFloatLE=n.bind(null,readUintLE),e.readFloatBE=n.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,i,o){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+n);else{var u=Math.floor(Math.log(r)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(s=r*Math.pow(2,-u))>>>0,i,o+t),e((a<<31|u+1023<<20|1048576*s&1048575)>>>0,i,o+n)}}}function n(e,t,n,r,i){var o=e(r,i+t),a=e(r,i+n),s=2*(a>>31)+1,u=a>>>20&2047,c=4294967296*(1048575&a)+o;return 2047===u?c?NaN:s*(1/0):0===u?5e-324*s*c:s*Math.pow(2,u-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0),e.readDoubleLE=n.bind(null,readUintLE,0,4),e.readDoubleBE=n.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function writeUintBE(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8_1=createCommonjsModule((function(e,t){var n=t;n.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],a=0;t<n;)(r=e[t++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},n.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}})),pool_1=pool;function pool(e,t,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){if(n<1||n>i)return e(n);a+n>r&&(o=e(r),a=0);var s=t.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}var longbits=LongBits;function LongBits(e,t){this.lo=e>>>0,this.hi=t>>>0}var zero=LongBits.zero=new LongBits(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function(e){if(0===e)return zero;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new LongBits(n,r)},LongBits.from=function(e){if("number"==typeof e)return LongBits.fromNumber(e);if(minimal.isString(e)){if(!minimal.Long)return LongBits.fromNumber(parseInt(e,10));e=minimal.Long.fromString(e)}return e.low||e.high?new LongBits(e.low>>>0,e.high>>>0):zero},LongBits.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},LongBits.prototype.toLong=function(e){return minimal.Long?new minimal.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var charCodeAt=String.prototype.charCodeAt;LongBits.fromHash=function(e){return e===zeroHash?zero:new LongBits((charCodeAt.call(e,0)|charCodeAt.call(e,1)<<8|charCodeAt.call(e,2)<<16|charCodeAt.call(e,3)<<24)>>>0,(charCodeAt.call(e,4)|charCodeAt.call(e,5)<<8|charCodeAt.call(e,6)<<16|charCodeAt.call(e,7)<<24)>>>0)},LongBits.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10};var minimal=createCommonjsModule((function(e,t){var n=t;function r(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function i(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=aspromise,n.base64=base64_1,n.EventEmitter=eventemitter,n.float=float_1,n.inquire=inquire_1,n.utf8=utf8_1,n.pool=pool_1,n.LongBits=longbits,n.global="undefined"!=typeof window&&window||void 0!==commonjsGlobal&&commonjsGlobal||"undefined"!=typeof self&&self||commonjsGlobal,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isNode=Boolean(n.global.process&&n.global.process.versions&&n.global.process.versions.node),n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"===_typeof(e)},n.isset=n.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!==_typeof(n)||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=r,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=i,n.ProtocolError=i("ProtocolError"),n.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},n.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}})),writer=Writer,BufferWriter,LongBits$1=minimal.LongBits,base64=minimal.base64,utf8=minimal.utf8;function Op(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function noop$2(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer(){this.len=0,this.head=new Op(noop$2,0,0),this.tail=this.head,this.states=null}function writeByte(e,t,n){t[n]=255&e}function writeVarint32(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function writeFixed32(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}Writer.create=minimal.Buffer?function(){return(Writer.create=function(){return new BufferWriter})()}:function(){return new Writer},Writer.alloc=function(e){return new minimal.Array(e)},minimal.Array!==Array&&(Writer.alloc=minimal.pool(Writer.alloc,minimal.Array.prototype.subarray)),Writer.prototype._push=function(e,t,n){return this.tail=this.tail.next=new Op(e,t,n),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer.prototype.uint64=function(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function(e){return this._push(minimal.float.writeFloatLE,4,e)},Writer.prototype.double=function(e){return this._push(minimal.float.writeDoubleLE,8,e)};var writeBytes=minimal.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};Writer.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(minimal.isString(e)){var n=Writer.alloc(t=base64.length(e));base64.decode(e,n,0),e=n}return this.uint32(t)._push(writeBytes,t,e)},Writer.prototype.string=function(e){var t=utf8.length(e);return t?this.uint32(t)._push(utf8.write,t,e):this._push(writeByte,1,0)},Writer.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop$2,0,0),this.len=0,this},Writer.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$2,0,0),this.len=0),this},Writer.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},Writer.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},Writer._configure=function(e){BufferWriter=e};var writer_buffer=BufferWriter$1;(BufferWriter$1.prototype=Object.create(writer.prototype)).constructor=BufferWriter$1;var Buffer=minimal.Buffer;function BufferWriter$1(){writer.call(this)}BufferWriter$1.alloc=function(e){return(BufferWriter$1.alloc=minimal._Buffer_allocUnsafe)(e)};var writeBytesBuffer=Buffer&&Buffer.prototype instanceof Uint8Array&&"set"===Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]};function writeStringBuffer(e,t,n){e.length<40?minimal.utf8.write(e,t,n):t.utf8Write(e,n)}BufferWriter$1.prototype.bytes=function(e){minimal.isString(e)&&(e=minimal._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(writeBytesBuffer,t,e),this},BufferWriter$1.prototype.string=function(e){var t=Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this};var reader=Reader,BufferReader,LongBits$2=minimal.LongBits,utf8$1=minimal.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader(e);throw Error("illegal buffer")},value;function readLongVarint(){var e=new LongBits$2(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$2(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=minimal.Buffer?function(e){return(Reader.create=function(e){return minimal.Buffer.isBuffer(e)?new BufferReader(e):create_array(e)})(e)}:create_array,Reader.prototype._slice=minimal.Array.prototype.subarray||minimal.Array.prototype.slice,Reader.prototype.uint32=(value=4294967295,function(){if(value=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return value;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return value}),Reader.prototype.int32=function(){return 0|this.uint32()},Reader.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},Reader.prototype.bool=function(){return 0!==this.uint32()},Reader.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},Reader.prototype.string=function(){var e=this.bytes();return utf8$1.read(e,0,e.length)},Reader.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader._configure=function(e){BufferReader=e;var t=minimal.Long?"toLong":"toNumber";minimal.merge(Reader.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader$1;function BufferReader$1(e){reader.call(this,e)}(BufferReader$1.prototype=Object.create(reader.prototype)).constructor=BufferReader$1,minimal.Buffer&&(BufferReader$1.prototype._slice=minimal.Buffer.prototype.slice),BufferReader$1.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))};var service=Service;function Service(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");minimal.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(Service.prototype=Object.create(minimal.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(t,n,r,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return minimal.asPromise(e,a,t,n,r,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return a.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof r))try{n=r[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",n,t),o(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var rpc_1=createCommonjsModule((function(e,t){t.Service=service})),roots={},indexMinimal=createCommonjsModule((function(e,t){var n=t;function r(){n.Reader._configure(n.BufferReader),n.util._configure()}n.build="minimal",n.Writer=writer,n.BufferWriter=writer_buffer,n.Reader=reader,n.BufferReader=reader_buffer,n.util=minimal,n.rpc=rpc_1,n.roots=roots,n.configure=r,n.Writer._configure(n.BufferWriter),r()})),indexMinimal_1=indexMinimal.build,indexMinimal_2=indexMinimal.Writer,indexMinimal_3=indexMinimal.BufferWriter,indexMinimal_4=indexMinimal.Reader,indexMinimal_5=indexMinimal.BufferReader,indexMinimal_6=indexMinimal.util,indexMinimal_7=indexMinimal.rpc,indexMinimal_8=indexMinimal.roots,indexMinimal_9=indexMinimal.configure;indexMinimal_6.Long=long_1,indexMinimal_9();var $Reader=indexMinimal_4,$Writer=indexMinimal_2,$util=indexMinimal_6,$root=indexMinimal_8.default||(indexMinimal_8.default={});$root.URI=function(){var e={},t=Object.create(e);return t[e[0]="Unknown"]=0,t[e[1]="PingUri"]=1,t[e[2]="PongUri"]=2,t[e[11]="UserJoinUri"]=11,t[e[12]="UserRespUri"]=12,t[e[21]="UserQuitUri"]=21,t[e[22]="UserDropUri"]=22,t[e[31]="GroupEnterUri"]=31,t[e[32]="GroupLeaveUri"]=32,t[e[33]="GroupReplyUri"]=33,t[e[36]="GroupEnterNoticeUri"]=36,t[e[37]="GroupLeaveNoticeUri"]=37,t[e[38]="GroupEventNoticeUri"]=38,t[e[39]="GroupCountNoticeUri"]=39,t[e[41]="UserStatusListUri"]=41,t[e[42]="UserStatusResultUri"]=42,t[e[51]="GroupStatusListUri"]=51,t[e[52]="GroupStatusResultUri"]=52,t[e[55]="GroupAllUsersListUri"]=55,t[e[56]="GroupAllUsersResultUri"]=56,t[e[100]="MessageUri"]=100,t[e[101]="AckUri"]=101,t[e[201]="UserJoinNoticeUri"]=201,t[e[202]="UserQuitNoticeUri"]=202,t[e[203]="UserWaitNoticeUri"]=203,t[e[301]="UserAttributeGetUri"]=301,t[e[302]="UserAttributeRetUri"]=302,t[e[303]="UserAttributeSetUri"]=303,t[e[304]="UserAttributeModUri"]=304,t[e[305]="UserAttributeDelUri"]=305,t[e[307]="UserAttributeRspUri"]=307,t[e[308]="UserAttributeErrUri"]=308,t[e[311]="UserAttributeKeysGetUri"]=311,t[e[312]="UserAttributeKeysRetUri"]=312,t[e[351]="GroupAttributeGetUri"]=351,t[e[352]="GroupAttributeRetUri"]=352,t[e[353]="GroupAttributeSetUri"]=353,t[e[354]="GroupAttributeModUri"]=354,t[e[355]="GroupAttributeDelUri"]=355,t[e[356]="GroupAttributeAltUri"]=356,t[e[357]="GroupAttributeRspUri"]=357,t[e[358]="GroupAttributeErrUri"]=358,t[e[361]="GroupAttributeKeysGetUri"]=361,t[e[362]="GroupAttributeKeysRetUri"]=362,t[e[401]="SubscribeUserStatusUri"]=401,t[e[402]="UnsubscribeUserStatusUri"]=402,t[e[499]="SubscribeResponseUri"]=499,t}();var Wrapper$1=$root.Wrapper=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.uri=0,e.prototype.data=$util.newBuffer([]),e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.uri&&e.hasOwnProperty("uri")&&t.uint32(8).int32(e.uri),null!=e.data&&e.hasOwnProperty("data")&&t.uint32(18).bytes(e.data),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.Wrapper;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.uri=e.int32();break;case 2:r.data=e.bytes();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.uri&&e.hasOwnProperty("uri"))switch(e.uri){default:return"uri: enum value expected";case 0:case 1:case 2:case 11:case 12:case 21:case 22:case 31:case 32:case 33:case 36:case 37:case 38:case 39:case 41:case 42:case 51:case 52:case 55:case 56:case 100:case 101:case 201:case 202:case 203:case 301:case 302:case 303:case 304:case 305:case 307:case 308:case 311:case 312:case 351:case 352:case 353:case 354:case 355:case 356:case 357:case 358:case 361:case 362:case 401:case 402:case 499:}return null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||$util.isString(e.data))?"data: buffer expected":null},e.fromObject=function(e){if(e instanceof $root.Wrapper)return e;var t=new $root.Wrapper;switch(e.uri){case"Unknown":case 0:t.uri=0;break;case"PingUri":case 1:t.uri=1;break;case"PongUri":case 2:t.uri=2;break;case"UserJoinUri":case 11:t.uri=11;break;case"UserRespUri":case 12:t.uri=12;break;case"UserQuitUri":case 21:t.uri=21;break;case"UserDropUri":case 22:t.uri=22;break;case"GroupEnterUri":case 31:t.uri=31;break;case"GroupLeaveUri":case 32:t.uri=32;break;case"GroupReplyUri":case 33:t.uri=33;break;case"GroupEnterNoticeUri":case 36:t.uri=36;break;case"GroupLeaveNoticeUri":case 37:t.uri=37;break;case"GroupEventNoticeUri":case 38:t.uri=38;break;case"GroupCountNoticeUri":case 39:t.uri=39;break;case"UserStatusListUri":case 41:t.uri=41;break;case"UserStatusResultUri":case 42:t.uri=42;break;case"GroupStatusListUri":case 51:t.uri=51;break;case"GroupStatusResultUri":case 52:t.uri=52;break;case"GroupAllUsersListUri":case 55:t.uri=55;break;case"GroupAllUsersResultUri":case 56:t.uri=56;break;case"MessageUri":case 100:t.uri=100;break;case"AckUri":case 101:t.uri=101;break;case"UserJoinNoticeUri":case 201:t.uri=201;break;case"UserQuitNoticeUri":case 202:t.uri=202;break;case"UserWaitNoticeUri":case 203:t.uri=203;break;case"UserAttributeGetUri":case 301:t.uri=301;break;case"UserAttributeRetUri":case 302:t.uri=302;break;case"UserAttributeSetUri":case 303:t.uri=303;break;case"UserAttributeModUri":case 304:t.uri=304;break;case"UserAttributeDelUri":case 305:t.uri=305;break;case"UserAttributeRspUri":case 307:t.uri=307;break;case"UserAttributeErrUri":case 308:t.uri=308;break;case"UserAttributeKeysGetUri":case 311:t.uri=311;break;case"UserAttributeKeysRetUri":case 312:t.uri=312;break;case"GroupAttributeGetUri":case 351:t.uri=351;break;case"GroupAttributeRetUri":case 352:t.uri=352;break;case"GroupAttributeSetUri":case 353:t.uri=353;break;case"GroupAttributeModUri":case 354:t.uri=354;break;case"GroupAttributeDelUri":case 355:t.uri=355;break;case"GroupAttributeAltUri":case 356:t.uri=356;break;case"GroupAttributeRspUri":case 357:t.uri=357;break;case"GroupAttributeErrUri":case 358:t.uri=358;break;case"GroupAttributeKeysGetUri":case 361:t.uri=361;break;case"GroupAttributeKeysRetUri":case 362:t.uri=362;break;case"SubscribeUserStatusUri":case 401:t.uri=401;break;case"UnsubscribeUserStatusUri":case 402:t.uri=402;break;case"SubscribeResponseUri":case 499:t.uri=499}return null!=e.data&&("string"==typeof e.data?$util.base64.decode(e.data,t.data=$util.newBuffer($util.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.uri=t.enums===String?"Unknown":0,t.bytes===String?n.data="":(n.data=[],t.bytes!==Array&&(n.data=$util.newBuffer(n.data)))),null!=e.uri&&e.hasOwnProperty("uri")&&(n.uri=t.enums===String?$root.URI[e.uri]:e.uri),null!=e.data&&e.hasOwnProperty("data")&&(n.data=t.bytes===String?$util.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),Ping=$root.Ping=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.ms=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.ms&&e.hasOwnProperty("ms")&&t.uint32(16).uint64(e.ms),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.Ping;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.ms&&e.hasOwnProperty("ms")&&!($util.isInteger(e.ms)||e.ms&&$util.isInteger(e.ms.low)&&$util.isInteger(e.ms.high))?"ms: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root.Ping)return e;var t=new $root.Ping;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.ms&&($util.Long?(t.ms=$util.Long.fromValue(e.ms)).unsigned=!0:"string"==typeof e.ms?t.ms=parseInt(e.ms,10):"number"==typeof e.ms?t.ms=e.ms:"object"===_typeof(e.ms)&&(t.ms=new $util.LongBits(e.ms.low>>>0,e.ms.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if($util.Long){var i=new $util.Long(0,0,!0);n.ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.ms=t.longs===String?"0":0}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.ms&&e.hasOwnProperty("ms")&&("number"==typeof e.ms?n.ms=t.longs===String?String(e.ms):e.ms:n.ms=t.longs===String?$util.Long.prototype.toString.call(e.ms):t.longs===Number?new $util.LongBits(e.ms.low>>>0,e.ms.high>>>0).toNumber(!0):e.ms),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),Pong=$root.Pong=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.ms=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.ms&&e.hasOwnProperty("ms")&&t.uint32(16).uint64(e.ms),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.Pong;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.ms&&e.hasOwnProperty("ms")&&!($util.isInteger(e.ms)||e.ms&&$util.isInteger(e.ms.low)&&$util.isInteger(e.ms.high))?"ms: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root.Pong)return e;var t=new $root.Pong;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.ms&&($util.Long?(t.ms=$util.Long.fromValue(e.ms)).unsigned=!0:"string"==typeof e.ms?t.ms=parseInt(e.ms,10):"number"==typeof e.ms?t.ms=e.ms:"object"===_typeof(e.ms)&&(t.ms=new $util.LongBits(e.ms.low>>>0,e.ms.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if($util.Long){var i=new $util.Long(0,0,!0);n.ms=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.ms=t.longs===String?"0":0}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.ms&&e.hasOwnProperty("ms")&&("number"==typeof e.ms?n.ms=t.longs===String?String(e.ms):e.ms:n.ms=t.longs===String?$util.Long.prototype.toString.call(e.ms):t.longs===Number?new $util.LongBits(e.ms.low>>>0,e.ms.high>>>0).toNumber(!0):e.ms),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserJoin=$root.UserJoin=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.opt=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.ticket="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.opt&&e.hasOwnProperty("opt")&&t.uint32(16).uint64(e.opt),null!=e.instance&&e.hasOwnProperty("instance")&&t.uint32(24).uint64(e.instance),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(34).string(e.account),null!=e.ticket&&e.hasOwnProperty("ticket")&&t.uint32(42).string(e.ticket),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserJoin;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.opt=e.uint64();break;case 3:r.instance=e.uint64();break;case 4:r.account=e.string();break;case 5:r.ticket=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.opt&&e.hasOwnProperty("opt")&&!($util.isInteger(e.opt)||e.opt&&$util.isInteger(e.opt.low)&&$util.isInteger(e.opt.high))?"opt: integer|Long expected":null!=e.instance&&e.hasOwnProperty("instance")&&!($util.isInteger(e.instance)||e.instance&&$util.isInteger(e.instance.low)&&$util.isInteger(e.instance.high))?"instance: integer|Long expected":null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account)?"account: string expected":null!=e.ticket&&e.hasOwnProperty("ticket")&&!$util.isString(e.ticket)?"ticket: string expected":null},e.fromObject=function(e){if(e instanceof $root.UserJoin)return e;var t=new $root.UserJoin;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.opt&&($util.Long?(t.opt=$util.Long.fromValue(e.opt)).unsigned=!0:"string"==typeof e.opt?t.opt=parseInt(e.opt,10):"number"==typeof e.opt?t.opt=e.opt:"object"===_typeof(e.opt)&&(t.opt=new $util.LongBits(e.opt.low>>>0,e.opt.high>>>0).toNumber(!0))),null!=e.instance&&($util.Long?(t.instance=$util.Long.fromValue(e.instance)).unsigned=!0:"string"==typeof e.instance?t.instance=parseInt(e.instance,10):"number"==typeof e.instance?t.instance=e.instance:"object"===_typeof(e.instance)&&(t.instance=new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0))),null!=e.account&&(t.account=String(e.account)),null!=e.ticket&&(t.ticket=String(e.ticket)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if($util.Long){var i=new $util.Long(0,0,!0);n.opt=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.opt=t.longs===String?"0":0;if($util.Long){var o=new $util.Long(0,0,!0);n.instance=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.instance=t.longs===String?"0":0;n.account="",n.ticket=""}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.opt&&e.hasOwnProperty("opt")&&("number"==typeof e.opt?n.opt=t.longs===String?String(e.opt):e.opt:n.opt=t.longs===String?$util.Long.prototype.toString.call(e.opt):t.longs===Number?new $util.LongBits(e.opt.low>>>0,e.opt.high>>>0).toNumber(!0):e.opt),null!=e.instance&&e.hasOwnProperty("instance")&&("number"==typeof e.instance?n.instance=t.longs===String?String(e.instance):e.instance:n.instance=t.longs===String?$util.Long.prototype.toString.call(e.instance):t.longs===Number?new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0):e.instance),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),null!=e.ticket&&e.hasOwnProperty("ticket")&&(n.ticket=e.ticket),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserResp=$root.UserResp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(18).string(e.account),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(24).uint32(e.code),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserResp;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account)?"account: string expected":null!=e.code&&e.hasOwnProperty("code")&&!$util.isInteger(e.code)?"code: integer expected":null},e.fromObject=function(e){if(e instanceof $root.UserResp)return e;var t=new $root.UserResp;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.account&&(t.account=String(e.account)),null!=e.code&&(t.code=e.code>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.account="",n.code=0}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserQuit=$root.UserQuit=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.encode=function(e,t){return t||(t=$Writer.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserQuit;e.pos<n;){var i=e.uint32();e.skipType(7&i)}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null},e.fromObject=function(e){return e instanceof $root.UserQuit?e:new $root.UserQuit},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserDrop=$root.UserDrop=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(8).uint32(e.code),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserDrop;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.code&&e.hasOwnProperty("code")&&!$util.isInteger(e.code)?"code: integer expected":null},e.fromObject=function(e){if(e instanceof $root.UserDrop)return e;var t=new $root.UserDrop;return null!=e.code&&(t.code=e.code>>>0),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.code=0),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupEnter=$root.GroupEnter=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(18).string(e.account),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupEnter;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account)?"account: string expected":null},e.fromObject=function(e){if(e instanceof $root.GroupEnter)return e;var t=new $root.GroupEnter;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.account&&(t.account=String(e.account)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.account=""}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupLeave=$root.GroupLeave=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.account="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(10).string(e.account),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupLeave;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.account=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account)?"account: string expected":null},e.fromObject=function(e){if(e instanceof $root.GroupLeave)return e;var t=new $root.GroupLeave;return null!=e.account&&(t.account=String(e.account)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.account=""),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupReply=$root.GroupReply=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(18).string(e.account),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(24).uint32(e.code),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupReply;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account)?"account: string expected":null!=e.code&&e.hasOwnProperty("code")&&!$util.isInteger(e.code)?"code: integer expected":null},e.fromObject=function(e){if(e instanceof $root.GroupReply)return e;var t=new $root.GroupReply;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.account&&(t.account=String(e.account)),null!=e.code&&(t.code=e.code>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.account="",n.code=0}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupLeaveNotice=$root.GroupLeaveNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.user="",e.prototype.group="",e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.size=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.user&&e.hasOwnProperty("user")&&t.uint32(18).string(e.user),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(26).string(e.group),null!=e.instance&&e.hasOwnProperty("instance")&&t.uint32(32).uint64(e.instance),null!=e.size&&e.hasOwnProperty("size")&&t.uint32(40).uint32(e.size),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupLeaveNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.user=e.string();break;case 3:r.group=e.string();break;case 4:r.instance=e.uint64();break;case 5:r.size=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.user&&e.hasOwnProperty("user")&&!$util.isString(e.user)?"user: string expected":null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group)?"group: string expected":null!=e.instance&&e.hasOwnProperty("instance")&&!($util.isInteger(e.instance)||e.instance&&$util.isInteger(e.instance.low)&&$util.isInteger(e.instance.high))?"instance: integer|Long expected":null!=e.size&&e.hasOwnProperty("size")&&!$util.isInteger(e.size)?"size: integer expected":null},e.fromObject=function(e){if(e instanceof $root.GroupLeaveNotice)return e;var t=new $root.GroupLeaveNotice;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.user&&(t.user=String(e.user)),null!=e.group&&(t.group=String(e.group)),null!=e.instance&&($util.Long?(t.instance=$util.Long.fromValue(e.instance)).unsigned=!0:"string"==typeof e.instance?t.instance=parseInt(e.instance,10):"number"==typeof e.instance?t.instance=e.instance:"object"===_typeof(e.instance)&&(t.instance=new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0))),null!=e.size&&(t.size=e.size>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(n.user="",n.group="",$util.Long){var i=new $util.Long(0,0,!0);n.instance=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.instance=t.longs===String?"0":0;n.size=0}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.user&&e.hasOwnProperty("user")&&(n.user=e.user),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),null!=e.instance&&e.hasOwnProperty("instance")&&("number"==typeof e.instance?n.instance=t.longs===String?String(e.instance):e.instance:n.instance=t.longs===String?$util.Long.prototype.toString.call(e.instance):t.longs===Number?new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0):e.instance),null!=e.size&&e.hasOwnProperty("size")&&(n.size=e.size),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupEnterNotice=$root.GroupEnterNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.user="",e.prototype.group="",e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.size=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.user&&e.hasOwnProperty("user")&&t.uint32(18).string(e.user),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(26).string(e.group),null!=e.instance&&e.hasOwnProperty("instance")&&t.uint32(32).uint64(e.instance),null!=e.size&&e.hasOwnProperty("size")&&t.uint32(40).uint32(e.size),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupEnterNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.user=e.string();break;case 3:r.group=e.string();break;case 4:r.instance=e.uint64();break;case 5:r.size=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.user&&e.hasOwnProperty("user")&&!$util.isString(e.user)?"user: string expected":null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group)?"group: string expected":null!=e.instance&&e.hasOwnProperty("instance")&&!($util.isInteger(e.instance)||e.instance&&$util.isInteger(e.instance.low)&&$util.isInteger(e.instance.high))?"instance: integer|Long expected":null!=e.size&&e.hasOwnProperty("size")&&!$util.isInteger(e.size)?"size: integer expected":null},e.fromObject=function(e){if(e instanceof $root.GroupEnterNotice)return e;var t=new $root.GroupEnterNotice;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.user&&(t.user=String(e.user)),null!=e.group&&(t.group=String(e.group)),null!=e.instance&&($util.Long?(t.instance=$util.Long.fromValue(e.instance)).unsigned=!0:"string"==typeof e.instance?t.instance=parseInt(e.instance,10):"number"==typeof e.instance?t.instance=e.instance:"object"===_typeof(e.instance)&&(t.instance=new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0))),null!=e.size&&(t.size=e.size>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(n.user="",n.group="",$util.Long){var i=new $util.Long(0,0,!0);n.instance=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.instance=t.longs===String?"0":0;n.size=0}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.user&&e.hasOwnProperty("user")&&(n.user=e.user),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),null!=e.instance&&e.hasOwnProperty("instance")&&("number"==typeof e.instance?n.instance=t.longs===String?String(e.instance):e.instance:n.instance=t.longs===String?$util.Long.prototype.toString.call(e.instance):t.longs===Number?new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0):e.instance),null!=e.size&&e.hasOwnProperty("size")&&(n.size=e.size),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),Message=$root.Message=function(){function e(e){if(this.MiscMap={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.dialogue=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.sequence=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.options=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.src="",e.prototype.dst="",e.prototype.payload=$util.newBuffer([]),e.prototype.MiscMap=$util.emptyObject,e.prototype.ms=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.instance&&e.hasOwnProperty("instance")&&t.uint32(8).uint64(e.instance),null!=e.dialogue&&e.hasOwnProperty("dialogue")&&t.uint32(16).uint64(e.dialogue),null!=e.sequence&&e.hasOwnProperty("sequence")&&t.uint32(24).uint64(e.sequence),null!=e.options&&e.hasOwnProperty("options")&&t.uint32(32).uint64(e.options),null!=e.src&&e.hasOwnProperty("src")&&t.uint32(42).string(e.src),null!=e.dst&&e.hasOwnProperty("dst")&&t.uint32(50).string(e.dst),null!=e.payload&&e.hasOwnProperty("payload")&&t.uint32(58).bytes(e.payload),null!=e.MiscMap&&e.hasOwnProperty("MiscMap"))for(var n=Object.keys(e.MiscMap),r=0;r<n.length;++r)t.uint32(66).fork().uint32(10).string(n[r]).uint32(18).string(e.MiscMap[n[r]]).ldelim();return null!=e.ms&&e.hasOwnProperty("ms")&&t.uint32(72).uint64(e.ms),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n,r=void 0===t?e.len:e.pos+t,i=new $root.Message;e.pos<r;){var o=e.uint32();switch(o>>>3){case 1:i.instance=e.uint64();break;case 2:i.dialogue=e.uint64();break;case 3:i.sequence=e.uint64();break;case 4:i.options=e.uint64();break;case 5:i.src=e.string();break;case 6:i.dst=e.string();break;case 7:i.payload=e.bytes();break;case 8:e.skip().pos++,i.MiscMap===$util.emptyObject&&(i.MiscMap={}),n=e.string(),e.pos++,i.MiscMap[n]=e.string();break;case 9:i.ms=e.uint64();break;default:e.skipType(7&o)}}return i},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.instance&&e.hasOwnProperty("instance")&&!($util.isInteger(e.instance)||e.instance&&$util.isInteger(e.instance.low)&&$util.isInteger(e.instance.high)))return"instance: integer|Long expected";if(null!=e.dialogue&&e.hasOwnProperty("dialogue")&&!($util.isInteger(e.dialogue)||e.dialogue&&$util.isInteger(e.dialogue.low)&&$util.isInteger(e.dialogue.high)))return"dialogue: integer|Long expected";if(null!=e.sequence&&e.hasOwnProperty("sequence")&&!($util.isInteger(e.sequence)||e.sequence&&$util.isInteger(e.sequence.low)&&$util.isInteger(e.sequence.high)))return"sequence: integer|Long expected";if(null!=e.options&&e.hasOwnProperty("options")&&!($util.isInteger(e.options)||e.options&&$util.isInteger(e.options.low)&&$util.isInteger(e.options.high)))return"options: integer|Long expected";if(null!=e.src&&e.hasOwnProperty("src")&&!$util.isString(e.src))return"src: string expected";if(null!=e.dst&&e.hasOwnProperty("dst")&&!$util.isString(e.dst))return"dst: string expected";if(null!=e.payload&&e.hasOwnProperty("payload")&&!(e.payload&&"number"==typeof e.payload.length||$util.isString(e.payload)))return"payload: buffer expected";if(null!=e.MiscMap&&e.hasOwnProperty("MiscMap")){if(!$util.isObject(e.MiscMap))return"MiscMap: object expected";for(var t=Object.keys(e.MiscMap),n=0;n<t.length;++n)if(!$util.isString(e.MiscMap[t[n]]))return"MiscMap: string{k:string} expected"}return null!=e.ms&&e.hasOwnProperty("ms")&&!($util.isInteger(e.ms)||e.ms&&$util.isInteger(e.ms.low)&&$util.isInteger(e.ms.high))?"ms: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root.Message)return e;var t=new $root.Message;if(null!=e.instance&&($util.Long?(t.instance=$util.Long.fromValue(e.instance)).unsigned=!0:"string"==typeof e.instance?t.instance=parseInt(e.instance,10):"number"==typeof e.instance?t.instance=e.instance:"object"===_typeof(e.instance)&&(t.instance=new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0))),null!=e.dialogue&&($util.Long?(t.dialogue=$util.Long.fromValue(e.dialogue)).unsigned=!0:"string"==typeof e.dialogue?t.dialogue=parseInt(e.dialogue,10):"number"==typeof e.dialogue?t.dialogue=e.dialogue:"object"===_typeof(e.dialogue)&&(t.dialogue=new $util.LongBits(e.dialogue.low>>>0,e.dialogue.high>>>0).toNumber(!0))),null!=e.sequence&&($util.Long?(t.sequence=$util.Long.fromValue(e.sequence)).unsigned=!0:"string"==typeof e.sequence?t.sequence=parseInt(e.sequence,10):"number"==typeof e.sequence?t.sequence=e.sequence:"object"===_typeof(e.sequence)&&(t.sequence=new $util.LongBits(e.sequence.low>>>0,e.sequence.high>>>0).toNumber(!0))),null!=e.options&&($util.Long?(t.options=$util.Long.fromValue(e.options)).unsigned=!0:"string"==typeof e.options?t.options=parseInt(e.options,10):"number"==typeof e.options?t.options=e.options:"object"===_typeof(e.options)&&(t.options=new $util.LongBits(e.options.low>>>0,e.options.high>>>0).toNumber(!0))),null!=e.src&&(t.src=String(e.src)),null!=e.dst&&(t.dst=String(e.dst)),null!=e.payload&&("string"==typeof e.payload?$util.base64.decode(e.payload,t.payload=$util.newBuffer($util.base64.length(e.payload)),0):e.payload.length&&(t.payload=e.payload)),e.MiscMap){if("object"!==_typeof(e.MiscMap))throw TypeError(".Message.MiscMap: object expected");t.MiscMap={};for(var n=Object.keys(e.MiscMap),r=0;r<n.length;++r)t.MiscMap[n[r]]=String(e.MiscMap[n[r]])}return null!=e.ms&&($util.Long?(t.ms=$util.Long.fromValue(e.ms)).unsigned=!0:"string"==typeof e.ms?t.ms=parseInt(e.ms,10):"number"==typeof e.ms?t.ms=e.ms:"object"===_typeof(e.ms)&&(t.ms=new $util.LongBits(e.ms.low>>>0,e.ms.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var n,r={};if((t.objects||t.defaults)&&(r.MiscMap={}),t.defaults){if($util.Long){var i=new $util.Long(0,0,!0);r.instance=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else r.instance=t.longs===String?"0":0;if($util.Long){var o=new $util.Long(0,0,!0);r.dialogue=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else r.dialogue=t.longs===String?"0":0;if($util.Long){var a=new $util.Long(0,0,!0);r.sequence=t.longs===String?a.toString():t.longs===Number?a.toNumber():a}else r.sequence=t.longs===String?"0":0;if($util.Long){var s=new $util.Long(0,0,!0);r.options=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else r.options=t.longs===String?"0":0;if(r.src="",r.dst="",t.bytes===String?r.payload="":(r.payload=[],t.bytes!==Array&&(r.payload=$util.newBuffer(r.payload))),$util.Long){var u=new $util.Long(0,0,!0);r.ms=t.longs===String?u.toString():t.longs===Number?u.toNumber():u}else r.ms=t.longs===String?"0":0}if(null!=e.instance&&e.hasOwnProperty("instance")&&("number"==typeof e.instance?r.instance=t.longs===String?String(e.instance):e.instance:r.instance=t.longs===String?$util.Long.prototype.toString.call(e.instance):t.longs===Number?new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0):e.instance),null!=e.dialogue&&e.hasOwnProperty("dialogue")&&("number"==typeof e.dialogue?r.dialogue=t.longs===String?String(e.dialogue):e.dialogue:r.dialogue=t.longs===String?$util.Long.prototype.toString.call(e.dialogue):t.longs===Number?new $util.LongBits(e.dialogue.low>>>0,e.dialogue.high>>>0).toNumber(!0):e.dialogue),null!=e.sequence&&e.hasOwnProperty("sequence")&&("number"==typeof e.sequence?r.sequence=t.longs===String?String(e.sequence):e.sequence:r.sequence=t.longs===String?$util.Long.prototype.toString.call(e.sequence):t.longs===Number?new $util.LongBits(e.sequence.low>>>0,e.sequence.high>>>0).toNumber(!0):e.sequence),null!=e.options&&e.hasOwnProperty("options")&&("number"==typeof e.options?r.options=t.longs===String?String(e.options):e.options:r.options=t.longs===String?$util.Long.prototype.toString.call(e.options):t.longs===Number?new $util.LongBits(e.options.low>>>0,e.options.high>>>0).toNumber(!0):e.options),null!=e.src&&e.hasOwnProperty("src")&&(r.src=e.src),null!=e.dst&&e.hasOwnProperty("dst")&&(r.dst=e.dst),null!=e.payload&&e.hasOwnProperty("payload")&&(r.payload=t.bytes===String?$util.base64.encode(e.payload,0,e.payload.length):t.bytes===Array?Array.prototype.slice.call(e.payload):e.payload),e.MiscMap&&(n=Object.keys(e.MiscMap)).length){r.MiscMap={};for(var c=0;c<n.length;++c)r.MiscMap[n[c]]=e.MiscMap[n[c]]}return null!=e.ms&&e.hasOwnProperty("ms")&&("number"==typeof e.ms?r.ms=t.longs===String?String(e.ms):e.ms:r.ms=t.longs===String?$util.Long.prototype.toString.call(e.ms):t.longs===Number?new $util.LongBits(e.ms.low>>>0,e.ms.high>>>0).toNumber(!0):e.ms),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),Ack=$root.Ack=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.dialogue=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.sequence=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.instance&&e.hasOwnProperty("instance")&&t.uint32(8).uint64(e.instance),null!=e.dialogue&&e.hasOwnProperty("dialogue")&&t.uint32(16).uint64(e.dialogue),null!=e.sequence&&e.hasOwnProperty("sequence")&&t.uint32(24).uint64(e.sequence),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(32).uint32(e.code),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.Ack;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.instance=e.uint64();break;case 2:r.dialogue=e.uint64();break;case 3:r.sequence=e.uint64();break;case 4:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.instance&&e.hasOwnProperty("instance")&&!($util.isInteger(e.instance)||e.instance&&$util.isInteger(e.instance.low)&&$util.isInteger(e.instance.high))?"instance: integer|Long expected":null!=e.dialogue&&e.hasOwnProperty("dialogue")&&!($util.isInteger(e.dialogue)||e.dialogue&&$util.isInteger(e.dialogue.low)&&$util.isInteger(e.dialogue.high))?"dialogue: integer|Long expected":null!=e.sequence&&e.hasOwnProperty("sequence")&&!($util.isInteger(e.sequence)||e.sequence&&$util.isInteger(e.sequence.low)&&$util.isInteger(e.sequence.high))?"sequence: integer|Long expected":null!=e.code&&e.hasOwnProperty("code")&&!$util.isInteger(e.code)?"code: integer expected":null},e.fromObject=function(e){if(e instanceof $root.Ack)return e;var t=new $root.Ack;return null!=e.instance&&($util.Long?(t.instance=$util.Long.fromValue(e.instance)).unsigned=!0:"string"==typeof e.instance?t.instance=parseInt(e.instance,10):"number"==typeof e.instance?t.instance=e.instance:"object"===_typeof(e.instance)&&(t.instance=new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0))),null!=e.dialogue&&($util.Long?(t.dialogue=$util.Long.fromValue(e.dialogue)).unsigned=!0:"string"==typeof e.dialogue?t.dialogue=parseInt(e.dialogue,10):"number"==typeof e.dialogue?t.dialogue=e.dialogue:"object"===_typeof(e.dialogue)&&(t.dialogue=new $util.LongBits(e.dialogue.low>>>0,e.dialogue.high>>>0).toNumber(!0))),null!=e.sequence&&($util.Long?(t.sequence=$util.Long.fromValue(e.sequence)).unsigned=!0:"string"==typeof e.sequence?t.sequence=parseInt(e.sequence,10):"number"==typeof e.sequence?t.sequence=e.sequence:"object"===_typeof(e.sequence)&&(t.sequence=new $util.LongBits(e.sequence.low>>>0,e.sequence.high>>>0).toNumber(!0))),null!=e.code&&(t.code=e.code>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.instance=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.instance=t.longs===String?"0":0;if($util.Long){var i=new $util.Long(0,0,!0);n.dialogue=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.dialogue=t.longs===String?"0":0;if($util.Long){var o=new $util.Long(0,0,!0);n.sequence=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.sequence=t.longs===String?"0":0;n.code=0}return null!=e.instance&&e.hasOwnProperty("instance")&&("number"==typeof e.instance?n.instance=t.longs===String?String(e.instance):e.instance:n.instance=t.longs===String?$util.Long.prototype.toString.call(e.instance):t.longs===Number?new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0):e.instance),null!=e.dialogue&&e.hasOwnProperty("dialogue")&&("number"==typeof e.dialogue?n.dialogue=t.longs===String?String(e.dialogue):e.dialogue:n.dialogue=t.longs===String?$util.Long.prototype.toString.call(e.dialogue):t.longs===Number?new $util.LongBits(e.dialogue.low>>>0,e.dialogue.high>>>0).toNumber(!0):e.dialogue),null!=e.sequence&&e.hasOwnProperty("sequence")&&("number"==typeof e.sequence?n.sequence=t.longs===String?String(e.sequence):e.sequence:n.sequence=t.longs===String?$util.Long.prototype.toString.call(e.sequence):t.longs===Number?new $util.LongBits(e.sequence.low>>>0,e.sequence.high>>>0).toNumber(!0):e.sequence),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupAllUsersList=$root.GroupAllUsersList=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.pageSize=0,e.prototype.pageNumber=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(18).string(e.group),null!=e.pageSize&&e.hasOwnProperty("pageSize")&&t.uint32(24).uint32(e.pageSize),null!=e.pageNumber&&e.hasOwnProperty("pageNumber")&&t.uint32(32).uint32(e.pageNumber),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAllUsersList;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.pageSize=e.uint32();break;case 4:r.pageNumber=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group)?"group: string expected":null!=e.pageSize&&e.hasOwnProperty("pageSize")&&!$util.isInteger(e.pageSize)?"pageSize: integer expected":null!=e.pageNumber&&e.hasOwnProperty("pageNumber")&&!$util.isInteger(e.pageNumber)?"pageNumber: integer expected":null},e.fromObject=function(e){if(e instanceof $root.GroupAllUsersList)return e;var t=new $root.GroupAllUsersList;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.group&&(t.group=String(e.group)),null!=e.pageSize&&(t.pageSize=e.pageSize>>>0),null!=e.pageNumber&&(t.pageNumber=e.pageNumber>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.group="",n.pageSize=0,n.pageNumber=0}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),null!=e.pageSize&&e.hasOwnProperty("pageSize")&&(n.pageSize=e.pageSize),null!=e.pageNumber&&e.hasOwnProperty("pageNumber")&&(n.pageNumber=e.pageNumber),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupAllUsersResult=$root.GroupAllUsersResult=function(){function e(e){if(this.memberInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.totalSize=0,e.prototype.pageSize=0,e.prototype.pageNumber=0,e.prototype.memberInfos=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(18).string(e.group),null!=e.totalSize&&e.hasOwnProperty("totalSize")&&t.uint32(24).uint32(e.totalSize),null!=e.pageSize&&e.hasOwnProperty("pageSize")&&t.uint32(32).uint32(e.pageSize),null!=e.pageNumber&&e.hasOwnProperty("pageNumber")&&t.uint32(40).uint32(e.pageNumber),null!=e.memberInfos&&e.memberInfos.length)for(var n=0;n<e.memberInfos.length;++n)$root.GroupAllUsersResult.MemberInfo.encode(e.memberInfos[n],t.uint32(50).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAllUsersResult;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.totalSize=e.uint32();break;case 4:r.pageSize=e.uint32();break;case 5:r.pageNumber=e.uint32();break;case 6:r.memberInfos&&r.memberInfos.length||(r.memberInfos=[]),r.memberInfos.push($root.GroupAllUsersResult.MemberInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group))return"group: string expected";if(null!=e.totalSize&&e.hasOwnProperty("totalSize")&&!$util.isInteger(e.totalSize))return"totalSize: integer expected";if(null!=e.pageSize&&e.hasOwnProperty("pageSize")&&!$util.isInteger(e.pageSize))return"pageSize: integer expected";if(null!=e.pageNumber&&e.hasOwnProperty("pageNumber")&&!$util.isInteger(e.pageNumber))return"pageNumber: integer expected";if(null!=e.memberInfos&&e.hasOwnProperty("memberInfos")){if(!Array.isArray(e.memberInfos))return"memberInfos: array expected";for(var t=0;t<e.memberInfos.length;++t){var n=$root.GroupAllUsersResult.MemberInfo.verify(e.memberInfos[t]);if(n)return"memberInfos."+n}}return null},e.fromObject=function(e){if(e instanceof $root.GroupAllUsersResult)return e;var t=new $root.GroupAllUsersResult;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.group&&(t.group=String(e.group)),null!=e.totalSize&&(t.totalSize=e.totalSize>>>0),null!=e.pageSize&&(t.pageSize=e.pageSize>>>0),null!=e.pageNumber&&(t.pageNumber=e.pageNumber>>>0),e.memberInfos){if(!Array.isArray(e.memberInfos))throw TypeError(".GroupAllUsersResult.memberInfos: array expected");t.memberInfos=[];for(var n=0;n<e.memberInfos.length;++n){if("object"!==_typeof(e.memberInfos[n]))throw TypeError(".GroupAllUsersResult.memberInfos: object expected");t.memberInfos[n]=$root.GroupAllUsersResult.MemberInfo.fromObject(e.memberInfos[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.memberInfos=[]),t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.group="",n.totalSize=0,n.pageSize=0,n.pageNumber=0}if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),null!=e.totalSize&&e.hasOwnProperty("totalSize")&&(n.totalSize=e.totalSize),null!=e.pageSize&&e.hasOwnProperty("pageSize")&&(n.pageSize=e.pageSize),null!=e.pageNumber&&e.hasOwnProperty("pageNumber")&&(n.pageNumber=e.pageNumber),e.memberInfos&&e.memberInfos.length){n.memberInfos=[];for(var i=0;i<e.memberInfos.length;++i)n.memberInfos[i]=$root.GroupAllUsersResult.MemberInfo.toObject(e.memberInfos[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.MemberInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.account="",e.prototype.ts=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(10).string(e.account),null!=e.ts&&e.hasOwnProperty("ts")&&t.uint32(16).uint32(e.ts),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAllUsersResult.MemberInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.account=e.string();break;case 2:r.ts=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account)?"account: string expected":null!=e.ts&&e.hasOwnProperty("ts")&&!$util.isInteger(e.ts)?"ts: integer expected":null},e.fromObject=function(e){if(e instanceof $root.GroupAllUsersResult.MemberInfo)return e;var t=new $root.GroupAllUsersResult.MemberInfo;return null!=e.account&&(t.account=String(e.account)),null!=e.ts&&(t.ts=e.ts>>>0),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.account="",n.ts=0),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),null!=e.ts&&e.hasOwnProperty("ts")&&(n.ts=e.ts),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),UserStatusList=$root.UserStatusList=function(){function e(e){if(this.users=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.users=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.users&&e.users.length)for(var n=0;n<e.users.length;++n)t.uint32(18).string(e.users[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserStatusList;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.users&&r.users.length||(r.users=[]),r.users.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.users&&e.hasOwnProperty("users")){if(!Array.isArray(e.users))return"users: array expected";for(var t=0;t<e.users.length;++t)if(!$util.isString(e.users[t]))return"users: string[] expected"}return null},e.fromObject=function(e){if(e instanceof $root.UserStatusList)return e;var t=new $root.UserStatusList;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.users){if(!Array.isArray(e.users))throw TypeError(".UserStatusList.users: array expected");t.users=[];for(var n=0;n<e.users.length;++n)t.users[n]=String(e.users[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.users=[]),t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.users&&e.users.length){n.users=[];for(var i=0;i<e.users.length;++i)n.users[i]=e.users[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserStatusResult=$root.UserStatusResult=function(){function e(e){if(this.userInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.userInfos=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.userInfos&&e.userInfos.length)for(var n=0;n<e.userInfos.length;++n)$root.UserStatusResult.UserStatusInfo.encode(e.userInfos[n],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserStatusResult;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.userInfos&&r.userInfos.length||(r.userInfos=[]),r.userInfos.push($root.UserStatusResult.UserStatusInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.userInfos&&e.hasOwnProperty("userInfos")){if(!Array.isArray(e.userInfos))return"userInfos: array expected";for(var t=0;t<e.userInfos.length;++t){var n=$root.UserStatusResult.UserStatusInfo.verify(e.userInfos[t]);if(n)return"userInfos."+n}}return null},e.fromObject=function(e){if(e instanceof $root.UserStatusResult)return e;var t=new $root.UserStatusResult;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.userInfos){if(!Array.isArray(e.userInfos))throw TypeError(".UserStatusResult.userInfos: array expected");t.userInfos=[];for(var n=0;n<e.userInfos.length;++n){if("object"!==_typeof(e.userInfos[n]))throw TypeError(".UserStatusResult.userInfos: object expected");t.userInfos[n]=$root.UserStatusResult.UserStatusInfo.fromObject(e.userInfos[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.userInfos=[]),t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.userInfos&&e.userInfos.length){n.userInfos=[];for(var i=0;i<e.userInfos.length;++i)n.userInfos[i]=$root.UserStatusResult.UserStatusInfo.toObject(e.userInfos[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.UserStatusInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.account="",e.prototype.ts=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(10).string(e.account),null!=e.ts&&e.hasOwnProperty("ts")&&t.uint32(16).uint32(e.ts),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserStatusResult.UserStatusInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.account=e.string();break;case 2:r.ts=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account)?"account: string expected":null!=e.ts&&e.hasOwnProperty("ts")&&!$util.isInteger(e.ts)?"ts: integer expected":null},e.fromObject=function(e){if(e instanceof $root.UserStatusResult.UserStatusInfo)return e;var t=new $root.UserStatusResult.UserStatusInfo;return null!=e.account&&(t.account=String(e.account)),null!=e.ts&&(t.ts=e.ts>>>0),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.account="",n.ts=0),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),null!=e.ts&&e.hasOwnProperty("ts")&&(n.ts=e.ts),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),UserAttributeGet=$root.UserAttributeGet=function(){function e(e){if(this.attributes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributes=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(18).string(e.account),null!=e.attributes&&e.attributes.length)for(var n=0;n<e.attributes.length;++n)t.uint32(26).string(e.attributes[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.attributes&&r.attributes.length||(r.attributes=[]),r.attributes.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account))return"account: string expected";if(null!=e.attributes&&e.hasOwnProperty("attributes")){if(!Array.isArray(e.attributes))return"attributes: array expected";for(var t=0;t<e.attributes.length;++t)if(!$util.isString(e.attributes[t]))return"attributes: string[] expected"}return null},e.fromObject=function(e){if(e instanceof $root.UserAttributeGet)return e;var t=new $root.UserAttributeGet;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.account&&(t.account=String(e.account)),e.attributes){if(!Array.isArray(e.attributes))throw TypeError(".UserAttributeGet.attributes: array expected");t.attributes=[];for(var n=0;n<e.attributes.length;++n)t.attributes[n]=String(e.attributes[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attributes=[]),t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.account=""}if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),e.attributes&&e.attributes.length){n.attributes=[];for(var i=0;i<e.attributes.length;++i)n.attributes[i]=e.attributes[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserAttributeRet=$root.UserAttributeRet=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.attributeInfos=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.attributeInfos&&e.attributeInfos.length)for(var n=0;n<e.attributeInfos.length;++n)$root.UserAttributeRet.AttributeInfo.encode(e.attributeInfos[n],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push($root.UserAttributeRet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.attributeInfos&&e.hasOwnProperty("attributeInfos")){if(!Array.isArray(e.attributeInfos))return"attributeInfos: array expected";for(var t=0;t<e.attributeInfos.length;++t){var n=$root.UserAttributeRet.AttributeInfo.verify(e.attributeInfos[t]);if(n)return"attributeInfos."+n}}return null},e.fromObject=function(e){if(e instanceof $root.UserAttributeRet)return e;var t=new $root.UserAttributeRet;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.attributeInfos){if(!Array.isArray(e.attributeInfos))throw TypeError(".UserAttributeRet.attributeInfos: array expected");t.attributeInfos=[];for(var n=0;n<e.attributeInfos.length;++n){if("object"!==_typeof(e.attributeInfos[n]))throw TypeError(".UserAttributeRet.attributeInfos: object expected");t.attributeInfos[n]=$root.UserAttributeRet.AttributeInfo.fromObject(e.attributeInfos[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attributeInfos=[]),t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.attributeInfos&&e.attributeInfos.length){n.attributeInfos=[];for(var i=0;i<e.attributeInfos.length;++i)n.attributeInfos[i]=$root.UserAttributeRet.AttributeInfo.toObject(e.attributeInfos[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&e.hasOwnProperty("key")&&t.uint32(10).string(e.key),null!=e.value&&e.hasOwnProperty("value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeRet.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!$util.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!$util.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof $root.UserAttributeRet.AttributeInfo)return e;var t=new $root.UserAttributeRet.AttributeInfo;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),UserAttributeSet=$root.UserAttributeSet=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributeInfos=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(18).string(e.account),null!=e.attributeInfos&&e.attributeInfos.length)for(var n=0;n<e.attributeInfos.length;++n)$root.UserAttributeSet.AttributeInfo.encode(e.attributeInfos[n],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeSet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push($root.UserAttributeSet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account))return"account: string expected";if(null!=e.attributeInfos&&e.hasOwnProperty("attributeInfos")){if(!Array.isArray(e.attributeInfos))return"attributeInfos: array expected";for(var t=0;t<e.attributeInfos.length;++t){var n=$root.UserAttributeSet.AttributeInfo.verify(e.attributeInfos[t]);if(n)return"attributeInfos."+n}}return null},e.fromObject=function(e){if(e instanceof $root.UserAttributeSet)return e;var t=new $root.UserAttributeSet;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.account&&(t.account=String(e.account)),e.attributeInfos){if(!Array.isArray(e.attributeInfos))throw TypeError(".UserAttributeSet.attributeInfos: array expected");t.attributeInfos=[];for(var n=0;n<e.attributeInfos.length;++n){if("object"!==_typeof(e.attributeInfos[n]))throw TypeError(".UserAttributeSet.attributeInfos: object expected");t.attributeInfos[n]=$root.UserAttributeSet.AttributeInfo.fromObject(e.attributeInfos[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attributeInfos=[]),t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.account=""}if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),e.attributeInfos&&e.attributeInfos.length){n.attributeInfos=[];for(var i=0;i<e.attributeInfos.length;++i)n.attributeInfos[i]=$root.UserAttributeSet.AttributeInfo.toObject(e.attributeInfos[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&e.hasOwnProperty("key")&&t.uint32(10).string(e.key),null!=e.value&&e.hasOwnProperty("value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeSet.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!$util.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!$util.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof $root.UserAttributeSet.AttributeInfo)return e;var t=new $root.UserAttributeSet.AttributeInfo;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),UserAttributeMod=$root.UserAttributeMod=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributeInfos=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(18).string(e.account),null!=e.attributeInfos&&e.attributeInfos.length)for(var n=0;n<e.attributeInfos.length;++n)$root.UserAttributeMod.AttributeInfo.encode(e.attributeInfos[n],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeMod;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push($root.UserAttributeMod.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account))return"account: string expected";if(null!=e.attributeInfos&&e.hasOwnProperty("attributeInfos")){if(!Array.isArray(e.attributeInfos))return"attributeInfos: array expected";for(var t=0;t<e.attributeInfos.length;++t){var n=$root.UserAttributeMod.AttributeInfo.verify(e.attributeInfos[t]);if(n)return"attributeInfos."+n}}return null},e.fromObject=function(e){if(e instanceof $root.UserAttributeMod)return e;var t=new $root.UserAttributeMod;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.account&&(t.account=String(e.account)),e.attributeInfos){if(!Array.isArray(e.attributeInfos))throw TypeError(".UserAttributeMod.attributeInfos: array expected");t.attributeInfos=[];for(var n=0;n<e.attributeInfos.length;++n){if("object"!==_typeof(e.attributeInfos[n]))throw TypeError(".UserAttributeMod.attributeInfos: object expected");t.attributeInfos[n]=$root.UserAttributeMod.AttributeInfo.fromObject(e.attributeInfos[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attributeInfos=[]),t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.account=""}if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),e.attributeInfos&&e.attributeInfos.length){n.attributeInfos=[];for(var i=0;i<e.attributeInfos.length;++i)n.attributeInfos[i]=$root.UserAttributeMod.AttributeInfo.toObject(e.attributeInfos[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&e.hasOwnProperty("key")&&t.uint32(10).string(e.key),null!=e.value&&e.hasOwnProperty("value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeMod.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!$util.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!$util.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof $root.UserAttributeMod.AttributeInfo)return e;var t=new $root.UserAttributeMod.AttributeInfo;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),UserAttributeDel=$root.UserAttributeDel=function(){function e(e){if(this.attributes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributes=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(18).string(e.account),null!=e.attributes&&e.attributes.length)for(var n=0;n<e.attributes.length;++n)t.uint32(26).string(e.attributes[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeDel;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.attributes&&r.attributes.length||(r.attributes=[]),r.attributes.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account))return"account: string expected";if(null!=e.attributes&&e.hasOwnProperty("attributes")){if(!Array.isArray(e.attributes))return"attributes: array expected";for(var t=0;t<e.attributes.length;++t)if(!$util.isString(e.attributes[t]))return"attributes: string[] expected"}return null},e.fromObject=function(e){if(e instanceof $root.UserAttributeDel)return e;var t=new $root.UserAttributeDel;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.account&&(t.account=String(e.account)),e.attributes){if(!Array.isArray(e.attributes))throw TypeError(".UserAttributeDel.attributes: array expected");t.attributes=[];for(var n=0;n<e.attributes.length;++n)t.attributes[n]=String(e.attributes[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attributes=[]),t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.account=""}if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),e.attributes&&e.attributes.length){n.attributes=[];for(var i=0;i<e.attributes.length;++i)n.attributes[i]=e.attributes[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserAttributeErr=$root.UserAttributeErr=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).uint32(e.code),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeErr;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.code&&e.hasOwnProperty("code")&&!$util.isInteger(e.code)?"code: integer expected":null},e.fromObject=function(e){if(e instanceof $root.UserAttributeErr)return e;var t=new $root.UserAttributeErr;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.code&&(t.code=e.code>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.code=0}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserAttributeKeysGet=$root.UserAttributeKeysGet=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(18).string(e.account),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeKeysGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account)?"account: string expected":null},e.fromObject=function(e){if(e instanceof $root.UserAttributeKeysGet)return e;var t=new $root.UserAttributeKeysGet;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.account&&(t.account=String(e.account)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.account=""}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserAttributeKeysRet=$root.UserAttributeKeysRet=function(){function e(e){if(this.keys=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.keys=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.keys&&e.keys.length)for(var n=0;n<e.keys.length;++n)t.uint32(18).string(e.keys[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeKeysRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.keys&&r.keys.length||(r.keys=[]),r.keys.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.keys&&e.hasOwnProperty("keys")){if(!Array.isArray(e.keys))return"keys: array expected";for(var t=0;t<e.keys.length;++t)if(!$util.isString(e.keys[t]))return"keys: string[] expected"}return null},e.fromObject=function(e){if(e instanceof $root.UserAttributeKeysRet)return e;var t=new $root.UserAttributeKeysRet;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.keys){if(!Array.isArray(e.keys))throw TypeError(".UserAttributeKeysRet.keys: array expected");t.keys=[];for(var n=0;n<e.keys.length;++n)t.keys[n]=String(e.keys[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.keys=[]),t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.keys&&e.keys.length){n.keys=[];for(var i=0;i<e.keys.length;++i)n.keys[i]=e.keys[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserAttributeRsp=$root.UserAttributeRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserAttributeRsp;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root.UserAttributeRsp)return e;var t=new $root.UserAttributeRsp;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupStatusList=$root.GroupStatusList=function(){function e(e){if(this.groups=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.groups=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.groups&&e.groups.length)for(var n=0;n<e.groups.length;++n)t.uint32(18).string(e.groups[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupStatusList;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.groups&&r.groups.length||(r.groups=[]),r.groups.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.groups&&e.hasOwnProperty("groups")){if(!Array.isArray(e.groups))return"groups: array expected";for(var t=0;t<e.groups.length;++t)if(!$util.isString(e.groups[t]))return"groups: string[] expected"}return null},e.fromObject=function(e){if(e instanceof $root.GroupStatusList)return e;var t=new $root.GroupStatusList;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.groups){if(!Array.isArray(e.groups))throw TypeError(".GroupStatusList.groups: array expected");t.groups=[];for(var n=0;n<e.groups.length;++n)t.groups[n]=String(e.groups[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.groups=[]),t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.groups&&e.groups.length){n.groups=[];for(var i=0;i<e.groups.length;++i)n.groups[i]=e.groups[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupStatusResult=$root.GroupStatusResult=function(){function e(e){if(this.groupInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.groupInfos=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.groupInfos&&e.groupInfos.length)for(var n=0;n<e.groupInfos.length;++n)$root.GroupStatusResult.GroupInfo.encode(e.groupInfos[n],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupStatusResult;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.groupInfos&&r.groupInfos.length||(r.groupInfos=[]),r.groupInfos.push($root.GroupStatusResult.GroupInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.groupInfos&&e.hasOwnProperty("groupInfos")){if(!Array.isArray(e.groupInfos))return"groupInfos: array expected";for(var t=0;t<e.groupInfos.length;++t){var n=$root.GroupStatusResult.GroupInfo.verify(e.groupInfos[t]);if(n)return"groupInfos."+n}}return null},e.fromObject=function(e){if(e instanceof $root.GroupStatusResult)return e;var t=new $root.GroupStatusResult;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.groupInfos){if(!Array.isArray(e.groupInfos))throw TypeError(".GroupStatusResult.groupInfos: array expected");t.groupInfos=[];for(var n=0;n<e.groupInfos.length;++n){if("object"!==_typeof(e.groupInfos[n]))throw TypeError(".GroupStatusResult.groupInfos: object expected");t.groupInfos[n]=$root.GroupStatusResult.GroupInfo.fromObject(e.groupInfos[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.groupInfos=[]),t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.groupInfos&&e.groupInfos.length){n.groupInfos=[];for(var i=0;i<e.groupInfos.length;++i)n.groupInfos[i]=$root.GroupStatusResult.GroupInfo.toObject(e.groupInfos[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.GroupInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.group="",e.prototype.memberCount=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(10).string(e.group),null!=e.memberCount&&e.hasOwnProperty("memberCount")&&t.uint32(16).uint32(e.memberCount),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupStatusResult.GroupInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.group=e.string();break;case 2:r.memberCount=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group)?"group: string expected":null!=e.memberCount&&e.hasOwnProperty("memberCount")&&!$util.isInteger(e.memberCount)?"memberCount: integer expected":null},e.fromObject=function(e){if(e instanceof $root.GroupStatusResult.GroupInfo)return e;var t=new $root.GroupStatusResult.GroupInfo;return null!=e.group&&(t.group=String(e.group)),null!=e.memberCount&&(t.memberCount=e.memberCount>>>0),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.group="",n.memberCount=0),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),null!=e.memberCount&&e.hasOwnProperty("memberCount")&&(n.memberCount=e.memberCount),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),GroupCountNotice=$root.GroupCountNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.size=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.instance&&e.hasOwnProperty("instance")&&t.uint32(8).uint64(e.instance),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(16).uint64(e.seq),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(26).string(e.group),null!=e.size&&e.hasOwnProperty("size")&&t.uint32(32).uint32(e.size),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupCountNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.instance=e.uint64();break;case 2:r.seq=e.uint64();break;case 3:r.group=e.string();break;case 4:r.size=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.instance&&e.hasOwnProperty("instance")&&!($util.isInteger(e.instance)||e.instance&&$util.isInteger(e.instance.low)&&$util.isInteger(e.instance.high))?"instance: integer|Long expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group)?"group: string expected":null!=e.size&&e.hasOwnProperty("size")&&!$util.isInteger(e.size)?"size: integer expected":null},e.fromObject=function(e){if(e instanceof $root.GroupCountNotice)return e;var t=new $root.GroupCountNotice;return null!=e.instance&&($util.Long?(t.instance=$util.Long.fromValue(e.instance)).unsigned=!0:"string"==typeof e.instance?t.instance=parseInt(e.instance,10):"number"==typeof e.instance?t.instance=e.instance:"object"===_typeof(e.instance)&&(t.instance=new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0))),null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.group&&(t.group=String(e.group)),null!=e.size&&(t.size=e.size>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.instance=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.instance=t.longs===String?"0":0;if($util.Long){var i=new $util.Long(0,0,!0);n.seq=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.seq=t.longs===String?"0":0;n.group="",n.size=0}return null!=e.instance&&e.hasOwnProperty("instance")&&("number"==typeof e.instance?n.instance=t.longs===String?String(e.instance):e.instance:n.instance=t.longs===String?$util.Long.prototype.toString.call(e.instance):t.longs===Number?new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0):e.instance),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),null!=e.size&&e.hasOwnProperty("size")&&(n.size=e.size),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupAttributeGet=$root.GroupAttributeGet=function(){function e(e){if(this.attributes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.attributes=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(18).string(e.group),null!=e.attributes&&e.attributes.length)for(var n=0;n<e.attributes.length;++n)t.uint32(26).string(e.attributes[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.attributes&&r.attributes.length||(r.attributes=[]),r.attributes.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group))return"group: string expected";if(null!=e.attributes&&e.hasOwnProperty("attributes")){if(!Array.isArray(e.attributes))return"attributes: array expected";for(var t=0;t<e.attributes.length;++t)if(!$util.isString(e.attributes[t]))return"attributes: string[] expected"}return null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeGet)return e;var t=new $root.GroupAttributeGet;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.group&&(t.group=String(e.group)),e.attributes){if(!Array.isArray(e.attributes))throw TypeError(".GroupAttributeGet.attributes: array expected");t.attributes=[];for(var n=0;n<e.attributes.length;++n)t.attributes[n]=String(e.attributes[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attributes=[]),t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.group=""}if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),e.attributes&&e.attributes.length){n.attributes=[];for(var i=0;i<e.attributes.length;++i)n.attributes[i]=e.attributes[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupAttributeRet=$root.GroupAttributeRet=function(){function e(e){if(this.attributeMaps=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.attributeMaps=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.attributeMaps&&e.attributeMaps.length)for(var n=0;n<e.attributeMaps.length;++n)$root.GroupAttributeRet.AttributeMap.encode(e.attributeMaps[n],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.attributeMaps&&r.attributeMaps.length||(r.attributeMaps=[]),r.attributeMaps.push($root.GroupAttributeRet.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.attributeMaps&&e.hasOwnProperty("attributeMaps")){if(!Array.isArray(e.attributeMaps))return"attributeMaps: array expected";for(var t=0;t<e.attributeMaps.length;++t){var n=$root.GroupAttributeRet.AttributeMap.verify(e.attributeMaps[t]);if(n)return"attributeMaps."+n}}return null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeRet)return e;var t=new $root.GroupAttributeRet;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.attributeMaps){if(!Array.isArray(e.attributeMaps))throw TypeError(".GroupAttributeRet.attributeMaps: array expected");t.attributeMaps=[];for(var n=0;n<e.attributeMaps.length;++n){if("object"!==_typeof(e.attributeMaps[n]))throw TypeError(".GroupAttributeRet.attributeMaps: object expected");t.attributeMaps[n]=$root.GroupAttributeRet.AttributeMap.fromObject(e.attributeMaps[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attributeMaps=[]),t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.attributeMaps&&e.attributeMaps.length){n.attributeMaps=[];for(var i=0;i<e.attributeMaps.length;++i)n.attributeMaps[i]=$root.GroupAttributeRet.AttributeMap.toObject(e.attributeMaps[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.AttributeMap=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&e.hasOwnProperty("key")&&t.uint32(10).string(e.key),null!=e.value&&e.hasOwnProperty("value")&&t.uint32(18).string(e.value),null!=e.origin&&e.hasOwnProperty("origin")&&t.uint32(26).string(e.origin),null!=e.ms&&e.hasOwnProperty("ms")&&t.uint32(32).uint64(e.ms),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeRet.AttributeMap;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;case 3:r.origin=e.string();break;case 4:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!$util.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!$util.isString(e.value)?"value: string expected":null!=e.origin&&e.hasOwnProperty("origin")&&!$util.isString(e.origin)?"origin: string expected":null!=e.ms&&e.hasOwnProperty("ms")&&!($util.isInteger(e.ms)||e.ms&&$util.isInteger(e.ms.low)&&$util.isInteger(e.ms.high))?"ms: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeRet.AttributeMap)return e;var t=new $root.GroupAttributeRet.AttributeMap;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),null!=e.origin&&(t.origin=String(e.origin)),null!=e.ms&&($util.Long?(t.ms=$util.Long.fromValue(e.ms)).unsigned=!0:"string"==typeof e.ms?t.ms=parseInt(e.ms,10):"number"==typeof e.ms?t.ms=e.ms:"object"===_typeof(e.ms)&&(t.ms=new $util.LongBits(e.ms.low>>>0,e.ms.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.key="",n.value="",n.origin="",$util.Long){var r=new $util.Long(0,0,!0);n.ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.ms=t.longs===String?"0":0;return null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),null!=e.origin&&e.hasOwnProperty("origin")&&(n.origin=e.origin),null!=e.ms&&e.hasOwnProperty("ms")&&("number"==typeof e.ms?n.ms=t.longs===String?String(e.ms):e.ms:n.ms=t.longs===String?$util.Long.prototype.toString.call(e.ms):t.longs===Number?new $util.LongBits(e.ms.low>>>0,e.ms.high>>>0).toNumber(!0):e.ms),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),GroupAttributeSet=$root.GroupAttributeSet=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributeInfos=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(18).string(e.group),null!=e.broadcast&&e.hasOwnProperty("broadcast")&&t.uint32(24).bool(e.broadcast),null!=e.attributeInfos&&e.attributeInfos.length)for(var n=0;n<e.attributeInfos.length;++n)$root.GroupAttributeSet.AttributeInfo.encode(e.attributeInfos[n],t.uint32(34).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeSet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.broadcast=e.bool();break;case 4:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push($root.GroupAttributeSet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group))return"group: string expected";if(null!=e.broadcast&&e.hasOwnProperty("broadcast")&&"boolean"!=typeof e.broadcast)return"broadcast: boolean expected";if(null!=e.attributeInfos&&e.hasOwnProperty("attributeInfos")){if(!Array.isArray(e.attributeInfos))return"attributeInfos: array expected";for(var t=0;t<e.attributeInfos.length;++t){var n=$root.GroupAttributeSet.AttributeInfo.verify(e.attributeInfos[t]);if(n)return"attributeInfos."+n}}return null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeSet)return e;var t=new $root.GroupAttributeSet;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.group&&(t.group=String(e.group)),null!=e.broadcast&&(t.broadcast=Boolean(e.broadcast)),e.attributeInfos){if(!Array.isArray(e.attributeInfos))throw TypeError(".GroupAttributeSet.attributeInfos: array expected");t.attributeInfos=[];for(var n=0;n<e.attributeInfos.length;++n){if("object"!==_typeof(e.attributeInfos[n]))throw TypeError(".GroupAttributeSet.attributeInfos: object expected");t.attributeInfos[n]=$root.GroupAttributeSet.AttributeInfo.fromObject(e.attributeInfos[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attributeInfos=[]),t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.group="",n.broadcast=!1}if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),null!=e.broadcast&&e.hasOwnProperty("broadcast")&&(n.broadcast=e.broadcast),e.attributeInfos&&e.attributeInfos.length){n.attributeInfos=[];for(var i=0;i<e.attributeInfos.length;++i)n.attributeInfos[i]=$root.GroupAttributeSet.AttributeInfo.toObject(e.attributeInfos[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&e.hasOwnProperty("key")&&t.uint32(10).string(e.key),null!=e.value&&e.hasOwnProperty("value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeSet.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!$util.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!$util.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeSet.AttributeInfo)return e;var t=new $root.GroupAttributeSet.AttributeInfo;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),GroupAttributeMod=$root.GroupAttributeMod=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributeInfos=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(18).string(e.group),null!=e.broadcast&&e.hasOwnProperty("broadcast")&&t.uint32(24).bool(e.broadcast),null!=e.attributeInfos&&e.attributeInfos.length)for(var n=0;n<e.attributeInfos.length;++n)$root.GroupAttributeMod.AttributeInfo.encode(e.attributeInfos[n],t.uint32(34).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeMod;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.broadcast=e.bool();break;case 4:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push($root.GroupAttributeMod.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group))return"group: string expected";if(null!=e.broadcast&&e.hasOwnProperty("broadcast")&&"boolean"!=typeof e.broadcast)return"broadcast: boolean expected";if(null!=e.attributeInfos&&e.hasOwnProperty("attributeInfos")){if(!Array.isArray(e.attributeInfos))return"attributeInfos: array expected";for(var t=0;t<e.attributeInfos.length;++t){var n=$root.GroupAttributeMod.AttributeInfo.verify(e.attributeInfos[t]);if(n)return"attributeInfos."+n}}return null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeMod)return e;var t=new $root.GroupAttributeMod;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.group&&(t.group=String(e.group)),null!=e.broadcast&&(t.broadcast=Boolean(e.broadcast)),e.attributeInfos){if(!Array.isArray(e.attributeInfos))throw TypeError(".GroupAttributeMod.attributeInfos: array expected");t.attributeInfos=[];for(var n=0;n<e.attributeInfos.length;++n){if("object"!==_typeof(e.attributeInfos[n]))throw TypeError(".GroupAttributeMod.attributeInfos: object expected");t.attributeInfos[n]=$root.GroupAttributeMod.AttributeInfo.fromObject(e.attributeInfos[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attributeInfos=[]),t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.group="",n.broadcast=!1}if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),null!=e.broadcast&&e.hasOwnProperty("broadcast")&&(n.broadcast=e.broadcast),e.attributeInfos&&e.attributeInfos.length){n.attributeInfos=[];for(var i=0;i<e.attributeInfos.length;++i)n.attributeInfos[i]=$root.GroupAttributeMod.AttributeInfo.toObject(e.attributeInfos[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&e.hasOwnProperty("key")&&t.uint32(10).string(e.key),null!=e.value&&e.hasOwnProperty("value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeMod.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!$util.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!$util.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeMod.AttributeInfo)return e;var t=new $root.GroupAttributeMod.AttributeInfo;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",n.value=""),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),GroupAttributeDel=$root.GroupAttributeDel=function(){function e(e){if(this.attributes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributes=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(18).string(e.group),null!=e.broadcast&&e.hasOwnProperty("broadcast")&&t.uint32(24).bool(e.broadcast),null!=e.attributes&&e.attributes.length)for(var n=0;n<e.attributes.length;++n)t.uint32(34).string(e.attributes[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeDel;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.broadcast=e.bool();break;case 4:r.attributes&&r.attributes.length||(r.attributes=[]),r.attributes.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group))return"group: string expected";if(null!=e.broadcast&&e.hasOwnProperty("broadcast")&&"boolean"!=typeof e.broadcast)return"broadcast: boolean expected";if(null!=e.attributes&&e.hasOwnProperty("attributes")){if(!Array.isArray(e.attributes))return"attributes: array expected";for(var t=0;t<e.attributes.length;++t)if(!$util.isString(e.attributes[t]))return"attributes: string[] expected"}return null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeDel)return e;var t=new $root.GroupAttributeDel;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.group&&(t.group=String(e.group)),null!=e.broadcast&&(t.broadcast=Boolean(e.broadcast)),e.attributes){if(!Array.isArray(e.attributes))throw TypeError(".GroupAttributeDel.attributes: array expected");t.attributes=[];for(var n=0;n<e.attributes.length;++n)t.attributes[n]=String(e.attributes[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attributes=[]),t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.group="",n.broadcast=!1}if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),null!=e.broadcast&&e.hasOwnProperty("broadcast")&&(n.broadcast=e.broadcast),e.attributes&&e.attributes.length){n.attributes=[];for(var i=0;i<e.attributes.length;++i)n.attributes[i]=e.attributes[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupAttributeAlt=$root.GroupAttributeAlt=function(){function e(e){if(this.attributeMaps=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.attributeMaps=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(18).string(e.group),null!=e.instance&&e.hasOwnProperty("instance")&&t.uint32(24).uint64(e.instance),null!=e.attributeMaps&&e.attributeMaps.length)for(var n=0;n<e.attributeMaps.length;++n)$root.GroupAttributeAlt.AttributeMap.encode(e.attributeMaps[n],t.uint32(34).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeAlt;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.instance=e.uint64();break;case 4:r.attributeMaps&&r.attributeMaps.length||(r.attributeMaps=[]),r.attributeMaps.push($root.GroupAttributeAlt.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group))return"group: string expected";if(null!=e.instance&&e.hasOwnProperty("instance")&&!($util.isInteger(e.instance)||e.instance&&$util.isInteger(e.instance.low)&&$util.isInteger(e.instance.high)))return"instance: integer|Long expected";if(null!=e.attributeMaps&&e.hasOwnProperty("attributeMaps")){if(!Array.isArray(e.attributeMaps))return"attributeMaps: array expected";for(var t=0;t<e.attributeMaps.length;++t){var n=$root.GroupAttributeAlt.AttributeMap.verify(e.attributeMaps[t]);if(n)return"attributeMaps."+n}}return null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeAlt)return e;var t=new $root.GroupAttributeAlt;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.group&&(t.group=String(e.group)),null!=e.instance&&($util.Long?(t.instance=$util.Long.fromValue(e.instance)).unsigned=!0:"string"==typeof e.instance?t.instance=parseInt(e.instance,10):"number"==typeof e.instance?t.instance=e.instance:"object"===_typeof(e.instance)&&(t.instance=new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0))),e.attributeMaps){if(!Array.isArray(e.attributeMaps))throw TypeError(".GroupAttributeAlt.attributeMaps: array expected");t.attributeMaps=[];for(var n=0;n<e.attributeMaps.length;++n){if("object"!==_typeof(e.attributeMaps[n]))throw TypeError(".GroupAttributeAlt.attributeMaps: object expected");t.attributeMaps[n]=$root.GroupAttributeAlt.AttributeMap.fromObject(e.attributeMaps[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attributeMaps=[]),t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(n.group="",$util.Long){var i=new $util.Long(0,0,!0);n.instance=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.instance=t.longs===String?"0":0}if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),null!=e.instance&&e.hasOwnProperty("instance")&&("number"==typeof e.instance?n.instance=t.longs===String?String(e.instance):e.instance:n.instance=t.longs===String?$util.Long.prototype.toString.call(e.instance):t.longs===Number?new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0):e.instance),e.attributeMaps&&e.attributeMaps.length){n.attributeMaps=[];for(var o=0;o<e.attributeMaps.length;++o)n.attributeMaps[o]=$root.GroupAttributeAlt.AttributeMap.toObject(e.attributeMaps[o],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.AttributeMap=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&e.hasOwnProperty("key")&&t.uint32(10).string(e.key),null!=e.value&&e.hasOwnProperty("value")&&t.uint32(18).string(e.value),null!=e.origin&&e.hasOwnProperty("origin")&&t.uint32(26).string(e.origin),null!=e.ms&&e.hasOwnProperty("ms")&&t.uint32(32).uint64(e.ms),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeAlt.AttributeMap;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;case 3:r.origin=e.string();break;case 4:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.key&&e.hasOwnProperty("key")&&!$util.isString(e.key)?"key: string expected":null!=e.value&&e.hasOwnProperty("value")&&!$util.isString(e.value)?"value: string expected":null!=e.origin&&e.hasOwnProperty("origin")&&!$util.isString(e.origin)?"origin: string expected":null!=e.ms&&e.hasOwnProperty("ms")&&!($util.isInteger(e.ms)||e.ms&&$util.isInteger(e.ms.low)&&$util.isInteger(e.ms.high))?"ms: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeAlt.AttributeMap)return e;var t=new $root.GroupAttributeAlt.AttributeMap;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=String(e.value)),null!=e.origin&&(t.origin=String(e.origin)),null!=e.ms&&($util.Long?(t.ms=$util.Long.fromValue(e.ms)).unsigned=!0:"string"==typeof e.ms?t.ms=parseInt(e.ms,10):"number"==typeof e.ms?t.ms=e.ms:"object"===_typeof(e.ms)&&(t.ms=new $util.LongBits(e.ms.low>>>0,e.ms.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.key="",n.value="",n.origin="",$util.Long){var r=new $util.Long(0,0,!0);n.ms=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.ms=t.longs===String?"0":0;return null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),null!=e.origin&&e.hasOwnProperty("origin")&&(n.origin=e.origin),null!=e.ms&&e.hasOwnProperty("ms")&&("number"==typeof e.ms?n.ms=t.longs===String?String(e.ms):e.ms:n.ms=t.longs===String?$util.Long.prototype.toString.call(e.ms):t.longs===Number?new $util.LongBits(e.ms.low>>>0,e.ms.high>>>0).toNumber(!0):e.ms),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),GroupAttributeRsp=$root.GroupAttributeRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeRsp;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeRsp)return e;var t=new $root.GroupAttributeRsp;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupAttributeErr=$root.GroupAttributeErr=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).uint32(e.code),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeErr;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.code&&e.hasOwnProperty("code")&&!$util.isInteger(e.code)?"code: integer expected":null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeErr)return e;var t=new $root.GroupAttributeErr;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.code&&(t.code=e.code>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.code=0}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupAttributeKeysGet=$root.GroupAttributeKeysGet=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&e.hasOwnProperty("group")&&t.uint32(18).string(e.group),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeKeysGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.group&&e.hasOwnProperty("group")&&!$util.isString(e.group)?"group: string expected":null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeKeysGet)return e;var t=new $root.GroupAttributeKeysGet;return null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.group&&(t.group=String(e.group)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;n.group=""}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.group&&e.hasOwnProperty("group")&&(n.group=e.group),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),GroupAttributeKeysRet=$root.GroupAttributeKeysRet=function(){function e(e){if(this.keys=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.keys=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.keys&&e.keys.length)for(var n=0;n<e.keys.length;++n)t.uint32(18).string(e.keys[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeKeysRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.keys&&r.keys.length||(r.keys=[]),r.keys.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.keys&&e.hasOwnProperty("keys")){if(!Array.isArray(e.keys))return"keys: array expected";for(var t=0;t<e.keys.length;++t)if(!$util.isString(e.keys[t]))return"keys: string[] expected"}return null},e.fromObject=function(e){if(e instanceof $root.GroupAttributeKeysRet)return e;var t=new $root.GroupAttributeKeysRet;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.keys){if(!Array.isArray(e.keys))throw TypeError(".GroupAttributeKeysRet.keys: array expected");t.keys=[];for(var n=0;n<e.keys.length;++n)t.keys[n]=String(e.keys[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.keys=[]),t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.keys&&e.keys.length){n.keys=[];for(var i=0;i<e.keys.length;++i)n.keys[i]=e.keys[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),SubscribeUserStatus=$root.SubscribeUserStatus=function(){function e(e){if(this.users=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.users=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.users&&e.users.length)for(var n=0;n<e.users.length;++n)t.uint32(18).string(e.users[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.SubscribeUserStatus;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.users&&r.users.length||(r.users=[]),r.users.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.users&&e.hasOwnProperty("users")){if(!Array.isArray(e.users))return"users: array expected";for(var t=0;t<e.users.length;++t)if(!$util.isString(e.users[t]))return"users: string[] expected"}return null},e.fromObject=function(e){if(e instanceof $root.SubscribeUserStatus)return e;var t=new $root.SubscribeUserStatus;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.users){if(!Array.isArray(e.users))throw TypeError(".SubscribeUserStatus.users: array expected");t.users=[];for(var n=0;n<e.users.length;++n)t.users[n]=String(e.users[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.users=[]),t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.users&&e.users.length){n.users=[];for(var i=0;i<e.users.length;++i)n.users[i]=e.users[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UnsubscribeUserStatus=$root.UnsubscribeUserStatus=function(){function e(e){if(this.users=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.users=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.users&&e.users.length)for(var n=0;n<e.users.length;++n)t.uint32(18).string(e.users[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UnsubscribeUserStatus;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.users&&r.users.length||(r.users=[]),r.users.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.users&&e.hasOwnProperty("users")){if(!Array.isArray(e.users))return"users: array expected";for(var t=0;t<e.users.length;++t)if(!$util.isString(e.users[t]))return"users: string[] expected"}return null},e.fromObject=function(e){if(e instanceof $root.UnsubscribeUserStatus)return e;var t=new $root.UnsubscribeUserStatus;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.users){if(!Array.isArray(e.users))throw TypeError(".UnsubscribeUserStatus.users: array expected");t.users=[];for(var n=0;n<e.users.length;++n)t.users[n]=String(e.users[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.users=[]),t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.users&&e.users.length){n.users=[];for(var i=0;i<e.users.length;++i)n.users[i]=e.users[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserJoinNotice=$root.UserJoinNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.user="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.instance&&e.hasOwnProperty("instance")&&t.uint32(8).uint64(e.instance),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(16).uint64(e.seq),null!=e.user&&e.hasOwnProperty("user")&&t.uint32(26).string(e.user),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserJoinNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.instance=e.uint64();break;case 2:r.seq=e.uint64();break;case 3:r.user=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.instance&&e.hasOwnProperty("instance")&&!($util.isInteger(e.instance)||e.instance&&$util.isInteger(e.instance.low)&&$util.isInteger(e.instance.high))?"instance: integer|Long expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.user&&e.hasOwnProperty("user")&&!$util.isString(e.user)?"user: string expected":null},e.fromObject=function(e){if(e instanceof $root.UserJoinNotice)return e;var t=new $root.UserJoinNotice;return null!=e.instance&&($util.Long?(t.instance=$util.Long.fromValue(e.instance)).unsigned=!0:"string"==typeof e.instance?t.instance=parseInt(e.instance,10):"number"==typeof e.instance?t.instance=e.instance:"object"===_typeof(e.instance)&&(t.instance=new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0))),null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.user&&(t.user=String(e.user)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.instance=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.instance=t.longs===String?"0":0;if($util.Long){var i=new $util.Long(0,0,!0);n.seq=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.seq=t.longs===String?"0":0;n.user=""}return null!=e.instance&&e.hasOwnProperty("instance")&&("number"==typeof e.instance?n.instance=t.longs===String?String(e.instance):e.instance:n.instance=t.longs===String?$util.Long.prototype.toString.call(e.instance):t.longs===Number?new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0):e.instance),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.user&&e.hasOwnProperty("user")&&(n.user=e.user),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserQuitNotice=$root.UserQuitNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.user="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.instance&&e.hasOwnProperty("instance")&&t.uint32(8).uint64(e.instance),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(16).uint64(e.seq),null!=e.user&&e.hasOwnProperty("user")&&t.uint32(26).string(e.user),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserQuitNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.instance=e.uint64();break;case 2:r.seq=e.uint64();break;case 3:r.user=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.instance&&e.hasOwnProperty("instance")&&!($util.isInteger(e.instance)||e.instance&&$util.isInteger(e.instance.low)&&$util.isInteger(e.instance.high))?"instance: integer|Long expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.user&&e.hasOwnProperty("user")&&!$util.isString(e.user)?"user: string expected":null},e.fromObject=function(e){if(e instanceof $root.UserQuitNotice)return e;var t=new $root.UserQuitNotice;return null!=e.instance&&($util.Long?(t.instance=$util.Long.fromValue(e.instance)).unsigned=!0:"string"==typeof e.instance?t.instance=parseInt(e.instance,10):"number"==typeof e.instance?t.instance=e.instance:"object"===_typeof(e.instance)&&(t.instance=new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0))),null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.user&&(t.user=String(e.user)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.instance=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.instance=t.longs===String?"0":0;if($util.Long){var i=new $util.Long(0,0,!0);n.seq=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.seq=t.longs===String?"0":0;n.user=""}return null!=e.instance&&e.hasOwnProperty("instance")&&("number"==typeof e.instance?n.instance=t.longs===String?String(e.instance):e.instance:n.instance=t.longs===String?$util.Long.prototype.toString.call(e.instance):t.longs===Number?new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0):e.instance),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.user&&e.hasOwnProperty("user")&&(n.user=e.user),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),UserWaitNotice=$root.UserWaitNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.user="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.instance&&e.hasOwnProperty("instance")&&t.uint32(8).uint64(e.instance),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(16).uint64(e.seq),null!=e.user&&e.hasOwnProperty("user")&&t.uint32(26).string(e.user),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserWaitNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.instance=e.uint64();break;case 2:r.seq=e.uint64();break;case 3:r.user=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.instance&&e.hasOwnProperty("instance")&&!($util.isInteger(e.instance)||e.instance&&$util.isInteger(e.instance.low)&&$util.isInteger(e.instance.high))?"instance: integer|Long expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.user&&e.hasOwnProperty("user")&&!$util.isString(e.user)?"user: string expected":null},e.fromObject=function(e){if(e instanceof $root.UserWaitNotice)return e;var t=new $root.UserWaitNotice;return null!=e.instance&&($util.Long?(t.instance=$util.Long.fromValue(e.instance)).unsigned=!0:"string"==typeof e.instance?t.instance=parseInt(e.instance,10):"number"==typeof e.instance?t.instance=e.instance:"object"===_typeof(e.instance)&&(t.instance=new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0))),null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.user&&(t.user=String(e.user)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util.Long){var r=new $util.Long(0,0,!0);n.instance=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.instance=t.longs===String?"0":0;if($util.Long){var i=new $util.Long(0,0,!0);n.seq=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.seq=t.longs===String?"0":0;n.user=""}return null!=e.instance&&e.hasOwnProperty("instance")&&("number"==typeof e.instance?n.instance=t.longs===String?String(e.instance):e.instance:n.instance=t.longs===String?$util.Long.prototype.toString.call(e.instance):t.longs===Number?new $util.LongBits(e.instance.low>>>0,e.instance.high>>>0).toNumber(!0):e.instance),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.user&&e.hasOwnProperty("user")&&(n.user=e.user),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),SubscribeResponse=$root.SubscribeResponse=function(){function e(e){if(this.errors=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.errors=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(8).uint64(e.seq),null!=e.errors&&e.errors.length)for(var n=0;n<e.errors.length;++n)$root.SubscribeResponse.SubscribeErrorsType.encode(e.errors[n],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.SubscribeResponse;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.errors&&r.errors.length||(r.errors=[]),r.errors.push($root.SubscribeResponse.SubscribeErrorsType.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.seq&&e.hasOwnProperty("seq")&&!($util.isInteger(e.seq)||e.seq&&$util.isInteger(e.seq.low)&&$util.isInteger(e.seq.high)))return"seq: integer|Long expected";if(null!=e.errors&&e.hasOwnProperty("errors")){if(!Array.isArray(e.errors))return"errors: array expected";for(var t=0;t<e.errors.length;++t){var n=$root.SubscribeResponse.SubscribeErrorsType.verify(e.errors[t]);if(n)return"errors."+n}}return null},e.fromObject=function(e){if(e instanceof $root.SubscribeResponse)return e;var t=new $root.SubscribeResponse;if(null!=e.seq&&($util.Long?(t.seq=$util.Long.fromValue(e.seq)).unsigned=!0:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.errors){if(!Array.isArray(e.errors))throw TypeError(".SubscribeResponse.errors: array expected");t.errors=[];for(var n=0;n<e.errors.length;++n){if("object"!==_typeof(e.errors[n]))throw TypeError(".SubscribeResponse.errors: object expected");t.errors[n]=$root.SubscribeResponse.SubscribeErrorsType.fromObject(e.errors[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.errors=[]),t.defaults)if($util.Long){var r=new $util.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util.Long.prototype.toString.call(e.seq):t.longs===Number?new $util.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.errors&&e.errors.length){n.errors=[];for(var i=0;i<e.errors.length;++i)n.errors[i]=$root.SubscribeResponse.SubscribeErrorsType.toObject(e.errors[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.SubscribeErrorsType=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.account="",e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.account&&e.hasOwnProperty("account")&&t.uint32(10).string(e.account),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(16).uint32(e.code),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.SubscribeResponse.SubscribeErrorsType;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.account=e.string();break;case 2:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.account&&e.hasOwnProperty("account")&&!$util.isString(e.account)?"account: string expected":null!=e.code&&e.hasOwnProperty("code")&&!$util.isInteger(e.code)?"code: integer expected":null},e.fromObject=function(e){if(e instanceof $root.SubscribeResponse.SubscribeErrorsType)return e;var t=new $root.SubscribeResponse.SubscribeErrorsType;return null!=e.account&&(t.account=String(e.account)),null!=e.code&&(t.code=e.code>>>0),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.account="",n.code=0),null!=e.account&&e.hasOwnProperty("account")&&(n.account=e.account),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),ProtoPackets=Object.freeze({Wrapper:Wrapper$1,Ping:Ping,Pong:Pong,UserJoin:UserJoin,UserResp:UserResp,UserQuit:UserQuit,UserDrop:UserDrop,GroupEnter:GroupEnter,GroupLeave:GroupLeave,GroupReply:GroupReply,GroupLeaveNotice:GroupLeaveNotice,GroupEnterNotice:GroupEnterNotice,Message:Message,Ack:Ack,GroupAllUsersList:GroupAllUsersList,GroupAllUsersResult:GroupAllUsersResult,UserStatusList:UserStatusList,UserStatusResult:UserStatusResult,UserAttributeGet:UserAttributeGet,UserAttributeRet:UserAttributeRet,UserAttributeSet:UserAttributeSet,UserAttributeMod:UserAttributeMod,UserAttributeDel:UserAttributeDel,UserAttributeErr:UserAttributeErr,UserAttributeKeysGet:UserAttributeKeysGet,UserAttributeKeysRet:UserAttributeKeysRet,UserAttributeRsp:UserAttributeRsp,GroupStatusList:GroupStatusList,GroupStatusResult:GroupStatusResult,GroupCountNotice:GroupCountNotice,GroupAttributeGet:GroupAttributeGet,GroupAttributeRet:GroupAttributeRet,GroupAttributeSet:GroupAttributeSet,GroupAttributeMod:GroupAttributeMod,GroupAttributeDel:GroupAttributeDel,GroupAttributeAlt:GroupAttributeAlt,GroupAttributeRsp:GroupAttributeRsp,GroupAttributeErr:GroupAttributeErr,GroupAttributeKeysGet:GroupAttributeKeysGet,GroupAttributeKeysRet:GroupAttributeKeysRet,SubscribeUserStatus:SubscribeUserStatus,UnsubscribeUserStatus:UnsubscribeUserStatus,UserJoinNotice:UserJoinNotice,UserQuitNotice:UserQuitNotice,UserWaitNotice:UserWaitNotice,SubscribeResponse:SubscribeResponse,default:$root}),now=function(){return _root.Date.now()},now_1=now,NAN=NaN,reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber$1(e){if("number"==typeof e)return e;if(isSymbol_1(e))return NAN;if(isObject_1(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject_1(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(reTrim,"");var n=reIsBinary.test(e);return n||reIsOctal.test(e)?freeParseInt(e.slice(2),n?2:8):reIsBadHex.test(e)?NAN:+e}var toNumber_1=toNumber$1,FUNC_ERROR_TEXT$1="Expected a function",nativeMax$1=Math.max,nativeMin=Math.min;function debounce(e,t,n){var r,i,o,a,s,u,c=0,l=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$1);function f(t){var n=r,o=i;return r=i=void 0,c=t,a=e.apply(o,n)}function h(e){var n=e-u;return void 0===u||n>=t||n<0||d&&e-c>=o}function g(){var e=now_1();if(h(e))return m(e);s=setTimeout(g,function(e){var n=t-(e-u);return d?nativeMin(n,o-(e-c)):n}(e))}function m(e){return s=void 0,p&&r?f(e):(r=i=void 0,a)}function v(){var e=now_1(),n=h(e);if(r=arguments,i=this,u=e,n){if(void 0===s)return function(e){return c=e,s=setTimeout(g,t),l?f(e):a}(u);if(d)return clearTimeout(s),s=setTimeout(g,t),f(u)}return void 0===s&&(s=setTimeout(g,t)),a}return t=toNumber_1(t)||0,isObject_1(n)&&(l=!!n.leading,o=(d="maxWait"in n)?nativeMax$1(toNumber_1(n.maxWait)||0,t):o,p="trailing"in n?!!n.trailing:p),v.cancel=function(){void 0!==s&&clearTimeout(s),c=0,r=u=i=s=void 0},v.flush=function(){return void 0===s?a:m(now_1())},v}var debounce_1=debounce;_fixReWks("match",1,(function(e,t,n,r){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=r(n,e,this);if(t.done)return t.value;var i=_anObject(e),o=String(this);if(!i.global)return _regexpExecAbstract(i,o);var a=i.unicode;i.lastIndex=0;for(var s,u=[],c=0;null!==(s=_regexpExecAbstract(i,o));){var l=String(s[0]);u[c]=l,""===l&&(i.lastIndex=_advanceStringIndex(o,_toLength(i.lastIndex),a)),c++}return 0===c?null:u}]})),_export(_export.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=_toIobject(e),i=_objectGopd.f,o=_ownKeys(r),a={},s=0;o.length>s;)void 0!==(n=i(r,t=o[s++]))&&_createProperty(a,t,n);return a}});var isBufferBrowser=function(e){return e&&"object"===_typeof(e)&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8},inherits_browser=createCommonjsModule((function(e){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}})),util=createCommonjsModule((function(e,t){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},r=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var i=arguments,o=i.length,s=String(e).replace(r,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return e}})),u=i[n];n<o;u=i[++n])h(u)||!_(u)?s+=" "+u:s+=" "+a(u);return s},t.deprecate=function(e,n){if("undefined"!=typeof process&&!0===process.noDeprecation)return e;if("undefined"==typeof process)return function(){return t.deprecate(e,n).apply(this,arguments)};var r=!1;return function(){if(!r){if(process.throwDeprecation)throw new Error(n);process.traceDeprecation?console.trace(n):console.error(n),r=!0}return e.apply(this,arguments)}};var i,o={};function a(e,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),f(n)?r.showHidden=n:n&&t._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),c(r,e,r.depth)}function s(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function u(e,t){return e}function c(e,n,r){if(e.customInspect&&n&&E(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return m(i)||(i=c(e,i,r)),i}var o=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(m(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return g(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):h(t)?e.stylize("null","null"):void 0}(e,n);if(o)return o;var a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),S(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(n);if(0===a.length){if(E(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(y(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(b(n))return e.stylize(Date.prototype.toString.call(n),"date");if(S(n))return l(n)}var _,w="",I=!1,T=["{","}"];return p(n)&&(I=!0,T=["[","]"]),E(n)&&(w=" [Function"+(n.name?": "+n.name:"")+"]"),y(n)&&(w=" "+RegExp.prototype.toString.call(n)),b(n)&&(w=" "+Date.prototype.toUTCString.call(n)),S(n)&&(w=" "+l(n)),0!==a.length||I&&0!=n.length?r<0?y(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),_=I?function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)O(t,String(a))?o.push(d(e,t,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(d(e,t,n,r,i,!0))})),o}(e,n,r,s,a):a.map((function(t){return d(e,n,r,s,t,I)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(_,w,T)):T[0]+w+T[1]}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),O(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=h(n)?c(e,u.value,null):c(e,u.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),v(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function h(e){return null===e}function g(e){return"number"==typeof e}function m(e){return"string"==typeof e}function v(e){return void 0===e}function y(e){return _(e)&&"[object RegExp]"===w(e)}function _(e){return"object"===_typeof(e)&&null!==e}function b(e){return _(e)&&"[object Date]"===w(e)}function S(e){return _(e)&&("[object Error]"===w(e)||e instanceof Error)}function E(e){return"function"==typeof e}function w(e){return Object.prototype.toString.call(e)}function I(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(v(i)&&(i=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!o[e])if(new RegExp("\\b"+e+"\\b","i").test(i)){var n=process.pid;o[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else o[e]=function(){};return o[e]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=f,t.isNull=h,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=m,t.isSymbol=function(e){return"symbol"===_typeof(e)},t.isUndefined=v,t.isRegExp=y,t.isObject=_,t.isDate=b,t.isError=S,t.isFunction=E,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===_typeof(e)||void 0===e},t.isBuffer=isBufferBrowser;var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,n;console.log("%s - %s",(n=[I((e=new Date).getHours()),I(e.getMinutes()),I(e.getSeconds())].join(":"),[e.getDate(),T[e.getMonth()],n].join(" ")),t.format.apply(t,arguments))},t.inherits=inherits_browser,t._extend=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var x="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function R(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(x&&e[x]){var t;if("function"!=typeof(t=e[x]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,x,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),x&&Object.defineProperty(t,x,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=x,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);var r=t.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return r.apply(i,arguments)};e.apply(this,t).then((function(e){process.nextTick(o,null,e)}),(function(e){process.nextTick(R,e,o)}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,n(e)),t}})),util_1=util.format,util_2=util.deprecate,util_3=util.debuglog,util_4=util.inspect,util_5=util.isArray,util_6=util.isBoolean,util_7=util.isNull,util_8=util.isNullOrUndefined,util_9=util.isNumber,util_10=util.isString,util_11=util.isSymbol,util_12=util.isUndefined,util_13=util.isRegExp,util_14=util.isObject,util_15=util.isDate,util_16=util.isError,util_17=util.isFunction,util_18=util.isPrimitive,util_19=util.isBuffer,util_20=util.log,util_21=util.inherits,util_22=util._extend,util_23=util.promisify,util_24=util.callbackify;function asyncGeneratorStep$1(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator$1(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep$1(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep$1(o,r,i,a,s,"throw",e)}a(void 0)}))}}function _toConsumableArray$1(e){return _arrayWithoutHoles$1(e)||_iterableToArray$1(e)||_nonIterableSpread$1()}function _nonIterableSpread$1(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray$1(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles$1(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var UINT32_MAX=4294967295;function getRandomInt(e,t){var n=Math.ceil(e),r=Math.floor(t);return Math.floor(Math.random()*(r-n+1))+e}function getRandomUInt64(){var e=getRandomInt(0,UINT32_MAX),t=getRandomInt(1,UINT32_MAX);return new long_1(e,t,!0)}function getSid(e){return e.toString().padEnd(32,"0")}function assertNever(e,t){return new TypeError("Unexpected ".concat(e,": ").concat(t))}function calIpDistance(e,t){var n=e.split(".").map((function(e){return Number(e)})),r=t.split(".").map((function(e){return Number(e)}));return Math.sqrt(1e3*Math.pow(n[0]-r[0],2)+100*Math.pow(n[1]-r[1],2)+10*Math.pow(n[2]-r[2],2)+1*Math.pow(n[3]-r[3],2))}function longToStringIfNeeded(e){return e.lessThanOrEqual(Number.MAX_SAFE_INTEGER)?e.toNumber():e.toString()}var prefixSeqMap=new Map;function uniquePrefixedId(e,t){var n="".concat(e).concat(t||""),r=prefixSeqMap.get(n)||1;return prefixSeqMap.set(n,r+1),"".concat(e).concat(r)}var getUTCTimestamp=function(){var e=new Date;return"".concat(e.toISOString().split("T")[1].replace(/\..+/,""),".").concat(e.getMilliseconds())},getKeys=Object.keys,getEntries=Object.entries.bind(Object);function isLongNum(e){return"number"==typeof e||long_1.isLong(e)}var getName=function(e){return Object.keys(e)[0]},addPeriodIfNeeded=function(e){return"string"==typeof e?e.endsWith(".")?e:"".concat(e,"."):e};function genErrorMessage(e,t){return("number"==typeof e?"Error Code ".concat(e,". "):"string"==typeof e?"[".concat(e,"] "):"")+("string"==typeof t&&t?addPeriodIfNeeded(t):Array.isArray(t)&&"string"==typeof t[0]&&t[0]?addPeriodIfNeeded(util_1.apply(void 0,[t[0]].concat(_toConsumableArray$1(t.slice(1))))):"")}function delay$1(e){return _delay.apply(this,arguments)}function _delay(){return(_delay=_asyncToGenerator$1(regenerator.mark((function e(t){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){setTimeout((function(){e()}),t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function post(e){return _post.apply(this,arguments)}function _post(){return(_post=_asyncToGenerator$1(regenerator.mark((function e(t){var n,r,i,o,a,s,u,c;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.url,r=t.body,i=t.headers,o=t.timeout,a=void 0===o?1e4:o,s=t.signal,(u=new XMLHttpRequest).timeout=a,u.open("POST",n,!0),u.setRequestHeader("Content-type","application/json; charset=utf-8"),i)for(c in i)"withCredentials"===c?u.withCredentials=!0:u.setRequestHeader(c,i[c]);return e.abrupt("return",new Promise((function(e,t){s.onabort=function(){u.abort()},u.onload=function(){e(u.responseText)},u.onerror=function(e){t(e)},u.onabort=function(){t(new DOMException("The request aborted.","AbortError"))},u.send(JSON.stringify(r))})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var isProd=!0;function _typeof$1(e){return(_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$1(e,t){return!t||"object"!==_typeof$1(t)&&"function"!=typeof t?_assertThisInitialized$1(e):t}function _assertThisInitialized$1(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$1(e,t)}function _wrapNativeSuper$1(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper$1=function(e){if(null===e||!_isNativeFunction$1(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return _construct$1(e,arguments,_getPrototypeOf$1(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf$1(n,e)})(e)}function isNativeReflectConstruct$1(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _construct$1(e,t,n){return(_construct$1=isNativeReflectConstruct$1()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&_setPrototypeOf$1(i,n.prototype),i}).apply(null,arguments)}function _isNativeFunction$1(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf$1(e,t){return(_setPrototypeOf$1=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf$1(e){return(_getPrototypeOf$1=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var RtmBaseError=function(e){function t(e,n,r){var i;return _classCallCheck$1(this,t),(i=_possibleConstructorReturn$1(this,_getPrototypeOf$1(t).call(this,genErrorMessage(n,e)))).code=n,r&&console.error(r),i}return _inherits$1(t,_wrapNativeSuper$1(Error)),t}(),RtmInternalError=function(e){function t(e,n){var r;return _classCallCheck$1(this,t),(r=_possibleConstructorReturn$1(this,_getPrototypeOf$1(t).call(this,genErrorMessage(n,e)))).code=n,r.name="RtmInternalError",r}return _inherits$1(t,_wrapNativeSuper$1(Error)),t}(),genError=function(){return function(e){function t(e){_classCallCheck$1(this,t);var n=Object.keys(e);return _possibleConstructorReturn$1(this,_getPrototypeOf$1(t).call(this,e[n[0]],n[0]))}return _inherits$1(t,RtmInternalError),t}()},CommonError=genError(),RtmTimeoutError=function(e){function t(e,n,r){var i;return _classCallCheck$1(this,t),(i=_possibleConstructorReturn$1(this,_getPrototypeOf$1(t).call(this,genErrorMessage(n,e)))).code=n,i.name="RtmTimeoutError",r&&console.error(r),i}return _inherits$1(t,RtmBaseError),t}(),RtmInvalidArgumentError=function(e){function t(){var e,n;_classCallCheck$1(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=_possibleConstructorReturn$1(this,(e=_getPrototypeOf$1(t)).call.apply(e,[this].concat(i)))).name="RtmInvalidArgumentError",n}return _inherits$1(t,RtmBaseError),t}(),RtmInvalidStatusError=function(e){function t(){var e,n;_classCallCheck$1(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=_possibleConstructorReturn$1(this,(e=_getPrototypeOf$1(t)).call.apply(e,[this].concat(i)))).name="RtmInvalidStatusError",n}return _inherits$1(t,RtmBaseError),t}(),RtmLimitExceededError=function(e){function t(){var e,n;_classCallCheck$1(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=_possibleConstructorReturn$1(this,(e=_getPrototypeOf$1(t)).call.apply(e,[this].concat(i)))).name="RtmLimitExceededError",n}return _inherits$1(t,RtmBaseError),t}(),RtmInvokeTooOftenError=function(e){function t(){var e,n;_classCallCheck$1(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=_possibleConstructorReturn$1(this,(e=_getPrototypeOf$1(t)).call.apply(e,[this].concat(i)))).name="RtmInvokeTooOftenError",n}return _inherits$1(t,RtmBaseError),t}(),RtmUnavailableError=function(e){function t(){var e,n;_classCallCheck$1(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=_possibleConstructorReturn$1(this,(e=_getPrototypeOf$1(t)).call.apply(e,[this].concat(i)))).name="RtmUnavailableError",n.serverCode=void 0,n}return _inherits$1(t,RtmBaseError),t}(),RtmUnauthenticatedError=function(e){function t(){var e,n;_classCallCheck$1(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=_possibleConstructorReturn$1(this,(e=_getPrototypeOf$1(t)).call.apply(e,[this].concat(i)))).name="RtmUnauthenticatedError",n.serverCode=void 0,n}return _inherits$1(t,RtmBaseError),t}(),RtmUnknownError=function(e){function t(){var e,n;_classCallCheck$1(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=_possibleConstructorReturn$1(this,(e=_getPrototypeOf$1(t)).call.apply(e,[this].concat(i)))).name="RtmUnknownError",n}return _inherits$1(t,RtmBaseError),t}(),isTimeout=function(e){return e instanceof RtmTimeoutError||e instanceof TimeoutError},isRtmError=function(e){return e instanceof RtmBaseError||e instanceof RtmTimeoutError},invalidArgumentMessage="The %s in the arguments is invalid",genTimeoutMessage=function(e,t,n){return['Executing "%s.%s" timed out after %ds',e,t,n/1e3]},merge$1=_createAssigner((function(e,t,n){_baseMerge(e,t,n)})),merge_1=merge$1,s=1e3,m=60*s,h=60*m,d=24*h,w=7*d,y=365.25*d,ms=function(e,t){t=t||{};var n=_typeof(e);if("string"===n&&e.length>0)return parse(e);if("number"===n&&!1===isNaN(e))return t.long?fmtLong(e):fmtShort(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function parse(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"weeks":case"week":case"w":return n*w;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function fmtShort(e){var t=Math.abs(e);return t>=d?Math.round(e/d)+"d":t>=h?Math.round(e/h)+"h":t>=m?Math.round(e/m)+"m":t>=s?Math.round(e/s)+"s":e+"ms"}function fmtLong(e){var t=Math.abs(e);return t>=d?plural(e,t,d,"day"):t>=h?plural(e,t,h,"hour"):t>=m?plural(e,t,m,"minute"):t>=s?plural(e,t,s,"second"):e+" ms"}function plural(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}function setup(e){function t(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){var o;function a(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(a.enabled){var i=a,s=Number(new Date),u=s-(o||s);i.diff=u,i.prev=o,i.curr=s,o=s,t[0]=n.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var c=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return e;c++;var o=n.formatters[r];if("function"==typeof o){var a=t[c];e=o.call(i,a),t.splice(c,1),c--}return e})),n.formatArgs.call(i,t),(i.log||n.log).apply(i,t)}}return a.namespace=e,a.enabled=n.enabled(e),a.useColors=n.useColors(),a.color=t(e),a.destroy=r,a.extend=i,"function"==typeof n.init&&n.init(a),n.instances.push(a),a}function r(){var e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}function i(e,t){var r=n(this.namespace+(void 0===t?":":t)+e);return r.log=this.log,r}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){var e=[].concat(_toConsumableArray(n.names.map(o)),_toConsumableArray(n.skips.map(o).map((function(e){return"-"+e})))).join(",");return n.enable(""),e},n.enable=function(e){var t;n.save(e),n.names=[],n.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(t=0;t<i;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){var o=n.instances[t];o.enabled=n.enabled(o.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=ms,Object.keys(e).forEach((function(t){n[t]=e[t]})),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=t,n.enable(n.load()),n}var common=setup,browser=createCommonjsModule((function(e,t){t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":_typeof(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=common(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}})),browser_1=browser.log,browser_2=browser.formatArgs,browser_3=browser.save,browser_4=browser.load,browser_5=browser.useColors,browser_6=browser.storage,browser_7=browser.colors,key$2="__global_unique_id__",gud=function(){return commonjsGlobal[key$2]=(commonjsGlobal[key$2]||0)+1},$values=_objectToArray(!1);_export(_export.S,"Object",{values:function(e){return $values(e)}}),_export(_export.S,"Reflect",{has:function(e,t){return t in e}});var umd=createCommonjsModule((function(e,t){!function(e){var t=function(e){return"undefined"!=typeof self&&self&&e in self?self[e]:"undefined"!=typeof window&&window&&e in window?window[e]:void 0!==commonjsGlobal&&commonjsGlobal&&e in commonjsGlobal?commonjsGlobal[e]:"undefined"!=typeof globalThis&&globalThis?globalThis[e]:void 0},n=t("document"),r=t("Headers"),i=t("Response"),o=t("ReadableStream"),a=t("fetch"),s=t("AbortController"),u=t("FormData"),c=function(e){return null!==e&&"object"===_typeof(e)},l="function"==typeof s,d="function"==typeof o,p="function"==typeof u,f=function e(){for(var t={},n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var o=0,a=r;o<a.length;o++){var s=a[o];if(Array.isArray(s))Array.isArray(t)||(t=[]),t=[].concat(_toConsumableArray(t),_toConsumableArray(s));else if(c(s))for(var u=0,l=Object.entries(s);u<l.length;u++){var d=_slicedToArray(l[u],2),p=d[0],f=d[1];c(f)&&Reflect.has(t,p)&&(f=e(t[p],f)),t=_objectSpread2({},t,_defineProperty({},p,f))}}return t},h=["get","post","put","patch","head","delete"],g={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},m=new Set(["get","put","head","delete","options","trace"]),v=new Set([408,413,429,500,502,503,504]),y=new Set([413,429,503]),_=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e.statusText))).name="HTTPError",n.response=e,n}return _inherits(t,e),t}(_wrapNativeSuper(Error)),b=function(e){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,"Request timed out"))).name="TimeoutError",e}return _inherits(t,e),t}(_wrapNativeSuper(Error)),S=function(e){return new Promise((function(t,n){e>2147483647?n(new RangeError("The `timeout` option cannot be greater than 2147483647")):setTimeout(t,e)}))},E=function(e,t,n){return new Promise((function(r,i){e.then(r).catch(i),S(t).then((function(){l&&n.abort(),i(new b)})).catch(i)}))},w=function(e){return h.includes(e)?e.toUpperCase():e},I=function(){function e(t,o){var a=this,c=o.timeout,h=void 0===c?1e4:c,v=o.hooks,y=o.throwHttpErrors,b=void 0===y||y,E=o.searchParams,I=o.json,T=_objectWithoutProperties(o,["timeout","hooks","throwHttpErrors","searchParams","json"]);if(_classCallCheck(this,e),this._retryCount=0,this._options=_objectSpread2({method:"get",credentials:"same-origin",retry:2},T),l&&(this.abortController=new s,this._options.signal&&this._options.signal.addEventListener("abort",(function(){a.abortController.abort()})),this._options.signal=this.abortController.signal),this._options.method=w(this._options.method),this._options.prefixUrl=String(this._options.prefixUrl||""),this._input=String(t||""),this._options.prefixUrl&&this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");if(this._options.prefixUrl&&!this._options.prefixUrl.endsWith("/")&&(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input,E){var O=new URL(this._input,n&&n.baseURI);if("string"==typeof E||URLSearchParams&&E instanceof URLSearchParams)O.search=E;else{if(!Object.values(E).every((function(e){return"number"==typeof e||"string"==typeof e})))throw new Error("The `searchParams` option must be either a string, `URLSearchParams` instance or an object with string and number values");O.search=new URLSearchParams(E).toString()}this._input=O.toString()}this._timeout=h,this._hooks=f({beforeRequest:[],afterResponse:[]},v),this._throwHttpErrors=b;var x=new r(this._options.headers||{});if((p&&this._options.body instanceof u||this._options.body instanceof URLSearchParams)&&x.has("content-type"))throw new Error("The `content-type` header cannot be used with a ".concat(this._options.body.constructor.name," body. It will be set automatically."));if(I){if(this._options.body)throw new Error("The `json` option cannot be used with the `body` option");x.set("content-type","application/json"),this._options.body=JSON.stringify(I)}this._options.headers=x;for(var R,A=(R=_asyncToGenerator(regenerator.mark((function e(){var t,n,r,o,s,u,c;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(1);case 2:return e.next=4,a._fetch();case 4:t=e.sent,n=a._hooks.afterResponse,r=Array.isArray(n),o=0,n=r?n:n[Symbol.iterator]();case 6:if(!r){e.next=12;break}if(!(o>=n.length)){e.next=9;break}return e.abrupt("break",23);case 9:s=n[o++],e.next=16;break;case 12:if(!(o=n.next()).done){e.next=15;break}return e.abrupt("break",23);case 15:s=o.value;case 16:return u=s,e.next=19,u(t.clone());case 19:(c=e.sent)instanceof i&&(t=c);case 21:e.next=6;break;case 23:if(t.ok||!a._throwHttpErrors){e.next=25;break}throw new _(t);case 25:if(!a._options.onDownloadProgress){e.next=31;break}if("function"==typeof a._options.onDownloadProgress){e.next=28;break}throw new TypeError("The `onDownloadProgress` option must be a function");case 28:if(d){e.next=30;break}throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");case 30:return e.abrupt("return",a._stream(t.clone(),a._options.onDownloadProgress));case 31:return e.abrupt("return",t);case 32:case"end":return e.stop()}}),e)}))),function(){return R.apply(this,arguments)}),L=m.has(this._options.method.toLowerCase())?this._retry(A):A(),C=function(){var e=_slicedToArray(M[N],2),t=e[0],n=e[1];L[t]=_asyncToGenerator(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.set("accept",n),e.next=3,L;case 3:return e.t0=t,e.abrupt("return",e.sent.clone()[e.t0]());case 5:case"end":return e.stop()}}),e)})))},N=0,M=Object.entries(g);N<M.length;N++)C();return L}return _createClass(e,[{key:"_calculateRetryDelay",value:function(e){if(this._retryCount++,this._retryCount<this._options.retry&&!(e instanceof b)){if(e instanceof _){if(!v.has(e.response.status))return 0;var t=e.response.headers.get("Retry-After");if(t&&y.has(e.response.status)){var n=Number(t);return Number.isNaN(n)?n=Date.parse(t)-Date.now():n*=1e3,n}if(413===e.response.status)return 0}return.3*Math.pow(2,this._retryCount-1)*1e3}return 0}},{key:"_retry",value:(c=_asyncToGenerator(regenerator.mark((function e(t){var n;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:return e.abrupt("return",e.sent);case 6:if(e.prev=6,e.t0=e.catch(0),!(0!==(n=this._calculateRetryDelay(e.t0))&&this._retryCount>0)){e.next=13;break}return e.next=12,S(n);case 12:return e.abrupt("return",this._retry(t));case 13:if(!this._throwHttpErrors){e.next=15;break}throw e.t0;case 15:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(e){return c.apply(this,arguments)})},{key:"_fetch",value:(t=_asyncToGenerator(regenerator.mark((function e(){var t,n,r,i,o;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._hooks.beforeRequest,n=Array.isArray(t),r=0,t=n?t:t[Symbol.iterator]();case 1:if(!n){e.next=7;break}if(!(r>=t.length)){e.next=4;break}return e.abrupt("break",16);case 4:i=t[r++],e.next=11;break;case 7:if(!(r=t.next()).done){e.next=10;break}return e.abrupt("break",16);case 10:i=r.value;case 11:return o=i,e.next=14,o(this._options);case 14:e.next=1;break;case 16:if(!1!==this._timeout){e.next=18;break}return e.abrupt("return",a(this._input,this._options));case 18:return e.abrupt("return",E(a(this._input,this._options),this._timeout,this.abortController));case 19:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_stream",value:function(e,t){var n=Number(e.headers.get("content-length"))||0,r=0;return new i(new o({start:function(i){var o=e.body.getReader();function a(){return s.apply(this,arguments)}function s(){return(s=_asyncToGenerator(regenerator.mark((function e(){var s,u,c;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.read();case 2:if(s=e.sent,u=s.done,c=s.value,!u){e.next=8;break}return i.close(),e.abrupt("return");case 8:t&&(r+=c.byteLength,t({percent:0===n?0:r/n,transferredBytes:r,totalBytes:n},c)),i.enqueue(c),a();case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t&&t({percent:0,transferredBytes:0,totalBytes:n},new Uint8Array),a()}}))}}]),e;var t,c}(),T=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r];if((!c(o)||Array.isArray(o))&&void 0!==o)throw new TypeError("The `options` argument must be an object")}return f.apply(void 0,[{}].concat(t))},O=function e(t){for(var n=function(e,n){return new I(e,T(t,n))},r=function(){var e=o[i];n[e]=function(n,r){return new I(n,T(t,r,{method:e}))}},i=0,o=h;i<o.length;i++)r();return n.create=function(t){return e(T(t))},n.extend=function(n){return e(T(t,n))},n}();e.HTTPError=_,e.TimeoutError=b,e.default=O,Object.defineProperty(e,"__esModule",{value:!0})}(t)})),ky=unwrapExports(umd),hasProp=Object.prototype.hasOwnProperty;function throwsMessage(e){return"[Throws: "+(e?e.message:"?")+"]"}function safeGetValueFromPropertyOnObject(e,t){if(hasProp.call(e,t))try{return e[t]}catch(e){return throwsMessage(e)}return e[t]}function ensureProperties(e){var t=[];return function e(n){if(null===n||"object"!==_typeof(n))return n;if(-1!==t.indexOf(n))return"[Circular]";if(t.push(n),"function"==typeof n.toJSON)try{var r=e(n.toJSON());return t.pop(),r}catch(e){return throwsMessage(e)}if(Array.isArray(n)){var i=n.map(e);return t.pop(),i}var o=Object.keys(n).reduce((function(t,r){return t[r]=e(safeGetValueFromPropertyOnObject(n,r)),t}),{});return t.pop(),o}(e)}var safeJsonStringify=function(e,t,n){return JSON.stringify(ensureProperties(e),t,n)},ensureProperties_1=ensureProperties;safeJsonStringify.ensureProperties=ensureProperties_1;var AP_CONCURRENT_REQ_NUM=2,APP_ID_LENGTH=32,AP_REQUEST_TIMEOUT=1e4,SOCKET_KEEPALIVE_TIMEOUT=4500,KEEPALIVE_INTERVAL=1e3,SOCKET_RETRY_INTERVAL=1500,CLIENT_LOGIN_TIMEOUT=8e3,LOGIN_RESP_TIMEOUT=5e3,MESSAGE_MIN_COMPRESSION_LEN=128,MESSAGE_SEND_TIMEOUT=1e4,COMMON_REQUEST_TIMEOUT=1e4,DIALOGUE_EXPIRE_TIMEOUT=1e4,LRU_MAX_ITEMS=1e4,MESSAGE_RETRY_TIMEOUT=6e3,LOGOUT_SOCKET_CLOSE_TIMEOUT=5e3,LOGIN_QPS_LIMIT=2,MESSAGE_TEXT_MAX_BYTES=32768,ONLINE_MESSAGE_DEDUP_DELAY=750,OFFLINE_MESSAGE_DEDUP_DELAY=1500,MSG_DEDUP_MAX_LEN=200,LOG_UPLOAD_MAX_ITEMS=40,MAX_JOINED_CHANNELS=20,INVITATION_EXPIRE_TIMEOUT=6e4,INVITATION_EXTRA_MAX_BYTES=8192,REMOTE_INVITATION_WAIT_ACCEPT_ACK_TIMEOUT=5e3,REMOTE_INVITATION_ACCEPT_RESEND_INTERVAL=1e3,LOCAL_INVITATION_ACK_TIMEOUT=3e4,LOCAL_INVITATION_RESEND_INTERVAL=2e3,MEMBER_COUNT_UPDATED_EVENT_INTERVAL=1e3,CHANNEL_ATTRIBUTES_CACHE_MAX_LENGTH=1e4;function asyncGeneratorStep$2(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator$2(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep$2(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep$2(o,r,i,a,s,"throw",e)}a(void 0)}))}}function _classCallCheck$2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$1(e,t,n){return t&&_defineProperties$1(e.prototype,t),n&&_defineProperties$1(e,n),e}var uploadLog=browser("RTM:DEBUG"),UploadState;uploadLog.enabled=!isProd,function(e){e[e.Uploading=0]="Uploading",e[e.Free=1]="Free"}(UploadState||(UploadState={}));var LogUploader=function(){function e(t){_classCallCheck$2(this,e),this.uploadRequest=void 0,this.uploadState=void 0,this.uploadResendCount=void 0,this.LogCache=void 0,this.LogsToPost=void 0,this.processId=void 0,this.sdkVersion=void 0,this.logId=void 0,this.processId=t.processId,this.sdkVersion=t.sdkVersion,this.uploadRequest=t.uploadRequest,this.uploadState=UploadState.Free,this.uploadResendCount=0,this.LogCache=[],this.LogsToPost=[],this.logId=0}return _createClass$1(e,[{key:"upload",value:function(e){this.LogCache.push(e),this.uploadState===UploadState.Free&&(this.LogsToPost=this.LogCache.length<LOG_UPLOAD_MAX_ITEMS?this.LogCache.splice(0,this.LogCache.length):this.LogCache.splice(0,LOG_UPLOAD_MAX_ITEMS),this.postLog(this.LogsToPost))}},{key:"postLog",value:function(e){var t=this;this.uploadState=UploadState.Uploading,setTimeout(_asyncToGenerator$2(regenerator.mark((function n(){var r,i;return regenerator.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={sdk_version:t.sdkVersion,process_id:t.processId,payload:JSON.stringify(e)},n.prev=1,n.next=4,t.uploadRequest(r);case 4:n.next=12;break;case 6:return n.prev=6,n.t0=n.catch(1),console.error(n.t0),i=t.uploadResendCount++<2?200:1e4,setTimeout((function(){return t.postLog(t.LogsToPost)}),i),n.abrupt("return");case 12:if(uploadLog('The logs uploaded for "process-'.concat(processId,'"')),0!==t.LogCache.length){n.next=16;break}return t.uploadState=UploadState.Free,n.abrupt("return");case 16:t.uploadResendCount=0,t.LogsToPost=t.LogCache.length<LOG_UPLOAD_MAX_ITEMS?t.LogCache.splice(0,t.LogCache.length):t.LogCache.splice(0,LOG_UPLOAD_MAX_ITEMS),t.postLog(t.LogsToPost);case 19:case"end":return n.stop()}}),n,null,[[1,6]])}))),3e3)}}]),e}();function _classCallCheck$3(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$2(e,t){return!t||"object"!==_typeof$2(t)&&"function"!=typeof t?_assertThisInitialized$2(e):t}function _getPrototypeOf$2(e){return(_getPrototypeOf$2=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _assertThisInitialized$2(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits$2(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$2(e,t)}function _setPrototypeOf$2(e,t){return(_setPrototypeOf$2=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _toConsumableArray$2(e){return _arrayWithoutHoles$2(e)||_iterableToArray$2(e)||_nonIterableSpread$2()}function _nonIterableSpread$2(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray$2(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles$2(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _typeof$2(e){return(_typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep$3(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator$3(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep$3(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep$3(o,r,i,a,s,"throw",e)}a(void 0)}))}}var LOG_SERVICE_MAIN_DOMAIN="logservice-rtm.agora.io",LOG_SERVICE_BACKUP_DOMAIN="logservice.agora.io",uploadRequest=function(){var e=_asyncToGenerator$3(regenerator.mark((function e(t){var n,r,i;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return n={mode:"cors",cache:"no-cache",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),retry:1,timeout:1e4},e.prev=3,r="https://".concat(LOG_SERVICE_MAIN_DOMAIN,"/upload/v1"),e.next=7,ky.post(r,n);case 7:e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(3),i="https://".concat(LOG_SERVICE_BACKUP_DOMAIN,"/upload/v1"),e.next=14,ky.post(i,n);case 14:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),logUploader=new LogUploader({processId:"process-".concat(processId),sdkVersion:"Agora_RTM_SDK_for_Web_".concat(BUILD),uploadRequest:uploadRequest}),blacklistedKeywords=["text","payload","rawMessage"],filterLogObject=function(e){return omit_1(e,blacklistedKeywords)},formatLogTextAndParameters=function(e,t){if(e instanceof Error)return e.message;if("string"!=typeof e)return JSON.stringify(filterLogObject(e));var n=t.map((function(e){if(e instanceof Error)return e.message;var t=function(e){return"object"===_typeof$2(e)?isPlainObject$1(e)?filterLogObject(e):e.constructor&&e.constructor.name:e};return"object"===_typeof$2(e)?safeJsonStringify(Array.isArray(e)?e.map(t):t(e)):e}));return util_1.apply(void 0,[e.replace(/%[oO%]/g,(function(e){return"%%"===e?"%":"%o"===e||"%O"===e?"%s":e}))].concat(_toConsumableArray$2(n)))},logItemId=1,logAndUploadGenerator=function(e,t){var n=browser(e);n.useColors=!1;var r=function r(i){for(var o=arguments.length,a=new Array(o>1?o-1:0),s=1;s<o;s++)a[s-1]=arguments[s];var u,c=addPeriodIfNeeded(i);t.logFilter.track=!0,u=formatLogTextAndParameters(c,a),t.enableLogUpload&&logUploader.upload({log_item_id:"".concat(logItemId++),log_level:e,payload_str:"[".concat(getUTCTimestamp(),"] ").concat(e," - ").concat(void 0===u?formatLogTextAndParameters(i,a):u)}),merge_1(n,r);var l=function(){return void 0===u?n.apply(void 0,[c].concat(a)):n(u)};switch(e){case"RTM:INFO":t.logFilter.info&&l();break;case"RTM:WARN":t.logFilter.warn&&l();break;case"RTM:ERROR":t.logFilter.error&&l();break;case"RTM:TRACK":t.logFilter.track&&l();break;case"RTM:MSG:RECV":case"RTM:MSG:SEND":case"RTM:DEBUG":t.logFilter.debug&&l()}};return merge_1(r,n),r},loggerId,prefixer=function(e){return function(t){var n=1===loggerId||void 0===e?"":"Ins#".concat(e," ");return"".concat(n).concat(t)}},loggerGenerator=function(e,t,n){var r=prefixer(loggerId),i=logAndUploadGenerator("RTM:".concat(t),n);return i.enabled=!0,i.log=function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return e.apply(void 0,[r(t)].concat(i))},i},createEventBase=function(){return function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(_classCallCheck$3(this,t),(r=_possibleConstructorReturn$2(this,_getPrototypeOf$2(t).call(this))).logger=e,r.name=n,r.logError=void 0,r.genTracker=void 0,r.info=void 0,r.warn=void 0,r.log=void 0,r.genLogger=void 0,r.loggerId=void 0,r.loggerId=e.loggerId,r.info=e.info,r.warn=e.warn,r.logError=e.logError,r.genLogger=e.genLogger,r.genTracker=e.genTracker,r.log=e.genLogger("RTM:DEBUG","<".concat(n,"> ")),i){var o=r.emit.bind(_assertThisInitialized$2(r));r.emit=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var a=t[0],s=t.slice(1);r.genTracker("Event").apply(void 0,["%s: ".concat(s.length>0?"%s emitted with args: ".concat(s.map((function(){return"%o"}))):"%s emitted"),n,a].concat(_toConsumableArray$2(s)));try{o.apply(void 0,t)}catch(e){r.logError("Caught in the callback function of the event %s",a,e)}}}return r}return _inherits$2(t,events),t}()};function initLoggerId(){return loggerId=gud()}var genInfoLogger=function(e){return loggerGenerator(console.log,"INFO",e)},genWarnLogger=function(e){return loggerGenerator(console.warn,"WARN",e)},genErrorLogger=function(e){return loggerGenerator(console.error,"ERROR",e)},debugLoggerGenerator=function(e,t){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=logAndUploadGenerator(n,t),o=prefixer(e),a=console.debug;return i.log=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.apply(void 0,[o(e)].concat(n))},i.enabled=!0,function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i.apply(void 0,[r+e].concat(n))}}},trackLoggerGenerator=function(e,t){return function(n){return debugLoggerGenerator(e,t)("RTM:TRACK","[".concat(n,"] "))}};function logged(e,t,n){var r=n;void 0===r&&(r=Object.getOwnPropertyDescriptor(e,t));var i=r.value;return r.value=function(){for(var e=this,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];this.genTracker("Invoke").apply(void 0,["%s: ".concat(r.length>0?"%s with args: ".concat(r.map((function(){return"%o"}))):"%s"),this.name,t].concat(r));var a=i.apply(this,r),s=Date.now();return _asyncToGenerator$3(regenerator.mark((function n(){var r;return regenerator.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,a;case 3:r=n.sent,n.next=10;break;case 6:return n.prev=6,n.t0=n.catch(0),e.logError(n.t0),n.abrupt("return");case 10:r!==a&&e.genTracker("Resolve")("%s resolves after %dms",t,Date.now()-s),void 0!==r&&e.genTracker("Result")("%s result is %o",t,r);case 12:case"end":return n.stop()}}),n,null,[[0,6]])})))(),a},r}function _objectWithoutProperties$1(e,t){if(null==e)return{};var n,r,i=_objectWithoutPropertiesLoose$1(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$1(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}var URI=$root.URI,Wrapper$2=Wrapper$1,PacketsAndURI=_objectWithoutProperties$1(ProtoPackets,["Wrapper"]),Packets=omit_1(PacketsAndURI,"URI"),nameToUri=function(e){var t="".concat(e,"Uri"),n=URI[t];if("number"!=typeof n||0===n)throw new TypeError("Got Unknown URI Name");return n};function uriToPacketName(e){return URI[e].slice(0,-3)}function getWrappedByName(e,t){var n=nameToUri(e),r=Packets[e],i=r.verify(t);if(null!==i)throw new TypeError(i);var o=new r(t),a=r.encode(o).finish();return new Wrapper$2({uri:n,data:a})}var nativeFloor=Math.floor,nativeRandom=Math.random;function baseRandom(e,t){return e+nativeFloor(nativeRandom()*(t-e+1))}var _baseRandom=baseRandom;function shuffleSelf(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=_baseRandom(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}var _shuffleSelf=shuffleSelf;function arrayShuffle(e){return _shuffleSelf(_copyArray(e))}var _arrayShuffle=arrayShuffle;function baseValues(e,t){return _arrayMap(t,(function(t){return e[t]}))}var _baseValues=baseValues;function values(e){return null==e?[]:_baseValues(e,keys_1(e))}var values_1=values;function baseShuffle(e){return _shuffleSelf(values_1(e))}var _baseShuffle=baseShuffle;function shuffle(e){return(isArray_1(e)?_arrayShuffle:_baseShuffle)(e)}var shuffle_1=shuffle;function _toConsumableArray$3(e){return _arrayWithoutHoles$3(e)||_iterableToArray$3(e)||_nonIterableSpread$3()}function _nonIterableSpread$3(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray$3(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles$3(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}var AP_DOMAINS_CN=["ap-web-1.agoraio.cn","ap-web-2.agoraio.cn","ap-web-3.agoraio.cn","ap-web-4.agoraio.cn"],AP_DOMAINS_IO=["ap-web-1.agora.io","ap-web-2.agora.io","ap-web-3.agora.io","ap-web-4.agora.io"],EDGE_ENV_PORT={0:9591,1:9593},getUrl=function(e){return"https://".concat(e,"/api/v1")};function getEdgeDomain(e,t){var n=t?"agoraio.cn":"agora.io";return"".concat(e.split(".").join("-"),".edge.").concat(n)}var cnUrl$=of.apply(void 0,_toConsumableArray$3(shuffle_1(AP_DOMAINS_CN.map(getUrl)))),ioUrl$=of.apply(void 0,_toConsumableArray$3(shuffle_1(AP_DOMAINS_IO.map(getUrl))));function isValidAppId(e){return/^[a-zA-Z0-9]{32}$/.test(e)}function isValidId(e){return"string"==typeof e&&/^[a-zA-Z0-9!#$%&()+\-:;<=.>?@[\]^_{}|~,\s]{1,64}$/.test(e)&&"null"!==e}function isValidIp(e){var t;try{t=e.split(".").map((function(e){return Number(e)}))}catch(e){return!1}if(4!==t.length)return!1;if(0===t[0])return!1;var n=t,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}var a=o;if(!Number.isInteger(a))return!1;if(a<0||a>255)return!1}return!0}function checkValidAttrGetByKeysArgs(e,t){if(!Array.isArray(t)||0===t.length||t.length>32||t.some((function(e){return 0===e.length||e.length>32})))throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);if(!isValidId(e))throw new RtmInvalidArgumentError("ID is invalid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT)}function _typeof$3(e){return(_typeof$3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$1(e,t){return _arrayWithHoles$1(e)||_iterableToArrayLimit$1(e,t)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit$1(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}function _arrayWithHoles$1(e){if(Array.isArray(e))return e}function _classCallCheck$4(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$3(e,t){return!t||"object"!==_typeof$3(t)&&"function"!=typeof t?_assertThisInitialized$3(e):t}function _assertThisInitialized$3(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf$3(e){return(_getPrototypeOf$3=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperties$2(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$2(e,t,n){return t&&_defineProperties$2(e.prototype,t),n&&_defineProperties$2(e,n),e}function _inherits$3(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$3(e,t)}function _setPrototypeOf$3(e,t){return(_setPrototypeOf$3=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var SocketError=genError(),Socket=function(e){function t(e,n,r,i,o){var a;if(_classCallCheck$4(this,t),(a=_possibleConstructorReturn$3(this,_getPrototypeOf$3(t).call(this,o,uniquePrefixedId("Socket-",o.loggerId)))).ip=e,a.env=n,a.ticket=r,a.context=i,a.isSpoiled=!1,a.notLoggedIn=!0,a.receivedPacket=new Subject,a.open$=void 0,a.input$=new Subject,a.userJoin$=new Subject,a.attemptsSinceLastError=0,a.message$=new Subject,a.socket$=void 0,a.toClose=new Subject,a.toReconnect=new Subject,a.socketReconnector=function(e){var t=function(e){return a.attemptsSinceLastError+=1,a.warn("The %s of Env %d reconnecting %s",a.name,a.env,e.message),timer((a.attemptsSinceLastError-1)*SOCKET_RETRY_INTERVAL)};return e.pipe(catchError((function(e){return a.isSpoiled?EMPTY:(a.notLoggedIn=!0,a.emit("reconnect"),throwError(e))})),retryWhen((function(e){return e.pipe(switchMap(t))})),tap((function(){a.attemptsSinceLastError=0})))},0!==n&&1!==n)throw new SocketError({ILLEGAL_RTM_ENV:"The env number is out of rtm env count"});if(!isValidIp(e))throw new SocketError({IP_NOT_VALID:"The ip from ap is not valid"});var s=EDGE_ENV_PORT[n],u=getEdgeDomain(e,"CN"===a.context.area),c="wss://".concat(u,":").concat(s);a.log("Opening websocket address %s for the Env %d",a.ip,a.env);var l=merge(a.input$,a.userJoin$.pipe(rateLimit(LOGIN_QPS_LIMIT)),a.message$).pipe(map$1((function(e){return Wrapper$1.encode(e).finish()})));return a.socket$=merge(makeWebSocketObservable(c,{protocols:[],makeWebSocket:function(e){var t=new WebSocket(e);return t.binaryType="arraybuffer",t}}),a.toReconnect).pipe(map$1((function(e){if(e instanceof Error)throw a.warn("Env_%d: Force reconnect the socket",a.env),e;return e(l).pipe(map$1((function(e){return Wrapper$1.decode(new Uint8Array(e))})))})),a.socketReconnector),a.open$=a.socket$.pipe(tap((function(e){a.log("Websocket opened",a.name),e.subscribe((function(e){var t=e.data,n=uriToPacketName(e.uri),r=Packets[n].decode(t),i=mergeWith_1({},omit_1(r,"toJSON"),(function(e,t){return t instanceof long_1?longToStringIfNeeded(t):t})),o=!1;if((r instanceof GroupEnterNotice||r instanceof GroupLeaveNotice)&&r.instance.lessThanOrEqual(UINT32_MAX)&&(o=!0),r instanceof Message||r instanceof Ack){var s=r.instance,u=r.dialogue,c=r.sequence;(u.lessThanOrEqual(UINT32_MAX)||s.lessThanOrEqual(UINT32_MAX)||c.lessThan(1))&&(o=!0)}o?a.warn("Env_%d: Illegal %s, abandoned %o",a.env,n,i):("Pong"!==n&&a.genLogger("RTM:MSG:RECV")("Env_%d: %s %o",a.env,n,i),a.receivedPacket.next([n,r]))}),(function(){}))})),mapTo(void 0),takeUntil(a.toClose),share()),a}return _inherits$3(t,createEventBase()),_createClass$2(t,[{key:"address",get:function(){return"".concat(this.ip,":").concat(EDGE_ENV_PORT[this.env])}}]),_createClass$2(t,[{key:"sendPacket",value:function(e,t){if("Ping"!==e){var n=mapValues_1(t,(function(e){return e instanceof long_1?longToStringIfNeeded(e):e}));this.genLogger("RTM:MSG:SEND")("Env_%d: %s %o",this.env,e,n)}var r=getWrappedByName(e,t);"UserJoin"===e?this.userJoin$.next(r):"Message"===e?this.message$.next(r):this.input$.next(r)}},{key:"close",value:function(){this.isSpoiled=!0,this.toClose.next()}},{key:"fromReceived",value:function(e){var t=this;return this.receivedPacket.pipe(tap((function(e){var n=_slicedToArray$1(e,2),r=n[0],i=n[1];"UserResp"===r&&(t.notLoggedIn=!1),"UserDrop"===r&&t.emit("socketUserDrop",i)})),filter((function(t){return _slicedToArray$1(t,1)[0]===e})),map$1((function(e){return _slicedToArray$1(e,2)[1]})))}},{key:"forceReconnect",value:function(){this.toReconnect.next(new SocketError({FORCE_RECONNECTING:"Connection seems broken, try force reconnecting"}))}}]),t}();function _typeof$4(e){return(_typeof$4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep$4(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator$4(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep$4(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep$4(o,r,i,a,s,"throw",e)}a(void 0)}))}}function _toConsumableArray$4(e){return _arrayWithoutHoles$4(e)||_iterableToArray$4(e)||_nonIterableSpread$4()}function _nonIterableSpread$4(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray$4(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles$4(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _classCallCheck$5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$4(e,t){return!t||"object"!==_typeof$4(t)&&"function"!=typeof t?_assertThisInitialized$4(e):t}function _assertThisInitialized$4(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf$4(e){return(_getPrototypeOf$4=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$4(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$4(e,t)}function _setPrototypeOf$4(e,t){return(_setPrototypeOf$4=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ApResErrorMessage={INVALID_APP_ID:"Illegal App ID",NO_AUTHORIZED:"Signature verification failed",TOKEN_TIMEOUT:"Dynamic key expired",INVALID_TOKEN_UID:"UID in the security key(token) is not valid",APP_ID_NO_ACTIVATED:"The vendor is not activated",DYNAMIC_KEY_NOT_ENABLED:"The vendor did not enable the dynamic key, but uses the dynamic key",DYNAMIC_ENABLED_BUT_STATIC_KEY:"The vendor enabled the dynamic key, but uses the static key",TOKEN_EXPIRED:"The token has expired",INVALID_USER_ID:"The user ID to login does not match the token"},ApResErrorCode={5:"INVALID_APP_ID",7:"INVALID_USER_ID",9:"NO_AUTHORIZED",10:"TOKEN_TIMEOUT",11:"APP_ID_NO_ACTIVATED",12:"INVALID_TOKEN_UID",13:"TOKEN_EXPIRED",14:"DYNAMIC_KEY_NOT_ENABLED",15:"DYNAMIC_ENABLED_BUT_STATIC_KEY"},AccessPoint=function(e){function t(e,n){var r;return _classCallCheck$5(this,t),(r=_possibleConstructorReturn$4(this,_getPrototypeOf$4(t).call(this,n,"AccessPoint"))).context=e,r.apEdgeInfo$=void 0,r.apFinish$=new Subject,r.usedUrl=[],r.url$=zip(cnUrl$,ioUrl$).pipe(concatMap((function(e){return of.apply(void 0,_toConsumableArray$4(e))})),filter((function(e){return!some_1(r.usedUrl,(function(t){return e[15]===t}))})),tap((function(e){r.usedUrl.push(e[15])})),take(AP_CONCURRENT_REQ_NUM),throwIfEmpty((function(){return t.runOutOfUrlSymbol})),catchError((function(e,n){return e===t.runOutOfUrlSymbol?(r.usedUrl=[],n):throwError(e)}))),r.fetchAp=function(e,t){var n=uniquePrefixedId("AP-",r.loggerId);r.log("The AccessPoint requests %s(%s)",e,n);var i=new AbortController;return r.apFinish$.pipe(first()).subscribe((function(){return i.abort()})),defer$1(_asyncToGenerator$4(regenerator.mark((function n(){var o;return regenerator.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=getRandomInt(0,Number.MAX_SAFE_INTEGER),r.log("The AP-%d request uid param is %d",r.loggerId,o),n.abrupt("return",post({url:e,headers:{"Content-Type":"application/json","X-Packet-Service-Type":"0","X-Packet-URI":"69"},body:{flag:128,opid:1,key:t||r.context.key,cname:r.context.uid,detail:{},uid:o,sid:r.context.sid},signal:i.signal}));case 3:case"end":return n.stop()}}),n)})))).pipe(catchError((function(t){return"AbortError"!==t.name&&(r.logError(t),r.warn("The AP server %s request failure",e)),EMPTY})),mergeMap(function(){var e=_asyncToGenerator$4(regenerator.mark((function e(t){var i,o,a,s,u,c,l,d,p,f,h,g,m,v,y,_,b;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=JSON.parse(t),r.log("The %s response is %o",n,i),a=(o=i).code,s=o.addresses,u=o.detail[9],0===a){e.next=30;break}if(c=a,a.toString().length>4&&(l=a.toString().padStart(8,"0"),d=l.slice(0,4),201===Number.parseInt(d,10)&&(c=Number.parseInt(l.slice(4,8),10))),p=c.toString(),Object.keys(ApResErrorCode).includes(p)){e.next=12;break}return(f=new RtmUnavailableError(["Login is rejected by the server. The response code is %d",a],LOGIN_ERR_REJECTED)).serverCode=c,e.abrupt("return",throwError(f));case 12:h=ApResErrorCode[p],g=ApResErrorMessage[h],e.t0=h,e.next="INVALID_APP_ID"===e.t0||"APP_ID_NO_ACTIVATED"===e.t0?17:"INVALID_USER_ID"===e.t0?20:"TOKEN_EXPIRED"===e.t0||"TOKEN_TIMEOUT"===e.t0?23:"NO_AUTHORIZED"===e.t0||"INVALID_TOKEN_UID"===e.t0||"DYNAMIC_KEY_NOT_ENABLED"===e.t0||"DYNAMIC_ENABLED_BUT_STATIC_KEY"===e.t0?26:29;break;case 17:return(m=new RtmUnauthenticatedError(g,LOGIN_ERR_INVALID_APP_ID)).serverCode=a,e.abrupt("return",throwError(m));case 20:return(v=new RtmUnauthenticatedError(g,LOGIN_ERR_INVALID_ARGUMENT)).serverCode=a,e.abrupt("return",throwError(v));case 23:return(y=new RtmUnauthenticatedError(g,LOGIN_ERR_TOKEN_EXPIRED)).serverCode=a,e.abrupt("return",throwError(y));case 26:return(_=new RtmUnauthenticatedError(g,LOGIN_ERR_INVALID_TOKEN)).serverCode=a,e.abrupt("return",throwError(_));case 29:return e.abrupt("return",throwError(assertNever("ApResErrType",h)));case 30:return b=s,r.context.area=u,e.abrupt("return",of.apply(void 0,_toConsumableArray$4(b).concat([queue$1])));case 35:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),mergeAll())},r.apEdgeInfo$=timer(0,2e3).pipe(take(6),takeUntil(r.apFinish$),mergeMap((function(){return r.url$})),mergeMap((function(e){return r.fetchAp(e)})),timeout(AP_REQUEST_TIMEOUT),catchError((function(e){return e instanceof TimeoutError&&r.warn("AP request timeout"),throwError(e)})),distinct((function(e){return e.ip}))),r}return _inherits$4(t,createEventBase()),t}();function _typeof$5(e){return(_typeof$5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray$5(e){return _arrayWithoutHoles$5(e)||_iterableToArray$5(e)||_nonIterableSpread$5()}function _nonIterableSpread$5(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray$5(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles$5(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _classCallCheck$6(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$3(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$3(e,t,n){return t&&_defineProperties$3(e.prototype,t),n&&_defineProperties$3(e,n),e}function _possibleConstructorReturn$5(e,t){return!t||"object"!==_typeof$5(t)&&"function"!=typeof t?_assertThisInitialized$5(e):t}function _assertThisInitialized$5(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf$5(e){return(_getPrototypeOf$5=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$5(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$5(e,t)}function _setPrototypeOf$5(e,t){return(_setPrototypeOf$5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}AccessPoint.runOutOfUrlSymbol=Symbol("AP urls are used up");var ConnectionError=genError(),Connection=function(e){function t(e,n){var r;_classCallCheck$6(this,t),(r=_possibleConstructorReturn$5(this,_getPrototypeOf$5(t).call(this,n,"Connection"))).context=e,r.apClient=new AccessPoint(r.context,r.logger),r.lastOpenSockets=[new ReplaySubject(1),new ReplaySubject(1)],r.curOpenSockets=[void 0,void 0],r.socketOpeners=[void 0,void 0],r.openKeeperSubjects=[new Subject,new Subject],r.openKeeperSubs=[void 0,void 0],r.edgeInfoPool=[];var i=r.apClient.apEdgeInfo$.pipe(throwIfEmpty((function(){return new ConnectionError({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})})),filter((function(e){return!some_1(r.edgeInfoPool,e)})),tap((function(e){r.edgeInfoPool.push(e),r.log("An edge info got %o",e)})),tap({error:function(e){r.emit("connectionInitFailure",e)}}),shareReplay()),o="",a=Math.random()>=.5?1:0,s=1===a?0:1,u=i.pipe(mergeMap((function(e){var t=e.ip,i=e.ticket,o=new Socket(t,a,i,r.context,n);return r.apClient.apFinish$.next(void 0),o.open$.pipe(mapTo(o))})),tap((function(e){r.log("The websocket of ENV_%d opened to %s:%d",e.env,e.ip,EDGE_ENV_PORT[e.env]),r.curOpenSockets[a]=e,r.lastOpenSockets[a].next(e),o=e.ip})),first(),share()),c=i.pipe(reduce((function(e,t){return[].concat(_toConsumableArray$5(e),[t])}),[]),map$1((function(e){return sortBy_1(e,(function(e){var t=e.ip;return calIpDistance(o,t)})).slice(-1)[0]})),first(),mergeMap((function(e){var t=e.ip,i=e.ticket,o=new Socket(t,s,i,r.context,n);return o.open$.pipe(tap((function(){r.lastOpenSockets[s].next(o),r.curOpenSockets[s]=o})))})),share());return r.socketOpeners[a]=u.pipe(mergeMap((function(e){return e.open$.pipe(tap((function(){r.log("The websocket of first ENV_%d re-opened to %s:%d",e.env,e.ip,EDGE_ENV_PORT[e.env]),r.curOpenSockets[a]=e,r.lastOpenSockets[a].next(e)})))}))),r.socketOpeners[s]=concat(u.pipe(skipLast(1),mapTo(void 0)),c),r.openKeeperSubjects.forEach((function(e,t){var n=e.pipe(switchAll());r.openKeeperSubs[t]=n.subscribe({error:r.logError})})),r}return _inherits$5(t,createEventBase()),_createClass$3(t,[{key:"initConnection",value:function(){var e=this;this.openKeeperSubjects.forEach((function(t,n){t.next(e.socketOpeners[n])}))}},{key:"closeSocket",value:function(e,t){if(![0,1].includes(e))throw new CommonError({INVALID_ENV:"The env argument is not 0 or 1"});var n=this.openKeeperSubs[e],r=this.curOpenSockets[e];this.openKeeperSubs[e]=void 0,this.curOpenSockets[e]=void 0,r&&(r.isSpoiled=!0,setTimeout((function(){r.close()}),t)),n&&setTimeout((function(){n.unsubscribe()}),t)}},{key:"waitClosing",value:function(e){var t=this;return e.isSpoiled=!0,e.open$.pipe(ignoreElements(),catchError((function(e){return e.message===lib_es5_1?EMPTY:throwError(e)})),timeout(LOGOUT_SOCKET_CLOSE_TIMEOUT),catchError((function(n){return n instanceof TimeoutError?(t.warn("Force closing the ENV_%d conneciton",e.env),EMPTY):throwError(n)})))}}]),t}(),$Reader$1=indexMinimal_4,$Writer$1=indexMinimal_2,$util$1=indexMinimal_6,$root$1=indexMinimal_8.default||(indexMinimal_8.default={}),Session=$root$1.Session=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.appId="",e.prototype.ver="",e.prototype.installId="",e.prototype.os=0,e.prototype.did="",e.prototype.index=null,e.prototype.token="",e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.appId&&e.hasOwnProperty("appId")&&t.uint32(42).string(e.appId),null!=e.ver&&e.hasOwnProperty("ver")&&t.uint32(50).string(e.ver),null!=e.installId&&e.hasOwnProperty("installId")&&t.uint32(66).string(e.installId),null!=e.os&&e.hasOwnProperty("os")&&t.uint32(128).int32(e.os),null!=e.did&&e.hasOwnProperty("did")&&t.uint32(138).string(e.did),null!=e.index&&e.hasOwnProperty("index")&&$root$1.Session.CommonIndex.encode(e.index,t.uint32(162).fork()).ldelim(),null!=e.token&&e.hasOwnProperty("token")&&t.uint32(170).string(e.token),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.Session;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 5:r.appId=e.string();break;case 6:r.ver=e.string();break;case 8:r.installId=e.string();break;case 16:r.os=e.int32();break;case 17:r.did=e.string();break;case 20:r.index=$root$1.Session.CommonIndex.decode(e,e.uint32());break;case 21:r.token=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid))return"sid: string expected";if(null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId))return"userId: string expected";if(null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high)))return"lts: integer|Long expected";if(null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high)))return"elapse: integer|Long expected";if(null!=e.appId&&e.hasOwnProperty("appId")&&!$util$1.isString(e.appId))return"appId: string expected";if(null!=e.ver&&e.hasOwnProperty("ver")&&!$util$1.isString(e.ver))return"ver: string expected";if(null!=e.installId&&e.hasOwnProperty("installId")&&!$util$1.isString(e.installId))return"installId: string expected";if(null!=e.os&&e.hasOwnProperty("os")&&!$util$1.isInteger(e.os))return"os: integer expected";if(null!=e.did&&e.hasOwnProperty("did")&&!$util$1.isString(e.did))return"did: string expected";if(null!=e.index&&e.hasOwnProperty("index")){var t=$root$1.Session.CommonIndex.verify(e.index);if(t)return"index."+t}return null!=e.token&&e.hasOwnProperty("token")&&!$util$1.isString(e.token)?"token: string expected":null},e.fromObject=function(e){if(e instanceof $root$1.Session)return e;var t=new $root$1.Session;if(null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.appId&&(t.appId=String(e.appId)),null!=e.ver&&(t.ver=String(e.ver)),null!=e.installId&&(t.installId=String(e.installId)),null!=e.os&&(t.os=0|e.os),null!=e.did&&(t.did=String(e.did)),null!=e.index){if("object"!==_typeof(e.index))throw TypeError(".Session.index: object expected");t.index=$root$1.Session.CommonIndex.fromObject(e.index)}return null!=e.token&&(t.token=String(e.token)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.appId="",n.ver="",n.installId="",n.os=0,n.did="",n.index=null,n.token=""}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.appId&&e.hasOwnProperty("appId")&&(n.appId=e.appId),null!=e.ver&&e.hasOwnProperty("ver")&&(n.ver=e.ver),null!=e.installId&&e.hasOwnProperty("installId")&&(n.installId=e.installId),null!=e.os&&e.hasOwnProperty("os")&&(n.os=e.os),null!=e.did&&e.hasOwnProperty("did")&&(n.did=e.did),null!=e.index&&e.hasOwnProperty("index")&&(n.index=$root$1.Session.CommonIndex.toObject(e.index,t)),null!=e.token&&e.hasOwnProperty("token")&&(n.token=e.token),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.CommonIndex=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.index1="",e.prototype.index2="",e.prototype.index3="",e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.index1&&e.hasOwnProperty("index1")&&t.uint32(10).string(e.index1),null!=e.index2&&e.hasOwnProperty("index2")&&t.uint32(18).string(e.index2),null!=e.index3&&e.hasOwnProperty("index3")&&t.uint32(26).string(e.index3),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.Session.CommonIndex;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.index1=e.string();break;case 2:r.index2=e.string();break;case 3:r.index3=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.index1&&e.hasOwnProperty("index1")&&!$util$1.isString(e.index1)?"index1: string expected":null!=e.index2&&e.hasOwnProperty("index2")&&!$util$1.isString(e.index2)?"index2: string expected":null!=e.index3&&e.hasOwnProperty("index3")&&!$util$1.isString(e.index3)?"index3: string expected":null},e.fromObject=function(e){if(e instanceof $root$1.Session.CommonIndex)return e;var t=new $root$1.Session.CommonIndex;return null!=e.index1&&(t.index1=String(e.index1)),null!=e.index2&&(t.index2=String(e.index2)),null!=e.index3&&(t.index3=String(e.index3)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.index1="",n.index2="",n.index3=""),null!=e.index1&&e.hasOwnProperty("index1")&&(n.index1=e.index1),null!=e.index2&&e.hasOwnProperty("index2")&&(n.index2=e.index2),null!=e.index3&&e.hasOwnProperty("index3")&&(n.index3=e.index3),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),ApEvent=$root$1.ApEvent=function(){function e(e){if(this.linkServerList=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.apAddr="",e.prototype.linkServerList=$util$1.emptyArray,e.prototype.errCode=0,e.prototype.serverErrCode=0,e.prototype.isp="",e.prototype.opId=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.envId=0,e.prototype.flag=0,e.prototype.area="",e.prototype.responseTime=0,e.prototype.apLinkType="",e.encode=function(e,t){if(t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.apAddr&&e.hasOwnProperty("apAddr")&&t.uint32(50).string(e.apAddr),null!=e.linkServerList&&e.linkServerList.length)for(var n=0;n<e.linkServerList.length;++n)t.uint32(58).string(e.linkServerList[n]);return null!=e.errCode&&e.hasOwnProperty("errCode")&&t.uint32(72).int32(e.errCode),null!=e.serverErrCode&&e.hasOwnProperty("serverErrCode")&&t.uint32(80).int32(e.serverErrCode),null!=e.isp&&e.hasOwnProperty("isp")&&t.uint32(90).string(e.isp),null!=e.opId&&e.hasOwnProperty("opId")&&t.uint32(96).int64(e.opId),null!=e.envId&&e.hasOwnProperty("envId")&&t.uint32(104).int32(e.envId),null!=e.flag&&e.hasOwnProperty("flag")&&t.uint32(112).int32(e.flag),null!=e.area&&e.hasOwnProperty("area")&&t.uint32(122).string(e.area),null!=e.responseTime&&e.hasOwnProperty("responseTime")&&t.uint32(128).int32(e.responseTime),null!=e.apLinkType&&e.hasOwnProperty("apLinkType")&&t.uint32(138).string(e.apLinkType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.ApEvent;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.apAddr=e.string();break;case 7:r.linkServerList&&r.linkServerList.length||(r.linkServerList=[]),r.linkServerList.push(e.string());break;case 9:r.errCode=e.int32();break;case 10:r.serverErrCode=e.int32();break;case 11:r.isp=e.string();break;case 12:r.opId=e.int64();break;case 13:r.envId=e.int32();break;case 14:r.flag=e.int32();break;case 15:r.area=e.string();break;case 16:r.responseTime=e.int32();break;case 17:r.apLinkType=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid))return"sid: string expected";if(null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId))return"userId: string expected";if(null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high)))return"lts: integer|Long expected";if(null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high)))return"elapse: integer|Long expected";if(null!=e.apAddr&&e.hasOwnProperty("apAddr")&&!$util$1.isString(e.apAddr))return"apAddr: string expected";if(null!=e.linkServerList&&e.hasOwnProperty("linkServerList")){if(!Array.isArray(e.linkServerList))return"linkServerList: array expected";for(var t=0;t<e.linkServerList.length;++t)if(!$util$1.isString(e.linkServerList[t]))return"linkServerList: string[] expected"}return null!=e.errCode&&e.hasOwnProperty("errCode")&&!$util$1.isInteger(e.errCode)?"errCode: integer expected":null!=e.serverErrCode&&e.hasOwnProperty("serverErrCode")&&!$util$1.isInteger(e.serverErrCode)?"serverErrCode: integer expected":null!=e.isp&&e.hasOwnProperty("isp")&&!$util$1.isString(e.isp)?"isp: string expected":null!=e.opId&&e.hasOwnProperty("opId")&&!($util$1.isInteger(e.opId)||e.opId&&$util$1.isInteger(e.opId.low)&&$util$1.isInteger(e.opId.high))?"opId: integer|Long expected":null!=e.envId&&e.hasOwnProperty("envId")&&!$util$1.isInteger(e.envId)?"envId: integer expected":null!=e.flag&&e.hasOwnProperty("flag")&&!$util$1.isInteger(e.flag)?"flag: integer expected":null!=e.area&&e.hasOwnProperty("area")&&!$util$1.isString(e.area)?"area: string expected":null!=e.responseTime&&e.hasOwnProperty("responseTime")&&!$util$1.isInteger(e.responseTime)?"responseTime: integer expected":null!=e.apLinkType&&e.hasOwnProperty("apLinkType")&&!$util$1.isString(e.apLinkType)?"apLinkType: string expected":null},e.fromObject=function(e){if(e instanceof $root$1.ApEvent)return e;var t=new $root$1.ApEvent;if(null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.apAddr&&(t.apAddr=String(e.apAddr)),e.linkServerList){if(!Array.isArray(e.linkServerList))throw TypeError(".ApEvent.linkServerList: array expected");t.linkServerList=[];for(var n=0;n<e.linkServerList.length;++n)t.linkServerList[n]=String(e.linkServerList[n])}return null!=e.errCode&&(t.errCode=0|e.errCode),null!=e.serverErrCode&&(t.serverErrCode=0|e.serverErrCode),null!=e.isp&&(t.isp=String(e.isp)),null!=e.opId&&($util$1.Long?(t.opId=$util$1.Long.fromValue(e.opId)).unsigned=!1:"string"==typeof e.opId?t.opId=parseInt(e.opId,10):"number"==typeof e.opId?t.opId=e.opId:"object"===_typeof(e.opId)&&(t.opId=new $util$1.LongBits(e.opId.low>>>0,e.opId.high>>>0).toNumber())),null!=e.envId&&(t.envId=0|e.envId),null!=e.flag&&(t.flag=0|e.flag),null!=e.area&&(t.area=String(e.area)),null!=e.responseTime&&(t.responseTime=0|e.responseTime),null!=e.apLinkType&&(t.apLinkType=String(e.apLinkType)),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.linkServerList=[]),t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;if(n.apAddr="",n.errCode=0,n.serverErrCode=0,n.isp="",$util$1.Long){var o=new $util$1.Long(0,0,!1);n.opId=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.opId=t.longs===String?"0":0;n.envId=0,n.flag=0,n.area="",n.responseTime=0,n.apLinkType=""}if(null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.apAddr&&e.hasOwnProperty("apAddr")&&(n.apAddr=e.apAddr),e.linkServerList&&e.linkServerList.length){n.linkServerList=[];for(var a=0;a<e.linkServerList.length;++a)n.linkServerList[a]=e.linkServerList[a]}return null!=e.errCode&&e.hasOwnProperty("errCode")&&(n.errCode=e.errCode),null!=e.serverErrCode&&e.hasOwnProperty("serverErrCode")&&(n.serverErrCode=e.serverErrCode),null!=e.isp&&e.hasOwnProperty("isp")&&(n.isp=e.isp),null!=e.opId&&e.hasOwnProperty("opId")&&("number"==typeof e.opId?n.opId=t.longs===String?String(e.opId):e.opId:n.opId=t.longs===String?$util$1.Long.prototype.toString.call(e.opId):t.longs===Number?new $util$1.LongBits(e.opId.low>>>0,e.opId.high>>>0).toNumber():e.opId),null!=e.envId&&e.hasOwnProperty("envId")&&(n.envId=e.envId),null!=e.flag&&e.hasOwnProperty("flag")&&(n.flag=e.flag),null!=e.area&&e.hasOwnProperty("area")&&(n.area=e.area),null!=e.responseTime&&e.hasOwnProperty("responseTime")&&(n.responseTime=e.responseTime),null!=e.apLinkType&&e.hasOwnProperty("apLinkType")&&(n.apLinkType=e.apLinkType),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),Link=$root$1.Link=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.ec=0,e.prototype.sc=0,e.prototype.destServerIp="",e.prototype.ackedServerIp="",e.prototype.responseTime=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.ec&&e.hasOwnProperty("ec")&&t.uint32(40).int32(e.ec),null!=e.sc&&e.hasOwnProperty("sc")&&t.uint32(48).int32(e.sc),null!=e.destServerIp&&e.hasOwnProperty("destServerIp")&&t.uint32(58).string(e.destServerIp),null!=e.ackedServerIp&&e.hasOwnProperty("ackedServerIp")&&t.uint32(66).string(e.ackedServerIp),null!=e.responseTime&&e.hasOwnProperty("responseTime")&&t.uint32(72).int32(e.responseTime),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.Link;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 5:r.ec=e.int32();break;case 6:r.sc=e.int32();break;case 7:r.destServerIp=e.string();break;case 8:r.ackedServerIp=e.string();break;case 9:r.responseTime=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.ec&&e.hasOwnProperty("ec")&&!$util$1.isInteger(e.ec)?"ec: integer expected":null!=e.sc&&e.hasOwnProperty("sc")&&!$util$1.isInteger(e.sc)?"sc: integer expected":null!=e.destServerIp&&e.hasOwnProperty("destServerIp")&&!$util$1.isString(e.destServerIp)?"destServerIp: string expected":null!=e.ackedServerIp&&e.hasOwnProperty("ackedServerIp")&&!$util$1.isString(e.ackedServerIp)?"ackedServerIp: string expected":null!=e.responseTime&&e.hasOwnProperty("responseTime")&&!$util$1.isInteger(e.responseTime)?"responseTime: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.Link)return e;var t=new $root$1.Link;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.ec&&(t.ec=0|e.ec),null!=e.sc&&(t.sc=0|e.sc),null!=e.destServerIp&&(t.destServerIp=String(e.destServerIp)),null!=e.ackedServerIp&&(t.ackedServerIp=String(e.ackedServerIp)),null!=e.responseTime&&(t.responseTime=0|e.responseTime),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.ec=0,n.sc=0,n.destServerIp="",n.ackedServerIp="",n.responseTime=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.ec&&e.hasOwnProperty("ec")&&(n.ec=e.ec),null!=e.sc&&e.hasOwnProperty("sc")&&(n.sc=e.sc),null!=e.destServerIp&&e.hasOwnProperty("destServerIp")&&(n.destServerIp=e.destServerIp),null!=e.ackedServerIp&&e.hasOwnProperty("ackedServerIp")&&(n.ackedServerIp=e.ackedServerIp),null!=e.responseTime&&e.hasOwnProperty("responseTime")&&(n.responseTime=e.responseTime),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),Logout=$root$1.Logout=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.Logout;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root$1.Logout)return e;var t=new $root$1.Logout;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),TxMessage=$root$1.TxMessage=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.insId=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.dialId=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.seq=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.srcId="",e.prototype.dstId="",e.prototype.dstType=0,e.prototype.payload="",e.prototype.messageId=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.isOfflineMessage=!1,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.insId&&e.hasOwnProperty("insId")&&t.uint32(48).int64(e.insId),null!=e.dialId&&e.hasOwnProperty("dialId")&&t.uint32(56).int64(e.dialId),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(64).int64(e.seq),null!=e.srcId&&e.hasOwnProperty("srcId")&&t.uint32(74).string(e.srcId),null!=e.dstId&&e.hasOwnProperty("dstId")&&t.uint32(82).string(e.dstId),null!=e.dstType&&e.hasOwnProperty("dstType")&&t.uint32(88).int32(e.dstType),null!=e.payload&&e.hasOwnProperty("payload")&&t.uint32(98).string(e.payload),null!=e.messageId&&e.hasOwnProperty("messageId")&&t.uint32(104).int64(e.messageId),null!=e.isOfflineMessage&&e.hasOwnProperty("isOfflineMessage")&&t.uint32(112).bool(e.isOfflineMessage),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.TxMessage;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.insId=e.int64();break;case 7:r.dialId=e.int64();break;case 8:r.seq=e.int64();break;case 9:r.srcId=e.string();break;case 10:r.dstId=e.string();break;case 11:r.dstType=e.int32();break;case 12:r.payload=e.string();break;case 13:r.messageId=e.int64();break;case 14:r.isOfflineMessage=e.bool();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.insId&&e.hasOwnProperty("insId")&&!($util$1.isInteger(e.insId)||e.insId&&$util$1.isInteger(e.insId.low)&&$util$1.isInteger(e.insId.high))?"insId: integer|Long expected":null!=e.dialId&&e.hasOwnProperty("dialId")&&!($util$1.isInteger(e.dialId)||e.dialId&&$util$1.isInteger(e.dialId.low)&&$util$1.isInteger(e.dialId.high))?"dialId: integer|Long expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util$1.isInteger(e.seq)||e.seq&&$util$1.isInteger(e.seq.low)&&$util$1.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.srcId&&e.hasOwnProperty("srcId")&&!$util$1.isString(e.srcId)?"srcId: string expected":null!=e.dstId&&e.hasOwnProperty("dstId")&&!$util$1.isString(e.dstId)?"dstId: string expected":null!=e.dstType&&e.hasOwnProperty("dstType")&&!$util$1.isInteger(e.dstType)?"dstType: integer expected":null!=e.payload&&e.hasOwnProperty("payload")&&!$util$1.isString(e.payload)?"payload: string expected":null!=e.messageId&&e.hasOwnProperty("messageId")&&!($util$1.isInteger(e.messageId)||e.messageId&&$util$1.isInteger(e.messageId.low)&&$util$1.isInteger(e.messageId.high))?"messageId: integer|Long expected":null!=e.isOfflineMessage&&e.hasOwnProperty("isOfflineMessage")&&"boolean"!=typeof e.isOfflineMessage?"isOfflineMessage: boolean expected":null},e.fromObject=function(e){if(e instanceof $root$1.TxMessage)return e;var t=new $root$1.TxMessage;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.insId&&($util$1.Long?(t.insId=$util$1.Long.fromValue(e.insId)).unsigned=!1:"string"==typeof e.insId?t.insId=parseInt(e.insId,10):"number"==typeof e.insId?t.insId=e.insId:"object"===_typeof(e.insId)&&(t.insId=new $util$1.LongBits(e.insId.low>>>0,e.insId.high>>>0).toNumber())),null!=e.dialId&&($util$1.Long?(t.dialId=$util$1.Long.fromValue(e.dialId)).unsigned=!1:"string"==typeof e.dialId?t.dialId=parseInt(e.dialId,10):"number"==typeof e.dialId?t.dialId=e.dialId:"object"===_typeof(e.dialId)&&(t.dialId=new $util$1.LongBits(e.dialId.low>>>0,e.dialId.high>>>0).toNumber())),null!=e.seq&&($util$1.Long?(t.seq=$util$1.Long.fromValue(e.seq)).unsigned=!1:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util$1.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber())),null!=e.srcId&&(t.srcId=String(e.srcId)),null!=e.dstId&&(t.dstId=String(e.dstId)),null!=e.dstType&&(t.dstType=0|e.dstType),null!=e.payload&&(t.payload=String(e.payload)),null!=e.messageId&&($util$1.Long?(t.messageId=$util$1.Long.fromValue(e.messageId)).unsigned=!1:"string"==typeof e.messageId?t.messageId=parseInt(e.messageId,10):"number"==typeof e.messageId?t.messageId=e.messageId:"object"===_typeof(e.messageId)&&(t.messageId=new $util$1.LongBits(e.messageId.low>>>0,e.messageId.high>>>0).toNumber())),null!=e.isOfflineMessage&&(t.isOfflineMessage=Boolean(e.isOfflineMessage)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;if($util$1.Long){var o=new $util$1.Long(0,0,!1);n.insId=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.insId=t.longs===String?"0":0;if($util$1.Long){var a=new $util$1.Long(0,0,!1);n.dialId=t.longs===String?a.toString():t.longs===Number?a.toNumber():a}else n.dialId=t.longs===String?"0":0;if($util$1.Long){var s=new $util$1.Long(0,0,!1);n.seq=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else n.seq=t.longs===String?"0":0;if(n.srcId="",n.dstId="",n.dstType=0,n.payload="",$util$1.Long){var u=new $util$1.Long(0,0,!1);n.messageId=t.longs===String?u.toString():t.longs===Number?u.toNumber():u}else n.messageId=t.longs===String?"0":0;n.isOfflineMessage=!1}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.insId&&e.hasOwnProperty("insId")&&("number"==typeof e.insId?n.insId=t.longs===String?String(e.insId):e.insId:n.insId=t.longs===String?$util$1.Long.prototype.toString.call(e.insId):t.longs===Number?new $util$1.LongBits(e.insId.low>>>0,e.insId.high>>>0).toNumber():e.insId),null!=e.dialId&&e.hasOwnProperty("dialId")&&("number"==typeof e.dialId?n.dialId=t.longs===String?String(e.dialId):e.dialId:n.dialId=t.longs===String?$util$1.Long.prototype.toString.call(e.dialId):t.longs===Number?new $util$1.LongBits(e.dialId.low>>>0,e.dialId.high>>>0).toNumber():e.dialId),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util$1.Long.prototype.toString.call(e.seq):t.longs===Number?new $util$1.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber():e.seq),null!=e.srcId&&e.hasOwnProperty("srcId")&&(n.srcId=e.srcId),null!=e.dstId&&e.hasOwnProperty("dstId")&&(n.dstId=e.dstId),null!=e.dstType&&e.hasOwnProperty("dstType")&&(n.dstType=e.dstType),null!=e.payload&&e.hasOwnProperty("payload")&&(n.payload=e.payload),null!=e.messageId&&e.hasOwnProperty("messageId")&&("number"==typeof e.messageId?n.messageId=t.longs===String?String(e.messageId):e.messageId:n.messageId=t.longs===String?$util$1.Long.prototype.toString.call(e.messageId):t.longs===Number?new $util$1.LongBits(e.messageId.low>>>0,e.messageId.high>>>0).toNumber():e.messageId),null!=e.isOfflineMessage&&e.hasOwnProperty("isOfflineMessage")&&(n.isOfflineMessage=e.isOfflineMessage),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),RxMessage=$root$1.RxMessage=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.insId=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.dialId=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.seq=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.srcId="",e.prototype.dstId="",e.prototype.dstType=0,e.prototype.payload="",e.prototype.messageId=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.serverReceivedTs=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.isOfflineMessage=!1,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.insId&&e.hasOwnProperty("insId")&&t.uint32(48).int64(e.insId),null!=e.dialId&&e.hasOwnProperty("dialId")&&t.uint32(56).int64(e.dialId),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(64).int64(e.seq),null!=e.srcId&&e.hasOwnProperty("srcId")&&t.uint32(74).string(e.srcId),null!=e.dstId&&e.hasOwnProperty("dstId")&&t.uint32(82).string(e.dstId),null!=e.dstType&&e.hasOwnProperty("dstType")&&t.uint32(88).int32(e.dstType),null!=e.payload&&e.hasOwnProperty("payload")&&t.uint32(98).string(e.payload),null!=e.messageId&&e.hasOwnProperty("messageId")&&t.uint32(104).int64(e.messageId),null!=e.serverReceivedTs&&e.hasOwnProperty("serverReceivedTs")&&t.uint32(112).int64(e.serverReceivedTs),null!=e.isOfflineMessage&&e.hasOwnProperty("isOfflineMessage")&&t.uint32(120).bool(e.isOfflineMessage),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.RxMessage;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.insId=e.int64();break;case 7:r.dialId=e.int64();break;case 8:r.seq=e.int64();break;case 9:r.srcId=e.string();break;case 10:r.dstId=e.string();break;case 11:r.dstType=e.int32();break;case 12:r.payload=e.string();break;case 13:r.messageId=e.int64();break;case 14:r.serverReceivedTs=e.int64();break;case 15:r.isOfflineMessage=e.bool();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.insId&&e.hasOwnProperty("insId")&&!($util$1.isInteger(e.insId)||e.insId&&$util$1.isInteger(e.insId.low)&&$util$1.isInteger(e.insId.high))?"insId: integer|Long expected":null!=e.dialId&&e.hasOwnProperty("dialId")&&!($util$1.isInteger(e.dialId)||e.dialId&&$util$1.isInteger(e.dialId.low)&&$util$1.isInteger(e.dialId.high))?"dialId: integer|Long expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util$1.isInteger(e.seq)||e.seq&&$util$1.isInteger(e.seq.low)&&$util$1.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.srcId&&e.hasOwnProperty("srcId")&&!$util$1.isString(e.srcId)?"srcId: string expected":null!=e.dstId&&e.hasOwnProperty("dstId")&&!$util$1.isString(e.dstId)?"dstId: string expected":null!=e.dstType&&e.hasOwnProperty("dstType")&&!$util$1.isInteger(e.dstType)?"dstType: integer expected":null!=e.payload&&e.hasOwnProperty("payload")&&!$util$1.isString(e.payload)?"payload: string expected":null!=e.messageId&&e.hasOwnProperty("messageId")&&!($util$1.isInteger(e.messageId)||e.messageId&&$util$1.isInteger(e.messageId.low)&&$util$1.isInteger(e.messageId.high))?"messageId: integer|Long expected":null!=e.serverReceivedTs&&e.hasOwnProperty("serverReceivedTs")&&!($util$1.isInteger(e.serverReceivedTs)||e.serverReceivedTs&&$util$1.isInteger(e.serverReceivedTs.low)&&$util$1.isInteger(e.serverReceivedTs.high))?"serverReceivedTs: integer|Long expected":null!=e.isOfflineMessage&&e.hasOwnProperty("isOfflineMessage")&&"boolean"!=typeof e.isOfflineMessage?"isOfflineMessage: boolean expected":null},e.fromObject=function(e){if(e instanceof $root$1.RxMessage)return e;var t=new $root$1.RxMessage;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.insId&&($util$1.Long?(t.insId=$util$1.Long.fromValue(e.insId)).unsigned=!1:"string"==typeof e.insId?t.insId=parseInt(e.insId,10):"number"==typeof e.insId?t.insId=e.insId:"object"===_typeof(e.insId)&&(t.insId=new $util$1.LongBits(e.insId.low>>>0,e.insId.high>>>0).toNumber())),null!=e.dialId&&($util$1.Long?(t.dialId=$util$1.Long.fromValue(e.dialId)).unsigned=!1:"string"==typeof e.dialId?t.dialId=parseInt(e.dialId,10):"number"==typeof e.dialId?t.dialId=e.dialId:"object"===_typeof(e.dialId)&&(t.dialId=new $util$1.LongBits(e.dialId.low>>>0,e.dialId.high>>>0).toNumber())),null!=e.seq&&($util$1.Long?(t.seq=$util$1.Long.fromValue(e.seq)).unsigned=!1:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util$1.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber())),null!=e.srcId&&(t.srcId=String(e.srcId)),null!=e.dstId&&(t.dstId=String(e.dstId)),null!=e.dstType&&(t.dstType=0|e.dstType),null!=e.payload&&(t.payload=String(e.payload)),null!=e.messageId&&($util$1.Long?(t.messageId=$util$1.Long.fromValue(e.messageId)).unsigned=!1:"string"==typeof e.messageId?t.messageId=parseInt(e.messageId,10):"number"==typeof e.messageId?t.messageId=e.messageId:"object"===_typeof(e.messageId)&&(t.messageId=new $util$1.LongBits(e.messageId.low>>>0,e.messageId.high>>>0).toNumber())),null!=e.serverReceivedTs&&($util$1.Long?(t.serverReceivedTs=$util$1.Long.fromValue(e.serverReceivedTs)).unsigned=!1:"string"==typeof e.serverReceivedTs?t.serverReceivedTs=parseInt(e.serverReceivedTs,10):"number"==typeof e.serverReceivedTs?t.serverReceivedTs=e.serverReceivedTs:"object"===_typeof(e.serverReceivedTs)&&(t.serverReceivedTs=new $util$1.LongBits(e.serverReceivedTs.low>>>0,e.serverReceivedTs.high>>>0).toNumber())),null!=e.isOfflineMessage&&(t.isOfflineMessage=Boolean(e.isOfflineMessage)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;if($util$1.Long){var o=new $util$1.Long(0,0,!1);n.insId=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.insId=t.longs===String?"0":0;if($util$1.Long){var a=new $util$1.Long(0,0,!1);n.dialId=t.longs===String?a.toString():t.longs===Number?a.toNumber():a}else n.dialId=t.longs===String?"0":0;if($util$1.Long){var s=new $util$1.Long(0,0,!1);n.seq=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else n.seq=t.longs===String?"0":0;if(n.srcId="",n.dstId="",n.dstType=0,n.payload="",$util$1.Long){var u=new $util$1.Long(0,0,!1);n.messageId=t.longs===String?u.toString():t.longs===Number?u.toNumber():u}else n.messageId=t.longs===String?"0":0;if($util$1.Long){var c=new $util$1.Long(0,0,!1);n.serverReceivedTs=t.longs===String?c.toString():t.longs===Number?c.toNumber():c}else n.serverReceivedTs=t.longs===String?"0":0;n.isOfflineMessage=!1}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.insId&&e.hasOwnProperty("insId")&&("number"==typeof e.insId?n.insId=t.longs===String?String(e.insId):e.insId:n.insId=t.longs===String?$util$1.Long.prototype.toString.call(e.insId):t.longs===Number?new $util$1.LongBits(e.insId.low>>>0,e.insId.high>>>0).toNumber():e.insId),null!=e.dialId&&e.hasOwnProperty("dialId")&&("number"==typeof e.dialId?n.dialId=t.longs===String?String(e.dialId):e.dialId:n.dialId=t.longs===String?$util$1.Long.prototype.toString.call(e.dialId):t.longs===Number?new $util$1.LongBits(e.dialId.low>>>0,e.dialId.high>>>0).toNumber():e.dialId),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util$1.Long.prototype.toString.call(e.seq):t.longs===Number?new $util$1.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber():e.seq),null!=e.srcId&&e.hasOwnProperty("srcId")&&(n.srcId=e.srcId),null!=e.dstId&&e.hasOwnProperty("dstId")&&(n.dstId=e.dstId),null!=e.dstType&&e.hasOwnProperty("dstType")&&(n.dstType=e.dstType),null!=e.payload&&e.hasOwnProperty("payload")&&(n.payload=e.payload),null!=e.messageId&&e.hasOwnProperty("messageId")&&("number"==typeof e.messageId?n.messageId=t.longs===String?String(e.messageId):e.messageId:n.messageId=t.longs===String?$util$1.Long.prototype.toString.call(e.messageId):t.longs===Number?new $util$1.LongBits(e.messageId.low>>>0,e.messageId.high>>>0).toNumber():e.messageId),null!=e.serverReceivedTs&&e.hasOwnProperty("serverReceivedTs")&&("number"==typeof e.serverReceivedTs?n.serverReceivedTs=t.longs===String?String(e.serverReceivedTs):e.serverReceivedTs:n.serverReceivedTs=t.longs===String?$util$1.Long.prototype.toString.call(e.serverReceivedTs):t.longs===Number?new $util$1.LongBits(e.serverReceivedTs.low>>>0,e.serverReceivedTs.high>>>0).toNumber():e.serverReceivedTs),null!=e.isOfflineMessage&&e.hasOwnProperty("isOfflineMessage")&&(n.isOfflineMessage=e.isOfflineMessage),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),KickedOff=$root$1.KickedOff=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.linkId=0,e.prototype.code=0,e.prototype.server="",e.prototype.serverCode=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.linkId&&e.hasOwnProperty("linkId")&&t.uint32(48).int32(e.linkId),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(56).int32(e.code),null!=e.server&&e.hasOwnProperty("server")&&t.uint32(66).string(e.server),null!=e.serverCode&&e.hasOwnProperty("serverCode")&&t.uint32(72).int32(e.serverCode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.KickedOff;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.linkId=e.int32();break;case 7:r.code=e.int32();break;case 8:r.server=e.string();break;case 9:r.serverCode=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.linkId&&e.hasOwnProperty("linkId")&&!$util$1.isInteger(e.linkId)?"linkId: integer expected":null!=e.code&&e.hasOwnProperty("code")&&!$util$1.isInteger(e.code)?"code: integer expected":null!=e.server&&e.hasOwnProperty("server")&&!$util$1.isString(e.server)?"server: string expected":null!=e.serverCode&&e.hasOwnProperty("serverCode")&&!$util$1.isInteger(e.serverCode)?"serverCode: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.KickedOff)return e;var t=new $root$1.KickedOff;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.linkId&&(t.linkId=0|e.linkId),null!=e.code&&(t.code=0|e.code),null!=e.server&&(t.server=String(e.server)),null!=e.serverCode&&(t.serverCode=0|e.serverCode),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.linkId=0,n.code=0,n.server="",n.serverCode=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.linkId&&e.hasOwnProperty("linkId")&&(n.linkId=e.linkId),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),null!=e.server&&e.hasOwnProperty("server")&&(n.server=e.server),null!=e.serverCode&&e.hasOwnProperty("serverCode")&&(n.serverCode=e.serverCode),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),TxMessageRes=$root$1.TxMessageRes=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.insId=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.dialId=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.seq=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.srcId="",e.prototype.dstId="",e.prototype.dstType=0,e.prototype.messageId=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.errCode=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.insId&&e.hasOwnProperty("insId")&&t.uint32(48).int64(e.insId),null!=e.dialId&&e.hasOwnProperty("dialId")&&t.uint32(56).int64(e.dialId),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(64).int64(e.seq),null!=e.srcId&&e.hasOwnProperty("srcId")&&t.uint32(74).string(e.srcId),null!=e.dstId&&e.hasOwnProperty("dstId")&&t.uint32(82).string(e.dstId),null!=e.dstType&&e.hasOwnProperty("dstType")&&t.uint32(88).int32(e.dstType),null!=e.messageId&&e.hasOwnProperty("messageId")&&t.uint32(96).int64(e.messageId),null!=e.errCode&&e.hasOwnProperty("errCode")&&t.uint32(104).int32(e.errCode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.TxMessageRes;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.insId=e.int64();break;case 7:r.dialId=e.int64();break;case 8:r.seq=e.int64();break;case 9:r.srcId=e.string();break;case 10:r.dstId=e.string();break;case 11:r.dstType=e.int32();break;case 12:r.messageId=e.int64();break;case 13:r.errCode=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.insId&&e.hasOwnProperty("insId")&&!($util$1.isInteger(e.insId)||e.insId&&$util$1.isInteger(e.insId.low)&&$util$1.isInteger(e.insId.high))?"insId: integer|Long expected":null!=e.dialId&&e.hasOwnProperty("dialId")&&!($util$1.isInteger(e.dialId)||e.dialId&&$util$1.isInteger(e.dialId.low)&&$util$1.isInteger(e.dialId.high))?"dialId: integer|Long expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util$1.isInteger(e.seq)||e.seq&&$util$1.isInteger(e.seq.low)&&$util$1.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.srcId&&e.hasOwnProperty("srcId")&&!$util$1.isString(e.srcId)?"srcId: string expected":null!=e.dstId&&e.hasOwnProperty("dstId")&&!$util$1.isString(e.dstId)?"dstId: string expected":null!=e.dstType&&e.hasOwnProperty("dstType")&&!$util$1.isInteger(e.dstType)?"dstType: integer expected":null!=e.messageId&&e.hasOwnProperty("messageId")&&!($util$1.isInteger(e.messageId)||e.messageId&&$util$1.isInteger(e.messageId.low)&&$util$1.isInteger(e.messageId.high))?"messageId: integer|Long expected":null!=e.errCode&&e.hasOwnProperty("errCode")&&!$util$1.isInteger(e.errCode)?"errCode: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.TxMessageRes)return e;var t=new $root$1.TxMessageRes;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.insId&&($util$1.Long?(t.insId=$util$1.Long.fromValue(e.insId)).unsigned=!1:"string"==typeof e.insId?t.insId=parseInt(e.insId,10):"number"==typeof e.insId?t.insId=e.insId:"object"===_typeof(e.insId)&&(t.insId=new $util$1.LongBits(e.insId.low>>>0,e.insId.high>>>0).toNumber())),null!=e.dialId&&($util$1.Long?(t.dialId=$util$1.Long.fromValue(e.dialId)).unsigned=!1:"string"==typeof e.dialId?t.dialId=parseInt(e.dialId,10):"number"==typeof e.dialId?t.dialId=e.dialId:"object"===_typeof(e.dialId)&&(t.dialId=new $util$1.LongBits(e.dialId.low>>>0,e.dialId.high>>>0).toNumber())),null!=e.seq&&($util$1.Long?(t.seq=$util$1.Long.fromValue(e.seq)).unsigned=!1:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util$1.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber())),null!=e.srcId&&(t.srcId=String(e.srcId)),null!=e.dstId&&(t.dstId=String(e.dstId)),null!=e.dstType&&(t.dstType=0|e.dstType),null!=e.messageId&&($util$1.Long?(t.messageId=$util$1.Long.fromValue(e.messageId)).unsigned=!1:"string"==typeof e.messageId?t.messageId=parseInt(e.messageId,10):"number"==typeof e.messageId?t.messageId=e.messageId:"object"===_typeof(e.messageId)&&(t.messageId=new $util$1.LongBits(e.messageId.low>>>0,e.messageId.high>>>0).toNumber())),null!=e.errCode&&(t.errCode=0|e.errCode),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;if($util$1.Long){var o=new $util$1.Long(0,0,!1);n.insId=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.insId=t.longs===String?"0":0;if($util$1.Long){var a=new $util$1.Long(0,0,!1);n.dialId=t.longs===String?a.toString():t.longs===Number?a.toNumber():a}else n.dialId=t.longs===String?"0":0;if($util$1.Long){var s=new $util$1.Long(0,0,!1);n.seq=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else n.seq=t.longs===String?"0":0;if(n.srcId="",n.dstId="",n.dstType=0,$util$1.Long){var u=new $util$1.Long(0,0,!1);n.messageId=t.longs===String?u.toString():t.longs===Number?u.toNumber():u}else n.messageId=t.longs===String?"0":0;n.errCode=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.insId&&e.hasOwnProperty("insId")&&("number"==typeof e.insId?n.insId=t.longs===String?String(e.insId):e.insId:n.insId=t.longs===String?$util$1.Long.prototype.toString.call(e.insId):t.longs===Number?new $util$1.LongBits(e.insId.low>>>0,e.insId.high>>>0).toNumber():e.insId),null!=e.dialId&&e.hasOwnProperty("dialId")&&("number"==typeof e.dialId?n.dialId=t.longs===String?String(e.dialId):e.dialId:n.dialId=t.longs===String?$util$1.Long.prototype.toString.call(e.dialId):t.longs===Number?new $util$1.LongBits(e.dialId.low>>>0,e.dialId.high>>>0).toNumber():e.dialId),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util$1.Long.prototype.toString.call(e.seq):t.longs===Number?new $util$1.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber():e.seq),null!=e.srcId&&e.hasOwnProperty("srcId")&&(n.srcId=e.srcId),null!=e.dstId&&e.hasOwnProperty("dstId")&&(n.dstId=e.dstId),null!=e.dstType&&e.hasOwnProperty("dstType")&&(n.dstType=e.dstType),null!=e.messageId&&e.hasOwnProperty("messageId")&&("number"==typeof e.messageId?n.messageId=t.longs===String?String(e.messageId):e.messageId:n.messageId=t.longs===String?$util$1.Long.prototype.toString.call(e.messageId):t.longs===Number?new $util$1.LongBits(e.messageId.low>>>0,e.messageId.high>>>0).toNumber():e.messageId),null!=e.errCode&&e.hasOwnProperty("errCode")&&(n.errCode=e.errCode),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),ChnJoin=$root$1.ChnJoin=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&t.uint32(50).string(e.cname),null!=e.errCode&&e.hasOwnProperty("errCode")&&t.uint32(56).int32(e.errCode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.ChnJoin;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.cname=e.string();break;case 7:r.errCode=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.cname&&e.hasOwnProperty("cname")&&!$util$1.isString(e.cname)?"cname: string expected":null!=e.errCode&&e.hasOwnProperty("errCode")&&!$util$1.isInteger(e.errCode)?"errCode: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.ChnJoin)return e;var t=new $root$1.ChnJoin;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.cname&&(t.cname=String(e.cname)),null!=e.errCode&&(t.errCode=0|e.errCode),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.cname="",n.errCode=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&(n.cname=e.cname),null!=e.errCode&&e.hasOwnProperty("errCode")&&(n.errCode=e.errCode),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),ChnJoinRes=$root$1.ChnJoinRes=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.prototype.serverErrCode=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&t.uint32(50).string(e.cname),null!=e.errCode&&e.hasOwnProperty("errCode")&&t.uint32(56).int32(e.errCode),null!=e.serverErrCode&&e.hasOwnProperty("serverErrCode")&&t.uint32(64).int32(e.serverErrCode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.ChnJoinRes;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.cname=e.string();break;case 7:r.errCode=e.int32();break;case 8:r.serverErrCode=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.cname&&e.hasOwnProperty("cname")&&!$util$1.isString(e.cname)?"cname: string expected":null!=e.errCode&&e.hasOwnProperty("errCode")&&!$util$1.isInteger(e.errCode)?"errCode: integer expected":null!=e.serverErrCode&&e.hasOwnProperty("serverErrCode")&&!$util$1.isInteger(e.serverErrCode)?"serverErrCode: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.ChnJoinRes)return e;var t=new $root$1.ChnJoinRes;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.cname&&(t.cname=String(e.cname)),null!=e.errCode&&(t.errCode=0|e.errCode),null!=e.serverErrCode&&(t.serverErrCode=0|e.serverErrCode),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.cname="",n.errCode=0,n.serverErrCode=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&(n.cname=e.cname),null!=e.errCode&&e.hasOwnProperty("errCode")&&(n.errCode=e.errCode),null!=e.serverErrCode&&e.hasOwnProperty("serverErrCode")&&(n.serverErrCode=e.serverErrCode),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),ChnLeave=$root$1.ChnLeave=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&t.uint32(50).string(e.cname),null!=e.errCode&&e.hasOwnProperty("errCode")&&t.uint32(56).int32(e.errCode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.ChnLeave;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.cname=e.string();break;case 7:r.errCode=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.cname&&e.hasOwnProperty("cname")&&!$util$1.isString(e.cname)?"cname: string expected":null!=e.errCode&&e.hasOwnProperty("errCode")&&!$util$1.isInteger(e.errCode)?"errCode: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.ChnLeave)return e;var t=new $root$1.ChnLeave;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.cname&&(t.cname=String(e.cname)),null!=e.errCode&&(t.errCode=0|e.errCode),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.cname="",n.errCode=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&(n.cname=e.cname),null!=e.errCode&&e.hasOwnProperty("errCode")&&(n.errCode=e.errCode),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),ChnGetMembers=$root$1.ChnGetMembers=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&t.uint32(50).string(e.cname),null!=e.errCode&&e.hasOwnProperty("errCode")&&t.uint32(56).int32(e.errCode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.ChnGetMembers;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.cname=e.string();break;case 7:r.errCode=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.cname&&e.hasOwnProperty("cname")&&!$util$1.isString(e.cname)?"cname: string expected":null!=e.errCode&&e.hasOwnProperty("errCode")&&!$util$1.isInteger(e.errCode)?"errCode: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.ChnGetMembers)return e;var t=new $root$1.ChnGetMembers;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.cname&&(t.cname=String(e.cname)),null!=e.errCode&&(t.errCode=0|e.errCode),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.cname="",n.errCode=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&(n.cname=e.cname),null!=e.errCode&&e.hasOwnProperty("errCode")&&(n.errCode=e.errCode),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),ChnGetMembersRes=$root$1.ChnGetMembersRes=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.prototype.size=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&t.uint32(50).string(e.cname),null!=e.errCode&&e.hasOwnProperty("errCode")&&t.uint32(56).int32(e.errCode),null!=e.size&&e.hasOwnProperty("size")&&t.uint32(64).int32(e.size),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.ChnGetMembersRes;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.cname=e.string();break;case 7:r.errCode=e.int32();break;case 8:r.size=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.cname&&e.hasOwnProperty("cname")&&!$util$1.isString(e.cname)?"cname: string expected":null!=e.errCode&&e.hasOwnProperty("errCode")&&!$util$1.isInteger(e.errCode)?"errCode: integer expected":null!=e.size&&e.hasOwnProperty("size")&&!$util$1.isInteger(e.size)?"size: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.ChnGetMembersRes)return e;var t=new $root$1.ChnGetMembersRes;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.cname&&(t.cname=String(e.cname)),null!=e.errCode&&(t.errCode=0|e.errCode),null!=e.size&&(t.size=0|e.size),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.cname="",n.errCode=0,n.size=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&(n.cname=e.cname),null!=e.errCode&&e.hasOwnProperty("errCode")&&(n.errCode=e.errCode),null!=e.size&&e.hasOwnProperty("size")&&(n.size=e.size),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),ChnMemberJoined=$root$1.ChnMemberJoined=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.memberId="",e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&t.uint32(50).string(e.cname),null!=e.memberId&&e.hasOwnProperty("memberId")&&t.uint32(58).string(e.memberId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.ChnMemberJoined;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.cname=e.string();break;case 7:r.memberId=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.cname&&e.hasOwnProperty("cname")&&!$util$1.isString(e.cname)?"cname: string expected":null!=e.memberId&&e.hasOwnProperty("memberId")&&!$util$1.isString(e.memberId)?"memberId: string expected":null},e.fromObject=function(e){if(e instanceof $root$1.ChnMemberJoined)return e;var t=new $root$1.ChnMemberJoined;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.cname&&(t.cname=String(e.cname)),null!=e.memberId&&(t.memberId=String(e.memberId)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.cname="",n.memberId=""}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&(n.cname=e.cname),null!=e.memberId&&e.hasOwnProperty("memberId")&&(n.memberId=e.memberId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),ChnMemberLeft=$root$1.ChnMemberLeft=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.memberId="",e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&t.uint32(50).string(e.cname),null!=e.memberId&&e.hasOwnProperty("memberId")&&t.uint32(58).string(e.memberId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.ChnMemberLeft;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.cname=e.string();break;case 7:r.memberId=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.cname&&e.hasOwnProperty("cname")&&!$util$1.isString(e.cname)?"cname: string expected":null!=e.memberId&&e.hasOwnProperty("memberId")&&!$util$1.isString(e.memberId)?"memberId: string expected":null},e.fromObject=function(e){if(e instanceof $root$1.ChnMemberLeft)return e;var t=new $root$1.ChnMemberLeft;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.cname&&(t.cname=String(e.cname)),null!=e.memberId&&(t.memberId=String(e.memberId)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.cname="",n.memberId=""}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&(n.cname=e.cname),null!=e.memberId&&e.hasOwnProperty("memberId")&&(n.memberId=e.memberId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),QueryPeersOnlineStatus=$root$1.QueryPeersOnlineStatus=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.peerCount=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.peerCount&&e.hasOwnProperty("peerCount")&&t.uint32(48).int32(e.peerCount),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.QueryPeersOnlineStatus;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.peerCount=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.peerCount&&e.hasOwnProperty("peerCount")&&!$util$1.isInteger(e.peerCount)?"peerCount: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.QueryPeersOnlineStatus)return e;var t=new $root$1.QueryPeersOnlineStatus;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.peerCount&&(t.peerCount=0|e.peerCount),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.peerCount=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.peerCount&&e.hasOwnProperty("peerCount")&&(n.peerCount=e.peerCount),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),QueryPeersOnlineStatusRes=$root$1.QueryPeersOnlineStatusRes=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.peerCount=0,e.prototype.errCode=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.peerCount&&e.hasOwnProperty("peerCount")&&t.uint32(48).int32(e.peerCount),null!=e.errCode&&e.hasOwnProperty("errCode")&&t.uint32(56).int32(e.errCode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.QueryPeersOnlineStatusRes;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.peerCount=e.int32();break;case 7:r.errCode=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.peerCount&&e.hasOwnProperty("peerCount")&&!$util$1.isInteger(e.peerCount)?"peerCount: integer expected":null!=e.errCode&&e.hasOwnProperty("errCode")&&!$util$1.isInteger(e.errCode)?"errCode: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.QueryPeersOnlineStatusRes)return e;var t=new $root$1.QueryPeersOnlineStatusRes;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.peerCount&&(t.peerCount=0|e.peerCount),null!=e.errCode&&(t.errCode=0|e.errCode),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.peerCount=0,n.errCode=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.peerCount&&e.hasOwnProperty("peerCount")&&(n.peerCount=e.peerCount),null!=e.errCode&&e.hasOwnProperty("errCode")&&(n.errCode=e.errCode),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),RenewToken=$root$1.RenewToken=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.token="",e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&t.uint32(50).string(e.cname),null!=e.token&&e.hasOwnProperty("token")&&t.uint32(58).string(e.token),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.RenewToken;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 6:r.cname=e.string();break;case 7:r.token=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.cname&&e.hasOwnProperty("cname")&&!$util$1.isString(e.cname)?"cname: string expected":null!=e.token&&e.hasOwnProperty("token")&&!$util$1.isString(e.token)?"token: string expected":null},e.fromObject=function(e){if(e instanceof $root$1.RenewToken)return e;var t=new $root$1.RenewToken;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.cname&&(t.cname=String(e.cname)),null!=e.token&&(t.token=String(e.token)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.cname="",n.token=""}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&(n.cname=e.cname),null!=e.token&&e.hasOwnProperty("token")&&(n.token=e.token),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),OperateAttribute=$root$1.OperateAttribute=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.destId="",e.prototype.attributeType=0,e.prototype.operationType=0,e.prototype.seq=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&t.uint32(42).string(e.cname),null!=e.destId&&e.hasOwnProperty("destId")&&t.uint32(50).string(e.destId),null!=e.attributeType&&e.hasOwnProperty("attributeType")&&t.uint32(56).int32(e.attributeType),null!=e.operationType&&e.hasOwnProperty("operationType")&&t.uint32(64).int32(e.operationType),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(72).int64(e.seq),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.OperateAttribute;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 5:r.cname=e.string();break;case 6:r.destId=e.string();break;case 7:r.attributeType=e.int32();break;case 8:r.operationType=e.int32();break;case 9:r.seq=e.int64();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.cname&&e.hasOwnProperty("cname")&&!$util$1.isString(e.cname)?"cname: string expected":null!=e.destId&&e.hasOwnProperty("destId")&&!$util$1.isString(e.destId)?"destId: string expected":null!=e.attributeType&&e.hasOwnProperty("attributeType")&&!$util$1.isInteger(e.attributeType)?"attributeType: integer expected":null!=e.operationType&&e.hasOwnProperty("operationType")&&!$util$1.isInteger(e.operationType)?"operationType: integer expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util$1.isInteger(e.seq)||e.seq&&$util$1.isInteger(e.seq.low)&&$util$1.isInteger(e.seq.high))?"seq: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root$1.OperateAttribute)return e;var t=new $root$1.OperateAttribute;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.cname&&(t.cname=String(e.cname)),null!=e.destId&&(t.destId=String(e.destId)),null!=e.attributeType&&(t.attributeType=0|e.attributeType),null!=e.operationType&&(t.operationType=0|e.operationType),null!=e.seq&&($util$1.Long?(t.seq=$util$1.Long.fromValue(e.seq)).unsigned=!1:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util$1.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;if(n.cname="",n.destId="",n.attributeType=0,n.operationType=0,$util$1.Long){var o=new $util$1.Long(0,0,!1);n.seq=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.seq=t.longs===String?"0":0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&(n.cname=e.cname),null!=e.destId&&e.hasOwnProperty("destId")&&(n.destId=e.destId),null!=e.attributeType&&e.hasOwnProperty("attributeType")&&(n.attributeType=e.attributeType),null!=e.operationType&&e.hasOwnProperty("operationType")&&(n.operationType=e.operationType),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util$1.Long.prototype.toString.call(e.seq):t.longs===Number?new $util$1.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber():e.seq),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),OperateAttributeRes=$root$1.OperateAttributeRes=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.destId="",e.prototype.attributeType=0,e.prototype.seq=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&t.uint32(42).string(e.cname),null!=e.destId&&e.hasOwnProperty("destId")&&t.uint32(50).string(e.destId),null!=e.attributeType&&e.hasOwnProperty("attributeType")&&t.uint32(56).int32(e.attributeType),null!=e.seq&&e.hasOwnProperty("seq")&&t.uint32(64).int64(e.seq),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(72).int32(e.code),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.OperateAttributeRes;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 5:r.cname=e.string();break;case 6:r.destId=e.string();break;case 7:r.attributeType=e.int32();break;case 8:r.seq=e.int64();break;case 9:r.code=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.cname&&e.hasOwnProperty("cname")&&!$util$1.isString(e.cname)?"cname: string expected":null!=e.destId&&e.hasOwnProperty("destId")&&!$util$1.isString(e.destId)?"destId: string expected":null!=e.attributeType&&e.hasOwnProperty("attributeType")&&!$util$1.isInteger(e.attributeType)?"attributeType: integer expected":null!=e.seq&&e.hasOwnProperty("seq")&&!($util$1.isInteger(e.seq)||e.seq&&$util$1.isInteger(e.seq.low)&&$util$1.isInteger(e.seq.high))?"seq: integer|Long expected":null!=e.code&&e.hasOwnProperty("code")&&!$util$1.isInteger(e.code)?"code: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.OperateAttributeRes)return e;var t=new $root$1.OperateAttributeRes;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.cname&&(t.cname=String(e.cname)),null!=e.destId&&(t.destId=String(e.destId)),null!=e.attributeType&&(t.attributeType=0|e.attributeType),null!=e.seq&&($util$1.Long?(t.seq=$util$1.Long.fromValue(e.seq)).unsigned=!1:"string"==typeof e.seq?t.seq=parseInt(e.seq,10):"number"==typeof e.seq?t.seq=e.seq:"object"===_typeof(e.seq)&&(t.seq=new $util$1.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber())),null!=e.code&&(t.code=0|e.code),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;if(n.cname="",n.destId="",n.attributeType=0,$util$1.Long){var o=new $util$1.Long(0,0,!1);n.seq=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.seq=t.longs===String?"0":0;n.code=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.cname&&e.hasOwnProperty("cname")&&(n.cname=e.cname),null!=e.destId&&e.hasOwnProperty("destId")&&(n.destId=e.destId),null!=e.attributeType&&e.hasOwnProperty("attributeType")&&(n.attributeType=e.attributeType),null!=e.seq&&e.hasOwnProperty("seq")&&("number"==typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$util$1.Long.prototype.toString.call(e.seq):t.longs===Number?new $util$1.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber():e.seq),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),ApRequest=$root$1.ApRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.apAddr="",e.prototype.opId=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.envId=0,e.prototype.flag=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.apAddr&&e.hasOwnProperty("apAddr")&&t.uint32(42).string(e.apAddr),null!=e.opId&&e.hasOwnProperty("opId")&&t.uint32(48).int64(e.opId),null!=e.envId&&e.hasOwnProperty("envId")&&t.uint32(56).int32(e.envId),null!=e.flag&&e.hasOwnProperty("flag")&&t.uint32(64).int32(e.flag),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.ApRequest;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 5:r.apAddr=e.string();break;case 6:r.opId=e.int64();break;case 7:r.envId=e.int32();break;case 8:r.flag=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.apAddr&&e.hasOwnProperty("apAddr")&&!$util$1.isString(e.apAddr)?"apAddr: string expected":null!=e.opId&&e.hasOwnProperty("opId")&&!($util$1.isInteger(e.opId)||e.opId&&$util$1.isInteger(e.opId.low)&&$util$1.isInteger(e.opId.high))?"opId: integer|Long expected":null!=e.envId&&e.hasOwnProperty("envId")&&!$util$1.isInteger(e.envId)?"envId: integer expected":null!=e.flag&&e.hasOwnProperty("flag")&&!$util$1.isInteger(e.flag)?"flag: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.ApRequest)return e;var t=new $root$1.ApRequest;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.apAddr&&(t.apAddr=String(e.apAddr)),null!=e.opId&&($util$1.Long?(t.opId=$util$1.Long.fromValue(e.opId)).unsigned=!1:"string"==typeof e.opId?t.opId=parseInt(e.opId,10):"number"==typeof e.opId?t.opId=e.opId:"object"===_typeof(e.opId)&&(t.opId=new $util$1.LongBits(e.opId.low>>>0,e.opId.high>>>0).toNumber())),null!=e.envId&&(t.envId=0|e.envId),null!=e.flag&&(t.flag=0|e.flag),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;if(n.apAddr="",$util$1.Long){var o=new $util$1.Long(0,0,!1);n.opId=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.opId=t.longs===String?"0":0;n.envId=0,n.flag=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.apAddr&&e.hasOwnProperty("apAddr")&&(n.apAddr=e.apAddr),null!=e.opId&&e.hasOwnProperty("opId")&&("number"==typeof e.opId?n.opId=t.longs===String?String(e.opId):e.opId:n.opId=t.longs===String?$util$1.Long.prototype.toString.call(e.opId):t.longs===Number?new $util$1.LongBits(e.opId.low>>>0,e.opId.high>>>0).toNumber():e.opId),null!=e.envId&&e.hasOwnProperty("envId")&&(n.envId=e.envId),null!=e.flag&&e.hasOwnProperty("flag")&&(n.flag=e.flag),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),LinkTcpEvent=$root$1.LinkTcpEvent=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.destServerIp="",e.prototype.action="",e.prototype.code=0,e.prototype.responseTime=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.destServerIp&&e.hasOwnProperty("destServerIp")&&t.uint32(42).string(e.destServerIp),null!=e.action&&e.hasOwnProperty("action")&&t.uint32(50).string(e.action),null!=e.code&&e.hasOwnProperty("code")&&t.uint32(56).int32(e.code),null!=e.responseTime&&e.hasOwnProperty("responseTime")&&t.uint32(64).int32(e.responseTime),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.LinkTcpEvent;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 5:r.destServerIp=e.string();break;case 6:r.action=e.string();break;case 7:r.code=e.int32();break;case 8:r.responseTime=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.destServerIp&&e.hasOwnProperty("destServerIp")&&!$util$1.isString(e.destServerIp)?"destServerIp: string expected":null!=e.action&&e.hasOwnProperty("action")&&!$util$1.isString(e.action)?"action: string expected":null!=e.code&&e.hasOwnProperty("code")&&!$util$1.isInteger(e.code)?"code: integer expected":null!=e.responseTime&&e.hasOwnProperty("responseTime")&&!$util$1.isInteger(e.responseTime)?"responseTime: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.LinkTcpEvent)return e;var t=new $root$1.LinkTcpEvent;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.destServerIp&&(t.destServerIp=String(e.destServerIp)),null!=e.action&&(t.action=String(e.action)),null!=e.code&&(t.code=0|e.code),null!=e.responseTime&&(t.responseTime=0|e.responseTime),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.destServerIp="",n.action="",n.code=0,n.responseTime=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.destServerIp&&e.hasOwnProperty("destServerIp")&&(n.destServerIp=e.destServerIp),null!=e.action&&e.hasOwnProperty("action")&&(n.action=e.action),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),null!=e.responseTime&&e.hasOwnProperty("responseTime")&&(n.responseTime=e.responseTime),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),LinkLoginRequest=$root$1.LinkLoginRequest=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.destServerIp="",e.prototype.linkId=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.destServerIp&&e.hasOwnProperty("destServerIp")&&t.uint32(42).string(e.destServerIp),null!=e.linkId&&e.hasOwnProperty("linkId")&&t.uint32(48).int32(e.linkId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.LinkLoginRequest;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 5:r.destServerIp=e.string();break;case 6:r.linkId=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.destServerIp&&e.hasOwnProperty("destServerIp")&&!$util$1.isString(e.destServerIp)?"destServerIp: string expected":null!=e.linkId&&e.hasOwnProperty("linkId")&&!$util$1.isInteger(e.linkId)?"linkId: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.LinkLoginRequest)return e;var t=new $root$1.LinkLoginRequest;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.destServerIp&&(t.destServerIp=String(e.destServerIp)),null!=e.linkId&&(t.linkId=0|e.linkId),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.destServerIp="",n.linkId=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.destServerIp&&e.hasOwnProperty("destServerIp")&&(n.destServerIp=e.destServerIp),null!=e.linkId&&e.hasOwnProperty("linkId")&&(n.linkId=e.linkId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),ConnectionStateChange=$root$1.ConnectionStateChange=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.oldState=0,e.prototype.newState=0,e.prototype.reason=0,e.prototype.reconnId=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&t.uint32(18).string(e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(32).int64(e.elapse),null!=e.oldState&&e.hasOwnProperty("oldState")&&t.uint32(40).int32(e.oldState),null!=e.newState&&e.hasOwnProperty("newState")&&t.uint32(48).int32(e.newState),null!=e.reason&&e.hasOwnProperty("reason")&&t.uint32(56).int32(e.reason),null!=e.reconnId&&e.hasOwnProperty("reconnId")&&t.uint32(64).int32(e.reconnId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.ConnectionStateChange;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.userId=e.string();break;case 3:r.lts=e.int64();break;case 4:r.elapse=e.int64();break;case 5:r.oldState=e.int32();break;case 6:r.newState=e.int32();break;case 7:r.reason=e.int32();break;case 8:r.reconnId=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.userId&&e.hasOwnProperty("userId")&&!$util$1.isString(e.userId)?"userId: string expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.oldState&&e.hasOwnProperty("oldState")&&!$util$1.isInteger(e.oldState)?"oldState: integer expected":null!=e.newState&&e.hasOwnProperty("newState")&&!$util$1.isInteger(e.newState)?"newState: integer expected":null!=e.reason&&e.hasOwnProperty("reason")&&!$util$1.isInteger(e.reason)?"reason: integer expected":null!=e.reconnId&&e.hasOwnProperty("reconnId")&&!$util$1.isInteger(e.reconnId)?"reconnId: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.ConnectionStateChange)return e;var t=new $root$1.ConnectionStateChange;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.userId&&(t.userId=String(e.userId)),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.oldState&&(t.oldState=0|e.oldState),null!=e.newState&&(t.newState=0|e.newState),null!=e.reason&&(t.reason=0|e.reason),null!=e.reconnId&&(t.reconnId=0|e.reconnId),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.userId="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.elapse=t.longs===String?"0":0;n.oldState=0,n.newState=0,n.reason=0,n.reconnId=0}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.userId&&e.hasOwnProperty("userId")&&(n.userId=e.userId),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.oldState&&e.hasOwnProperty("oldState")&&(n.oldState=e.oldState),null!=e.newState&&e.hasOwnProperty("newState")&&(n.newState=e.newState),null!=e.reason&&e.hasOwnProperty("reason")&&(n.reason=e.reason),null!=e.reconnId&&e.hasOwnProperty("reconnId")&&(n.reconnId=e.reconnId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),ApiExec=$root$1.ApiExec=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.cname="",e.prototype.cid=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.ip="",e.prototype.uid=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.success=!1,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.peer=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.apiPayload="",e.prototype.isCache=!1,e.prototype.isNotificationSuppressed=!1,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.cname&&e.hasOwnProperty("cname")&&t.uint32(18).string(e.cname),null!=e.cid&&e.hasOwnProperty("cid")&&t.uint32(24).int64(e.cid),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(32).int64(e.lts),null!=e.ip&&e.hasOwnProperty("ip")&&t.uint32(42).string(e.ip),null!=e.uid&&e.hasOwnProperty("uid")&&t.uint32(48).int64(e.uid),null!=e.success&&e.hasOwnProperty("success")&&t.uint32(56).bool(e.success),null!=e.elapse&&e.hasOwnProperty("elapse")&&t.uint32(64).int64(e.elapse),null!=e.peer&&e.hasOwnProperty("peer")&&t.uint32(72).int64(e.peer),null!=e.apiPayload&&e.hasOwnProperty("apiPayload")&&t.uint32(82).string(e.apiPayload),null!=e.isCache&&e.hasOwnProperty("isCache")&&t.uint32(88).bool(e.isCache),null!=e.isNotificationSuppressed&&e.hasOwnProperty("isNotificationSuppressed")&&t.uint32(96).bool(e.isNotificationSuppressed),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.ApiExec;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.cname=e.string();break;case 3:r.cid=e.int64();break;case 4:r.lts=e.int64();break;case 5:r.ip=e.string();break;case 6:r.uid=e.int64();break;case 7:r.success=e.bool();break;case 8:r.elapse=e.int64();break;case 9:r.peer=e.int64();break;case 10:r.apiPayload=e.string();break;case 11:r.isCache=e.bool();break;case 12:r.isNotificationSuppressed=e.bool();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid)?"sid: string expected":null!=e.cname&&e.hasOwnProperty("cname")&&!$util$1.isString(e.cname)?"cname: string expected":null!=e.cid&&e.hasOwnProperty("cid")&&!($util$1.isInteger(e.cid)||e.cid&&$util$1.isInteger(e.cid.low)&&$util$1.isInteger(e.cid.high))?"cid: integer|Long expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.ip&&e.hasOwnProperty("ip")&&!$util$1.isString(e.ip)?"ip: string expected":null!=e.uid&&e.hasOwnProperty("uid")&&!($util$1.isInteger(e.uid)||e.uid&&$util$1.isInteger(e.uid.low)&&$util$1.isInteger(e.uid.high))?"uid: integer|Long expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!=typeof e.success?"success: boolean expected":null!=e.elapse&&e.hasOwnProperty("elapse")&&!($util$1.isInteger(e.elapse)||e.elapse&&$util$1.isInteger(e.elapse.low)&&$util$1.isInteger(e.elapse.high))?"elapse: integer|Long expected":null!=e.peer&&e.hasOwnProperty("peer")&&!($util$1.isInteger(e.peer)||e.peer&&$util$1.isInteger(e.peer.low)&&$util$1.isInteger(e.peer.high))?"peer: integer|Long expected":null!=e.apiPayload&&e.hasOwnProperty("apiPayload")&&!$util$1.isString(e.apiPayload)?"apiPayload: string expected":null!=e.isCache&&e.hasOwnProperty("isCache")&&"boolean"!=typeof e.isCache?"isCache: boolean expected":null!=e.isNotificationSuppressed&&e.hasOwnProperty("isNotificationSuppressed")&&"boolean"!=typeof e.isNotificationSuppressed?"isNotificationSuppressed: boolean expected":null},e.fromObject=function(e){if(e instanceof $root$1.ApiExec)return e;var t=new $root$1.ApiExec;return null!=e.sid&&(t.sid=String(e.sid)),null!=e.cname&&(t.cname=String(e.cname)),null!=e.cid&&($util$1.Long?(t.cid=$util$1.Long.fromValue(e.cid)).unsigned=!1:"string"==typeof e.cid?t.cid=parseInt(e.cid,10):"number"==typeof e.cid?t.cid=e.cid:"object"===_typeof(e.cid)&&(t.cid=new $util$1.LongBits(e.cid.low>>>0,e.cid.high>>>0).toNumber())),null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.ip&&(t.ip=String(e.ip)),null!=e.uid&&($util$1.Long?(t.uid=$util$1.Long.fromValue(e.uid)).unsigned=!1:"string"==typeof e.uid?t.uid=parseInt(e.uid,10):"number"==typeof e.uid?t.uid=e.uid:"object"===_typeof(e.uid)&&(t.uid=new $util$1.LongBits(e.uid.low>>>0,e.uid.high>>>0).toNumber())),null!=e.success&&(t.success=Boolean(e.success)),null!=e.elapse&&($util$1.Long?(t.elapse=$util$1.Long.fromValue(e.elapse)).unsigned=!1:"string"==typeof e.elapse?t.elapse=parseInt(e.elapse,10):"number"==typeof e.elapse?t.elapse=e.elapse:"object"===_typeof(e.elapse)&&(t.elapse=new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber())),null!=e.peer&&($util$1.Long?(t.peer=$util$1.Long.fromValue(e.peer)).unsigned=!1:"string"==typeof e.peer?t.peer=parseInt(e.peer,10):"number"==typeof e.peer?t.peer=e.peer:"object"===_typeof(e.peer)&&(t.peer=new $util$1.LongBits(e.peer.low>>>0,e.peer.high>>>0).toNumber())),null!=e.apiPayload&&(t.apiPayload=String(e.apiPayload)),null!=e.isCache&&(t.isCache=Boolean(e.isCache)),null!=e.isNotificationSuppressed&&(t.isNotificationSuppressed=Boolean(e.isNotificationSuppressed)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.sid="",n.cname="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.cid=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.cid=t.longs===String?"0":0;if($util$1.Long){var i=new $util$1.Long(0,0,!1);n.lts=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.lts=t.longs===String?"0":0;if(n.ip="",$util$1.Long){var o=new $util$1.Long(0,0,!1);n.uid=t.longs===String?o.toString():t.longs===Number?o.toNumber():o}else n.uid=t.longs===String?"0":0;if(n.success=!1,$util$1.Long){var a=new $util$1.Long(0,0,!1);n.elapse=t.longs===String?a.toString():t.longs===Number?a.toNumber():a}else n.elapse=t.longs===String?"0":0;if($util$1.Long){var s=new $util$1.Long(0,0,!1);n.peer=t.longs===String?s.toString():t.longs===Number?s.toNumber():s}else n.peer=t.longs===String?"0":0;n.apiPayload="",n.isCache=!1,n.isNotificationSuppressed=!1}return null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.cname&&e.hasOwnProperty("cname")&&(n.cname=e.cname),null!=e.cid&&e.hasOwnProperty("cid")&&("number"==typeof e.cid?n.cid=t.longs===String?String(e.cid):e.cid:n.cid=t.longs===String?$util$1.Long.prototype.toString.call(e.cid):t.longs===Number?new $util$1.LongBits(e.cid.low>>>0,e.cid.high>>>0).toNumber():e.cid),null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.ip&&e.hasOwnProperty("ip")&&(n.ip=e.ip),null!=e.uid&&e.hasOwnProperty("uid")&&("number"==typeof e.uid?n.uid=t.longs===String?String(e.uid):e.uid:n.uid=t.longs===String?$util$1.Long.prototype.toString.call(e.uid):t.longs===Number?new $util$1.LongBits(e.uid.low>>>0,e.uid.high>>>0).toNumber():e.uid),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.elapse&&e.hasOwnProperty("elapse")&&("number"==typeof e.elapse?n.elapse=t.longs===String?String(e.elapse):e.elapse:n.elapse=t.longs===String?$util$1.Long.prototype.toString.call(e.elapse):t.longs===Number?new $util$1.LongBits(e.elapse.low>>>0,e.elapse.high>>>0).toNumber():e.elapse),null!=e.peer&&e.hasOwnProperty("peer")&&("number"==typeof e.peer?n.peer=t.longs===String?String(e.peer):e.peer:n.peer=t.longs===String?$util$1.Long.prototype.toString.call(e.peer):t.longs===Number?new $util$1.LongBits(e.peer.low>>>0,e.peer.high>>>0).toNumber():e.peer),null!=e.apiPayload&&e.hasOwnProperty("apiPayload")&&(n.apiPayload=e.apiPayload),null!=e.isCache&&e.hasOwnProperty("isCache")&&(n.isCache=e.isCache),null!=e.isNotificationSuppressed&&e.hasOwnProperty("isNotificationSuppressed")&&(n.isNotificationSuppressed=e.isNotificationSuppressed),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),Counter=$root$1.Counter=function(){function e(e){if(this.items=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.peer=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.items=$util$1.emptyArray,e.encode=function(e,t){if(t||(t=$Writer$1.create()),null!=e.sid&&e.hasOwnProperty("sid")&&t.uint32(10).string(e.sid),null!=e.peer&&e.hasOwnProperty("peer")&&t.uint32(16).int64(e.peer),null!=e.items&&e.items.length)for(var n=0;n<e.items.length;++n)$root$1.Counter.CounterItem.encode(e.items[n],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.Counter;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sid=e.string();break;case 2:r.peer=e.int64();break;case 3:r.items&&r.items.length||(r.items=[]),r.items.push($root$1.Counter.CounterItem.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==_typeof(e)||null===e)return"object expected";if(null!=e.sid&&e.hasOwnProperty("sid")&&!$util$1.isString(e.sid))return"sid: string expected";if(null!=e.peer&&e.hasOwnProperty("peer")&&!($util$1.isInteger(e.peer)||e.peer&&$util$1.isInteger(e.peer.low)&&$util$1.isInteger(e.peer.high)))return"peer: integer|Long expected";if(null!=e.items&&e.hasOwnProperty("items")){if(!Array.isArray(e.items))return"items: array expected";for(var t=0;t<e.items.length;++t){var n=$root$1.Counter.CounterItem.verify(e.items[t]);if(n)return"items."+n}}return null},e.fromObject=function(e){if(e instanceof $root$1.Counter)return e;var t=new $root$1.Counter;if(null!=e.sid&&(t.sid=String(e.sid)),null!=e.peer&&($util$1.Long?(t.peer=$util$1.Long.fromValue(e.peer)).unsigned=!1:"string"==typeof e.peer?t.peer=parseInt(e.peer,10):"number"==typeof e.peer?t.peer=e.peer:"object"===_typeof(e.peer)&&(t.peer=new $util$1.LongBits(e.peer.low>>>0,e.peer.high>>>0).toNumber())),e.items){if(!Array.isArray(e.items))throw TypeError(".Counter.items: array expected");t.items=[];for(var n=0;n<e.items.length;++n){if("object"!==_typeof(e.items[n]))throw TypeError(".Counter.items: object expected");t.items[n]=$root$1.Counter.CounterItem.fromObject(e.items[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.items=[]),t.defaults)if(n.sid="",$util$1.Long){var r=new $util$1.Long(0,0,!1);n.peer=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.peer=t.longs===String?"0":0;if(null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.peer&&e.hasOwnProperty("peer")&&("number"==typeof e.peer?n.peer=t.longs===String?String(e.peer):e.peer:n.peer=t.longs===String?$util$1.Long.prototype.toString.call(e.peer):t.longs===Number?new $util$1.LongBits(e.peer.low>>>0,e.peer.high>>>0).toNumber():e.peer),e.items&&e.items.length){n.items=[];for(var i=0;i<e.items.length;++i)n.items[i]=$root$1.Counter.CounterItem.toObject(e.items[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e.CounterItem=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.id=0,e.prototype.value=0,e.prototype.tagErrorCode=0,e.prototype.streamId=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.lts&&e.hasOwnProperty("lts")&&t.uint32(8).int64(e.lts),null!=e.id&&e.hasOwnProperty("id")&&t.uint32(16).int32(e.id),null!=e.value&&e.hasOwnProperty("value")&&t.uint32(24).int32(e.value),null!=e.tagErrorCode&&e.hasOwnProperty("tagErrorCode")&&t.uint32(32).int32(e.tagErrorCode),null!=e.streamId&&e.hasOwnProperty("streamId")&&t.uint32(40).uint32(e.streamId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader$1||(e=$Reader$1.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root$1.Counter.CounterItem;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.lts=e.int64();break;case 2:r.id=e.int32();break;case 3:r.value=e.int32();break;case 4:r.tagErrorCode=e.int32();break;case 5:r.streamId=e.uint32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof $Reader$1||(e=new $Reader$1(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==_typeof(e)||null===e?"object expected":null!=e.lts&&e.hasOwnProperty("lts")&&!($util$1.isInteger(e.lts)||e.lts&&$util$1.isInteger(e.lts.low)&&$util$1.isInteger(e.lts.high))?"lts: integer|Long expected":null!=e.id&&e.hasOwnProperty("id")&&!$util$1.isInteger(e.id)?"id: integer expected":null!=e.value&&e.hasOwnProperty("value")&&!$util$1.isInteger(e.value)?"value: integer expected":null!=e.tagErrorCode&&e.hasOwnProperty("tagErrorCode")&&!$util$1.isInteger(e.tagErrorCode)?"tagErrorCode: integer expected":null!=e.streamId&&e.hasOwnProperty("streamId")&&!$util$1.isInteger(e.streamId)?"streamId: integer expected":null},e.fromObject=function(e){if(e instanceof $root$1.Counter.CounterItem)return e;var t=new $root$1.Counter.CounterItem;return null!=e.lts&&($util$1.Long?(t.lts=$util$1.Long.fromValue(e.lts)).unsigned=!1:"string"==typeof e.lts?t.lts=parseInt(e.lts,10):"number"==typeof e.lts?t.lts=e.lts:"object"===_typeof(e.lts)&&(t.lts=new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber())),null!=e.id&&(t.id=0|e.id),null!=e.value&&(t.value=0|e.value),null!=e.tagErrorCode&&(t.tagErrorCode=0|e.tagErrorCode),null!=e.streamId&&(t.streamId=e.streamId>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if($util$1.Long){var r=new $util$1.Long(0,0,!1);n.lts=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.lts=t.longs===String?"0":0;n.id=0,n.value=0,n.tagErrorCode=0,n.streamId=0}return null!=e.lts&&e.hasOwnProperty("lts")&&("number"==typeof e.lts?n.lts=t.longs===String?String(e.lts):e.lts:n.lts=t.longs===String?$util$1.Long.prototype.toString.call(e.lts):t.longs===Number?new $util$1.LongBits(e.lts.low>>>0,e.lts.high>>>0).toNumber():e.lts),null!=e.id&&e.hasOwnProperty("id")&&(n.id=e.id),null!=e.value&&e.hasOwnProperty("value")&&(n.value=e.value),null!=e.tagErrorCode&&e.hasOwnProperty("tagErrorCode")&&(n.tagErrorCode=e.tagErrorCode),null!=e.streamId&&e.hasOwnProperty("streamId")&&(n.streamId=e.streamId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,indexMinimal_6.toJSONOptions)},e}(),e}(),ProtoPackets$1=Object.freeze({Session:Session,ApEvent:ApEvent,Link:Link,Logout:Logout,TxMessage:TxMessage,RxMessage:RxMessage,KickedOff:KickedOff,TxMessageRes:TxMessageRes,ChnJoin:ChnJoin,ChnJoinRes:ChnJoinRes,ChnLeave:ChnLeave,ChnGetMembers:ChnGetMembers,ChnGetMembersRes:ChnGetMembersRes,ChnMemberJoined:ChnMemberJoined,ChnMemberLeft:ChnMemberLeft,QueryPeersOnlineStatus:QueryPeersOnlineStatus,QueryPeersOnlineStatusRes:QueryPeersOnlineStatusRes,RenewToken:RenewToken,OperateAttribute:OperateAttribute,OperateAttributeRes:OperateAttributeRes,ApRequest:ApRequest,LinkTcpEvent:LinkTcpEvent,LinkLoginRequest:LinkLoginRequest,ConnectionStateChange:ConnectionStateChange,ApiExec:ApiExec,Counter:Counter,default:$root$1}),Counter$1=1,ApiExec$1=154,Session$1=164,ApEvent$1=165,Link$1=166,Logout$1=167,TxMessage$1=168,RxMessage$1=169,KickedOff$1=170,TxMessageRes$1=171,ChnJoin$1=172,ChnJoinRes$1=173,ChnLeave$1=174,ChnGetMembers$1=175,ChnGetMembersRes$1=176,ChnMemberJoined$1=177,ChnMemberLeft$1=178,QueryPeersOnlineStatus$1=179,QueryPeersOnlineStatusRes$1=180,RenewToken$1=181,OperateAttribute$1=186,OperateAttributeRes$1=187,ApRequest$1=188,LinkTcpEvent$1=189,LinkLoginRequest$1=190,ConnectionStateChange$1=191,reportId={Counter:Counter$1,ApiExec:ApiExec$1,Session:Session$1,ApEvent:ApEvent$1,Link:Link$1,Logout:Logout$1,TxMessage:TxMessage$1,RxMessage:RxMessage$1,KickedOff:KickedOff$1,TxMessageRes:TxMessageRes$1,ChnJoin:ChnJoin$1,ChnJoinRes:ChnJoinRes$1,ChnLeave:ChnLeave$1,ChnGetMembers:ChnGetMembers$1,ChnGetMembersRes:ChnGetMembersRes$1,ChnMemberJoined:ChnMemberJoined$1,ChnMemberLeft:ChnMemberLeft$1,QueryPeersOnlineStatus:QueryPeersOnlineStatus$1,QueryPeersOnlineStatusRes:QueryPeersOnlineStatusRes$1,RenewToken:RenewToken$1,OperateAttribute:OperateAttribute$1,OperateAttributeRes:OperateAttributeRes$1,ApRequest:ApRequest$1,LinkTcpEvent:LinkTcpEvent$1,LinkLoginRequest:LinkLoginRequest$1,ConnectionStateChange:ConnectionStateChange$1},ReportId=Object.freeze({Counter:Counter$1,ApiExec:ApiExec$1,Session:Session$1,ApEvent:ApEvent$1,Link:Link$1,Logout:Logout$1,TxMessage:TxMessage$1,RxMessage:RxMessage$1,KickedOff:KickedOff$1,TxMessageRes:TxMessageRes$1,ChnJoin:ChnJoin$1,ChnJoinRes:ChnJoinRes$1,ChnLeave:ChnLeave$1,ChnGetMembers:ChnGetMembers$1,ChnGetMembersRes:ChnGetMembersRes$1,ChnMemberJoined:ChnMemberJoined$1,ChnMemberLeft:ChnMemberLeft$1,QueryPeersOnlineStatus:QueryPeersOnlineStatus$1,QueryPeersOnlineStatusRes:QueryPeersOnlineStatusRes$1,RenewToken:RenewToken$1,OperateAttribute:OperateAttribute$1,OperateAttributeRes:OperateAttributeRes$1,ApRequest:ApRequest$1,LinkTcpEvent:LinkTcpEvent$1,LinkLoginRequest:LinkLoginRequest$1,ConnectionStateChange:ConnectionStateChange$1,default:reportId});function asyncGeneratorStep$5(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator$5(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep$5(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep$5(o,r,i,a,s,"throw",e)}a(void 0)}))}}var EVENT_REPORT_DOMAIN="webcollector-rtm.agora.io",EVENT_REPORT_BACKUP_DOMAIN="webcollector-2.agoraio.cn";function sendReport(e,t){return _sendReport.apply(this,arguments)}function _sendReport(){return(_sendReport=_asyncToGenerator$5(regenerator.mark((function e(t,n){var r,i,o;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:return r=ProtoPackets$1[t].encode(n).finish(),(i=new URLSearchParams).append("sentTs",Math.ceil(Date.now()/1e3).toString()),i.append("id",ReportId[t].toString()),o=function(e){return ky.post("https://".concat(e,":6443/events/proto-raw"),{body:r,retry:1,timeout:1e4,searchParams:i,headers:{"Content-Type":"application/octet-stream"},mode:"cors",cache:"no-cache",credentials:"same-origin"})},e.prev=7,e.next=10,o(EVENT_REPORT_DOMAIN);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(7),e.next=16,o(EVENT_REPORT_BACKUP_DOMAIN);case 16:case"end":return e.stop()}}),e,null,[[7,12]])})))).apply(this,arguments)}function getElapse(e){return void 0===e?long_1.fromNumber(0):long_1.fromNumber(Date.now()-e)}function _typeof$6(e){return(_typeof$6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$4(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$4(e,t,n){return t&&_defineProperties$4(e.prototype,t),n&&_defineProperties$4(e,n),e}function _possibleConstructorReturn$6(e,t){return!t||"object"!==_typeof$6(t)&&"function"!=typeof t?_assertThisInitialized$6(e):t}function _assertThisInitialized$6(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf$6(e){return(_getPrototypeOf$6=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$6(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$6(e,t)}function _setPrototypeOf$6(e,t){return(_setPrototypeOf$6=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Context=function(e){function t(e,n){var r;return _classCallCheck$7(this,t),(r=_possibleConstructorReturn$6(this,_getPrototypeOf$6(t).call(this,n,"Context"))).appId=e,r._token=void 0,r._uid=void 0,r._sid=void 0,r._area=void 0,r}return _inherits$6(t,createEventBase()),_createClass$4(t,[{key:"token",set:function(e){this.log("The token is set to %s",e),this._token="string"==typeof e&&e?e:void 0}},{key:"uid",set:function(e){if(this.log("The user ID is set to %s",e),!isValidId(e))throw new RtmInternalError;this._uid=e},get:function(){if("string"==typeof this._uid&&this._uid)return this._uid;throw new RtmInternalError("Cannot get illegal uid")}},{key:"key",get:function(){if("string"==typeof this._token&&this._token)return this._token;if("string"==typeof this.appId&&this.appId)return this.appId;throw new RtmInternalError("Cannot get illegal key")}},{key:"sid",get:function(){if("string"==typeof this._sid&&this._sid)return this._sid;throw new RtmInternalError("Cannot get illegal sid")},set:function(e){if(this.log("sid is set to %s",e),"string"!=typeof e||!e)throw new RtmInternalError;this._sid=e}},{key:"area",get:function(){if("string"==typeof this._area&&this._area)return this._area;throw new RtmInternalError("Cannot get illegal area")},set:function(e){if(this.log("area is set to %s",e),"string"!=typeof e||!e)throw new RtmInternalError("The area is illegal");this._area=e}}]),t}();function compact(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i}var compact_1=compact,common$1=createCommonjsModule((function(e,t){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!==_typeof(n))throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(e[i]=n[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){var t,n,r,i,o,a;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(a=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)o=e[t],a.set(o,i),i+=o.length;return a}},o={arraySet:function(e,t,n,r,i){for(var o=0;o<r;o++)e[i+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(n)})),common_1=common$1.assign,common_2=common$1.shrinkBuf,common_3=common$1.setTyped,common_4=common$1.Buf8,common_5=common$1.Buf16,common_6=common$1.Buf32,Z_FIXED=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN=2;function zero$1(e){for(var t=e.length;--t>=0;)e[t]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH=3,MAX_MATCH=258,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=new Array(2*(L_CODES+2));zero$1(static_ltree);var static_dtree=new Array(2*D_CODES);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH-MIN_MATCH+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES);zero$1(base_length);var base_dist=new Array(D_CODES),static_l_desc,static_d_desc,static_bl_desc;function StaticTreeDesc(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function TreeDesc(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function d_code(e){return e<256?_dist_code[e]:_dist_code[256+(e>>>7)]}function put_short(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function send_bits(e,t,n){e.bi_valid>Buf_size-n?(e.bi_buf|=t<<e.bi_valid&65535,put_short(e,e.bi_buf),e.bi_buf=t>>Buf_size-e.bi_valid,e.bi_valid+=n-Buf_size):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function send_code(e,t,n){send_bits(e,n[2*t],n[2*t+1])}function bi_reverse(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function bi_flush(e){16===e.bi_valid?(put_short(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function gen_bitlen(e,t){var n,r,i,o,a,s,u=t.dyn_tree,c=t.max_code,l=t.stat_desc.static_tree,d=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,h=t.stat_desc.max_length,g=0;for(o=0;o<=MAX_BITS;o++)e.bl_count[o]=0;for(u[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<HEAP_SIZE;n++)(o=u[2*u[2*(r=e.heap[n])+1]+1]+1)>h&&(o=h,g++),u[2*r+1]=o,r>c||(e.bl_count[o]++,a=0,r>=f&&(a=p[r-f]),s=u[2*r],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(l[2*r+1]+a)));if(0!==g){do{for(o=h-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[h]--,g-=2}while(g>0);for(o=h;0!==o;o--)for(r=e.bl_count[o];0!==r;)(i=e.heap[--n])>c||(u[2*i+1]!==o&&(e.opt_len+=(o-u[2*i+1])*u[2*i],u[2*i+1]=o),r--)}}function gen_codes(e,t,n){var r,i,o=new Array(MAX_BITS+1),a=0;for(r=1;r<=MAX_BITS;r++)o[r]=a=a+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=bi_reverse(o[s]++,s))}}function tr_static_init(){var e,t,n,r,i,o=new Array(MAX_BITS+1);for(n=0,r=0;r<LENGTH_CODES-1;r++)for(base_length[r]=n,e=0;e<1<<extra_lbits[r];e++)_length_code[n++]=r;for(_length_code[n-1]=r,i=0,r=0;r<16;r++)for(base_dist[r]=i,e=0;e<1<<extra_dbits[r];e++)_dist_code[i++]=r;for(i>>=7;r<D_CODES;r++)for(base_dist[r]=i<<7,e=0;e<1<<extra_dbits[r]-7;e++)_dist_code[256+i++]=r;for(t=0;t<=MAX_BITS;t++)o[t]=0;for(e=0;e<=143;)static_ltree[2*e+1]=8,e++,o[8]++;for(;e<=255;)static_ltree[2*e+1]=9,e++,o[9]++;for(;e<=279;)static_ltree[2*e+1]=7,e++,o[7]++;for(;e<=287;)static_ltree[2*e+1]=8,e++,o[8]++;for(gen_codes(static_ltree,L_CODES+1,o),e=0;e<D_CODES;e++)static_dtree[2*e+1]=5,static_dtree[2*e]=bi_reverse(e,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS+1,L_CODES,MAX_BITS),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES,MAX_BITS),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES,MAX_BL_BITS)}function init_block(e){var t;for(t=0;t<L_CODES;t++)e.dyn_ltree[2*t]=0;for(t=0;t<D_CODES;t++)e.dyn_dtree[2*t]=0;for(t=0;t<BL_CODES;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*END_BLOCK]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function bi_windup(e){e.bi_valid>8?put_short(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function copy_block(e,t,n,r){bi_windup(e),r&&(put_short(e,n),put_short(e,~n)),common$1.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}function smaller(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]}function pqdownheap(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&smaller(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!smaller(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function compress_block(e,t,n){var r,i,o,a,s=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===r?send_code(e,i,t):(send_code(e,(o=_length_code[i])+LITERALS+1,t),0!==(a=extra_lbits[o])&&send_bits(e,i-=base_length[o],a),send_code(e,o=d_code(--r),n),0!==(a=extra_dbits[o])&&send_bits(e,r-=base_dist[o],a))}while(s<e.last_lit);send_code(e,END_BLOCK,t)}function build_tree(e,t){var n,r,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,u=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=HEAP_SIZE,n=0;n<u;n++)0!==o[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)pqdownheap(e,o,n);i=u;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pqdownheap(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,pqdownheap(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],gen_bitlen(e,t),gen_codes(o,c,e.bl_count)}function scan_tree(e,t,n){var r,i,o=-1,a=t[1],s=0,u=7,c=4;for(0===a&&(u=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=t[2*(r+1)+1],++s<u&&i===a||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*REP_3_6]++):s<=10?e.bl_tree[2*REPZ_3_10]++:e.bl_tree[2*REPZ_11_138]++,s=0,o=i,0===a?(u=138,c=3):i===a?(u=6,c=3):(u=7,c=4))}function send_tree(e,t,n){var r,i,o=-1,a=t[1],s=0,u=7,c=4;for(0===a&&(u=138,c=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++s<u&&i===a)){if(s<c)do{send_code(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(send_code(e,i,e.bl_tree),s--),send_code(e,REP_3_6,e.bl_tree),send_bits(e,s-3,2)):s<=10?(send_code(e,REPZ_3_10,e.bl_tree),send_bits(e,s-3,3)):(send_code(e,REPZ_11_138,e.bl_tree),send_bits(e,s-11,7));s=0,o=i,0===a?(u=138,c=3):i===a?(u=6,c=3):(u=7,c=4)}}function build_bl_tree(e){var t;for(scan_tree(e,e.dyn_ltree,e.l_desc.max_code),scan_tree(e,e.dyn_dtree,e.d_desc.max_code),build_tree(e,e.bl_desc),t=BL_CODES-1;t>=3&&0===e.bl_tree[2*bl_order[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function send_all_trees(e,t,n,r){var i;for(send_bits(e,t-257,5),send_bits(e,n-1,5),send_bits(e,r-4,4),i=0;i<r;i++)send_bits(e,e.bl_tree[2*bl_order[i]+1],3);send_tree(e,e.dyn_ltree,t-1),send_tree(e,e.dyn_dtree,n-1)}function detect_data_type(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return Z_BINARY;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return Z_TEXT;for(t=32;t<LITERALS;t++)if(0!==e.dyn_ltree[2*t])return Z_TEXT;return Z_BINARY}zero$1(base_dist);var static_init_done=!1;function _tr_init(e){static_init_done||(tr_static_init(),static_init_done=!0),e.l_desc=new TreeDesc(e.dyn_ltree,static_l_desc),e.d_desc=new TreeDesc(e.dyn_dtree,static_d_desc),e.bl_desc=new TreeDesc(e.bl_tree,static_bl_desc),e.bi_buf=0,e.bi_valid=0,init_block(e)}function _tr_stored_block(e,t,n,r){send_bits(e,(STORED_BLOCK<<1)+(r?1:0),3),copy_block(e,t,n,!0)}function _tr_align(e){send_bits(e,STATIC_TREES<<1,3),send_code(e,END_BLOCK,static_ltree),bi_flush(e)}function _tr_flush_block(e,t,n,r){var i,o,a=0;e.level>0?(e.strm.data_type===Z_UNKNOWN&&(e.strm.data_type=detect_data_type(e)),build_tree(e,e.l_desc),build_tree(e,e.d_desc),a=build_bl_tree(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?_tr_stored_block(e,t,n,r):e.strategy===Z_FIXED||o===i?(send_bits(e,(STATIC_TREES<<1)+(r?1:0),3),compress_block(e,static_ltree,static_dtree)):(send_bits(e,(DYN_TREES<<1)+(r?1:0),3),send_all_trees(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),compress_block(e,e.dyn_ltree,e.dyn_dtree)),init_block(e),r&&bi_windup(e)}function _tr_tally(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(_length_code[n]+LITERALS+1)]++,e.dyn_dtree[2*d_code(t)]++),e.last_lit===e.lit_bufsize-1}var _tr_init_1=_tr_init,_tr_stored_block_1=_tr_stored_block,_tr_flush_block_1=_tr_flush_block,_tr_tally_1=_tr_tally,_tr_align_1=_tr_align,trees={_tr_init:_tr_init_1,_tr_stored_block:_tr_stored_block_1,_tr_flush_block:_tr_flush_block_1,_tr_tally:_tr_tally_1,_tr_align:_tr_align_1};function adler32(e,t,n,r){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{o=o+(i=i+t[r++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0}var adler32_1=adler32;function makeTable(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}var crcTable=makeTable();function crc32(e,t,n,r){var i=crcTable,o=r+n;e^=-1;for(var a=r;a<o;a++)e=e>>>8^i[255&(e^t[a])];return-1^e}var crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Z_NO_FLUSH=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH=4,Z_BLOCK=5,Z_OK=0,Z_STREAM_END=1,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_BUF_ERROR=-5,Z_DEFAULT_COMPRESSION=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED$1=4,Z_DEFAULT_STRATEGY=0,Z_UNKNOWN$1=2,Z_DEFLATED=8,MAX_MEM_LEVEL=9,MAX_WBITS=15,DEF_MEM_LEVEL=8,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,MIN_MATCH$1=3,MAX_MATCH$1=258,MIN_LOOKAHEAD=MAX_MATCH$1+MIN_MATCH$1+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3,configuration_table;function err(e,t){return e.msg=messages[t],t}function rank(e){return(e<<1)-(e>4?9:0)}function zero$2(e){for(var t=e.length;--t>=0;)e[t]=0}function flush_pending(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(common$1.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function flush_block_only(e,t){trees._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,flush_pending(e.strm)}function put_byte(e,t){e.pending_buf[e.pending++]=t}function putShortMSB(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function read_buf(e,t,n,r){var i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,common$1.arraySet(t,e.input,e.next_in,i,n),1===e.state.wrap?e.adler=adler32_1(e.adler,t,i,n):2===e.state.wrap&&(e.adler=crc32_1(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)}function longest_match(e,t){var n,r,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,u=e.strstart>e.w_size-MIN_LOOKAHEAD?e.strstart-(e.w_size-MIN_LOOKAHEAD):0,c=e.window,l=e.w_mask,d=e.prev,p=e.strstart+MAX_MATCH$1,f=c[o+a-1],h=c[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+a]===h&&c[n+a-1]===f&&c[n]===c[o]&&c[++n]===c[o+1]){o+=2,n++;do{}while(c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&o<p);if(r=MAX_MATCH$1-(p-o),o=p-MAX_MATCH$1,r>a){if(e.match_start=t,a=r,r>=s)break;f=c[o+a-1],h=c[o+a]}}}while((t=d[t&l])>u&&0!=--i);return a<=e.lookahead?a:e.lookahead}function fill_window(e){var t,n,r,i,o,a=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-MIN_LOOKAHEAD)){common$1.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=a?r-a:0}while(--n);t=n=a;do{r=e.prev[--t],e.prev[t]=r>=a?r-a:0}while(--n);i+=a}if(0===e.strm.avail_in)break;if(n=read_buf(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=n,e.lookahead+e.insert>=MIN_MATCH$1)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+MIN_MATCH$1-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<MIN_MATCH$1)););}while(e.lookahead<MIN_LOOKAHEAD&&0!==e.strm.avail_in)}function deflate_stored(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(fill_window(e),0===e.lookahead&&t===Z_NO_FLUSH)return BS_NEED_MORE;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE;if(e.strstart-e.block_start>=e.w_size-MIN_LOOKAHEAD&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=0,t===Z_FINISH?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):(e.strstart>e.block_start&&(flush_block_only(e,!1),e.strm.avail_out),BS_NEED_MORE)}function deflate_fast(e,t){for(var n,r;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&t===Z_NO_FLUSH)return BS_NEED_MORE;if(0===e.lookahead)break}if(n=0,e.lookahead>=MIN_MATCH$1&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH$1-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,n)),e.match_length>=MIN_MATCH$1)if(r=trees._tr_tally(e,e.strstart-e.match_start,e.match_length-MIN_MATCH$1),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=MIN_MATCH$1){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH$1-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=e.strstart<MIN_MATCH$1-1?e.strstart:MIN_MATCH$1-1,t===Z_FINISH?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(e,t){for(var n,r,i;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&t===Z_NO_FLUSH)return BS_NEED_MORE;if(0===e.lookahead)break}if(n=0,e.lookahead>=MIN_MATCH$1&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH$1-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=MIN_MATCH$1-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,n),e.match_length<=5&&(e.strategy===Z_FILTERED||e.match_length===MIN_MATCH$1&&e.strstart-e.match_start>4096)&&(e.match_length=MIN_MATCH$1-1)),e.prev_length>=MIN_MATCH$1&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-MIN_MATCH$1,r=trees._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-MIN_MATCH$1),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH$1-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=MIN_MATCH$1-1,e.strstart++,r&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}else if(e.match_available){if((r=trees._tr_tally(e,0,e.window[e.strstart-1]))&&flush_block_only(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return BS_NEED_MORE}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=trees._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<MIN_MATCH$1-1?e.strstart:MIN_MATCH$1-1,t===Z_FINISH?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(e,t){for(var n,r,i,o,a=e.window;;){if(e.lookahead<=MAX_MATCH$1){if(fill_window(e),e.lookahead<=MAX_MATCH$1&&t===Z_NO_FLUSH)return BS_NEED_MORE;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=MIN_MATCH$1&&e.strstart>0&&(r=a[i=e.strstart-1])===a[++i]&&r===a[++i]&&r===a[++i]){o=e.strstart+MAX_MATCH$1;do{}while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<o);e.match_length=MAX_MATCH$1-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=MIN_MATCH$1?(n=trees._tr_tally(e,1,e.match_length-MIN_MATCH$1),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=0,t===Z_FINISH?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(e,t){for(var n;;){if(0===e.lookahead&&(fill_window(e),0===e.lookahead)){if(t===Z_NO_FLUSH)return BS_NEED_MORE;break}if(e.match_length=0,n=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=0,t===Z_FINISH?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function lm_init(e){e.window_size=2*e.w_size,zero$2(e.head),e.max_lazy_match=configuration_table[e.level].max_lazy,e.good_match=configuration_table[e.level].good_length,e.nice_match=configuration_table[e.level].nice_length,e.max_chain_length=configuration_table[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=MIN_MATCH$1-1,e.match_available=0,e.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new common$1.Buf16(2*HEAP_SIZE$1),this.dyn_dtree=new common$1.Buf16(2*(2*D_CODES$1+1)),this.bl_tree=new common$1.Buf16(2*(2*BL_CODES$1+1)),zero$2(this.dyn_ltree),zero$2(this.dyn_dtree),zero$2(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new common$1.Buf16(MAX_BITS$1+1),this.heap=new common$1.Buf16(2*L_CODES$1+1),zero$2(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new common$1.Buf16(2*L_CODES$1+1),zero$2(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=Z_UNKNOWN$1,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?INIT_STATE:BUSY_STATE,e.adler=2===t.wrap?0:1,t.last_flush=Z_NO_FLUSH,trees._tr_init(t),Z_OK):err(e,Z_STREAM_ERROR)}function deflateReset(e){var t=deflateResetKeep(e);return t===Z_OK&&lm_init(e.state),t}function deflateSetHeader(e,t){return e&&e.state?2!==e.state.wrap?Z_STREAM_ERROR:(e.state.gzhead=t,Z_OK):Z_STREAM_ERROR}function deflateInit2(e,t,n,r,i,o){if(!e)return Z_STREAM_ERROR;var a=1;if(t===Z_DEFAULT_COMPRESSION&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),i<1||i>MAX_MEM_LEVEL||n!==Z_DEFLATED||r<8||r>15||t<0||t>9||o<0||o>Z_FIXED$1)return err(e,Z_STREAM_ERROR);8===r&&(r=9);var s=new DeflateState;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+MIN_MATCH$1-1)/MIN_MATCH$1),s.window=new common$1.Buf8(2*s.w_size),s.head=new common$1.Buf16(s.hash_size),s.prev=new common$1.Buf16(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new common$1.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=o,s.method=n,deflateReset(e)}function deflateInit(e,t){return deflateInit2(e,t,Z_DEFLATED,MAX_WBITS,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY)}function deflate(e,t){var n,r,i,o;if(!e||!e.state||t>Z_BLOCK||t<0)return e?err(e,Z_STREAM_ERROR):Z_STREAM_ERROR;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||r.status===FINISH_STATE&&t!==Z_FINISH)return err(e,0===e.avail_out?Z_BUF_ERROR:Z_STREAM_ERROR);if(r.strm=e,n=r.last_flush,r.last_flush=t,r.status===INIT_STATE)if(2===r.wrap)e.adler=0,put_byte(r,31),put_byte(r,139),put_byte(r,8),r.gzhead?(put_byte(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),put_byte(r,255&r.gzhead.time),put_byte(r,r.gzhead.time>>8&255),put_byte(r,r.gzhead.time>>16&255),put_byte(r,r.gzhead.time>>24&255),put_byte(r,9===r.level?2:r.strategy>=Z_HUFFMAN_ONLY||r.level<2?4:0),put_byte(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(put_byte(r,255&r.gzhead.extra.length),put_byte(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=crc32_1(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=EXTRA_STATE):(put_byte(r,0),put_byte(r,0),put_byte(r,0),put_byte(r,0),put_byte(r,0),put_byte(r,9===r.level?2:r.strategy>=Z_HUFFMAN_ONLY||r.level<2?4:0),put_byte(r,OS_CODE),r.status=BUSY_STATE);else{var a=Z_DEFLATED+(r.w_bits-8<<4)<<8;a|=(r.strategy>=Z_HUFFMAN_ONLY||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(a|=PRESET_DICT),a+=31-a%31,r.status=BUSY_STATE,putShortMSB(r,a),0!==r.strstart&&(putShortMSB(r,e.adler>>>16),putShortMSB(r,65535&e.adler)),e.adler=1}if(r.status===EXTRA_STATE)if(r.gzhead.extra){for(i=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>i&&(e.adler=crc32_1(e.adler,r.pending_buf,r.pending-i,i)),flush_pending(e),i=r.pending,r.pending!==r.pending_buf_size));)put_byte(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>i&&(e.adler=crc32_1(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=NAME_STATE)}else r.status=NAME_STATE;if(r.status===NAME_STATE)if(r.gzhead.name){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(e.adler=crc32_1(e.adler,r.pending_buf,r.pending-i,i)),flush_pending(e),i=r.pending,r.pending===r.pending_buf_size)){o=1;break}o=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,put_byte(r,o)}while(0!==o);r.gzhead.hcrc&&r.pending>i&&(e.adler=crc32_1(e.adler,r.pending_buf,r.pending-i,i)),0===o&&(r.gzindex=0,r.status=COMMENT_STATE)}else r.status=COMMENT_STATE;if(r.status===COMMENT_STATE)if(r.gzhead.comment){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(e.adler=crc32_1(e.adler,r.pending_buf,r.pending-i,i)),flush_pending(e),i=r.pending,r.pending===r.pending_buf_size)){o=1;break}o=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,put_byte(r,o)}while(0!==o);r.gzhead.hcrc&&r.pending>i&&(e.adler=crc32_1(e.adler,r.pending_buf,r.pending-i,i)),0===o&&(r.status=HCRC_STATE)}else r.status=HCRC_STATE;if(r.status===HCRC_STATE&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&flush_pending(e),r.pending+2<=r.pending_buf_size&&(put_byte(r,255&e.adler),put_byte(r,e.adler>>8&255),e.adler=0,r.status=BUSY_STATE)):r.status=BUSY_STATE),0!==r.pending){if(flush_pending(e),0===e.avail_out)return r.last_flush=-1,Z_OK}else if(0===e.avail_in&&rank(t)<=rank(n)&&t!==Z_FINISH)return err(e,Z_BUF_ERROR);if(r.status===FINISH_STATE&&0!==e.avail_in)return err(e,Z_BUF_ERROR);if(0!==e.avail_in||0!==r.lookahead||t!==Z_NO_FLUSH&&r.status!==FINISH_STATE){var s=r.strategy===Z_HUFFMAN_ONLY?deflate_huff(r,t):r.strategy===Z_RLE?deflate_rle(r,t):configuration_table[r.level].func(r,t);if(s!==BS_FINISH_STARTED&&s!==BS_FINISH_DONE||(r.status=FINISH_STATE),s===BS_NEED_MORE||s===BS_FINISH_STARTED)return 0===e.avail_out&&(r.last_flush=-1),Z_OK;if(s===BS_BLOCK_DONE&&(t===Z_PARTIAL_FLUSH?trees._tr_align(r):t!==Z_BLOCK&&(trees._tr_stored_block(r,0,0,!1),t===Z_FULL_FLUSH&&(zero$2(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),flush_pending(e),0===e.avail_out))return r.last_flush=-1,Z_OK}return t!==Z_FINISH?Z_OK:r.wrap<=0?Z_STREAM_END:(2===r.wrap?(put_byte(r,255&e.adler),put_byte(r,e.adler>>8&255),put_byte(r,e.adler>>16&255),put_byte(r,e.adler>>24&255),put_byte(r,255&e.total_in),put_byte(r,e.total_in>>8&255),put_byte(r,e.total_in>>16&255),put_byte(r,e.total_in>>24&255)):(putShortMSB(r,e.adler>>>16),putShortMSB(r,65535&e.adler)),flush_pending(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?Z_OK:Z_STREAM_END)}function deflateEnd(e){var t;return e&&e.state?(t=e.state.status)!==INIT_STATE&&t!==EXTRA_STATE&&t!==NAME_STATE&&t!==COMMENT_STATE&&t!==HCRC_STATE&&t!==BUSY_STATE&&t!==FINISH_STATE?err(e,Z_STREAM_ERROR):(e.state=null,t===BUSY_STATE?err(e,Z_DATA_ERROR):Z_OK):Z_STREAM_ERROR}function deflateSetDictionary(e,t){var n,r,i,o,a,s,u,c,l=t.length;if(!e||!e.state)return Z_STREAM_ERROR;if(2===(o=(n=e.state).wrap)||1===o&&n.status!==INIT_STATE||n.lookahead)return Z_STREAM_ERROR;for(1===o&&(e.adler=adler32_1(e.adler,t,l,0)),n.wrap=0,l>=n.w_size&&(0===o&&(zero$2(n.head),n.strstart=0,n.block_start=0,n.insert=0),c=new common$1.Buf8(n.w_size),common$1.arraySet(c,t,l-n.w_size,n.w_size,0),t=c,l=n.w_size),a=e.avail_in,s=e.next_in,u=e.input,e.avail_in=l,e.next_in=0,e.input=t,fill_window(n);n.lookahead>=MIN_MATCH$1;){r=n.strstart,i=n.lookahead-(MIN_MATCH$1-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+MIN_MATCH$1-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--i);n.strstart=r,n.lookahead=MIN_MATCH$1-1,fill_window(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=MIN_MATCH$1-1,n.match_available=0,e.next_in=s,e.input=u,e.avail_in=a,n.wrap=o,Z_OK}configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];var deflateInit_1=deflateInit,deflateInit2_1=deflateInit2,deflateReset_1=deflateReset,deflateResetKeep_1=deflateResetKeep,deflateSetHeader_1=deflateSetHeader,deflate_2=deflate,deflateEnd_1=deflateEnd,deflateSetDictionary_1=deflateSetDictionary,deflateInfo="pako deflate (from Nodeca project)",deflate_1={deflateInit:deflateInit_1,deflateInit2:deflateInit2_1,deflateReset:deflateReset_1,deflateResetKeep:deflateResetKeep_1,deflateSetHeader:deflateSetHeader_1,deflate:deflate_2,deflateEnd:deflateEnd_1,deflateSetDictionary:deflateSetDictionary_1,deflateInfo:deflateInfo},STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(e){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}for(var _utf8len=new common$1.Buf8(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=function(e){var t,n,r,i,o,a=e.length,s=0;for(i=0;i<a;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new common$1.Buf8(s),o=0,i=0;o<s;i++)55296==(64512&(n=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(r=e.charCodeAt(i+1)))&&(n=65536+(n-55296<<10)+(r-56320),i++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t};function buf2binstring(e,t){if(t<65534&&(e.subarray&&STR_APPLY_UIA_OK||!e.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,common$1.shrinkBuf(e,t));for(var n="",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n}var buf2binstring_1=function(e){return buf2binstring(e,e.length)},binstring2buf=function(e){for(var t=new common$1.Buf8(e.length),n=0,r=t.length;n<r;n++)t[n]=e.charCodeAt(n);return t},buf2string=function(e,t){var n,r,i,o,a=t||e.length,s=new Array(2*a);for(r=0,n=0;n<a;)if((i=e[n++])<128)s[r++]=i;else if((o=_utf8len[i])>4)s[r++]=65533,n+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&n<a;)i=i<<6|63&e[n++],o--;o>1?s[r++]=65533:i<65536?s[r++]=i:(i-=65536,s[r++]=55296|i>>10&1023,s[r++]=56320|1023&i)}return buf2binstring(s,r)},utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+_utf8len[e[n]]>t?n:t},strings={string2buf:string2buf,buf2binstring:buf2binstring_1,binstring2buf:binstring2buf,buf2string:buf2string,utf8border:utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream,toString$3=Object.prototype.toString,Z_NO_FLUSH$1=0,Z_FINISH$1=4,Z_OK$1=0,Z_STREAM_END$1=1,Z_SYNC_FLUSH=2,Z_DEFAULT_COMPRESSION$1=-1,Z_DEFAULT_STRATEGY$1=0,Z_DEFLATED$1=8;function Deflate(e){if(!(this instanceof Deflate))return new Deflate(e);this.options=common$1.assign({level:Z_DEFAULT_COMPRESSION$1,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY$1,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;var n=deflate_1.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Z_OK$1)throw new Error(messages[n]);if(t.header&&deflate_1.deflateSetHeader(this.strm,t.header),t.dictionary){var r;if(r="string"==typeof t.dictionary?strings.string2buf(t.dictionary):"[object ArrayBuffer]"===toString$3.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=deflate_1.deflateSetDictionary(this.strm,r))!==Z_OK$1)throw new Error(messages[n]);this._dict_set=!0}}function deflate$1(e,t){var n=new Deflate(t);if(n.push(e,!0),n.err)throw n.msg||messages[n.err];return n.result}function deflateRaw(e,t){return(t=t||{}).raw=!0,deflate$1(e,t)}function gzip(e,t){return(t=t||{}).gzip=!0,deflate$1(e,t)}Deflate.prototype.push=function(e,t){var n,r,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;r=t===~~t?t:!0===t?Z_FINISH$1:Z_NO_FLUSH$1,"string"==typeof e?i.input=strings.string2buf(e):"[object ArrayBuffer]"===toString$3.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new common$1.Buf8(o),i.next_out=0,i.avail_out=o),(n=deflate_1.deflate(i,r))!==Z_STREAM_END$1&&n!==Z_OK$1)return this.onEnd(n),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||r!==Z_FINISH$1&&r!==Z_SYNC_FLUSH)||("string"===this.options.to?this.onData(strings.buf2binstring(common$1.shrinkBuf(i.output,i.next_out))):this.onData(common$1.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&n!==Z_STREAM_END$1);return r===Z_FINISH$1?(n=deflate_1.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Z_OK$1):r!==Z_SYNC_FLUSH||(this.onEnd(Z_OK$1),i.avail_out=0,!0)},Deflate.prototype.onData=function(e){this.chunks.push(e)},Deflate.prototype.onEnd=function(e){e===Z_OK$1&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=common$1.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Deflate_1=Deflate,deflate_2$1=deflate$1,deflateRaw_1=deflateRaw,gzip_1=gzip,deflate_1$1={Deflate:Deflate_1,deflate:deflate_2$1,deflateRaw:deflateRaw_1,gzip:gzip_1},BAD=30,TYPE=12,inffast=function(e,t){var n,r,i,o,a,s,u,c,l,d,p,f,h,g,m,v,y,_,b,S,E,w,I,T,O;n=e.state,r=e.next_in,T=e.input,i=r+(e.avail_in-5),o=e.next_out,O=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),u=n.dmax,c=n.wsize,l=n.whave,d=n.wnext,p=n.window,f=n.hold,h=n.bits,g=n.lencode,m=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{h<15&&(f+=T[r++]<<h,h+=8,f+=T[r++]<<h,h+=8),_=g[f&v];t:for(;;){if(f>>>=b=_>>>24,h-=b,0==(b=_>>>16&255))O[o++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=g[(65535&_)+(f&(1<<b)-1)];continue t}if(32&b){n.mode=TYPE;break e}e.msg="invalid literal/length code",n.mode=BAD;break e}S=65535&_,(b&=15)&&(h<b&&(f+=T[r++]<<h,h+=8),S+=f&(1<<b)-1,f>>>=b,h-=b),h<15&&(f+=T[r++]<<h,h+=8,f+=T[r++]<<h,h+=8),_=m[f&y];n:for(;;){if(f>>>=b=_>>>24,h-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=m[(65535&_)+(f&(1<<b)-1)];continue n}e.msg="invalid distance code",n.mode=BAD;break e}if(E=65535&_,h<(b&=15)&&(f+=T[r++]<<h,(h+=8)<b&&(f+=T[r++]<<h,h+=8)),(E+=f&(1<<b)-1)>u){e.msg="invalid distance too far back",n.mode=BAD;break e}if(f>>>=b,h-=b,E>(b=o-a)){if((b=E-b)>l&&n.sane){e.msg="invalid distance too far back",n.mode=BAD;break e}if(w=0,I=p,0===d){if(w+=c-b,b<S){S-=b;do{O[o++]=p[w++]}while(--b);w=o-E,I=O}}else if(d<b){if(w+=c+d-b,(b-=d)<S){S-=b;do{O[o++]=p[w++]}while(--b);if(w=0,d<S){S-=b=d;do{O[o++]=p[w++]}while(--b);w=o-E,I=O}}}else if(w+=d-b,b<S){S-=b;do{O[o++]=p[w++]}while(--b);w=o-E,I=O}for(;S>2;)O[o++]=I[w++],O[o++]=I[w++],O[o++]=I[w++],S-=3;S&&(O[o++]=I[w++],S>1&&(O[o++]=I[w++]))}else{w=o-E;do{O[o++]=O[w++],O[o++]=O[w++],O[o++]=O[w++],S-=3}while(S>2);S&&(O[o++]=O[w++],S>1&&(O[o++]=O[w++]))}break}}break}}while(r<i&&o<s);r-=S=h>>3,f&=(1<<(h-=S<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=o<s?s-o+257:257-(o-s),n.hold=f,n.bits=h},MAXBITS=15,ENOUGH_LENS=852,ENOUGH_DISTS=592,CODES=0,LENS=1,DISTS=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],inftrees=function(e,t,n,r,i,o,a,s){var u,c,l,d,p,f,h,g,m,v=s.bits,y=0,_=0,b=0,S=0,E=0,w=0,I=0,T=0,O=0,x=0,R=null,A=0,L=new common$1.Buf16(MAXBITS+1),C=new common$1.Buf16(MAXBITS+1),N=null,M=0;for(y=0;y<=MAXBITS;y++)L[y]=0;for(_=0;_<r;_++)L[t[n+_]]++;for(E=v,S=MAXBITS;S>=1&&0===L[S];S--);if(E>S&&(E=S),0===S)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(b=1;b<S&&0===L[b];b++);for(E<b&&(E=b),T=1,y=1;y<=MAXBITS;y++)if(T<<=1,(T-=L[y])<0)return-1;if(T>0&&(e===CODES||1!==S))return-1;for(C[1]=0,y=1;y<MAXBITS;y++)C[y+1]=C[y]+L[y];for(_=0;_<r;_++)0!==t[n+_]&&(a[C[t[n+_]]++]=_);if(e===CODES?(R=N=a,f=19):e===LENS?(R=lbase,A-=257,N=lext,M-=257,f=256):(R=dbase,N=dext,f=-1),x=0,_=0,y=b,p=o,w=E,I=0,l=-1,d=(O=1<<E)-1,e===LENS&&O>ENOUGH_LENS||e===DISTS&&O>ENOUGH_DISTS)return 1;for(;;){h=y-I,a[_]<f?(g=0,m=a[_]):a[_]>f?(g=N[M+a[_]],m=R[A+a[_]]):(g=96,m=0),u=1<<y-I,b=c=1<<w;do{i[p+(x>>I)+(c-=u)]=h<<24|g<<16|m|0}while(0!==c);for(u=1<<y-1;x&u;)u>>=1;if(0!==u?(x&=u-1,x+=u):x=0,_++,0==--L[y]){if(y===S)break;y=t[n+a[_]]}if(y>E&&(x&d)!==l){for(0===I&&(I=E),p+=b,T=1<<(w=y-I);w+I<S&&!((T-=L[w+I])<=0);)w++,T<<=1;if(O+=1<<w,e===LENS&&O>ENOUGH_LENS||e===DISTS&&O>ENOUGH_DISTS)return 1;i[l=x&d]=E<<24|w<<16|p-o|0}}return 0!==x&&(i[p+x]=y-I<<24|64<<16|0),s.bits=E,0},CODES$1=0,LENS$1=1,DISTS$1=2,Z_FINISH$2=4,Z_BLOCK$1=5,Z_TREES=6,Z_OK$2=0,Z_STREAM_END$2=1,Z_NEED_DICT=2,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR$1=-5,Z_DEFLATED$2=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME$2=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE$1=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH$2=25,LIT=26,CHECK=27,LENGTH$1=28,DONE=29,BAD$1=30,MEM=31,SYNC=32,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,MAX_WBITS$1=15,DEF_WBITS=MAX_WBITS$1;function zswap32(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new common$1.Buf16(320),this.work=new common$1.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=HEAD,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new common$1.Buf32(ENOUGH_LENS$1),t.distcode=t.distdyn=new common$1.Buf32(ENOUGH_DISTS$1),t.sane=1,t.back=-1,Z_OK$2):Z_STREAM_ERROR$1}function inflateReset(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,inflateResetKeep(e)):Z_STREAM_ERROR$1}function inflateReset2(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Z_STREAM_ERROR$1:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,inflateReset(e))):Z_STREAM_ERROR$1}function inflateInit2(e,t){var n,r;return e?(r=new InflateState,e.state=r,r.window=null,(n=inflateReset2(e,t))!==Z_OK$2&&(e.state=null),n):Z_STREAM_ERROR$1}function inflateInit(e){return inflateInit2(e,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(e){if(virgin){var t;for(lenfix=new common$1.Buf32(512),distfix=new common$1.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(inftrees(LENS$1,e.lens,0,288,lenfix,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;inftrees(DISTS$1,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5}function updatewindow(e,t,n,r){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new common$1.Buf8(o.wsize)),r>=o.wsize?(common$1.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((i=o.wsize-o.wnext)>r&&(i=r),common$1.arraySet(o.window,t,n-r,i,o.wnext),(r-=i)?(common$1.arraySet(o.window,t,n-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}function inflate(e,t){var n,r,i,o,a,s,u,c,l,d,p,f,h,g,m,v,y,_,b,S,E,w,I,T,O=0,x=new common$1.Buf8(4),R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Z_STREAM_ERROR$1;(n=e.state).mode===TYPE$1&&(n.mode=TYPEDO),a=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,r=e.input,s=e.avail_in,c=n.hold,l=n.bits,d=s,p=u,w=Z_OK$2;e:for(;;)switch(n.mode){case HEAD:if(0===n.wrap){n.mode=TYPEDO;break}for(;l<16;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}if(2&n.wrap&&35615===c){n.check=0,x[0]=255&c,x[1]=c>>>8&255,n.check=crc32_1(n.check,x,2,0),c=0,l=0,n.mode=FLAGS;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=BAD$1;break}if((15&c)!==Z_DEFLATED$2){e.msg="unknown compression method",n.mode=BAD$1;break}if(l-=4,E=8+(15&(c>>>=4)),0===n.wbits)n.wbits=E;else if(E>n.wbits){e.msg="invalid window size",n.mode=BAD$1;break}n.dmax=1<<E,e.adler=n.check=1,n.mode=512&c?DICTID:TYPE$1,c=0,l=0;break;case FLAGS:for(;l<16;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}if(n.flags=c,(255&n.flags)!==Z_DEFLATED$2){e.msg="unknown compression method",n.mode=BAD$1;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=BAD$1;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&(x[0]=255&c,x[1]=c>>>8&255,n.check=crc32_1(n.check,x,2,0)),c=0,l=0,n.mode=TIME;case TIME:for(;l<32;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}n.head&&(n.head.time=c),512&n.flags&&(x[0]=255&c,x[1]=c>>>8&255,x[2]=c>>>16&255,x[3]=c>>>24&255,n.check=crc32_1(n.check,x,4,0)),c=0,l=0,n.mode=OS;case OS:for(;l<16;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&(x[0]=255&c,x[1]=c>>>8&255,n.check=crc32_1(n.check,x,2,0)),c=0,l=0,n.mode=EXLEN;case EXLEN:if(1024&n.flags){for(;l<16;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&(x[0]=255&c,x[1]=c>>>8&255,n.check=crc32_1(n.check,x,2,0)),c=0,l=0}else n.head&&(n.head.extra=null);n.mode=EXTRA;case EXTRA:if(1024&n.flags&&((f=n.length)>s&&(f=s),f&&(n.head&&(E=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),common$1.arraySet(n.head.extra,r,o,f,E)),512&n.flags&&(n.check=crc32_1(n.check,r,f,o)),s-=f,o+=f,n.length-=f),n.length))break e;n.length=0,n.mode=NAME$2;case NAME$2:if(2048&n.flags){if(0===s)break e;f=0;do{E=r[o+f++],n.head&&E&&n.length<65536&&(n.head.name+=String.fromCharCode(E))}while(E&&f<s);if(512&n.flags&&(n.check=crc32_1(n.check,r,f,o)),s-=f,o+=f,E)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=COMMENT;case COMMENT:if(4096&n.flags){if(0===s)break e;f=0;do{E=r[o+f++],n.head&&E&&n.length<65536&&(n.head.comment+=String.fromCharCode(E))}while(E&&f<s);if(512&n.flags&&(n.check=crc32_1(n.check,r,f,o)),s-=f,o+=f,E)break e}else n.head&&(n.head.comment=null);n.mode=HCRC;case HCRC:if(512&n.flags){for(;l<16;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}if(c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=BAD$1;break}c=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=TYPE$1;break;case DICTID:for(;l<32;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}e.adler=n.check=zswap32(c),c=0,l=0,n.mode=DICT;case DICT:if(0===n.havedict)return e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=s,n.hold=c,n.bits=l,Z_NEED_DICT;e.adler=n.check=1,n.mode=TYPE$1;case TYPE$1:if(t===Z_BLOCK$1||t===Z_TREES)break e;case TYPEDO:if(n.last){c>>>=7&l,l-=7&l,n.mode=CHECK;break}for(;l<3;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}switch(n.last=1&c,l-=1,3&(c>>>=1)){case 0:n.mode=STORED;break;case 1:if(fixedtables(n),n.mode=LEN_,t===Z_TREES){c>>>=2,l-=2;break e}break;case 2:n.mode=TABLE;break;case 3:e.msg="invalid block type",n.mode=BAD$1}c>>>=2,l-=2;break;case STORED:for(c>>>=7&l,l-=7&l;l<32;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=BAD$1;break}if(n.length=65535&c,c=0,l=0,n.mode=COPY_,t===Z_TREES)break e;case COPY_:n.mode=COPY;case COPY:if(f=n.length){if(f>s&&(f=s),f>u&&(f=u),0===f)break e;common$1.arraySet(i,r,o,f,a),s-=f,o+=f,u-=f,a+=f,n.length-=f;break}n.mode=TYPE$1;break;case TABLE:for(;l<14;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}if(n.nlen=257+(31&c),c>>>=5,l-=5,n.ndist=1+(31&c),c>>>=5,l-=5,n.ncode=4+(15&c),c>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=BAD$1;break}n.have=0,n.mode=LENLENS;case LENLENS:for(;n.have<n.ncode;){for(;l<3;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}n.lens[R[n.have++]]=7&c,c>>>=3,l-=3}for(;n.have<19;)n.lens[R[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,I={bits:n.lenbits},w=inftrees(CODES$1,n.lens,0,19,n.lencode,0,n.work,I),n.lenbits=I.bits,w){e.msg="invalid code lengths set",n.mode=BAD$1;break}n.have=0,n.mode=CODELENS;case CODELENS:for(;n.have<n.nlen+n.ndist;){for(;v=(O=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,y=65535&O,!((m=O>>>24)<=l);){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}if(y<16)c>>>=m,l-=m,n.lens[n.have++]=y;else{if(16===y){for(T=m+2;l<T;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}if(c>>>=m,l-=m,0===n.have){e.msg="invalid bit length repeat",n.mode=BAD$1;break}E=n.lens[n.have-1],f=3+(3&c),c>>>=2,l-=2}else if(17===y){for(T=m+3;l<T;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}l-=m,E=0,f=3+(7&(c>>>=m)),c>>>=3,l-=3}else{for(T=m+7;l<T;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}l-=m,E=0,f=11+(127&(c>>>=m)),c>>>=7,l-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=BAD$1;break}for(;f--;)n.lens[n.have++]=E}}if(n.mode===BAD$1)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=BAD$1;break}if(n.lenbits=9,I={bits:n.lenbits},w=inftrees(LENS$1,n.lens,0,n.nlen,n.lencode,0,n.work,I),n.lenbits=I.bits,w){e.msg="invalid literal/lengths set",n.mode=BAD$1;break}if(n.distbits=6,n.distcode=n.distdyn,I={bits:n.distbits},w=inftrees(DISTS$1,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,I),n.distbits=I.bits,w){e.msg="invalid distances set",n.mode=BAD$1;break}if(n.mode=LEN_,t===Z_TREES)break e;case LEN_:n.mode=LEN;case LEN:if(s>=6&&u>=258){e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=s,n.hold=c,n.bits=l,inffast(e,p),a=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,r=e.input,s=e.avail_in,c=n.hold,l=n.bits,n.mode===TYPE$1&&(n.back=-1);break}for(n.back=0;v=(O=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,y=65535&O,!((m=O>>>24)<=l);){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}if(v&&0==(240&v)){for(_=m,b=v,S=y;v=(O=n.lencode[S+((c&(1<<_+b)-1)>>_)])>>>16&255,y=65535&O,!(_+(m=O>>>24)<=l);){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}c>>>=_,l-=_,n.back+=_}if(c>>>=m,l-=m,n.back+=m,n.length=y,0===v){n.mode=LIT;break}if(32&v){n.back=-1,n.mode=TYPE$1;break}if(64&v){e.msg="invalid literal/length code",n.mode=BAD$1;break}n.extra=15&v,n.mode=LENEXT;case LENEXT:if(n.extra){for(T=n.extra;l<T;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=DIST;case DIST:for(;v=(O=n.distcode[c&(1<<n.distbits)-1])>>>16&255,y=65535&O,!((m=O>>>24)<=l);){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}if(0==(240&v)){for(_=m,b=v,S=y;v=(O=n.distcode[S+((c&(1<<_+b)-1)>>_)])>>>16&255,y=65535&O,!(_+(m=O>>>24)<=l);){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}c>>>=_,l-=_,n.back+=_}if(c>>>=m,l-=m,n.back+=m,64&v){e.msg="invalid distance code",n.mode=BAD$1;break}n.offset=y,n.extra=15&v,n.mode=DISTEXT;case DISTEXT:if(n.extra){for(T=n.extra;l<T;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=BAD$1;break}n.mode=MATCH$2;case MATCH$2:if(0===u)break e;if(f=p-u,n.offset>f){if((f=n.offset-f)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=BAD$1;break}f>n.wnext?(f-=n.wnext,h=n.wsize-f):h=n.wnext-f,f>n.length&&(f=n.length),g=n.window}else g=i,h=a-n.offset,f=n.length;f>u&&(f=u),u-=f,n.length-=f;do{i[a++]=g[h++]}while(--f);0===n.length&&(n.mode=LEN);break;case LIT:if(0===u)break e;i[a++]=n.length,u--,n.mode=LEN;break;case CHECK:if(n.wrap){for(;l<32;){if(0===s)break e;s--,c|=r[o++]<<l,l+=8}if(p-=u,e.total_out+=p,n.total+=p,p&&(e.adler=n.check=n.flags?crc32_1(n.check,i,p,a-p):adler32_1(n.check,i,p,a-p)),p=u,(n.flags?c:zswap32(c))!==n.check){e.msg="incorrect data check",n.mode=BAD$1;break}c=0,l=0}n.mode=LENGTH$1;case LENGTH$1:if(n.wrap&&n.flags){for(;l<32;){if(0===s)break e;s--,c+=r[o++]<<l,l+=8}if(c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=BAD$1;break}c=0,l=0}n.mode=DONE;case DONE:w=Z_STREAM_END$2;break e;case BAD$1:w=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR$1}return e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=s,n.hold=c,n.bits=l,(n.wsize||p!==e.avail_out&&n.mode<BAD$1&&(n.mode<CHECK||t!==Z_FINISH$2))&&updatewindow(e,e.output,e.next_out,p-e.avail_out),d-=e.avail_in,p-=e.avail_out,e.total_in+=d,e.total_out+=p,n.total+=p,n.wrap&&p&&(e.adler=n.check=n.flags?crc32_1(n.check,i,p,e.next_out-p):adler32_1(n.check,i,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(n.mode===TYPE$1?128:0)+(n.mode===LEN_||n.mode===COPY_?256:0),(0===d&&0===p||t===Z_FINISH$2)&&w===Z_OK$2&&(w=Z_BUF_ERROR$1),w}function inflateEnd(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return t.window&&(t.window=null),e.state=null,Z_OK$2}function inflateGetHeader(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?Z_STREAM_ERROR$1:(n.head=t,t.done=!1,Z_OK$2):Z_STREAM_ERROR$1}function inflateSetDictionary(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&n.mode!==DICT?Z_STREAM_ERROR$1:n.mode===DICT&&adler32_1(1,t,r,0)!==n.check?Z_DATA_ERROR$1:updatewindow(e,t,r,r)?(n.mode=MEM,Z_MEM_ERROR):(n.havedict=1,Z_OK$2):Z_STREAM_ERROR$1}var inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2=inflate,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo:inflateInfo},constants={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader,toString$4=Object.prototype.toString;function Inflate(e){if(!(this instanceof Inflate))return new Inflate(e);this.options=common$1.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;var n=inflate_1.inflateInit2(this.strm,t.windowBits);if(n!==constants.Z_OK)throw new Error(messages[n]);if(this.header=new gzheader,inflate_1.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=strings.string2buf(t.dictionary):"[object ArrayBuffer]"===toString$4.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=inflate_1.inflateSetDictionary(this.strm,t.dictionary))!==constants.Z_OK))throw new Error(messages[n])}function inflate$1(e,t){var n=new Inflate(t);if(n.push(e,!0),n.err)throw n.msg||messages[n.err];return n.result}function inflateRaw(e,t){return(t=t||{}).raw=!0,inflate$1(e,t)}Inflate.prototype.push=function(e,t){var n,r,i,o,a,s=this.strm,u=this.options.chunkSize,c=this.options.dictionary,l=!1;if(this.ended)return!1;r=t===~~t?t:!0===t?constants.Z_FINISH:constants.Z_NO_FLUSH,"string"==typeof e?s.input=strings.binstring2buf(e):"[object ArrayBuffer]"===toString$4.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new common$1.Buf8(u),s.next_out=0,s.avail_out=u),(n=inflate_1.inflate(s,constants.Z_NO_FLUSH))===constants.Z_NEED_DICT&&c&&(n=inflate_1.inflateSetDictionary(this.strm,c)),n===constants.Z_BUF_ERROR&&!0===l&&(n=constants.Z_OK,l=!1),n!==constants.Z_STREAM_END&&n!==constants.Z_OK)return this.onEnd(n),this.ended=!0,!1;s.next_out&&(0!==s.avail_out&&n!==constants.Z_STREAM_END&&(0!==s.avail_in||r!==constants.Z_FINISH&&r!==constants.Z_SYNC_FLUSH)||("string"===this.options.to?(i=strings.utf8border(s.output,s.next_out),o=s.next_out-i,a=strings.buf2string(s.output,i),s.next_out=o,s.avail_out=u-o,o&&common$1.arraySet(s.output,s.output,i,o,0),this.onData(a)):this.onData(common$1.shrinkBuf(s.output,s.next_out)))),0===s.avail_in&&0===s.avail_out&&(l=!0)}while((s.avail_in>0||0===s.avail_out)&&n!==constants.Z_STREAM_END);return n===constants.Z_STREAM_END&&(r=constants.Z_FINISH),r===constants.Z_FINISH?(n=inflate_1.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===constants.Z_OK):r!==constants.Z_SYNC_FLUSH||(this.onEnd(constants.Z_OK),s.avail_out=0,!0)},Inflate.prototype.onData=function(e){this.chunks.push(e)},Inflate.prototype.onEnd=function(e){e===constants.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=common$1.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Inflate_1=Inflate,inflate_2$1=inflate$1,inflateRaw_1=inflateRaw,ungzip=inflate$1,inflate_1$1={Inflate:Inflate_1,inflate:inflate_2$1,inflateRaw:inflateRaw_1,ungzip:ungzip},assign=common$1.assign,pako={};assign(pako,deflate_1$1,inflate_1$1,constants);var pako_1=pako,pako_2=pako_1.deflate,pako_3=pako_1.inflate;function createFind(e){return function(t,n,r){var i=Object(t);if(!isArrayLike_1(t)){var o=_baseIteratee(n);t=keys_1(t),n=function(e){return o(i[e],e,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:void 0}}var _createFind=createFind,INFINITY$3=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(e){return e?(e=toNumber_1(e))===INFINITY$3||e===-INFINITY$3?(e<0?-1:1)*MAX_INTEGER:e==e?e:0:0===e?e:0}var toFinite_1=toFinite;function toInteger(e){var t=toFinite_1(e),n=t%1;return t==t?n?t-n:t:0}var toInteger_1=toInteger,nativeMax$2=Math.max;function findIndex(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:toInteger_1(n);return i<0&&(i=nativeMax$2(r+i,0)),_baseFindIndex(e,_baseIteratee(t),i)}var findIndex_1=findIndex,find=_createFind(findIndex_1),find_1=find;function uniqWith(e,t){return t="function"==typeof t?t:void 0,e&&e.length?_baseUniq(e,void 0,t):[]}var uniqWith_1=uniqWith;function _slicedToArray$2(e,t){return _arrayWithHoles$2(e)||_iterableToArrayLimit$2(e,t)||_nonIterableRest$2()}function _nonIterableRest$2(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit$2(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}function _arrayWithHoles$2(e){if(Array.isArray(e))return e}function _classCallCheck$8(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$5(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$5(e,t,n){return t&&_defineProperties$5(e.prototype,t),n&&_defineProperties$5(e,n),e}function comparator(e,t){return long_1.fromValue(e).eq(t)}function validateField(e,t){var n=void 0===t?e.val:t,r=e.isBoolean,i=e.isNumber,o=e.oneof,a=e.len;if(2!==[r,i,o].filter((function(e){return!e})).length)throw new TypeError("invalid field type");if(void 0!==n){var s=!1;if(void 0!==o){var u=values_1(o);uniqWith_1(u,comparator).length===u.length&&void 0!==find_1(u,(function(e){return comparator(n,e)}))&&(s=!0)}var c=void 0!==r&&(0===n||1===n)&&1===a,l=void 0!==i&&n.toString(2).length<=a;if(!(s||c||l))throw new Error("invalid field value")}}var Struct=function(){function e(){_classCallCheck$8(this,e),this.size=0,this.fields=new Map}return _createClass$5(e,[{key:"define",value:function(e,t,n){if(this.size+=n,this.size>64)throw new RangeError("the struct over 64 bits is not supported");var r={val:0,isNumber:"number"===t,isBoolean:"boolean"===t,oneof:"number"===t||"boolean"===t?void 0:t,len:n};validateField(r),this.fields.set(e,r)}},{key:"set",value:function(e,t){var n=this.fields.get(e);if(!n)throw new Error("field not found");var r,i=n.oneof;if(long_1.isLong(t)||"number"==typeof t)r=t;else if("boolean"==typeof t)r=t?1:0;else{if(void 0===i)throw new Error("invalid field type");var o=i[t];if(void 0===o)throw new Error("field type not found");r=o}validateField(n,r),n.val=r}},{key:"toNumber",value:function(){var e=0,t=0,n=this.fields,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}var a=_slicedToArray$2(o,2)[1],s=a.len,u=a.val;void 0!==u&&(e+=long_1.fromValue(u).shiftLeft(t).toNumber(),t+=s)}return e}},{key:"toLong",value:function(){var e=long_1.fromNumber(0,!0),t=0,n=this.fields,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}var a=_slicedToArray$2(o,2)[1],s=a.len,u=a.val;void 0!==u&&(e=long_1.fromValue(u).shiftLeft(t).add(e),t+=s)}return e}},{key:"assert",value:function(e,t){var n=this.fields.get(e);if(!n)throw new Error("field not found");var r,i=n.oneof;if(long_1.isLong(t)||"number"==typeof t)r=t;else if("boolean"==typeof t)r=t?1:0;else{if(void 0===i)throw new Error("invalid field type");var o=i[t];if(void 0===o)throw new Error("field type not found");r=o}return validateField(n,r),comparator(r,n.val)}},{key:"from",value:function(e){var t=long_1.fromValue(e),n=0,r=this.fields,i=Array.isArray(r),o=0;for(r=i?r:r[Symbol.iterator]();;){var a;if(i){if(o>=r.length)break;a=r[o++]}else{if((o=r.next()).done)break;a=o.value}var s=_slicedToArray$2(a,2)[1],u=s.len,c=long_1.fromNumber(Math.pow(2,u)-1,!0).shiftLeft(n),l=t.and(c).shiftRightUnsigned(n);validateField(s,l),s.val=l,n+=u}}},{key:"typeOf",value:function(e){var t=this.fields.get(e);if(void 0!==t){var n=t.oneof,r=t.val;if(void 0!==n)for(var i=0,o=Object.entries(n);i<o.length;i++){var a=_slicedToArray$2(o[i],2),s=a[0];if(comparator(r,a[1]))return s}}throw new TypeError("can only get type of oneof type")}}]),e}();function _typeof$7(e){return(_typeof$7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$9(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$7(e,t){return!t||"object"!==_typeof$7(t)&&"function"!=typeof t?_assertThisInitialized$7(e):t}function _assertThisInitialized$7(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf$7(e){return(_getPrototypeOf$7=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$7(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$7(e,t)}function _setPrototypeOf$7(e,t){return(_setPrototypeOf$7=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var UserJoinOptions=function(e){function t(e){var n;return _classCallCheck$9(this,t),(n=_possibleConstructorReturn$7(this,_getPrototypeOf$7(t).call(this))).define("Rejoin","boolean",1),n.define("Unused","number",31),n.define("Platform","number",8),n.define("Version","number",12),n.define("Subversion","number",12),n.set("Platform",WEB_PLATFORM_TYPE),n.set("Version",VERSION_NO),n.set("Subversion",SUBVERSION),n.set("Rejoin",e),n}return _inherits$7(t,Struct),t}();function _typeof$8(e){return(_typeof$8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray$3(e,t){return _arrayWithHoles$3(e)||_iterableToArrayLimit$3(e,t)||_nonIterableRest$3()}function _nonIterableRest$3(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit$3(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}function _arrayWithHoles$3(e){if(Array.isArray(e))return e}function _classCallCheck$a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$6(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$6(e,t,n){return t&&_defineProperties$6(e.prototype,t),n&&_defineProperties$6(e,n),e}function _possibleConstructorReturn$8(e,t){return!t||"object"!==_typeof$8(t)&&"function"!=typeof t?_assertThisInitialized$8(e):t}function _assertThisInitialized$8(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf$8(e){return(_getPrototypeOf$8=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$8(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$8(e,t)}function _setPrototypeOf$8(e,t){return(_setPrototypeOf$8=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ownKeys$1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$1(n,!0).forEach((function(t){_defineProperty$2(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$1(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty$2(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var MessageDstType={PeerToPeerMessage:0,ChannelMessage:1,PeerRawMessage:3,ChannelRawMessage:4},InvitationType={CallInvite:101,CallAccept:102,CallReject:103,CallCancel:104},MessageType=_objectSpread({},MessageDstType,{},InvitationType),CompressionMethod={Uncompressed:0,Zlib:1},MessageOption=function(e){function t(e){var n;if(_classCallCheck$a(this,t),(n=_possibleConstructorReturn$8(this,_getPrototypeOf$8(t).call(this))).define("MessageType",MessageType,8),n.define("BroadcastJumps","number",2),n.define("ToCache","boolean",1),n.define("FromCache","boolean",1),n.define("CompressionMethod",CompressionMethod,2),n.define("IterationNumber","number",4),n.define("BufferedMessage","boolean",1),n.define("ToArchive","boolean",1),isLongNum(e))n.from(e);else if(void 0!==e){var r=getEntries(e),i=Array.isArray(r),o=0;for(r=i?r:r[Symbol.iterator]();;){var a;if(i){if(o>=r.length)break;a=r[o++]}else{if((o=r.next()).done)break;a=o.value}var s=_slicedToArray$3(a,2),u=s[0],c=s[1];n.set(u,c)}}return n}return _inherits$8(t,Struct),_createClass$6(t,[{key:"isTextMessage",value:function(){return this.assert("MessageType","ChannelMessage")||this.assert("MessageType","PeerToPeerMessage")}},{key:"isRawMessage",value:function(){return this.assert("MessageType","ChannelRawMessage")||this.assert("MessageType","PeerRawMessage")}},{key:"isRawPeerMessage",value:function(){return this.assert("MessageType","PeerRawMessage")}},{key:"isRawChannelMessage",value:function(){return this.assert("MessageType","ChannelRawMessage")}},{key:"isPeerToPeerMessage",value:function(){return this.assert("MessageType","PeerToPeerMessage")}},{key:"isChannelMessage",value:function(){return this.assert("MessageType","ChannelMessage")}},{key:"isInvitation",value:function(e){var t=this;return void 0!==e?this.assert("MessageType",e):getKeys(InvitationType).some((function(e){return t.assert("MessageType",e)}))}},{key:"isZlibCompressed",value:function(){return this.assert("CompressionMethod","Zlib")}},{key:"isFromCache",value:function(){return this.assert("FromCache",!0)}},{key:"isBufferedMessage",value:function(){return this.assert("BufferedMessage",!0)}},{key:"getInvitationType",value:function(){if(!this.isInvitation())throw new TypeError("cannot get InvitationType of a normal message type");return this.typeOf("MessageType")}}]),t}();function _typeof$9(e){return(_typeof$9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck$b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$7(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$7(e,t,n){return t&&_defineProperties$7(e.prototype,t),n&&_defineProperties$7(e,n),e}function _possibleConstructorReturn$9(e,t){return!t||"object"!==_typeof$9(t)&&"function"!=typeof t?_assertThisInitialized$9(e):t}function _assertThisInitialized$9(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf$9(e){return(_getPrototypeOf$9=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$9(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$9(e,t)}function _setPrototypeOf$9(e,t){return(_setPrototypeOf$9=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ChatManager=function(e){function t(e){var n;return _classCallCheck$b(this,t),(n=_possibleConstructorReturn$9(this,_getPrototypeOf$9(t).call(this,e,"ChatManager"))).dialogueLru=new TLRUCache(void 0,{maxlen:LRU_MAX_ITEMS,ttl:DIALOGUE_EXPIRE_TIMEOUT}),n}return _inherits$9(t,createEventBase()),_createClass$7(t,[{key:"getChatInfo",value:function(e){var t=this.dialogueLru.get(e);if(this.dialogueLru.prune(),t){var n=t.dialogue,r=t.sequence.add(1),i={dialogue:n,sequence:r};return this.dialogueLru.set(e,{dialogue:n,sequence:r}),i}var o={dialogue:getRandomUInt64(),sequence:long_1.fromNumber(1,!0)};return this.dialogueLru.set(e,o),o}}]),t}();function _typeof$a(e){return(_typeof$a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys$2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread$1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$2(n,!0).forEach((function(t){_defineProperty$3(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$2(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty$3(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _objectWithoutProperties$2(e,t){if(null==e)return{};var n,r,i=_objectWithoutPropertiesLoose$2(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose$2(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}function _slicedToArray$4(e,t){return _arrayWithHoles$4(e)||_iterableToArrayLimit$4(e,t)||_nonIterableRest$4()}function _nonIterableRest$4(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit$4(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}function _arrayWithHoles$4(e){if(Array.isArray(e))return e}function _toConsumableArray$6(e){return _arrayWithoutHoles$6(e)||_iterableToArray$6(e)||_nonIterableSpread$6()}function _nonIterableSpread$6(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray$6(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles$6(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function asyncGeneratorStep$6(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator$6(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep$6(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep$6(o,r,i,a,s,"throw",e)}a(void 0)}))}}function _classCallCheck$c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$a(e,t){return!t||"object"!==_typeof$a(t)&&"function"!=typeof t?_assertThisInitialized$a(e):t}function _assertThisInitialized$a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf$a(e){return(_getPrototypeOf$a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperties$8(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$8(e,t,n){return t&&_defineProperties$8(e.prototype,t),n&&_defineProperties$8(e,n),e}function _inherits$a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$a(e,t)}function _setPrototypeOf$a(e,t){return(_setPrototypeOf$a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Session$2=function(e){function t(e,n,r,i){var o;return _classCallCheck$c(this,t),(o=_possibleConstructorReturn$a(this,_getPrototypeOf$a(t).call(this,i,"Session"))).context=e,o.connection=n,o.instanceId=r,o.chatManager=new ChatManager(o.logger),o.joinedChannels=new Set,o.msgDedupLru=new LRUCache(void 0,{maxlen:MSG_DEDUP_MAX_LEN}),o.startTime=Date.now(),o.seq=long_1.fromNumber(1,!0),o.seqSentStatuses=[!1,!1],o.dialogueSequenceLru=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),o.curLoginSockets=[void 0,void 0],o.loginSocketSubs=[[],[]],o.lastLoginSockets=[new ReplaySubject(1),new ReplaySubject(1)],o.dialPendingMsgSubjectMaps=[new Map,new Map],o.log("The instanceId is %s",o.instanceId.toString()),o}return _inherits$a(t,createEventBase()),_createClass$8(t,null,[{key:"sendMessageAck",value:function(e,t){var n=new MessageOption(e.options);(n.isInvitation()||n.isPeerToPeerMessage()||n.isRawPeerMessage())&&t.sendPacket("Ack",{code:0,dialogue:e.dialogue,instance:e.instance,sequence:e.sequence})}}]),_createClass$8(t,[{key:"loginHandler",value:function(){var e=_asyncToGenerator$6(regenerator.mark((function e(){var t,n,r,i=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.connection.initConnection(),t=this.seq,n=this.getSocketLoginObservables(this.connection.lastOpenSockets,t),r=Date.now(),n.forEach((function(e,t){i.loginSocketSubs[t].push(e.pipe(tap(function(){var e=_asyncToGenerator$6(regenerator.mark((function e(n){var o;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.curLoginSockets[t]=n,o=Date.now(),sendReport("Link",{ackedServerIp:n.address,destServerIp:n.ip,ec:0,sc:0,elapse:getElapse(i.startTime),lts:long_1.fromNumber(o),responseTime:r-o,sid:getSid(i.instanceId),userId:i.context.uid}),i.emit("userJoined",n.env);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).subscribe(i.lastLoginSockets[t]))})),this.initKeepAliveSender(),this.initKeepAliveReconnector(),this.initLoginReceiver(),e.abrupt("return",merge.apply(void 0,_toConsumableArray$6(n).concat([fromEvent(this.connection,"connectionInitFailure").pipe(tap((function(e){if(isRtmError(e)||isTimeout(e))throw e;throw new RtmUnknownError("Login failure",LOGIN_ERR_UNKNOWN,e)})))])).pipe(first(),timeout(CLIENT_LOGIN_TIMEOUT),catchError((function(e){return e instanceof TimeoutError&&i.warn("Client login timeout"),i.clearSockets(),throwError(e)})),finalize((function(){i.connection.apClient.apFinish$.next(void 0)}))).toPromise());case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logoutHandler",value:function(){var e=_asyncToGenerator$6(regenerator.mark((function e(){var t,n,r,i=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getLoginSockets(),n=t.map((function(e){return e.sendPacket("UserQuit",{}),i.connection.waitClosing(e)})),this.clearSockets(LOGOUT_SOCKET_CLOSE_TIMEOUT),r=t.map((function(e){return e.env})),[0,1].filter((function(e){return!r.includes(e)})).forEach((function(e){i.connection.closeSocket(e,0)})),e.abrupt("return",merge.apply(void 0,_toConsumableArray$6(n)).toPromise());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"requestChannelJoin",value:function(){var e=_asyncToGenerator$6(regenerator.mark((function e(t,n){var r,i,o,a=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.getLoginSockets().length){e.next=2;break}throw new RtmInvalidStatusError("Client is not logged in. Cannot join the channel",JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN);case 2:return r=fromEvent(this,"channelLeft").pipe(filter((function(e){return e===t})),first()),i=this.incGetSeq(),(o=this.lastLoginSockets.map((function(e){return e.pipe(switchMap((function(e,t){0!==t&&a.incSeqIfNeeded(e.env);var r=0===t?i:a.seq;return e.sendPacket("GroupEnter",{account:n,seq:r}),e.fromReceived("GroupReply").pipe(first((function(e){var t=e.seq;return r.eq(t)})),tap((function(e){var t=e.code;if(0!==t)throw new RtmUnavailableError(["Channel join failure. The response code is %d",t],JOIN_CHANNEL_ERR_FAILURE)})))})),takeUntil(r),share())}))).forEach((function(e,t){return a.loginSocketSubs[t].push(e.subscribe({error:function(){}}))})),e.next=8,merge.apply(void 0,_toConsumableArray$6(o)).pipe(first(),timeout(COMMON_REQUEST_TIMEOUT),catchError((function(e){return e instanceof TimeoutError&&a.warn("Channel join timeout"),throwError(e)}))).toPromise();case 8:this.joinedChannels.add(t);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"requestChannelLeave",value:function(e,t){this.emit("channelLeft",e),this.joinedChannels.delete(e),this.getLoginSockets().forEach((function(e){e.sendPacket("GroupLeave",{account:t})}))}},{key:"requestChannelMemberList",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new RtmInvalidStatusError("Client is not logged in. Cannot get the channel members",GET_MEMBERS_ERR_REJECTED);var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("GroupAllUsersList",{group:e,pageNumber:0,pageSize:200,seq:r})})),race.apply(void 0,[t.genTimeoutError(GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT)].concat(_toConsumableArray$6(n.map((function(t){return t.fromReceived("GroupAllUsersResult").pipe(first((function(t){var n=t.group,i=t.seq;return n===e&&r.eq(i)})))})))))}},{key:"requestPeersOnlineStatus",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new RtmInvalidStatusError("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("UserStatusList",{users:e,seq:r})})),race.apply(void 0,[t.genTimeoutError(QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT)].concat(_toConsumableArray$6(n.map((function(e){return e.fromReceived("UserStatusResult").pipe(first((function(e){var t=e.seq;return r.eq(t)})))})))))}},{key:"requestSetLocalUserAttributes",value:function(e,n){var r=this,i=this.getLoginSockets();if(0===i.length)throw new RtmInvalidStatusError("Client is not logged in");var o=this.incGetSeq();return i.forEach((function(t,i){void 0!==n&&i!==n||t.sendPacket("UserAttributeSet",{account:r.context.uid,attributeInfos:Object.entries(e).map((function(e){var t=_slicedToArray$4(e,2);return{key:t[0],value:t[1]}})),seq:o})})),race.apply(void 0,_toConsumableArray$6(i.map((function(e){return e.fromReceived("UserAttributeErr").pipe(first((function(e){var t=e.seq;return o.eq(t)})),map$1((function(){throw new RtmUnavailableError("The user attributes set failure",ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray$6(i.map((function(e){return e.fromReceived("UserAttributeRsp").pipe(first((function(e){var t=e.seq;return o.eq(t)})))})))))}},{key:"requestSetChannelAttributes",value:function(e,n,r){var i=this.getLoginSockets();if(0===i.length)throw new RtmInvalidStatusError("Client is not logged in");var o=this.incGetSeq();return i.forEach((function(t){t.sendPacket("GroupAttributeSet",{broadcast:r,group:e,attributeInfos:Object.entries(n).map((function(e){var t=_slicedToArray$4(e,2);return{key:t[0],value:t[1]}})),seq:o})})),race.apply(void 0,_toConsumableArray$6(i.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return o.eq(t)})),map$1((function(){throw new RtmUnavailableError("The group attributes set failure",ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray$6(i.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(first((function(e){var t=e.seq;return o.eq(t)})))})))))}},{key:"requestAddOrUpdateLocalUserAttributes",value:function(e){var n=this,r=this.getLoginSockets();if(0===r.length)throw new RtmInvalidStatusError("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(t){t.sendPacket("UserAttributeMod",{account:n.context.uid,attributeInfos:Object.entries(e).map((function(e){var t=_slicedToArray$4(e,2);return{key:t[0],value:t[1]}})),seq:i})})),race.apply(void 0,_toConsumableArray$6(r.map((function(e){return e.fromReceived("UserAttributeErr").pipe(first((function(e){var t=e.seq;return i.eq(t)})),map$1((function(){throw new RtmUnavailableError("The user attributes add or update failure",ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray$6(r.map((function(e){return e.fromReceived("UserAttributeRsp").pipe(first((function(e){var t=e.seq;return i.eq(t)})))})))))}},{key:"requestAddOrUpdateChannelAttributes",value:function(e,n,r){var i=this.getLoginSockets();if(0===i.length)throw new RtmInvalidStatusError("Client is not logged in");var o=this.incGetSeq();return i.forEach((function(t){t.sendPacket("GroupAttributeMod",{broadcast:r,group:e,attributeInfos:Object.entries(n).map((function(e){var t=_slicedToArray$4(e,2);return{key:t[0],value:t[1]}})),seq:o})})),race.apply(void 0,_toConsumableArray$6(i.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return o.eq(t)})),map$1((function(){throw new RtmUnavailableError("The group attributes add or update failure",ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray$6(i.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(first((function(e){var t=e.seq;return o.eq(t)})))})))))}},{key:"requestDeleteLocalUserAttributesByKeys",value:function(e){var n=this,r=this.getLoginSockets();if(0===r.length)throw new RtmInvalidStatusError("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(t){t.sendPacket("UserAttributeDel",{account:n.context.uid,attributes:e,seq:i})})),race.apply(void 0,_toConsumableArray$6(r.map((function(e){return e.fromReceived("UserAttributeErr").pipe(first((function(e){var t=e.seq;return i.eq(t)})),map$1((function(){throw new RtmUnavailableError("The user attributes delete failure",ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray$6(r.map((function(e){return e.fromReceived("UserAttributeRsp").pipe(first((function(e){var t=e.seq;return i.eq(t)})))})))))}},{key:"requestDeleteChannelAttributesByKeys",value:function(e,n,r){var i=this.getLoginSockets();if(0===i.length)throw new RtmInvalidStatusError("Client is not logged in");var o=this.incGetSeq();return i.forEach((function(t){t.sendPacket("GroupAttributeDel",{group:e,broadcast:r,attributes:n,seq:o})})),race.apply(void 0,_toConsumableArray$6(i.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return o.eq(t)})),map$1((function(){throw new RtmUnavailableError("The channel attributes delete failure",ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray$6(i.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(first((function(e){var t=e.seq;return o.eq(t)})))})))))}},{key:"requestClearLocalUserAttributes",value:function(){var e=this,n=this.getLoginSockets();if(0===n.length)throw new RtmInvalidStatusError("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("UserAttributeSet",{account:e.context.uid,seq:r,attributeInfos:[]})})),race.apply(void 0,_toConsumableArray$6(n.map((function(e){return e.fromReceived("UserAttributeErr").pipe(first((function(e){var t=e.seq;return r.eq(t)})),map$1((function(){throw new RtmUnavailableError("The user attributes clear failure",ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray$6(n.map((function(e){return e.fromReceived("UserAttributeRsp").pipe(first((function(e){var t=e.seq;return r.eq(t)})))})))))}},{key:"requestClearChannelAttributes",value:function(e,n){var r=this.getLoginSockets();if(0===r.length)throw new RtmInvalidStatusError("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(t){t.sendPacket("GroupAttributeSet",{group:e,seq:i,attributeInfos:[],broadcast:n})})),race.apply(void 0,_toConsumableArray$6(r.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return i.eq(t)})),map$1((function(){throw new RtmUnavailableError("The channel attributes clear failure",ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray$6(r.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(first((function(e){var t=e.seq;return i.eq(t)})))})))))}},{key:"requestGetUserAttributesByKeys",value:function(e,n){var r=this.getLoginSockets();if(0===r.length)throw new RtmInvalidStatusError("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(t){t.sendPacket("UserAttributeGet",{account:e,seq:i,attributes:n})})),race.apply(void 0,[t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)].concat(_toConsumableArray$6(r.map((function(e){return e.fromReceived("UserAttributeErr").pipe(first((function(e){var t=e.seq;return i.eq(t)})),map$1((function(e){var t=e.code;if(10008===t)throw new RtmUnavailableError("The user requested is not online",ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND);throw new RtmUnknownError(["User attribute operation unknown error code: %d",t],ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))),_toConsumableArray$6(r.map((function(e){return e.fromReceived("UserAttributeRet").pipe(first((function(e){var t=e.seq;return i.eq(t)})))})))))}},{key:"requestGetChannelAttributesByKeys",value:function(e,n){var r=this.getLoginSockets();if(0===r.length)throw new RtmInvalidStatusError("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(t){t.sendPacket("GroupAttributeGet",{group:e,seq:i,attributes:n})})),race.apply(void 0,[t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)].concat(_toConsumableArray$6(r.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return i.eq(t)})),map$1((function(){throw new RtmUnavailableError("The channel attributes get failure",ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))),_toConsumableArray$6(r.map((function(e){return e.fromReceived("GroupAttributeRet").pipe(first((function(e){var t=e.seq;return i.eq(t)})))})))))}},{key:"requestGetUserAttributeKeys",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new RtmInvalidStatusError("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("UserAttributeKeysGet",{account:e,seq:r})})),race.apply(void 0,[t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)].concat(_toConsumableArray$6(n.map((function(e){return e.fromReceived("UserAttributeErr").pipe(first((function(e){var t=e.seq;return r.eq(t)})),map$1((function(e){var t=e.code;if(10008===t)throw new RtmUnavailableError("The user requested is not online",ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND);throw new RtmUnknownError(["User attribute operation unknown error code: %d",t],ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))),_toConsumableArray$6(n.map((function(e){return e.fromReceived("UserAttributeKeysRet").pipe(first((function(e){var t=e.seq;return r.eq(t)})))})))))}},{key:"requestGetChannelAttributesKeys",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new RtmInvalidStatusError("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("GroupAttributeKeysGet",{group:e,seq:r})})),race.apply(void 0,[t.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)].concat(_toConsumableArray$6(n.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return r.eq(t)})),map$1((function(e){var t=e.code;throw new RtmUnknownError(["Channel attribute operation unknown error code: %d",t],ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))),_toConsumableArray$6(n.map((function(e){return e.fromReceived("GroupAttributeKeysRet").pipe(first((function(e){var t=e.seq;return r.eq(t)})))})))))}},{key:"requestGetChannelMemberCount",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new RtmInvalidStatusError("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("GroupStatusList",{groups:e,seq:r})})),race.apply(void 0,[t.genTimeoutError(GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT)].concat(_toConsumableArray$6(n.map((function(e){return e.fromReceived("GroupStatusResult").pipe(first((function(e){var t=e.seq;return r.eq(t)})))})))))}},{key:"requestSubscribePeersOnlineStatus",value:function(e){var n=this.getLoginSockets();if(0===n.length)throw new RtmInvalidStatusError("Client is not logged in");var r=this.incGetSeq();return n.forEach((function(t){t.sendPacket("SubscribeUserStatus",{seq:r,users:e})})),race.apply(void 0,[t.genTimeoutError(PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT)].concat(_toConsumableArray$6(n.map((function(e){return e.fromReceived("SubscribeResponse").pipe(first((function(e){var t=e.seq;return r.eq(t)})))})))))}},{key:"requestUnsubscribePeersOnlineStatus",value:function(e){var t=this.getLoginSockets();if(0===t.length)throw new RtmInvalidStatusError("Client is not logged in");var n=this.incGetSeq();t.forEach((function(t){t.sendPacket("UnsubscribeUserStatus",{seq:n,users:e})}))}},{key:"sendInvitationMessage",value:function(){var e=_asyncToGenerator$6(regenerator.mark((function e(t){var n,r,i,o,a,s,u,c,l,d,p,f,h=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.peerId,r=t.callId,i=t.extra,o=t.isAcceptAck,a=t.channelId,s=t.type,u={callId:r},void 0===o){e.next=6;break}if("CallAccept"===s){e.next=5;break}throw new Error("invalid invitation type");case 5:u.type=o?"ack":"request";case 6:return u.channel=a,("CallInvite"===s||"CallCancel"===s||"CallReject"===s||"CallAccept"===s&&!1===o)&&void 0!==i&&(u.extra=i),c=getRandomUInt64(),this.log("The sent invitation body is %o",u),l=function(e){return{MiscMap:{},sequence:long_1.fromNumber(1),dialogue:c,instance:h.instanceId,dst:n,ms:long_1.fromNumber(Date.now(),!0),options:new MessageOption({IterationNumber:e,MessageType:s}).toLong(),payload:(new TextEncoder).encode(JSON.stringify(u)),src:h.context.uid}},e.next=14,from(this.sendMessageToRetry(l,!0)).pipe(timeout(MESSAGE_SEND_TIMEOUT),catchError((function(e){return e instanceof TimeoutError&&h.warn("Send invitation timeout"),throwError(e)}))).toPromise();case 14:return d=e.sent,p=d.code,f=d.retryTimes,e.abrupt("return",{hasPeerReceived:0===p,hasReSent:0!==f});case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendRawMessage",value:function(){var e=_asyncToGenerator$6(regenerator.mark((function e(t,n,r,i,o,a){var s,u,c,l,d,p,f,h,g,m,v=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=o.enableOfflineMessaging,u=o.enableHistoricalMessaging,isValidId(r)&&t instanceof Uint8Array&&"string"==typeof n){e.next=3;break}throw new RtmInvalidArgumentError("The send message arguments are not valid",i?PEER_MESSAGE_ERR_INVALID_USERID:CHANNEL_MESSAGE_ERR_FAILURE);case 3:if(!(t.byteLength+new Blob([n]).size>MESSAGE_TEXT_MAX_BYTES)){e.next=5;break}throw new RtmLimitExceededError("The message size is over the 32KB limit",i?PEER_MESSAGE_ERR_INVALID_MESSAGE:CHANNEL_MESSAGE_ERR_INVALID_MESSAGE);case 5:return c=t.byteLength>=MESSAGE_MIN_COMPRESSION_LEN,l=this.chatManager.getChatInfo(r),d=l.dialogue,p=l.sequence,f=this.instanceId,this.log('A%s %s raw message is sending to %s: "'.concat(f,"-").concat(d,"#").concat(p,'"'),c?" compressed":"",i?"peer":"channel",r),h=function(e){return{MiscMap:{description:n},sequence:p,dialogue:d,instance:f,dst:r,ms:long_1.fromNumber(Date.now(),!0),options:new MessageOption({IterationNumber:e,CompressionMethod:c?"Zlib":"Uncompressed",MessageType:i?"PeerRawMessage":"ChannelRawMessage",ToCache:s,ToArchive:u}).toLong(),payload:c?pako_2(t):t,src:v.context.uid}},e.next=12,from(this.sendMessageToRetry(h,!0)).pipe(timeout(void 0===a?MESSAGE_SEND_TIMEOUT:a),catchError((function(e){return e instanceof TimeoutError&&v.warn("Send message timeout"),throwError(e)}))).toPromise();case 12:return g=e.sent,m=g.code,e.abrupt("return",{hasPeerReceived:0===m});case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,o,a){return e.apply(this,arguments)}}()},{key:"sendTextMessage",value:function(){var e=_asyncToGenerator$6(regenerator.mark((function e(t,n,r,i,o){var a,s,u,c,l,d,p,f,h,g,m=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.enableOfflineMessaging,s=i.enableHistoricalMessaging,isValidId(n)){e.next=3;break}throw new RtmInvalidArgumentError("The send message arguments are not valid",r?PEER_MESSAGE_ERR_INVALID_USERID:CHANNEL_MESSAGE_ERR_FAILURE);case 3:if(!(new Blob([t]).size>MESSAGE_TEXT_MAX_BYTES)){e.next=5;break}throw new RtmLimitExceededError("The message size is over the 32KB limit",r?PEER_MESSAGE_ERR_INVALID_MESSAGE:CHANNEL_MESSAGE_ERR_INVALID_MESSAGE);case 5:return u=new Blob([t]).size>=MESSAGE_MIN_COMPRESSION_LEN,c=this.chatManager.getChatInfo(n),l=c.dialogue,d=c.sequence,p=this.instanceId,this.log('A%s %s message is sending to %s: "'.concat(p,"-").concat(l,"#").concat(d,'"'),u?" compressed":"",r?"peer":"channel",n),f=function(e){return{MiscMap:{},sequence:d,dialogue:l,instance:p,dst:n,ms:long_1.fromNumber(Date.now(),!0),options:new MessageOption({IterationNumber:e,CompressionMethod:u?"Zlib":"Uncompressed",MessageType:r?"PeerToPeerMessage":"ChannelMessage",ToCache:a,ToArchive:s}).toLong(),payload:u?pako_2(t):(new TextEncoder).encode(t),src:m.context.uid}},e.next=12,from(this.sendMessageToRetry(f,!0)).pipe(timeout(void 0===o?COMMON_REQUEST_TIMEOUT:o),catchError((function(e){return e instanceof TimeoutError&&m.warn("Send message timeout"),throwError(e)}))).toPromise();case 12:return h=e.sent,g=h.code,e.abrupt("return",{hasPeerReceived:0===g});case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,o){return e.apply(this,arguments)}}()},{key:"cleanLoginSubs",value:function(e){this.loginSocketSubs[e].reverse().forEach((function(e){return e.unsubscribe()})),this.loginSocketSubs[e]=[]}},{key:"sendMessageToRetry",value:function(){var e=_asyncToGenerator$6(regenerator.mark((function e(t,n){var r,i,o,a,s,u,c,l,d,p=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p.length>2&&void 0!==p[2]?p[2]:0,this.log("Attempt to send the message ".concat(n?" with retrying, %o":"without retrying"),{retryTimes:r}),0!==(i=this.getLoginSockets()).length){e.next=5;break}throw new Error("no logged-in sockets");case 5:return o=t(r),i.forEach((function(e){e.sendPacket("Message",o)})),a=o.dialogue,s=o.sequence,u=o.instance,c=i.map((function(e){return e.fromReceived("Ack").pipe(filter((function(e){return a.eq(e.dialogue)&&s.eq(e.sequence)&&u.eq(e.instance)})))})),e.prev=9,e.next=12,merge.apply(void 0,_toConsumableArray$6(c)).pipe(timeout(MESSAGE_RETRY_TIMEOUT)).pipe(first()).toPromise();case 12:return l=e.sent,d=l.code,this.log("The message has been acked, %o",{code:d}),e.abrupt("return",{code:d,retryTimes:r});case 18:if(e.prev=18,e.t0=e.catch(9),!(e.t0 instanceof TimeoutError&&n)){e.next=22;break}return e.abrupt("return",this.sendMessageToRetry(t,!1,r+1));case 22:throw e.t0;case 23:case"end":return e.stop()}}),e,this,[[9,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"initKeepAliveSender",value:function(){var e=this;this.lastLoginSockets.map((function(t){return t.pipe(switchMap((function(t){return timer(0,KEEPALIVE_INTERVAL).pipe(tap((function(){e.incSeqIfNeeded(t.env),t.sendPacket("Ping",{ms:long_1.fromNumber(Date.now(),!0),seq:e.seq})})))})))})).forEach((function(t,n){e.loginSocketSubs[n].push(t.subscribe({error:function(){}}))}))}},{key:"initKeepAliveReconnector",value:function(){var e=this;this.lastLoginSockets.map((function(e){return e.pipe(switchMap((function(e){var t,n=!1,r=e.userJoin$.pipe(tap((function(){n=!0}))),i=e.input$.pipe(tap((function(e){"Ping"!==uriToPacketName(e.uri)&&(n=!1)})));return merge(timer(LOGIN_RESP_TIMEOUT,SOCKET_KEEPALIVE_TIMEOUT).pipe(withLatestFrom(e.receivedPacket),tap((function(r){var i=_slicedToArray$4(r,2),o=_slicedToArray$4(i[1],2)[1];t!==o||n||e.forceReconnect(),t=o}))),r,i)})))})).forEach((function(t,n){e.loginSocketSubs[n].push(t.subscribe({error:function(){}}))}))}},{key:"initLoginReceiver",value:function(){var e=this;this.lastLoginSockets.map((function(t){return t.pipe(switchMap((function(t){return merge(fromEvent(t,"reconnect").pipe(tap(e.onReconnect(t))),t.fromReceived("Message").pipe(tap(e.onMessage(t))),t.fromReceived("GroupEnterNotice").pipe(tap(e.onGroupEnterNotice())),t.fromReceived("GroupLeaveNotice").pipe(tap(e.onGroupLeaveNotice())),t.fromReceived("GroupCountNotice").pipe(tap(e.onGroupCountNotice())),t.fromReceived("GroupAttributeAlt").pipe(tap(e.onGroupAttributeAlt())),t.fromReceived("UserJoinNotice").pipe(tap(e.onUserNotice(RtmStatusCode$1.PeerOnlineState.ONLINE))),t.fromReceived("UserQuitNotice").pipe(tap(e.onUserNotice(RtmStatusCode$1.PeerOnlineState.OFFLINE))),t.fromReceived("UserWaitNotice").pipe(tap(e.onUserNotice(RtmStatusCode$1.PeerOnlineState.UNREACHABLE)))).pipe(mapTo(void 0))})))})).forEach((function(t,n){e.loginSocketSubs[n].push(t.subscribe({error:function(){}}))}))}},{key:"requestSocketLogin",value:function(e,t,n){var r=this;return concat(defer$1(_asyncToGenerator$6(regenerator.mark((function i(){return regenerator.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:e.sendPacket("UserJoin",{account:r.context.uid,instance:r.instanceId,opt:new UserJoinOptions(t).toLong(),seq:n,ticket:e.ticket});case 1:case"end":return i.stop()}}),i)})))),e.fromReceived("UserResp").pipe(first((function(e){return n.eq(e.seq)})),tap((function(t){var n=t.code;if(0!==n)throw r.clearSockets(),r.logError("Connected to gateway success but the Rtm server rejected login"),new RtmUnavailableError(["Login failure. The response code from the RTM service is %d",n],LOGIN_ERR_REJECTED);r.log("ENV_%d logged in",e.env)})),mapTo(e),timeout(LOGIN_RESP_TIMEOUT))).pipe(filter((function(e){return void 0!==e})),catchError((function(e,n){return e instanceof TimeoutError&&r.warn("Login response timeout, rejoin: %s",t),r.logError(e),t?n:throwError(e)})))}},{key:"getSocketLoginObservables",value:function(e,t){var n=this;return e.map((function(e){return e.pipe(tap((function(e){e.on("socketUserDrop",(function(t){return n.onUserDrop(t,e)}))})),switchMap((function(e,r){return n.incSeqIfNeeded(e.env),n.requestSocketLogin(e,0!==r,0===r?t:n.seq)})),share())}))}},{key:"incSeqIfNeeded",value:function(e){if(![0,1].includes(e))throw new CommonError({INVALID_ENV:"The env argument is not 0 or 1"});this.seqSentStatuses[e]&&(this.seq=this.seq.add(1),this.seqSentStatuses=[!1,!1]),this.seqSentStatuses[e]=!0}},{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1),this.seqSentStatuses=[!0,!0],this.seq}},{key:"getLoginSockets",value:function(){return compact_1(this.curLoginSockets)}},{key:"emitMessage",value:function(e,t){var n=e.options,r=e.payload,i=e.src,o=e.dst,a=e.instance,s=e.dialogue,u=e.sequence,c=e.ms,l=e.MiscMap;this.dialogueSequenceLru.set(s.toString(),u);var d="".concat(a,"-").concat(s,"#").concat(u);if(this.msgDedupLru.has(d))this.warn("Env_%d: Messages out-of-order or not start with 1: %s",t,d);else{this.msgDedupLru.set(d,void 0);var p=new MessageOption(n),f=p.isZlibCompressed();if(p.isInvitation()){var h=f?pako_3(r,{to:"string"}):new TextDecoder("utf-8").decode(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)),g=JSON.parse(h);this.log("The received invitation body is %o",g),this.emit("invitationMessage",{body:g,type:p.getInvitationType(),peerId:i,serverReceivedTs:c.toNumber()})}else if(p.isTextMessage()){var m=p.isPeerToPeerMessage(),v=f?pako_3(r,{to:"string"}):new TextDecoder("utf-8").decode(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength));if(this.info("Received a%s %s text message from %s to %s, %s",f?" compressed":"",m?"peer":"channel",i,o,d),m){var y={text:v,peerId:i,properties:{serverReceivedTs:c.toNumber(),isOfflineMessage:p.isFromCache()}};this.emit("peerTextMessage",y)}else this.emit("channelTextMessage",{channelId:o,memberId:i,text:v,properties:{serverReceivedTs:c.toNumber(),isOfflineMessage:!1}})}else if(p.isRawMessage()){var _=p.isRawPeerMessage(),b=void 0===l.description?"":l.description,S=f?pako_3(r):r;if(this.info("Received a%s %s raw message from %s to %s, %s",f?" compressed":"",_?"peer":"channel",i,o,d),_){var E={desc:b,raw:S,peerId:i,properties:{serverReceivedTs:c.toNumber(),isOfflineMessage:p.isFromCache()}};this.emit("peerRawMessage",E)}else this.emit("channelRawMessage",{desc:b,raw:S,channelId:o,memberId:i,properties:{serverReceivedTs:c.toNumber(),isOfflineMessage:!1}})}}}},{key:"onReconnect",value:function(e){var t=this;return function(){var n=[0,1].filter((function(t){return t!==e.env}))[0],r=t.connection.curOpenSockets[n];r&&!0===r.notLoggedIn&&t.emit("connectionLost")}}},{key:"onUserDrop",value:function(e,t){var n=e.code;if(sendReport("KickedOff",{code:0,elapse:getElapse(this.startTime),linkId:Number.parseInt(t.name.split("-")[1],10),lts:long_1.fromNumber(Date.now()),server:t.address,serverCode:n,sid:getSid(this.instanceId),userId:this.context.uid}),10006!==n&&10001!==n){if(10009===n)return this.warn("The instance ID conflicts, reconnecting"),this.instanceId=getRandomUInt64(),this.context.sid=getSid(this.instanceId),void this.emit("instanceChanged",this.instanceId);[11,14,15,16].includes(n)&&(this.emit("userDrop",n),this.clearSockets())}else this.warn("Login too often and kicked off, reconnect and login")}},{key:"clearSockets",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;[0,1].forEach((function(n){e.cleanLoginSubs(n),e.connection.closeSocket(n,t)}))}},{key:"onMessage",value:function(e){var n=this;return function(r){var i=r.dialogue,o=r.instance,a=r.sequence,s=r.options;if(r.src!==n.context.uid){var u=i.toString(),c=n.dialPendingMsgSubjectMaps[e.env].get(u),l="".concat(o,"-").concat(i,"#").concat(a);if(c)return c.next(r),void n.log("Env_%d: The dialogue has pending messages, next: %s",e.env,l);var d=n.dialogueSequenceLru.get(u),p=!d&&a.eq(1),f=void 0!==d&&a.sub(d).eq(1);if(p||f)return t.sendMessageAck(r,e),void n.emitMessage(r,e.env);if(d){if(a.lte(d))return;n.log("Env_%d: The message pended, the sequence is not continuous with the last: %s",e.env,l)}else n.log("Env_%d: The message pended, the first sequence is not equal to 1: %s",e.env,l);var h=new Subject;n.dialPendingMsgSubjectMaps[e.env].set(u,h);var g=h.pipe(observeOn(async),scan((function(e,t){return[].concat(_toConsumableArray$6(e),[t])}),[]),map$1((function(e){return e.sort((function(e,t){var n=e.sequence,r=t.sequence;return n.eq(r)?0:n.gt(r)?1:-1}))})),shareReplay(1)),m=new MessageOption(s),v=!m.isFromCache()&&!m.isBufferedMessage();g.pipe(takeUntil(timer(v?ONLINE_MESSAGE_DEDUP_DELAY:OFFLINE_MESSAGE_DEDUP_DELAY)),first((function(e){if(e.length<2)return!1;for(var t=void 0===d?long_1.fromNumber(1,!0):d.add(1),n=0;n<e.length;t=t.add(1),n++)if(!e[n].sequence.eq(t))return!1;return!0})),finalize((function(){n.dialPendingMsgSubjectMaps[e.env].delete(u)}))).subscribe((function(r){r.forEach((function(r){t.sendMessageAck(r,e),n.emitMessage(r,e.env),n.log("Env_%d: The message queue has fully ordered, emitting: %s",e.env,"".concat(r.instance,"-").concat(r.dialogue,"#").concat(r.sequence))}))}),(function(r){r instanceof EmptyError&&g.pipe(first()).subscribe((function(r){return r.forEach((function(r){n.log("Env_%d: The message pending queue expired, emitting: %s",e.env,"".concat(r.instance,"-").concat(r.dialogue,"#").concat(r.sequence)),t.sendMessageAck(r,e),n.emitMessage(r,e.env)}))}))})),h.next(r)}else n.log("The message is from the local account, ignored")}}},{key:"onGroupEnterNotice",value:function(){var e=this;return function(t){var n=t.group,r=t.instance,i=t.seq,o=t.user,a=t.size;e.emit("memberNotice",{channelId:n,seq:i,instance:r,memberId:o,type:"MemberJoined",size:a})}}},{key:"onGroupLeaveNotice",value:function(){var e=this;return function(t){var n=t.group,r=t.instance,i=t.seq,o=t.user,a=t.size;e.emit("memberNotice",{channelId:n,seq:i,instance:r,memberId:o,type:"MemberLeft",size:a})}}},{key:"onGroupCountNotice",value:function(){var e=this;return function(t){var n=t.group,r=t.instance,i=t.size,o=t.seq;e.emit("memberNotice",{channelId:n,seq:o,instance:r,type:"MemberCountUpdated",size:i})}}},{key:"onGroupAttributeAlt",value:function(){var e=this;return function(t){var n=t.group,r=_objectWithoutProperties$2(t,["group"]);e.emit("channelAttributesUpdated",_objectSpread$1({channelId:n},r))}}},{key:"onUserNotice",value:function(e){var t=this;return function(n){var r=n.instance,i=n.seq,o=n.user;t.emit("peerOnlineStatusChanged",{peerId:o,instance:r,seq:i,state:e})}}}]),t}();function genGetSession(e){return function(){var t=e();if(!t)throw new RtmInvalidStatusError("Client is not logged in. Cannot do the operation");return t}}function _typeof$b(e){return(_typeof$b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep$7(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator$7(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep$7(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep$7(o,r,i,a,s,"throw",e)}a(void 0)}))}}function _classCallCheck$d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn$b(e,t){return!t||"object"!==_typeof$b(t)&&"function"!=typeof t?_assertThisInitialized$b(e):t}function _getPrototypeOf$b(e){return(_getPrototypeOf$b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _assertThisInitialized$b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _defineProperties$9(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$9(e,t,n){return t&&_defineProperties$9(e.prototype,t),n&&_defineProperties$9(e,n),e}function _inherits$b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$b(e,t)}function _setPrototypeOf$b(e,t){return(_setPrototypeOf$b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Session$2.genTimeoutError=function(e){return of(void 0).pipe(delay(COMMON_REQUEST_TIMEOUT),map$1((function(){throw new RtmTimeoutError(["Request timed out after %ds",COMMON_REQUEST_TIMEOUT],e)})))};var LocalInvitationFailureReason=RtmStatusCode$1.LocalInvitationFailureReason,LocalInvitationState=RtmStatusCode$1.LocalInvitationState,RemoteInvitationFailureReason=RtmStatusCode$1.RemoteInvitationFailureReason,RemoteInvitationState=RtmStatusCode$1.RemoteInvitationState,EndedInvitationLogMessage="The invitation has ended, skipped emitting the %s event",InvitationError=genError(),RtmLocalInvitation=function(e){function t(e,n,r){var i;return _classCallCheck$d(this,t),(i=_possibleConstructorReturn$b(this,_getPrototypeOf$b(t).call(this,r,"RtmLocalInvitation",!0))).calleeId=e,i.getSession=n,i.state=LocalInvitationState.IDLE,i.localInvitationEnd$=merge(fromEvent(_assertThisInitialized$b(i),"LocalInvitationAccepted"),fromEvent(_assertThisInitialized$b(i),"LocalInvitationRefused"),fromEvent(_assertThisInitialized$b(i),"LocalInvitationFailure"),fromEvent(_assertThisInitialized$b(i),"LocalInvitationCanceled")).pipe(first(),subscribeOn(async)),i.callId=v4_1(),i._content="",i._channelId="",i._response="",i.onLocalInvitationAccepted=function(){i.state===LocalInvitationState.RECEIVED_BY_REMOTE?i.state=LocalInvitationState.ACCEPTED_BY_REMOTE:i.log(EndedInvitationLogMessage,"LocalInvitationAccepted")},i.onLocalInvitationCanceled=function(){i.isLocalInvitationEnd()?i.log(EndedInvitationLogMessage,"LocalInvitationCanceled"):i.state=LocalInvitationState.CANCELED},i.onLocalInvitationFailure=function(){i.isLocalInvitationEnd()?i.log(EndedInvitationLogMessage,"LocalInvitationFailure"):i.state=LocalInvitationState.FAILURE},i.onLocalInvitationReceivedByPeer=function(){i.state===LocalInvitationState.SENT_TO_REMOTE?i.state=LocalInvitationState.RECEIVED_BY_REMOTE:i.log(EndedInvitationLogMessage,"LocalInvitationReceivedByPeer")},i.onLocalInvitationRefused=function(){i.state===LocalInvitationState.RECEIVED_BY_REMOTE?i.state=LocalInvitationState.REFUSED_BY_REMOTE:i.log(EndedInvitationLogMessage,"LocalInvitationRefused")},i}return _inherits$b(t,createEventBase()),_createClass$9(t,[{key:"channelId",get:function(){return this._channelId},set:function(e){if(!isValidId(e))throw new RtmInvalidArgumentError("Illegal invitation channel ID",INVITATION_API_CALL_ERR_INVALID_ARGUMENT);if(this.state!==LocalInvitationState.IDLE)throw new RtmInvalidStatusError(["Cannot set the channel ID under the %s state",this.state],INVITATION_API_CALL_ERR_ALREADY_SENT);this._channelId=e}},{key:"content",get:function(){return this._content},set:function(e){if(this.state!==LocalInvitationState.IDLE&&this.state!==LocalInvitationState.SENT_TO_REMOTE&&this.state!==LocalInvitationState.RECEIVED_BY_REMOTE)throw new RtmInvalidStatusError(["Cannot set the content under the %s state",this.state],INVITATION_API_CALL_ERR_ALREADY_SENT);if(new Blob([e]).size>INVITATION_EXTRA_MAX_BYTES)throw new RtmInvalidArgumentError('The length of the "content" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT);this._content=e}},{key:"response",get:function(){return this._response},set:function(e){throw new RtmInvalidArgumentError('Cannot set the "response" of the LocalInvitation instance.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT)}}]),_createClass$9(t,[{key:"send",value:function(){var e,t=this;if(this.state===LocalInvitationState.SENT_TO_REMOTE||this.state===LocalInvitationState.RECEIVED_BY_REMOTE)throw new RtmInvalidStatusError("The local invitation send failure. The call invitation has already been sent.",INVITATION_API_CALL_ERR_ALREADY_SENT);if(this.isLocalInvitationEnd())throw new RtmInvalidStatusError("The local invitation send failure. The call invitation has ended.",INVITATION_API_CALL_ERR_ALREADY_END);this.state=LocalInvitationState.SENT_TO_REMOTE,defer$1(_asyncToGenerator$7(regenerator.mark((function n(){var r,i,o;return regenerator.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getSession().sendInvitationMessage({peerId:t.calleeId,callId:t.callId,extra:t.content,type:"CallInvite",channelId:t.channelId});case 2:if(r=n.sent,i=r.hasPeerReceived,o=r.hasReSent,t.log("The local invitation has sent to the callee"),i||o){n.next=9;break}throw e=new InvitationError({PEER_NOT_ONLINE:"The peer of the invitation is not online"});case 9:if(i){n.next=12;break}throw e=new InvitationError({RESENT_AND_OFFLINE:"Resent and the peer of the invitation is not online"});case 12:case"end":return n.stop()}}),n)})))).pipe(retryWhen((function(e){return e.pipe(tap((function(e){if(!(e instanceof InvitationError))throw e})),delay(LOCAL_INVITATION_RESEND_INTERVAL))})),timeout(LOCAL_INVITATION_ACK_TIMEOUT),takeUntil(this.localInvitationEnd$)).subscribe({next:function(){t.isLocalInvitationEnd()?t.log(EndedInvitationLogMessage,"LocalInvitationReceivedByPeer"):t.state!==LocalInvitationState.RECEIVED_BY_REMOTE?(t.info("The peer received the local invitation %s.",t.callId),t.onLocalInvitationReceivedByPeer(),t.emit("LocalInvitationReceivedByPeer"),t.localInvitationEnd$.pipe(timeout(INVITATION_EXPIRE_TIMEOUT),takeUntil(t.localInvitationEnd$)).subscribe({error:function(e){t.isLocalInvitationEnd()?t.log(EndedInvitationLogMessage,"LocalInvitationFailure"):(t.state=LocalInvitationState.FAILURE,isTimeout(e)?t.emit("LocalInvitationFailure",LocalInvitationFailureReason.INVITATION_EXPIRE):e instanceof RtmInvalidStatusError?t.emit("LocalInvitationFailure",LocalInvitationFailureReason.NOT_LOGGEDIN):t.emit("LocalInvitationFailure",LocalInvitationFailureReason.UNKNOWN),t.onLocalInvitationFailure())}})):t.log('The local invitation state is already "RECEIVED_BY_REMOTE", skipped emitting "LocalInvitationReceivedByPeer"')},error:function(n){if(t.isLocalInvitationEnd())t.log(EndedInvitationLogMessage,"LocalInvitationFailure");else{if(t.onLocalInvitationFailure(),isTimeout(n)&&e){if("PEER_NOT_ONLINE"===e.code)return void t.emit("LocalInvitationFailure",LocalInvitationFailureReason.PEER_OFFLINE);if("RESENT_AND_OFFLINE"===e.code)return void t.emit("LocalInvitationFailure",LocalInvitationFailureReason.PEER_NO_RESPONSE)}t.emit("LocalInvitationFailure",LocalInvitationFailureReason.UNKNOWN)}}})}},{key:"cancel",value:function(){if(this.isLocalInvitationEnd())throw new RtmInvalidStatusError("The local invitation cancel failure",INVITATION_API_CALL_ERR_ALREADY_END);if(this.state===LocalInvitationState.IDLE)throw new RtmInvalidStatusError("The local invitation has not been sent",INVITATION_API_CALL_ERR_NOT_STARTED);this.getSession().sendInvitationMessage({callId:this.callId,peerId:this.calleeId,type:"CallCancel",channelId:this.channelId,extra:this.content}),this.onLocalInvitationCanceled(),this.emit("LocalInvitationCanceled")}},{key:"onAcceptReceived",value:function(e){this.isLocalInvitationEnd()?this.log(EndedInvitationLogMessage,"LocalInvitationAccepted"):(this._response=e,this.onLocalInvitationAccepted(),this.emit("LocalInvitationAccepted",e),this.getSession().sendInvitationMessage({callId:this.callId,isAcceptAck:!0,type:"CallAccept",peerId:this.calleeId,channelId:this.channelId}))}},{key:"onRefuseReceived",value:function(e){this.isLocalInvitationEnd()?this.log(EndedInvitationLogMessage,"LocalInvitationRefused"):(this._response=e,this.onLocalInvitationRefused(),this.emit("LocalInvitationRefused",e))}},{key:"isLocalInvitationEnd",value:function(){return[LocalInvitationState.CANCELED,LocalInvitationState.FAILURE,LocalInvitationState.ACCEPTED_BY_REMOTE,LocalInvitationState.REFUSED_BY_REMOTE].includes(this.state)}}]),t}(),RtmRemoteInvitation=function(e){function t(e,n,r,i,o,a){var s;return _classCallCheck$d(this,t),(s=_possibleConstructorReturn$b(this,_getPrototypeOf$b(t).call(this,i,"RtmRemoteInvitation",!0))).callerId=e,s.callId=n,s.getSession=r,s.logger=i,s._content=o,s._channelId=a,s.state=RemoteInvitationState.INVITATION_RECEIVED,s.remoteInvitationEnd$=merge(fromEvent(_assertThisInitialized$b(s),"RemoteInvitationCanceled"),fromEvent(_assertThisInitialized$b(s),"RemoteInvitationRefused"),fromEvent(_assertThisInitialized$b(s),"RemoteInvitationAccepted"),fromEvent(_assertThisInitialized$b(s),"RemoteInvitationFailure")).pipe(first(),subscribeOn(async)),s._response="",s.onRemoteInvitationAccepted=function(){s.state===RemoteInvitationState.ACCEPT_SENT_TO_LOCAL?s.state=RemoteInvitationState.ACCEPTED:s.log(EndedInvitationLogMessage,"RemoteInvitationAccepted")},s.onRemoteInvitationCanceled=function(){s.isRemoteInvitationEnd()?s.log(EndedInvitationLogMessage,"RemoteInvitationCanceled"):s.state=RemoteInvitationState.CANCELED},s.onRemoteInvitationFailure=function(){s.isRemoteInvitationEnd()?s.log(EndedInvitationLogMessage,"RemoteInvitationFailure"):s.state=RemoteInvitationState.FAILURE},s.onRemoteInvitationRefused=function(){s.state===RemoteInvitationState.INVITATION_RECEIVED?s.state=RemoteInvitationState.REFUSED:s.log(EndedInvitationLogMessage,"RemoteInvitationRefused")},s.remoteInvitationEnd$.pipe(timeout(INVITATION_EXPIRE_TIMEOUT),takeUntil(s.remoteInvitationEnd$)).subscribe({error:function(e){s.isRemoteInvitationEnd()?s.log(EndedInvitationLogMessage,"RemoteInvitationFailure"):(s.onRemoteInvitationFailure(),isTimeout(e)?s.emit("RemoteInvitationFailure",RemoteInvitationFailureReason.INVITATION_EXPIRE):s.emit("RemoteInvitationFailure",RemoteInvitationFailureReason.UNKNOWN))}}),s}return _inherits$b(t,createEventBase()),_createClass$9(t,[{key:"channelId",get:function(){return this._channelId},set:function(e){throw new RtmInvalidArgumentError('Cannot set the "response" of the RemoteInvitation instance.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT)}},{key:"content",get:function(){return this._content},set:function(e){throw new RtmInvalidArgumentError('Cannot set the "content" of the RemoteInvitation instance.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT)}},{key:"response",get:function(){return this._response},set:function(e){if(this.isRemoteInvitationEnd())throw new RtmInvalidStatusError("The response set failure. The call invitation has already ended.",INVITATION_API_CALL_ERR_ALREADY_END);if(this.state!==RemoteInvitationState.INVITATION_RECEIVED)throw new RtmInvalidStatusError(["Cannot set the response under the %s state",this.state],INVITATION_API_CALL_ERR_ALREADY_ACCEPT);if(new Blob([e]).size>INVITATION_EXTRA_MAX_BYTES)throw new RtmInvalidArgumentError('The length of the "content" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT);this._response=e}}]),_createClass$9(t,[{key:"accept",value:function(){var e=this;if(this.isRemoteInvitationEnd())throw new RtmInvalidStatusError("The local invitation has ended. Cannot accept.",INVITATION_API_CALL_ERR_ALREADY_END);if(this.state===RemoteInvitationState.ACCEPT_SENT_TO_LOCAL)throw new RtmInvalidStatusError("The remote invitation is accepting. Cannot do the operation.",INVITATION_API_CALL_ERR_ALREADY_ACCEPT);this.state=RemoteInvitationState.ACCEPT_SENT_TO_LOCAL,defer$1(_asyncToGenerator$7(regenerator.mark((function t(){return regenerator.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getSession().sendInvitationMessage({peerId:e.callerId,callId:e.callId,extra:e.response,type:"CallAccept",isAcceptAck:!1,channelId:e.channelId});case 2:if(t.sent.hasPeerReceived){t.next=6;break}throw new RtmUnavailableError;case 6:return t.next=8,fromEvent(e,"RemoteInvitationAccepted").toPromise();case 8:case"end":return t.stop()}}),t)})))).pipe(retryWhen((function(e){return e.pipe(delay(REMOTE_INVITATION_ACCEPT_RESEND_INTERVAL))})),timeout(REMOTE_INVITATION_WAIT_ACCEPT_ACK_TIMEOUT),takeUntil(this.remoteInvitationEnd$),throwIfEmpty()).subscribe({error:function(t){e.isRemoteInvitationEnd()?t instanceof EmptyError||e.log(EndedInvitationLogMessage,"RemoteInvitationFailure"):(e.logError(t),e.onRemoteInvitationFailure(),e.emit("RemoteInvitationFailure",RemoteInvitationFailureReason.ACCEPT_FAILURE))}})}},{key:"refuse",value:function(){if(this.state===RemoteInvitationState.ACCEPT_SENT_TO_LOCAL)throw new RtmInvalidStatusError("The remote invitation is accepting. Cannot do the operation.",INVITATION_API_CALL_ERR_ALREADY_ACCEPT);if(this.isRemoteInvitationEnd())throw new RtmInvalidStatusError("The invitation is end. Cannot refuse",INVITATION_API_CALL_ERR_ALREADY_END);this.getSession().sendInvitationMessage({peerId:this.callerId,callId:this.callId,extra:this.response,type:"CallReject",channelId:this.channelId}),this.onRemoteInvitationRefused(),this.emit("RemoteInvitationRefused")}},{key:"onCancelReceived",value:function(e){this.isRemoteInvitationEnd()?this.log(EndedInvitationLogMessage,"RemoteInvitationCanceled"):(this._content=e,this.onRemoteInvitationCanceled(),this.emit("RemoteInvitationCanceled",e))}},{key:"onAcceptAckReceived",value:function(){this.isRemoteInvitationEnd()?this.log(EndedInvitationLogMessage,"RemoteInvitationAccepted"):(this.onRemoteInvitationAccepted(),this.emit("RemoteInvitationAccepted"))}},{key:"isRemoteInvitationEnd",value:function(){return[RemoteInvitationState.ACCEPTED,RemoteInvitationState.REFUSED,RemoteInvitationState.CANCELED,RemoteInvitationState.FAILURE].includes(this.state)}}]),t}(),InvitationManager=function(e){function t(e,n){var r;return _classCallCheck$d(this,t),(r=_possibleConstructorReturn$b(this,_getPrototypeOf$b(t).call(this,n,"InvitationManager"))).logger=n,r.getSession=void 0,r.invitationDispatcher=new events,r.outgoingLocalInvitations=new Map,r.receivedRemoteInvitations=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),r.getSession=genGetSession(e),r.invitationDispatcher.on("remoteInvitationToManager",(function(e){var t=e.callId,i=e.extra,o=e.callerId,a=e.channelId;if(!r.receivedRemoteInvitations.has(t)){var s=new RtmRemoteInvitation(o,t,r.getSession,n,i,a);s.remoteInvitationEnd$.subscribe((function(){r.receivedRemoteInvitations.delete(t),s.removeAllListeners()})),r.receivedRemoteInvitations.set(t,s),r.emit("remoteInvitationInstance",s)}})),r.invitationDispatcher.on("acceptAckToRemoteInvitation",(function(e){var t=e.callId,n=r.receivedRemoteInvitations.get(t);n&&n.onAcceptAckReceived()})),r.invitationDispatcher.on("cancelToRemoteInvitation",(function(e){var t=e.callId,n=e.extra,i=r.receivedRemoteInvitations.get(t);i&&i.onCancelReceived(n)})),r.invitationDispatcher.on("acceptToLocalInvitation",(function(e){var t=e.callId,n=e.extra,i=r.outgoingLocalInvitations.get(t);i&&i.onAcceptReceived(n)})),r.invitationDispatcher.on("refuseToLocalInvitation",(function(e){var t=e.callId,n=e.extra,i=r.outgoingLocalInvitations.get(t);i&&i.onRefuseReceived(n)})),r}return _inherits$b(t,createEventBase()),_createClass$9(t,[{key:"invitationMessageHandler",value:function(e){var t=e.body,n=t.callId,r=t.extra,i=void 0===r?"":r,o=t.type,a=t.channel,s=void 0===a?"":a,u=e.type,c=e.peerId,l=e.serverReceivedTs;switch(u){case"CallAccept":return void("ack"===o?this.invitationDispatcher.emit("acceptAckToRemoteInvitation",{callId:n}):"request"===o&&this.invitationDispatcher.emit("acceptToLocalInvitation",{callId:n,extra:i}));case"CallInvite":return void this.invitationDispatcher.emit("remoteInvitationToManager",{callId:n,callerId:c,extra:i,channelId:s});case"CallCancel":if("0"===n){var d="".concat(END_CALL_PREFIX,"_").concat(s,"_").concat(i);return void this.getSession().emit("peerTextMessage",{peerId:c,properties:{serverReceivedTs:l,isOfflineMessage:!1},text:d})}return void this.invitationDispatcher.emit("cancelToRemoteInvitation",{callId:n,extra:i});case"CallReject":return void this.invitationDispatcher.emit("refuseToLocalInvitation",{callId:n,extra:i});default:throw assertNever("invitationType",u)}}},{key:"genLocalInvitation",value:function(e){var t=this,n=new RtmLocalInvitation(e,this.getSession,this.logger);return n.localInvitationEnd$.subscribe((function(){n.removeAllListeners(),t.outgoingLocalInvitations.delete(n.callId)})),this.outgoingLocalInvitations.set(n.callId,n),n}}]),t}(),FUNC_ERROR_TEXT$2="Expected a function";function throttle(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$2);return isObject_1(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),debounce_1(e,t,{leading:r,maxWait:t,trailing:i})}var throttle_1=throttle,_class,_temp;function _typeof$c(e){return(_typeof$c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray$7(e){return _arrayWithoutHoles$7(e)||_iterableToArray$7(e)||_nonIterableSpread$7()}function _nonIterableSpread$7(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray$7(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles$7(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function asyncGeneratorStep$8(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator$8(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep$8(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep$8(o,r,i,a,s,"throw",e)}a(void 0)}))}}function _classCallCheck$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$a(e,t,n){return t&&_defineProperties$a(e.prototype,t),n&&_defineProperties$a(e,n),e}function _possibleConstructorReturn$c(e,t){return!t||"object"!==_typeof$c(t)&&"function"!=typeof t?_assertThisInitialized$c(e):t}function _assertThisInitialized$c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf$c(e){return(_getPrototypeOf$c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$c(e,t)}function _setPrototypeOf$c(e,t){return(_setPrototypeOf$c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _applyDecoratedDescriptor(e,t,n,r,i){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}const MemberJoinState={JOINED:0,LEFT:1};var ConnectionState=RtmStatusCode$1.ConnectionState,Channel=(_temp=function(e){function t(e,n,r,i){var o;return _classCallCheck$e(this,t),(o=_possibleConstructorReturn$c(this,_getPrototypeOf$c(t).call(this,i,"RtmChannel",!0))).channelId=e,o.client=r,o.onMemberCountUpdated=throttle_1((function(e){e!==o.memberCount&&(o.memberCount=e,o.emit("MemberCountUpdated",e))}),MEMBER_COUNT_UPDATED_EVENT_INTERVAL),o.getSession=void 0,o.memberCount=0,o.memberJoinedLru=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),o.memberLeftLru=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),o.memberJoinStateLru=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),o.attributesSeqLru=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),o.onAttributesUpdated=function(e){var t=e.channelId,n=e.attributeMaps,r=e.instance,i=e.seq,a=r.toString(),s=o.attributesSeqLru.get(a);if((!s||i.greaterThan(s))&&(o.attributesSeqLru.set(a,i),t===o.channelId)){var u={},c=n,l=Array.isArray(c),d=0;for(c=l?c:c[Symbol.iterator]();;){var p;if(l){if(d>=c.length)break;p=c[d++]}else{if((d=c.next()).done)break;p=d.value}var f=p,h=f.key,g=f.ms,m=f.value,v=f.origin;if("string"!=typeof h||!long_1.isLong(g)||"string"!=typeof m||!isValidId(v))break;u[h]={value:m,lastUpdateUserId:v,lastUpdateTs:g.toNumber()}}o.emit("AttributesUpdated",u)}},o.onChannelTextMessage=function(e){var t=e.memberId,n=e.text,r=e.channelId,i=e.properties;r===o.channelId&&o.emit("ChannelMessage",{text:n,messageType:RtmStatusCode$1.MessageType.TEXT},t,i)},o.onChannelRawMessage=function(e){var t=e.desc,n=e.raw,r=e.memberId,i=e.channelId,a=e.properties;i===o.channelId&&o.emit("ChannelMessage",{messageType:RtmStatusCode$1.MessageType.RAW,rawMessage:n,description:t},r,a)},o.onMemberNotice=function(e){var t=e.channelId,n=e.instance,r=e.memberId,i=e.seq,a=e.type,s=e.size;if(t===o.channelId){var u=n.toString(),c=i.toString(),l={MemberLeft:o.memberLeftLru,MemberJoined:o.memberJoinedLru,MemberCountUpdated:void 0}[a];if(l){if(l.has(u+c))return void o.log("received duplicated %s notice (seq: %s), channel '%s', member '%s'",a,c,o.channelId,r);if(l.set(u+c,void 0),"string"!=typeof r)return;if(r!==o.getSession().context.uid){var d=o.memberJoinStateLru.get(r);if(d===MemberJoinState.JOINED&&"MemberJoined"===a)return void o.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",a,c,o.channelId,r);if(d===MemberJoinState.LEFT&&"MemberLeft"===a)return void o.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",a,c,o.channelId,r)}o.memberJoinStateLru.set(r,"MemberJoined"===a?MemberJoinState.JOINED:MemberJoinState.LEFT)}o.info("Channel %s - %s, memberId: %s",a,o.channelId,"MemberCountUpdated"===a?"[unknown]":r);var p=r===o.getSession().context.uid;"MemberLeft"===a&&isValidId(r)||"MemberJoined"===a&&isValidId(r)?(p||o.emit(a,r),o.onMemberCountUpdated(s)):"MemberCountUpdated"===a&&"number"==typeof s&&o.onMemberCountUpdated(s)}},o.getSession=genGetSession(n),o.info("A channel created, id %s",e),o}return _inherits$c(t,createEventBase()),_createClass$a(t,[{key:"join",value:function(){var e=_asyncToGenerator$8(regenerator.mark((function e(){var t;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(isValidId(this.channelId)){e.next=2;break}throw new RtmInvalidArgumentError([invalidArgumentMessage,"channelId"],JOIN_CHANNEL_ERR_INVALID_ARGUMENT);case 2:e.prev=2,t=this.getSession(),e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(2),new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN);case 9:if(!t.joinedChannels.has(this)){e.next=12;break}throw sendReport("ChnJoin",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),userId:t.context.uid,elapse:getElapse(t.startTime),errCode:JOIN_CHANNEL_ERR_ALREADY_JOINED,sid:getSid(t.instanceId)}),new RtmInvalidStatusError("The channel has joined. Cannot rejoin",JOIN_CHANNEL_ERR_ALREADY_JOINED);case 12:if(e.prev=12,this.log("Joining the channel %s",this.channelId),!this.hasOtherChannelJoined()){e.next=17;break}throw sendReport("ChnJoin",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),userId:t.context.uid,elapse:getElapse(t.startTime),errCode:JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,sid:getSid(t.instanceId)}),new RtmInvalidStatusError("A channel of the same channel ID has already joined. Cannot rejoin",JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID);case 17:if(t.joinedChannels.size!==MAX_JOINED_CHANNELS){e.next=20;break}throw sendReport("ChnJoin",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),userId:t.context.uid,elapse:getElapse(t.startTime),errCode:JOIN_CHANNEL_ERR_EXCEED_LIMIT,sid:getSid(t.instanceId)}),new RtmLimitExceededError("The joined channels has exceeded the limit of 20",JOIN_CHANNEL_ERR_EXCEED_LIMIT);case 20:return sendReport("ChnJoin",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),userId:t.context.uid,elapse:getElapse(t.startTime),errCode:0,sid:getSid(t.instanceId)}),e.next=23,t.requestChannelJoin(this,this.channelId);case 23:sendReport("ChnJoinRes",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),elapse:getElapse(t.startTime),errCode:0,sid:getSid(t.instanceId),serverErrCode:0,userId:t.context.uid}),this.info("The channel %s joined successfully",this.channelId),t.on("channelTextMessage",this.onChannelTextMessage),t.on("channelRawMessage",this.onChannelRawMessage),t.on("memberNotice",this.onMemberNotice),t.on("channelAttributesUpdated",this.onAttributesUpdated),e.next=40;break;case 31:if(e.prev=31,e.t1=e.catch(12),this.logError(e.t1),!isRtmError(e.t1)){e.next=36;break}throw e.t1;case 36:if(!isTimeout(e.t1)){e.next=39;break}throw sendReport("ChnJoinRes",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),elapse:getElapse(t.startTime),errCode:JOIN_CHANNEL_TIMEOUT,sid:getSid(t.instanceId),serverErrCode:0,userId:t.context.uid}),new RtmTimeoutError(["Join channel %s timed out",this.channelId],JOIN_CHANNEL_TIMEOUT);case 39:throw new RtmUnknownError(["The channel %s join failure",this.channelId],JOIN_CHANNEL_ERR_FAILURE,e.t1);case 40:case"end":return e.stop()}}),e,this,[[2,6],[12,31]])})));return function(){return e.apply(this,arguments)}}()},{key:"leave",value:function(){var e=_asyncToGenerator$8(regenerator.mark((function e(){var t;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=this.getSession(),e.next=7;break;case 4:throw e.prev=4,e.t0=e.catch(0),new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN);case 7:if(t.joinedChannels.has(this)){e.next=9;break}throw new RtmInvalidStatusError("The channel does not join. Cannot do the operation",LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL);case 9:e.prev=9,t.requestChannelLeave(this,this.channelId),this.memberLeftLru.empty(),this.memberJoinedLru.empty(),this.attributesSeqLru.empty(),this.memberJoinStateLru.empty(),this.memberCount=0,t.removeListener("channelTextMessage",this.onChannelTextMessage),t.removeListener("channelRawMessage",this.onChannelRawMessage),t.removeListener("memberNotice",this.onMemberNotice),t.removeListener("channelAttributesUpdated",this.onAttributesUpdated),e.next=31;break;case 22:if(e.prev=22,e.t1=e.catch(9),this.logError(e.t1),!isRtmError(e.t1)){e.next=29;break}throw!e.t1.code&&(e.t1.code=LEAVE_CHANNEL_ERR_REJECTED),sendReport("ChnLeave",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),elapse:getElapse(t.startTime),errCode:LEAVE_CHANNEL_ERR_REJECTED,sid:getSid(t.instanceId),userId:t.context.uid}),e.t1;case 29:throw sendReport("ChnLeave",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),elapse:getElapse(t.startTime),errCode:LEAVE_CHANNEL_ERR_FAILURE,sid:getSid(t.instanceId),userId:t.context.uid}),new RtmUnknownError("The channel leave failure",LEAVE_CHANNEL_ERR_FAILURE,e.t1);case 31:sendReport("ChnLeave",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),elapse:getElapse(t.startTime),errCode:0,sid:getSid(t.instanceId),userId:t.context.uid});case 32:case"end":return e.stop()}}),e,this,[[0,4],[9,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var e=_asyncToGenerator$8(regenerator.mark((function e(t){var n,r,i,o,a,s,u=this,c=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:{},r=n.enableHistoricalMessaging,i=void 0!==r&&r,isPlainObject$1(t)){e.next=3;break}throw new RtmInvalidArgumentError("Message is not valid",CHANNEL_MESSAGE_ERR_INVALID_MESSAGE);case 3:if(void 0===t.messageType&&(void 0!==t.rawMessage?t.messageType="RAW":t.messageType="TEXT"),o=!0,"RAW"===t.messageType&&void 0!==t.text&&(o=!1),"TEXT"===t.messageType&&(void 0!==t.rawMessage&&(o=!1),void 0!==t.description&&(o=!1)),o){e.next=9;break}throw new RtmInvalidArgumentError("Message is not valid",CHANNEL_MESSAGE_ERR_INVALID_MESSAGE);case 9:if(this.client.connectionState!==ConnectionState.RECONNECTING){e.next=12;break}return a=Date.now(),e.abrupt("return",new Promise((function(e,n){var r,o=function(){var o=_asyncToGenerator$8(regenerator.mark((function o(){var s,c;return regenerator.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,s=u.getSession(),o.next=7;break;case 4:throw o.prev=4,o.t0=o.catch(0),new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN);case 7:if(c=Date.now()-a,o.prev=8,"TEXT"!==t.messageType){o.next=15;break}return o.next=12,s.sendTextMessage(t.text,u.channelId,!1,{enableHistoricalMessaging:i,enableOfflineMessaging:!1},MESSAGE_SEND_TIMEOUT-c);case 12:e(),o.next=23;break;case 15:if("RAW"!==t.messageType){o.next=22;break}return void 0===t.description&&(t.description=""),o.next=19,s.sendRawMessage(t.rawMessage,t.description,u.channelId,!1,{enableHistoricalMessaging:i,enableOfflineMessaging:!1},MESSAGE_SEND_TIMEOUT-c);case 19:e(),o.next=23;break;case 22:n(new RtmInvalidArgumentError("Invalid message type",CHANNEL_MESSAGE_ERR_INVALID_MESSAGE));case 23:return o.abrupt("return");case 26:o.prev=26,o.t1=o.catch(8),isTimeout(o.t1)&&n(new RtmTimeoutError(genTimeoutMessage(u.name,"sendMessageToPeer",MESSAGE_SEND_TIMEOUT),CHANNEL_MESSAGE_ERR_TIMEOUT)),isRtmError(o.t1)&&n(o.t1),n(new RtmUnavailableError("Channel message send failure",CHANNEL_MESSAGE_ERR_FAILURE,o.t1));case 31:return o.prev=31,clearTimeout(r),o.finish(31);case 34:case"end":return o.stop()}}),o,null,[[0,4],[8,26,31,34]])})));return function(){return o.apply(this,arguments)}}();u.client.internalEmitter.once("RECONNECTED",o),r=setTimeout((function(){u.client.internalEmitter.off("RECONNECTED",o),n(new RtmTimeoutError(genTimeoutMessage(u.name,"sendMessageToPeer",MESSAGE_SEND_TIMEOUT),CHANNEL_MESSAGE_ERR_TIMEOUT))}),MESSAGE_RETRY_TIMEOUT)})));case 12:if(this.client.connectionState===ConnectionState.CONNECTED){e.next=14;break}throw new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN);case 14:e.prev=14,s=this.getSession(),e.next=21;break;case 18:throw e.prev=18,e.t0=e.catch(14),new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN);case 21:if(e.prev=21,s.joinedChannels.has(this)){e.next=24;break}throw new RtmInvalidStatusError("The channel does not join. Cannot do the operation",CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN);case 24:if("TEXT"!==t.messageType){e.next=29;break}return e.next=27,s.sendTextMessage(t.text,this.channelId,!1,{enableHistoricalMessaging:i,enableOfflineMessaging:!1});case 27:e.next=36;break;case 29:if("RAW"!==t.messageType){e.next=35;break}return void 0===t.description&&(t.description=""),e.next=33,s.sendRawMessage(t.rawMessage,t.description,this.channelId,!1,{enableHistoricalMessaging:i,enableOfflineMessaging:!1});case 33:e.next=36;break;case 35:throw new RtmInvalidArgumentError("Invalid message type",CHANNEL_MESSAGE_ERR_INVALID_MESSAGE);case 36:e.next=46;break;case 38:if(e.prev=38,e.t1=e.catch(21),!isTimeout(e.t1)){e.next=42;break}throw new RtmTimeoutError(genTimeoutMessage(this.name,"sendMessage",MESSAGE_SEND_TIMEOUT),CHANNEL_MESSAGE_ERR_TIMEOUT);case 42:if(!isRtmError(e.t1)){e.next=45;break}throw this.logError(e.t1),e.t1;case 45:throw new RtmUnknownError("The channel message send failure",CHANNEL_MESSAGE_ERR_FAILURE);case 46:case"end":return e.stop()}}),e,this,[[14,18],[21,38]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getMembers",value:function(){var e=_asyncToGenerator$8(regenerator.mark((function e(){var t,n,r;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.prev=1,t=this.getSession(),e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(1),new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",GET_MEMBERS_ERR_USER_NOT_LOGGED_IN);case 8:if(t.joinedChannels.has(this)){e.next=10;break}throw new RtmInvalidStatusError("The channel does not join. Cannot do the operation",GET_MEMBERS_ERR_NOT_IN_CHANNEL);case 10:return n=this.getSession().requestChannelMemberList(this.channelId),e.next=13,n.pipe(map$1((function(e){return e.memberInfos.map((function(e){return e.account}))}))).toPromise();case 13:return r=e.sent,this.info("Channel %s - get members success, %o",this.channelId,r),e.abrupt("return",r);case 18:if(e.prev=18,e.t1=e.catch(0),!isRtmError(e.t1)){e.next=23;break}throw this.logError(e.t1),e.t1;case 23:throw new RtmUnknownError("The channel members get failure",GET_MEMBERS_ERR_FAILURE);case 24:case"end":return e.stop()}}),e,this,[[0,18],[1,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"hasOtherChannelJoined",value:function(){var e=this;return!this.getSession().joinedChannels.has(this)&&_toConsumableArray$7(this.getSession().joinedChannels).some((function(t){return t.channelId===e.channelId}))}}]),t}(),_class=_temp,_applyDecoratedDescriptor(_class.prototype,"join",[logged],Object.getOwnPropertyDescriptor(_class.prototype,"join"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"leave",[logged],Object.getOwnPropertyDescriptor(_class.prototype,"leave"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"sendMessage",[logged],Object.getOwnPropertyDescriptor(_class.prototype,"sendMessage"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"getMembers",[logged],Object.getOwnPropertyDescriptor(_class.prototype,"getMembers"),_class.prototype),_class),_class$1,_temp$1;function _typeof$d(e){return(_typeof$d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys$3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread$2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$3(n,!0).forEach((function(t){_defineProperty$4(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$3(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _slicedToArray$5(e,t){return _arrayWithHoles$5(e)||_iterableToArrayLimit$5(e,t)||_nonIterableRest$5()}function _nonIterableRest$5(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit$5(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}function _arrayWithHoles$5(e){if(Array.isArray(e))return e}function _defineProperty$4(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function asyncGeneratorStep$9(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator$9(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep$9(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep$9(o,r,i,a,s,"throw",e)}a(void 0)}))}}function _classCallCheck$f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties$b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass$b(e,t,n){return t&&_defineProperties$b(e.prototype,t),n&&_defineProperties$b(e,n),e}function _possibleConstructorReturn$d(e,t){return!t||"object"!==_typeof$d(t)&&"function"!=typeof t?_assertThisInitialized$d(e):t}function _assertThisInitialized$d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf$d(e){return(_getPrototypeOf$d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits$d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf$d(e,t)}function _setPrototypeOf$d(e,t){return(_setPrototypeOf$d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _applyDecoratedDescriptor$1(e,t,n,r,i){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var ConnectionChangeReason=RtmStatusCode$1.ConnectionChangeReason,ConnectionState$1=RtmStatusCode$1.ConnectionState,connectionStateCodeMap={DISCONNECTED:1,CONNECTING:2,CONNECTED:3,RECONNECTING:4,ABORTED:5},connectionStateChangeReason={LOGIN:1,LOGIN_SUCCESS:2,LOGIN_FAILURE:3,LOGIN_TIMEOUT:4,INTERRUPTED:5,LOGOUT:6,BANNED_BY_SERVER:7,REMOTE_LOGIN:8},Client=(_temp$1=function(e){function t(e,n,r,i){var o;return _classCallCheck$f(this,t),(o=_possibleConstructorReturn$d(this,_getPrototypeOf$d(t).call(this,n,"RtmClient",!0))).parameters=r,o.setParameters=i,o.connectionState=ConnectionState$1.DISCONNECTED,o.internalEmitter=new events,o.context=void 0,o.attributes={},o.loginPromise=void 0,o.attributeDrafts=new Set,o.session=void 0,o.lastLoginTime=void 0,o.reconnId=0,o.channelAttributesCacheLru=new LRUCache(void 0,{maxlen:CHANNEL_ATTRIBUTES_CACHE_MAX_LENGTH}),o.invitationManager=new InvitationManager((function(){return o.session}),o.logger),o.subscribedPeerStatusCache={},o.peerStatusSeqLru=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),o.peerUnreachableTimers={},o.reconnectionTimer=void 0,o.userDropHandler=function(e){if(void 0!==o.reconnectionTimer&&window.clearTimeout(o.reconnectionTimer),o.connectionState!==ConnectionState$1.ABORTED)switch(e){case 11:return o.logError("Kicked off by remote session"),void o.onConnectionStateChanged(ConnectionState$1.ABORTED,ConnectionChangeReason.REMOTE_LOGIN);case 14:case 15:case 16:return o.logError("Server banned because of illegal ".concat({14:"User ID",15:"IP",16:"Channel Name"}[e])),void o.onConnectionStateChanged(ConnectionState$1.ABORTED,ConnectionChangeReason.BANNED_BY_SERVER);default:o.logError("User kicked off for unknown code: ".concat(e)),o.onConnectionStateChanged(ConnectionState$1.ABORTED,ConnectionChangeReason.INTERRUPTED)}},o.context=new Context(e,n),o.invitationManager.on("remoteInvitationInstance",(function(e){o.emit("RemoteInvitationReceived",e)})),o}return _inherits$d(t,createEventBase()),_createClass$b(t,[{key:"renewToken",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t&&0!==t.length){e.next=2;break}throw new RtmInvalidArgumentError("Invalid argument",RENEW_TOKEN_ERR_INVALID_ARGUMENT);case 2:if("string"!=typeof t){e.next=5;break}if(!(t.length<APP_ID_LENGTH||t.substr(3,APP_ID_LENGTH)!==this.context.appId)){e.next=5;break}throw new RtmInvalidArgumentError("Invalid token",RENEW_TOKEN_ERR_INVALID_TOKEN);case 5:if(this.connectionState!==ConnectionState$1.ABORTED){e.next=8;break}return e.next=8,new Promise((function(){}));case 8:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=10;break}throw new RtmInvalidStatusError("The client is not logged in",RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN);case 10:if(void 0!==this.session){e.next=12;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 12:return e.prev=12,e.next=15,this.session.connection.apClient.fetchAp(getUrl("ap-web-1.agora.io"),t).pipe(timeout(AP_REQUEST_TIMEOUT)).toPromise();case 15:n=e.sent,r=n.ticket,e.next=27;break;case 19:if(e.prev=19,e.t0=e.catch(12),e.t0.code!==LOGIN_ERR_INVALID_APP_ID&&e.t0.code!==LOGIN_ERR_INVALID_TOKEN){e.next=23;break}throw new RtmUnauthenticatedError("Invalid token",RENEW_TOKEN_ERR_INVALID_TOKEN);case 23:if(e.t0.code!==LOGIN_ERR_TOKEN_EXPIRED){e.next=25;break}throw new RtmUnauthenticatedError("The token expired",RENEW_TOKEN_ERR_TOKEN_EXPIRED);case 25:if(!isTimeout(e.t0)){e.next=27;break}throw new RtmTimeoutError("Renew token timed out",RENEW_TOKEN_ERR_FAILURE);case 27:this.context.token=t,this.session.curLoginSockets.filter((function(e){return void 0!==e})).forEach((function(e){return e.ticket=r}));case 29:case"end":return e.stop()}}),e,this,[[12,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"queryPeersOnlineStatus",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=2;break}throw new RtmInvalidStatusError("The client is not logged in",QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN);case 2:if(void 0!==this.session){e.next=4;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(!(!Array.isArray(t)||0===t.length||t.some((function(e){return!isValidId(e)}))||t.length>256)){e.next=6;break}throw new RtmInvalidArgumentError("invalid arguments",QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT);case 6:return e.next=8,this.session.requestPeersOnlineStatus(t).toPromise();case 8:return n=e.sent,r=mapValues_1(keyBy_1(n.userInfos,"account"),(function(e){var t=e.ts;return Boolean(t)})),Object.keys(r).forEach((function(e){if(e in i.subscribedPeerStatusCache&&i.subscribedPeerStatusCache[e]!==RtmStatusCode$1.PeerOnlineState.UNREACHABLE){var t=r[e]?RtmStatusCode$1.PeerOnlineState.ONLINE:RtmStatusCode$1.PeerOnlineState.OFFLINE;i.emit("PeersOnlineStatusChanged",_defineProperty$4({},e,t)),i.subscribedPeerStatusCache[e]=t}})),e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChannelMemberCount",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i,o,a,s,u,c,l,d,p,f,h,g=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=2;break}throw new RtmInvalidStatusError("The client is not logged in",GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN);case 2:if(void 0!==this.session){e.next=4;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(!(t.length>32)){e.next=6;break}throw new RtmInvalidArgumentError("getChannelMemberCount exceed limit of 32 channelIds",GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT);case 6:if(Array.isArray(t)&&0!==t.length){e.next=8;break}throw new RtmInvalidArgumentError("Invalid arguments: channelIds",GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT);case 8:n=t,r=Array.isArray(n),i=0,n=r?n:n[Symbol.iterator]();case 9:if(!r){e.next=15;break}if(!(i>=n.length)){e.next=12;break}return e.abrupt("break",24);case 12:o=n[i++],e.next=19;break;case 15:if(!(i=n.next()).done){e.next=18;break}return e.abrupt("break",24);case 18:o=i.value;case 19:if(isValidId(a=o)){e.next=22;break}throw new RtmInvalidArgumentError(["getChannelMemberCount channel id %s is invalid",a],GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT);case 22:e.next=9;break;case 24:return e.next=26,this.session.requestGetChannelMemberCount(t).toPromise();case 26:s=e.sent,u=s.groupInfos,c={},l=function(){if(p){if(f>=d.length)return"break";h=d[f++]}else{if((f=d.next()).done)return"break";h=f.value}var e=h,t=e.group,n=e.memberCount;isValidId(t)&&"number"==typeof n&&(g.session.joinedChannels.forEach((function(e){e.channelId===t&&e.onMemberCountUpdated(n)})),c[t]=n)},d=u,p=Array.isArray(d),f=0,d=p?d:d[Symbol.iterator]();case 31:if("break"!==l()){e.next=34;break}return e.abrupt("break",36);case 34:e.next=31;break;case 36:return e.abrupt("return",c);case 37:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setLocalUserAttributes",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i,o,a,s,u,c,l,d;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Object.keys(t).length>32)){e.next=2;break}throw new RtmLimitExceededError("Exceed the limit of 32 attributes",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 2:if(0!==Object.keys(t).length){e.next=4;break}throw new RtmInvalidArgumentError("The attributes is an empty object",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 4:n=0,r=0,i=Object.entries(t);case 6:if(!(r<i.length)){e.next=21;break}if(o=_slicedToArray$5(i[r],2),a=o[0],s=o[1],u=new Blob([a]).size,!(0===a.length||u>32)){e.next=11;break}throw new RtmInvalidArgumentError("Invalid attribute key",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 11:if(!((c=new Blob([s]).size)>8192)){e.next=14;break}throw new RtmLimitExceededError("Invalid attribute value, over the limit of 8KB",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 14:if(0!==s.length){e.next=16;break}throw new RtmInvalidArgumentError("Invalid attribute value",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 16:n+=u,n+=c;case 18:r++,e.next=6;break;case 21:if(!(n>16384)){e.next=23;break}throw new RtmLimitExceededError("The attributes size overflow",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 23:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=25;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 25:if(void 0!==this.session){e.next=27;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 27:return l=this.session.requestSetLocalUserAttributes(t).toPromise(),d={attribute:t,promise:l},this.attributeDrafts.add(d),e.prev=30,e.next=33,l;case 33:this.attributes=t,e.next=41;break;case 36:if(e.prev=36,e.t0=e.catch(30),!isRtmError(e.t0)){e.next=40;break}throw e.t0;case 40:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 41:return e.prev=41,this.attributeDrafts.delete(d),e.finish(41);case 44:case"end":return e.stop()}}),e,this,[[30,36,41,44]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setChannelAttributes",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t,n){var r,i,o,a,s,u,c,l,d,p,f,h,g,m=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=m.length>2&&void 0!==m[2]?m[2]:{},i=r.enableNotificationToChannelMembers,o=void 0!==i&&i,!(Object.keys(n).length>32)){e.next=3;break}throw new RtmLimitExceededError("Exceed the limit of 32 attributes",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 3:if(0!==Object.keys(n).length){e.next=5;break}throw new RtmInvalidArgumentError("The attributes is an empty object",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 5:a=0,s=0,u=Object.entries(n);case 7:if(!(s<u.length)){e.next=22;break}if(c=_slicedToArray$5(u[s],2),l=c[0],d=c[1],p=new Blob([l]).size,!(0===l.length||p>32)){e.next=12;break}throw new RtmInvalidArgumentError("Invalid attribute key",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 12:if(!((f=new Blob([d]).size)>8192)){e.next=15;break}throw new RtmLimitExceededError("Invalid attribute value, over the limit of 8KB",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 15:if(0!==d.length){e.next=17;break}throw new RtmInvalidArgumentError("Invalid attribute value",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 17:a+=p,a+=f;case 19:s++,e.next=7;break;case 22:if(!(a>32768)){e.next=24;break}throw new RtmLimitExceededError("The attributes size overflow",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 24:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=26;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 26:if(void 0!==this.session){e.next=28;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 28:return h=this.session.requestSetChannelAttributes(t,n,o).toPromise(),e.prev=29,e.next=32,h;case 32:g=mapValues_1(n,(function(e){return new Blob([e]).size})),this.channelAttributesCacheLru.set(t,g),e.next=41;break;case 36:if(e.prev=36,e.t0=e.catch(29),!isRtmError(e.t0)){e.next=40;break}throw e.t0;case 40:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 41:case"end":return e.stop()}}),e,this,[[29,36]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addOrUpdateLocalUserAttributes",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i,o,a,s,u,c,l,d,p,f,h;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(isPlainObject$1(t)){e.next=2;break}throw new RtmInvalidArgumentError("Invalid attribute",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 2:if(0!==Object.keys(t).length){e.next=4;break}throw new RtmInvalidArgumentError("The attributes is an empty object",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 4:if(n=_objectSpread$2({},this.attributes,{},t),!(Object.keys(n).length>32)){e.next=7;break}throw new RtmLimitExceededError("Exceed the limit of 32 attributes",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 7:for(r=0,i=0,o=Object.entries(n);i<o.length;i++)a=_slicedToArray$5(o[i],2),s=a[0],u=a[1],r+=new Blob([s,u]).size;if(!(r>16384)){e.next=11;break}throw new RtmLimitExceededError("The attributes size overflow",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 11:c=0,l=Object.entries(t);case 12:if(!(c<l.length)){e.next=23;break}if(d=_slicedToArray$5(l[c],2),p=d[0],u=d[1],!(0===p.length||new Blob([p]).size>32)){e.next=16;break}throw new RtmInvalidArgumentError("Invalid attribute key",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 16:if(!(new Blob([u]).size>8192)){e.next=18;break}throw new RtmLimitExceededError("Invalid attribute value, over the limit of 8KB",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 18:if(0!==u.length){e.next=20;break}throw new RtmInvalidArgumentError("Invalid attribute value",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 20:c++,e.next=12;break;case 23:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=25;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 25:if(void 0!==this.session){e.next=27;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 27:return f=this.session.requestAddOrUpdateLocalUserAttributes(t).toPromise(),h={attribute:n,promise:f},this.attributeDrafts.add(h),e.prev=30,e.next=33,f;case 33:this.attributes=n,e.next=41;break;case 36:if(e.prev=36,e.t0=e.catch(30),!isRtmError(e.t0)){e.next=40;break}throw e.t0;case 40:throw new RtmInvalidArgumentError("arguments is not valid",QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT);case 41:return e.prev=41,this.attributeDrafts.delete(h),e.finish(41);case 44:case"end":return e.stop()}}),e,this,[[30,36,41,44]])})));return function(t){return e.apply(this,arguments)}}()},{key:"addOrUpdateChannelAttributes",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t,n){var r,i,o,a,s,u,c,l,d,p,f,h,g,m=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=m.length>2&&void 0!==m[2]?m[2]:{},i=r.enableNotificationToChannelMembers,o=void 0!==i&&i,isPlainObject$1(n)){e.next=3;break}throw new RtmInvalidArgumentError("Invalid attribute",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 3:if(0!==Object.keys(n).length){e.next=5;break}throw new RtmInvalidArgumentError("The attributes is an empty object",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 5:if(!(Object.keys(n).length>32)){e.next=7;break}throw new RtmLimitExceededError("Exceed the limit of 32 attributes",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 7:a=this.channelAttributesCacheLru.get(t,{}),s=mapValues_1(n,(function(e){return new Blob([e]).size})),u=0,c=_objectSpread$2({},a,{},s),l=0,d=Object.entries(c);case 12:if(!(l<d.length)){e.next=25;break}if(p=_slicedToArray$5(d[l],2),f=p[0],h=p[1],!(0===f.length||new Blob([f]).size>32)){e.next=16;break}throw new RtmInvalidArgumentError("Invalid attribute key",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 16:if(!(h>8192)){e.next=18;break}throw new RtmLimitExceededError("Invalid attribute value, over the limit of 8KB",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 18:if(0!==h){e.next=20;break}throw new RtmInvalidArgumentError("Invalid attribute value",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 20:u+=h,u+=new Blob([f]).size;case 22:l++,e.next=12;break;case 25:if(!(u>32768)){e.next=27;break}throw new RtmLimitExceededError("The attributes size overflow",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);case 27:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=29;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 29:if(void 0!==this.session){e.next=31;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 31:return g=this.session.requestAddOrUpdateChannelAttributes(t,n,o).toPromise(),e.prev=32,e.next=35,g;case 35:this.channelAttributesCacheLru.set(t,c),e.next=43;break;case 38:if(e.prev=38,e.t0=e.catch(32),!isRtmError(e.t0)){e.next=42;break}throw e.t0;case 42:throw new RtmInvalidArgumentError("arguments is not valid",QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT);case 43:case"end":return e.stop()}}),e,this,[[32,38]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteLocalUserAttributesByKeys",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i,o,a,s,u;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Array.isArray(t)&&0!==t.length&&!t.some((function(e){return 0===e.length||e.length>32}))){e.next=2;break}throw new RtmInvalidStatusError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 2:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=4;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 4:if(void 0!==this.session){e.next=6;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return n=this.session.requestDeleteLocalUserAttributesByKeys(t).toPromise(),r={attribute:omit_1(this.attributes,t),promise:n},this.attributeDrafts.add(r),e.prev=9,e.next=12,n;case 12:i=t,o=Array.isArray(i),a=0,i=o?i:i[Symbol.iterator]();case 13:if(!o){e.next=19;break}if(!(a>=i.length)){e.next=16;break}return e.abrupt("break",27);case 16:s=i[a++],e.next=23;break;case 19:if(!(a=i.next()).done){e.next=22;break}return e.abrupt("break",27);case 22:s=a.value;case 23:u=s,delete this.attributes[u];case 25:e.next=13;break;case 27:e.next=34;break;case 29:if(e.prev=29,e.t0=e.catch(9),!isRtmError(e.t0)){e.next=33;break}throw e.t0;case 33:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 34:return e.prev=34,this.attributeDrafts.delete(r),e.finish(34);case 37:case"end":return e.stop()}}),e,this,[[9,29,34,37]])})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteChannelAttributesByKeys",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t,n){var r,i,o,a,s,u,c,l,d,p=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p.length>2&&void 0!==p[2]?p[2]:{},i=r.enableNotificationToChannelMembers,o=void 0!==i&&i,Array.isArray(n)&&0!==n.length&&isValidId(t)&&!n.some((function(e){return 0===e.length||e.length>32}))){e.next=3;break}throw new RtmInvalidStatusError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 3:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=5;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 5:if(void 0!==this.session){e.next=7;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return a=this.session.requestDeleteChannelAttributesByKeys(t,n,o).toPromise(),e.prev=8,e.next=11,a;case 11:if(!(s=this.channelAttributesCacheLru.get(t))){e.next=28;break}u=n,c=Array.isArray(u),l=0,u=c?u:u[Symbol.iterator]();case 14:if(!c){e.next=20;break}if(!(l>=u.length)){e.next=17;break}return e.abrupt("break",28);case 17:d=u[l++],e.next=24;break;case 20:if(!(l=u.next()).done){e.next=23;break}return e.abrupt("break",28);case 23:d=l.value;case 24:delete s[d];case 26:e.next=14;break;case 28:e.next=35;break;case 30:if(e.prev=30,e.t0=e.catch(8),!isRtmError(e.t0)){e.next=34;break}throw e.t0;case 34:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 35:case"end":return e.stop()}}),e,this,[[8,30]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"clearLocalUserAttributes",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(){var t,n;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=2;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 2:if(void 0!==this.session){e.next=4;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return t=this.session.requestClearLocalUserAttributes().toPromise(),n={attribute:{},promise:t},this.attributeDrafts.add(n),e.prev=7,e.next=10,t;case 10:this.attributes={},e.next=18;break;case 13:if(e.prev=13,e.t0=e.catch(7),!isRtmError(e.t0)){e.next=17;break}throw e.t0;case 17:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 18:return e.prev=18,this.attributeDrafts.delete(n),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[7,13,18,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"clearChannelAttributes",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i,o,a=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},r=n.enableNotificationToChannelMembers,i=void 0!==r&&r,this.connectionState===ConnectionState$1.CONNECTED){e.next=3;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 3:if(void 0!==this.session){e.next=5;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return o=this.session.requestClearChannelAttributes(t,i).toPromise(),e.prev=6,e.next=9,o;case 9:this.channelAttributesCacheLru.delete(t),e.next=17;break;case 12:if(e.prev=12,e.t0=e.catch(6),!isRtmError(e.t0)){e.next=16;break}throw e.t0;case 16:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 17:case"end":return e.stop()}}),e,this,[[6,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(isValidId(t)){e.next=2;break}throw new RtmInvalidArgumentError("Not a valid user ID",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 2:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=4;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 4:if(void 0!==this.session){e.next=6;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return e.prev=6,e.next=9,this.session.requestGetUserAttributeKeys(t).toPromise();case 9:return n=e.sent,r=n.keys,e.next=13,this.session.requestGetUserAttributesByKeys(t,r.slice(0,32)).toPromise();case 13:i=e.sent,e.next=21;break;case 16:if(e.prev=16,e.t0=e.catch(6),!isRtmError(e.t0)){e.next=20;break}throw e.t0;case 20:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 21:return e.abrupt("return",fromPairs_1(i.attributeInfos.map((function(e){return[e.key,e.value]}))));case 22:case"end":return e.stop()}}),e,this,[[6,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getChannelAttributes",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i,o,a,s,u,c,l,d,p,f,h,g;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(isValidId(t)){e.next=2;break}throw new RtmInvalidArgumentError("Not a valid channel ID",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 2:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=4;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 4:if(void 0!==this.session){e.next=6;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return e.prev=6,e.next=9,this.session.requestGetChannelAttributesKeys(t).toPromise();case 9:return n=e.sent,r=n.keys,e.next=13,this.session.requestGetChannelAttributesByKeys(t,r.slice(0,32)).toPromise();case 13:i=e.sent,o=i.attributeMaps,e.next=22;break;case 17:if(e.prev=17,e.t0=e.catch(6),!isRtmError(e.t0)){e.next=21;break}throw e.t0;case 21:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 22:a={},s=o,u=Array.isArray(s),c=0,s=u?s:s[Symbol.iterator]();case 24:if(!u){e.next=30;break}if(!(c>=s.length)){e.next=27;break}return e.abrupt("break",40);case 27:l=s[c++],e.next=34;break;case 30:if(!(c=s.next()).done){e.next=33;break}return e.abrupt("break",40);case 33:l=c.value;case 34:if(p=(d=l).key,f=d.ms,h=d.value,g=d.origin,"string"==typeof p&&long_1.isLong(f)&&"string"==typeof h&&isValidId(g)){e.next=37;break}return e.abrupt("break",40);case 37:a[p]={value:h,lastUpdateUserId:g,lastUpdateTs:f.toNumber()};case 38:e.next=24;break;case 40:return this.channelAttributesCacheLru.set(t,mapValues_1(a,(function(e){var t=e.value;return new Blob([t]).size}))),e.abrupt("return",a);case 42:case"end":return e.stop()}}),e,this,[[6,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getChannelAttributesByKeys",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t,n){var r,i,o,a,s,u,c,l,d,p,f,h,g;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=2;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 2:if(void 0!==this.session){e.next=4;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return checkValidAttrGetByKeysArgs(t,n),e.prev=5,e.next=8,this.session.requestGetChannelAttributesByKeys(t,n).toPromise();case 8:r=e.sent,i=r.attributeMaps,e.next=17;break;case 12:if(e.prev=12,e.t0=e.catch(5),!isRtmError(e.t0)){e.next=16;break}throw e.t0;case 16:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 17:o={},a=this.channelAttributesCacheLru.get(t,{}),s=i,u=Array.isArray(s),c=0,s=u?s:s[Symbol.iterator]();case 20:if(!u){e.next=26;break}if(!(c>=s.length)){e.next=23;break}return e.abrupt("break",37);case 23:l=s[c++],e.next=30;break;case 26:if(!(c=s.next()).done){e.next=29;break}return e.abrupt("break",37);case 29:l=c.value;case 30:if(p=(d=l).key,f=d.ms,h=d.value,g=d.origin,"string"==typeof p&&long_1.isLong(f)&&"string"==typeof h&&isValidId(g)){e.next=33;break}return e.abrupt("break",37);case 33:a[p]=new Blob([h]).size,o[p]={value:h,lastUpdateUserId:g,lastUpdateTs:f.toNumber()};case 35:e.next=20;break;case 37:return this.channelAttributesCacheLru.set(t,a),e.abrupt("return",o);case 39:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getUserAttributesByKeys",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t,n){var r;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=2;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 2:if(void 0!==this.session){e.next=4;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return checkValidAttrGetByKeysArgs(t,n),e.prev=5,e.next=8,this.session.requestGetUserAttributesByKeys(t,n).toPromise();case 8:r=e.sent,e.next=16;break;case 11:if(e.prev=11,e.t0=e.catch(5),!isRtmError(e.t0)){e.next=15;break}throw e.t0;case 15:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 16:return e.abrupt("return",fromPairs_1(r.attributeInfos.map((function(e){return[e.key,e.value]}))));case 17:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=getRandomUInt64(),r=t.token,t.token===this.context.appId&&(r=void 0),sendReport("Session",{appId:this.context.appId,did:navigator.userAgent,elapse:getElapse(this.session&&this.session.startTime),index:{index1:t.uid,index2:this.context.appId,index3:"enableLogUpload=".concat(this.parameters.enableLogUpload)},installId:processId,lts:long_1.fromNumber(Date.now()),os:WEB_PLATFORM_TYPE,sid:getSid(n),token:r||"",userId:t.uid,ver:version}),isPlainObject$1(t)&&isValidId(t.uid)){e.next=6;break}throw new RtmInvalidArgumentError("not a valid user id",LOGIN_ERR_INVALID_ARGUMENT);case 6:if("string"!=typeof r||!r){e.next=12;break}if(!(r.length<APP_ID_LENGTH+3||r.substr(3,APP_ID_LENGTH)!==this.context.appId)){e.next=9;break}throw new RtmInvalidArgumentError("Invalid token",LOGIN_ERR_INVALID_TOKEN);case 9:this.context.token=r,e.next=14;break;case 12:if("string"==typeof r||isNil_1(r)){e.next=14;break}throw new RtmInvalidArgumentError('The "token" is not a valid string.',LOGIN_ERR_INVALID_ARGUMENT);case 14:return i=Date.now(),this.context.sid=getSid(n),this.loginPromise=this.loginImpl({uid:t.uid,instanceId:n}),this.info("RTM Client logging in as".concat(t.uid)),e.prev=18,e.next=21,this.loginPromise;case 21:e.next=28;break;case 23:throw e.prev=23,e.t0=e.catch(18),isRtmError(e.t0)&&sendReport("Link",{ackedServerIp:"",destServerIp:"",ec:e.t0.code||1,sc:e.t0.serverCode,elapse:getElapse(this.session&&this.session.startTime),lts:long_1.fromNumber(Date.now()),responseTime:Date.now()-i,sid:getSid(n),userId:t.uid}),this.context.token=void 0,e.t0;case 28:return e.prev=28,this.loginPromise=void 0,e.finish(28);case 31:case"end":return e.stop()}}),e,this,[[18,23,28,31]])})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.loginPromise){e.next=3;break}return e.next=3,this.loginPromise;case 3:if(void 0!==this.reconnectionTimer&&window.clearTimeout(this.reconnectionTimer),this.connectionState!==ConnectionState$1.DISCONNECTED){e.next=7;break}throw this.logError("Already in logout state"),new RtmInvalidStatusError("Logout failure. The client has already been logged out",LOGOUT_ERR_USER_NOT_LOGGED_IN);case 7:if(this.connectionState!==ConnectionState$1.ABORTED){e.next=11;break}return this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'),this.onConnectionStateChanged(ConnectionState$1.DISCONNECTED,ConnectionChangeReason.LOGOUT),e.abrupt("return");case 11:if(void 0!==this.session){e.next=14;break}return this.onConnectionStateChanged(ConnectionState$1.DISCONNECTED,ConnectionChangeReason.LOGOUT),e.abrupt("return");case 14:return sendReport("Logout",{elapse:getElapse(this.session.startTime),lts:long_1.fromNumber(Date.now()),sid:getSid(this.session.instanceId),userId:this.context.uid}),e.next=17,this.session.logoutHandler();case 17:this.onConnectionStateChanged(ConnectionState$1.DISCONNECTED,ConnectionChangeReason.LOGOUT),this.log("Log out success");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendMessageToPeer",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t,n){var r,i,o,a,s,u,c,l,d,p,f,h,g,m,v,y,_=this,b=arguments;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=b.length>2&&void 0!==b[2]?b[2]:{},i=r.enableOfflineMessaging,o=void 0!==i&&i,a=r.enableHistoricalMessaging,s=void 0!==a&&a,isPlainObject$1(t)){e.next=3;break}throw new RtmInvalidArgumentError("Message is not valid",PEER_MESSAGE_ERR_INVALID_MESSAGE);case 3:if(void 0===t.messageType&&(void 0!==t.rawMessage?t.messageType="RAW":t.messageType="TEXT"),u=!0,c=!1,"RAW"===t.messageType&&void 0!==t.text&&(u=!1),"TEXT"===t.messageType&&("string"!=typeof t.text?u=!1:t.text.startsWith(END_CALL_PREFIX)&&(l=t.text.split("_"),d=_slicedToArray$5(l,3),p=d[0],f=d[1],void 0!==d[2]&&isValidId(f)&&p===END_CALL_PREFIX?c=!0:u=!1),void 0!==t.rawMessage&&(u=!1),void 0!==t.description&&(u=!1)),u){e.next=10;break}throw new RtmInvalidArgumentError("Message is not valid",PEER_MESSAGE_ERR_INVALID_MESSAGE);case 10:if(this.connectionState!==ConnectionState$1.RECONNECTING){e.next=13;break}return h=Date.now(),e.abrupt("return",new Promise((function(e,r){var i,a=function(){var a=_asyncToGenerator$9(regenerator.mark((function a(){var u,l,d,p,f;return regenerator.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(void 0!==_.session){a.next=2;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 2:if(u=Date.now()-h,a.prev=3,"TEXT"!==t.messageType){a.next=22;break}if(!c){a.next=15;break}return l=t.text.split("_"),d=_slicedToArray$5(l,3),p=d[1],f=d[2],_.log("[rtm-API] EndCall message send api is called"),a.t0=e,a.next=11,_.session.sendInvitationMessage({peerId:n,type:"CallCancel",extra:f,channelId:p,callId:"0"});case 11:a.t1=a.sent,(0,a.t0)(a.t1),a.next=20;break;case 15:return a.t2=e,a.next=18,_.session.sendTextMessage(t.text,n,!0,{enableOfflineMessaging:o,enableHistoricalMessaging:s},MESSAGE_SEND_TIMEOUT-u);case 18:a.t3=a.sent,(0,a.t2)(a.t3);case 20:a.next=32;break;case 22:if("RAW"!==t.messageType){a.next=31;break}return void 0===t.description&&(t.description=""),a.t4=e,a.next=27,_.session.sendRawMessage(t.rawMessage,t.description,n,!0,{enableOfflineMessaging:o,enableHistoricalMessaging:s},MESSAGE_SEND_TIMEOUT-u);case 27:a.t5=a.sent,(0,a.t4)(a.t5),a.next=32;break;case 31:r(new RtmInvalidArgumentError("Invalid message type",PEER_MESSAGE_ERR_INVALID_MESSAGE));case 32:return a.abrupt("return");case 35:a.prev=35,a.t6=a.catch(3),isTimeout(a.t6)&&r(new RtmTimeoutError(genTimeoutMessage(_.name,"sendMessageToPeer",MESSAGE_SEND_TIMEOUT),PEER_MESSAGE_ERR_TIMEOUT)),isRtmError(a.t6)&&r(a.t6),r(new RtmUnavailableError("Peer-to-peer message send failure",PEER_MESSAGE_ERR_FAILURE,a.t6));case 40:return a.prev=40,clearTimeout(i),a.finish(40);case 43:case"end":return a.stop()}}),a,null,[[3,35,40,43]])})));return function(){return a.apply(this,arguments)}}();_.internalEmitter.once("RECONNECTED",a),i=setTimeout((function(){_.internalEmitter.off("RECONNECTED",a),r(new RtmTimeoutError(genTimeoutMessage(_.name,"sendMessageToPeer",MESSAGE_SEND_TIMEOUT),PEER_MESSAGE_ERR_TIMEOUT))}),MESSAGE_RETRY_TIMEOUT)})));case 13:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=15;break}throw new RtmInvalidStatusError("Failed to send the peer-to-peer message. The client is not logged in",PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN);case 15:if(void 0!==this.session){e.next=17;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 17:if(e.prev=17,"TEXT"!==t.messageType){e.next=28;break}if(!c){e.next=25;break}return g=t.text.split("_"),m=_slicedToArray$5(g,3),v=m[1],y=m[2],this.log("[rtm-API] EndCall message send api is called"),e.next=24,this.session.sendInvitationMessage({peerId:n,type:"CallCancel",extra:y,channelId:v,callId:"0"});case 24:return e.abrupt("return",e.sent);case 25:return e.next=27,this.session.sendTextMessage(t.text,n,!0,{enableOfflineMessaging:o,enableHistoricalMessaging:s});case 27:return e.abrupt("return",e.sent);case 28:if("RAW"!==t.messageType){e.next=33;break}return void 0===t.description&&(t.description=""),e.next=32,this.session.sendRawMessage(t.rawMessage,t.description,n,!0,{enableOfflineMessaging:o,enableHistoricalMessaging:s});case 32:return e.abrupt("return",e.sent);case 33:throw new RtmInvalidArgumentError("Invalid message type",PEER_MESSAGE_ERR_INVALID_MESSAGE);case 36:if(e.prev=36,e.t0=e.catch(17),!isTimeout(e.t0)){e.next=40;break}throw new RtmTimeoutError(genTimeoutMessage(this.name,"sendMessageToPeer",MESSAGE_SEND_TIMEOUT),PEER_MESSAGE_ERR_TIMEOUT);case 40:if(!isRtmError(e.t0)){e.next=42;break}throw e.t0;case 42:throw new RtmUnavailableError("Peer-to-peer message send failure",PEER_MESSAGE_ERR_FAILURE,e.t0);case 43:case"end":return e.stop()}}),e,this,[[17,36]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createChannel",value:function(e){var t=this;if(!isValidId(e))throw new RtmInvalidArgumentError([invalidArgumentMessage,getName({channelId:e})],CREATE_CHANNEL_ERR_INVALID_ARGUMENT);return new Channel(e,(function(){return t.session}),this,this.logger)}},{key:"createLocalInvitation",value:function(e){if(!isValidId(e))throw new RtmInvalidArgumentError([invalidArgumentMessage,getName({calleeId:e})],INVITATION_API_CALL_ERR_INVALID_ARGUMENT);return this.invitationManager.genLocalInvitation(e)}},{key:"subscribePeersOnlineStatus",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i,o,a,s,u,c,l,d,p,f,h,g,m,v,y,_,b,S,E,w=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=2;break}throw new RtmInvalidStatusError("The client is not logged in",PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN);case 2:if(void 0!==this.session){e.next=4;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(t)&&0!==t.length){e.next=6;break}throw new RtmInvalidArgumentError("Invalid arguments: peerIds",PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT);case 6:n=t,r=Array.isArray(n),i=0,n=r?n:n[Symbol.iterator]();case 7:if(!r){e.next=13;break}if(!(i>=n.length)){e.next=10;break}return e.abrupt("break",22);case 10:o=n[i++],e.next=17;break;case 13:if(!(i=n.next()).done){e.next=16;break}return e.abrupt("break",22);case 16:o=i.value;case 17:if(isValidId(a=o)){e.next=20;break}throw new RtmInvalidArgumentError(["subscribePeersOnlineStatus peer id %s is invalid",a],PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT);case 20:e.next=7;break;case 22:if(!((s=uniq_1(t)).length+Object.keys(this.subscribedPeerStatusCache).length>512)){e.next=25;break}throw new RtmLimitExceededError("Subscribed peers overflows",PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW);case 25:return e.next=27,this.session.requestSubscribePeersOnlineStatus(s).toPromise();case 27:u=e.sent,c=u.errors,l=[],d=[],p=c,f=Array.isArray(p),h=0,p=f?p:p[Symbol.iterator]();case 32:if(!f){e.next=38;break}if(!(h>=p.length)){e.next=35;break}return e.abrupt("break",48);case 35:g=p[h++],e.next=42;break;case 38:if(!(h=p.next()).done){e.next=41;break}return e.abrupt("break",48);case 41:g=h.value;case 42:if(v=(m=g).code,"string"==typeof(y=m.account)){e.next=45;break}throw new RtmUnavailableError("Returned account is invalid",PEER_SUBSCRIPTION_STATUS_ERR_FAILURE);case 45:0!==v&&l.push(y);case 46:e.next=32;break;case 48:_=s,b=Array.isArray(_),S=0,_=b?_:_[Symbol.iterator]();case 49:if(!b){e.next=55;break}if(!(S>=_.length)){e.next=52;break}return e.abrupt("break",63);case 52:E=_[S++],e.next=59;break;case 55:if(!(S=_.next()).done){e.next=58;break}return e.abrupt("break",63);case 58:E=S.value;case 59:y=E,l.includes(y)||(d.push(y),this.subscribedPeerStatusCache[y]=void 0);case 61:e.next=49;break;case 63:if(this.session.requestPeersOnlineStatus(d).pipe(map$1((function(e){var t=e.userInfos;return mapValues_1(keyBy_1(t,"account"),(function(e){var t=e.ts;return Boolean(t)}))}))).subscribe((function(e){var t=mapValues_1(e,(function(e,t){var n=e?RtmStatusCode$1.PeerOnlineState.ONLINE:RtmStatusCode$1.PeerOnlineState.OFFLINE;return w.subscribedPeerStatusCache[t]=n,n}));w.emit("PeersOnlineStatusChanged",t)})),0===l.length){e.next=66;break}throw new RtmUnavailableError("Subscription failed",PEER_SUBSCRIPTION_STATUS_ERR_FAILURE);case 66:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unsubscribePeersOnlineStatus",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i,o,a,s,u,c,l,d,p;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=2;break}throw new RtmInvalidStatusError("The client is not logged in",PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN);case 2:if(void 0!==this.session){e.next=4;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(t)&&0!==t.length){e.next=6;break}throw new RtmInvalidArgumentError("Invalid arguments: peerIds",PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT);case 6:n=t,r=Array.isArray(n),i=0,n=r?n:n[Symbol.iterator]();case 7:if(!r){e.next=13;break}if(!(i>=n.length)){e.next=10;break}return e.abrupt("break",22);case 10:o=n[i++],e.next=17;break;case 13:if(!(i=n.next()).done){e.next=16;break}return e.abrupt("break",22);case 16:o=i.value;case 17:if(isValidId(a=o)){e.next=20;break}throw new RtmInvalidArgumentError(["subscribePeersOnlineStatus peer id %s is invalid",a],PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT);case 20:e.next=7;break;case 22:if(!(t.length>512)){e.next=24;break}throw new RtmLimitExceededError("Unsubscribed peers overflows",PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW);case 24:s=uniq_1(t),this.session.requestUnsubscribePeersOnlineStatus(s),u=s,c=Array.isArray(u),l=0,u=c?u:u[Symbol.iterator]();case 27:if(!c){e.next=33;break}if(!(l>=u.length)){e.next=30;break}return e.abrupt("break",41);case 30:d=u[l++],e.next=37;break;case 33:if(!(l=u.next()).done){e.next=36;break}return e.abrupt("break",41);case 36:d=l.value;case 37:p=d,delete this.subscribedPeerStatusCache[p];case 39:e.next=27;break;case 41:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryPeersBySubscriptionOption",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=2;break}throw new RtmInvalidStatusError("The client is not logged in",PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN);case 2:if(t!==RtmStatusCode$1.PeerSubscriptionOption.ONLINE_STATUS){e.next=4;break}return e.abrupt("return",Object.keys(this.subscribedPeerStatusCache));case 4:throw new RtmInvalidArgumentError("Subscription option not supported",PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loginImpl",value:function(){var e=_asyncToGenerator$9(regenerator.mark((function e(t){var n,r,i,o,a,s=this;return regenerator.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.uid,r=t.instanceId,i=r,!(void 0!==this.lastLoginTime&&Date.now()-this.lastLoginTime<1e3/LOGIN_QPS_LIMIT)){e.next=4;break}throw new RtmInvokeTooOftenError(["The frequency of login exceeded the limit of %d queries per second",LOGIN_QPS_LIMIT],LOGIN_ERR_TOO_OFTEN);case 4:if(this.connectionState===ConnectionState$1.DISCONNECTED){e.next=6;break}throw new RtmInvalidStatusError("The SDK is either logging in or has logged in the Agora RTM system",LOGIN_ERR_ALREADY_LOGIN);case 6:e.prev=6,this.context.uid=n,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(6),new RtmInvalidArgumentError([invalidArgumentMessage,getName({uid:n})],LOGIN_ERR_INVALID_ARGUMENT);case 13:return this.onConnectionStateChanged(ConnectionState$1.CONNECTING,ConnectionChangeReason.LOGIN),o=new Session$2(this.context,new Connection(this.context,this.logger),i,this.logger),this.session=o,a=function e(){if(s.connectionState===ConnectionState$1.CONNECTED){var t,n,r;s.onConnectionStateChanged(ConnectionState$1.RECONNECTING,ConnectionChangeReason.INTERRUPTED);var o=function(){var a=_asyncToGenerator$9(regenerator.mark((function a(){var u,c,l;return regenerator.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(u=long_1.fromNumber(1),c=[!1,!1],l=Date.now(),s.connectionState===ConnectionState$1.RECONNECTING){a.next=5;break}return a.abrupt("return");case 5:return s.log("Enter giant reconnection"),s.session&&(s.session.removeAllListeners(),u=s.session.seq,c=s.session.seqSentStatuses,l=s.session.startTime,0!==s.session.joinedChannels.size&&(t=s.session.joinedChannels),0!==s.session.msgDedupLru.size&&(n=s.session.msgDedupLru),0!==s.session.dialogueSequenceLru.size&&(r=s.session.dialogueSequenceLru),s.session.logoutHandler()),s.session=new Session$2(s.context,new Connection(s.context,s.logger),i,s.logger),s.session.on("instanceChanged",(function(e){return i=e})),s.session.on("userJoined",(function(e){if(0!==Object.keys(s.attributes).length){if(void 0===s.session)return;s.session.requestSetLocalUserAttributes(s.attributes,e).toPromise()}if(0!==s.attributeDrafts.size){var t=function(){if(r){if(i>=n.length)return"break";o=n[i++]}else{if((i=n.next()).done)return"break";o=i.value}var t=o,a=t.promise,u=t.attribute;a.then((function(){void 0!==s.session&&s.session.requestSetLocalUserAttributes(u,e).toPromise()}))},n=s.attributeDrafts,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if("break"===t())break}}if(0!==Object.keys(s.subscribedPeerStatusCache).length){if(void 0===s.session)return;s.session.requestSubscribePeersOnlineStatus(Object.keys(s.subscribedPeerStatusCache))}})),a.prev=10,s.session.startTime=l,s.session.seq=u,s.session.seqSentStatuses=c,a.next=16,s.session.loginHandler();case 16:s.log("Login success for account %s",s.context.uid),a.next=27;break;case 19:return a.prev=19,a.t0=a.catch(10),a.t0.code===LOGIN_ERR_TOKEN_EXPIRED&&s.emit("TokenExpired"),a.next=24,delay$1(2e3);case 24:return a.next=26,o();case 26:return a.abrupt("return");case 27:s.session.on("connectionLost",e),s.session.once("userDrop",s.userDropHandler),s.session.on("peerTextMessage",(function(e){var t=e.peerId,n=e.text,r=e.properties;s.emit("MessageFromPeer",{text:n,messageType:RtmStatusCode$1.MessageType.TEXT},t,r)})),s.session.on("peerRawMessage",(function(e){var t=e.desc,n=e.raw,r=e.properties,i=e.peerId;s.emit("MessageFromPeer",{rawMessage:n,description:t,messageType:RtmStatusCode$1.MessageType.RAW},i,r)})),s.session.on("peerOnlineStatusChanged",(function(e){var t=e.instance.toString()+e.state,n=s.peerStatusSeqLru.get(t);!n||e.seq.greaterThan(n)?(s.peerStatusSeqLru.set(t,e.seq),e.state!==s.subscribedPeerStatusCache[e.peerId]?s.emit("PeersOnlineStatusChanged",_defineProperty$4({},e.peerId,e.state)):s.log("peer status for %s not changed, previous %s",e.peerId,e.state),s.subscribedPeerStatusCache[e.peerId]=e.state,clearTimeout(s.peerUnreachableTimers[t]),e.state===RtmStatusCode$1.PeerOnlineState.UNREACHABLE&&(s.peerUnreachableTimers[t]=setTimeout((function(){s.subscribedPeerStatusCache[e.peerId]===RtmStatusCode$1.PeerOnlineState.UNREACHABLE&&(s.subscribedPeerStatusCache[e.peerId]=RtmStatusCode$1.PeerOnlineState.ONLINE,s.emit("PeersOnlineStatusChanged",_defineProperty$4({},e.peerId,RtmStatusCode$1.PeerOnlineState.ONLINE)))}),3e4))):s.log("peerOnlineStatusChanged dedup for %s, %d",t,e.seq.toNumber())})),s.session.on("invitationMessage",s.invitationManager.invitationMessageHandler.bind(s.invitationManager)),s.session.on("channelAttributesUpdated",(function(e){var t=e.channelId,n={},r=e.attributeMaps,i=Array.isArray(r),o=0;for(r=i?r:r[Symbol.iterator]();;){var a;if(i){if(o>=r.length)break;a=r[o++]}else{if((o=r.next()).done)break;a=o.value}var u=a,c=u.key,l=u.ms,d=u.value,p=u.origin;if("string"!=typeof c||!long_1.isLong(l)||"string"!=typeof d||!isValidId(p))break;n[c]=new Blob([d]).size}s.channelAttributesCacheLru.set(t,n)})),void 0!==t&&(t.forEach((function(e){return e.join()})),s.session.joinedChannels=t),void 0!==n&&(s.session.msgDedupLru=n),void 0!==u&&(s.session.seq=u),void 0!==r&&(s.session.dialogueSequenceLru=r),void 0!==c&&(s.session.seqSentStatuses=c),s.onConnectionStateChanged(ConnectionState$1.CONNECTED,ConnectionChangeReason.LOGIN_SUCCESS),0!==Object.keys(s.attributes).length&&s.setLocalUserAttributes(s.attributes);case 41:case"end":return a.stop()}}),a,null,[[10,19]])})));return function(){return a.apply(this,arguments)}}();s.reconnectionTimer=window.setTimeout(o,12e3),s.session&&s.session.once("userJoined",(function(){void 0!==s.reconnectionTimer&&window.clearTimeout(s.reconnectionTimer),s.onConnectionStateChanged(ConnectionState$1.CONNECTED,ConnectionChangeReason.LOGIN_SUCCESS)}))}},o.on("connectionLost",a),o.once("userDrop",this.userDropHandler),this.session.on("peerTextMessage",(function(e){var t=e.peerId,n=e.text,r=e.properties;s.emit("MessageFromPeer",{text:n,messageType:RtmStatusCode$1.MessageType.TEXT},t,r)})),this.session.on("peerRawMessage",(function(e){var t=e.desc,n=e.raw,r=e.properties,i=e.peerId;s.emit("MessageFromPeer",{rawMessage:n,description:t,messageType:RtmStatusCode$1.MessageType.RAW},i,r)})),o.on("instanceChanged",(function(e){return i=e})),o.on("peerOnlineStatusChanged",(function(e){var t=e.instance.toString()+e.state,n=s.peerStatusSeqLru.get(t);!n||e.seq.greaterThan(n)?(s.peerStatusSeqLru.set(t,e.seq),e.state!==s.subscribedPeerStatusCache[e.peerId]?s.emit("PeersOnlineStatusChanged",_defineProperty$4({},e.peerId,e.state)):s.log("peer status for %s not changed, previous %s",e.peerId,e.state),s.subscribedPeerStatusCache[e.peerId]=e.state,clearTimeout(s.peerUnreachableTimers[t]),e.state===RtmStatusCode$1.PeerOnlineState.UNREACHABLE&&(s.peerUnreachableTimers[t]=setTimeout((function(){s.subscribedPeerStatusCache[e.peerId]===RtmStatusCode$1.PeerOnlineState.UNREACHABLE&&(s.subscribedPeerStatusCache[e.peerId]=RtmStatusCode$1.PeerOnlineState.ONLINE,s.emit("PeersOnlineStatusChanged",_defineProperty$4({},e.peerId,RtmStatusCode$1.PeerOnlineState.ONLINE)))}),3e4))):s.log("peerOnlineStatusChanged dedup for %s, %d",t,e.seq.toNumber())})),o.on("invitationMessage",this.invitationManager.invitationMessageHandler.bind(this.invitationManager)),o.on("channelAttributesUpdated",(function(e){var t=e.channelId,n={},r=e.attributeMaps,i=Array.isArray(r),o=0;for(r=i?r:r[Symbol.iterator]();;){var a;if(i){if(o>=r.length)break;a=r[o++]}else{if((o=r.next()).done)break;a=o.value}var u=a,c=u.key,l=u.ms,d=u.value,p=u.origin;if("string"!=typeof c||!long_1.isLong(l)||"string"!=typeof d||!isValidId(p))break;n[c]=new Blob([d]).size}s.channelAttributesCacheLru.set(t,n)})),o.on("userJoined",(function(e){if(0!==Object.keys(s.attributes).length){if(void 0===s.session)return;s.session.requestSetLocalUserAttributes(s.attributes,e).toPromise()}if(0!==s.attributeDrafts.size){var t=function(){if(r){if(i>=n.length)return"break";a=n[i++]}else{if((i=n.next()).done)return"break";a=i.value}var t=a,o=t.promise,u=t.attribute;o.then((function(){void 0!==s.session&&s.session.requestSetLocalUserAttributes(u,e).toPromise()}))},n=s.attributeDrafts,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var a;if("break"===t())break}}0!==Object.keys(s.subscribedPeerStatusCache).length&&o.requestSubscribePeersOnlineStatus(Object.keys(s.subscribedPeerStatusCache))})),this.lastLoginTime=Date.now(),e.prev=27,e.next=30,o.loginHandler();case 30:e.next=41;break;case 32:if(e.prev=32,e.t1=e.catch(27),!isTimeout(e.t1)){e.next=37;break}throw this.onConnectionStateChanged(ConnectionState$1.DISCONNECTED,ConnectionChangeReason.LOGIN_TIMEOUT),new RtmTimeoutError(genTimeoutMessage(this.name,"login",CLIENT_LOGIN_TIMEOUT),LOGIN_ERR_TIMEOUT);case 37:if(this.onConnectionStateChanged(ConnectionState$1.DISCONNECTED,ConnectionChangeReason.LOGIN_FAILURE),!isRtmError(e.t1)){e.next=40;break}throw e.t1;case 40:throw new RtmUnavailableError("Login failure",LOGIN_ERR_UNKNOWN,e.t1);case 41:this.onConnectionStateChanged(ConnectionState$1.CONNECTED,ConnectionChangeReason.LOGIN_SUCCESS);case 42:case"end":return e.stop()}}),e,this,[[6,10],[27,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onConnectionStateChanged",value:function(e,t){var n=this;e===ConnectionState$1.RECONNECTING&&(this.reconnId+=1),sendReport("ConnectionStateChange",{elapse:getElapse(this.session&&this.session.startTime),lts:long_1.fromNumber(Date.now()),newState:connectionStateCodeMap[e],oldState:connectionStateCodeMap[this.connectionState],reason:connectionStateChangeReason[t],sid:getSid(this.session&&this.session.instanceId||long_1.fromNumber(0)),userId:this.context.uid,reconnId:this.reconnId}),this.connectionState===ConnectionState$1.RECONNECTING&&e===ConnectionState$1.CONNECTED&&(0!==Object.keys(this.subscribedPeerStatusCache).length&&void 0!==this.session&&this.session.requestPeersOnlineStatus(Object.keys(this.subscribedPeerStatusCache)).pipe(map$1((function(e){var t=e.userInfos;return mapValues_1(keyBy_1(t,"account"),(function(e){var t=e.ts;return Boolean(t)}))}))).subscribe((function(e){var t=mapValues_1(e,(function(e,t){var r=e?RtmStatusCode$1.PeerOnlineState.ONLINE:RtmStatusCode$1.PeerOnlineState.OFFLINE;return n.subscribedPeerStatusCache[t]=r,r}));n.emit("PeersOnlineStatusChanged",t)})),this.internalEmitter.emit("RECONNECTED")),this.connectionState=e,e!==ConnectionState$1.ABORTED&&e!==ConnectionState$1.DISCONNECTED||(this.reconnId=0,this.attributes={},this.session&&this.session.removeAllListeners(),this.session=void 0,this.channelAttributesCacheLru.empty(),this.peerStatusSeqLru.empty(),this.peerUnreachableTimers={},this.reconnectionTimer=void 0,this.subscribedPeerStatusCache={},this.attributeDrafts.clear(),this.context.token=void 0),this.emit("ConnectionStateChanged",e,t)}}]),t}(),_class$1=_temp$1,_applyDecoratedDescriptor$1(_class$1.prototype,"renewToken",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"renewToken"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"queryPeersOnlineStatus",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"queryPeersOnlineStatus"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getChannelMemberCount",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"getChannelMemberCount"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"setLocalUserAttributes",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"setLocalUserAttributes"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"setChannelAttributes",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"setChannelAttributes"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"addOrUpdateLocalUserAttributes",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"addOrUpdateLocalUserAttributes"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"addOrUpdateChannelAttributes",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"addOrUpdateChannelAttributes"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"deleteLocalUserAttributesByKeys",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"deleteLocalUserAttributesByKeys"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"deleteChannelAttributesByKeys",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"deleteChannelAttributesByKeys"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"clearLocalUserAttributes",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"clearLocalUserAttributes"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"clearChannelAttributes",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"clearChannelAttributes"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getUserAttributes",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"getUserAttributes"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getChannelAttributes",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"getChannelAttributes"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getChannelAttributesByKeys",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"getChannelAttributesByKeys"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getUserAttributesByKeys",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"getUserAttributesByKeys"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"login",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"login"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"logout",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"logout"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"sendMessageToPeer",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"sendMessageToPeer"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"createChannel",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"createChannel"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"subscribePeersOnlineStatus",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"subscribePeersOnlineStatus"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"unsubscribePeersOnlineStatus",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"unsubscribePeersOnlineStatus"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"queryPeersBySubscriptionOption",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"queryPeersBySubscriptionOption"),_class$1.prototype),_class$1);function ownKeys$4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread$3(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$4(n,!0).forEach((function(t){_defineProperty$5(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$4(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty$5(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ConnectionChangeReason$1=RtmStatusCode$1.ConnectionChangeReason,ConnectionState$2=RtmStatusCode$1.ConnectionState,LocalInvitationFailureReason$1=RtmStatusCode$1.LocalInvitationFailureReason,LocalInvitationState$1=RtmStatusCode$1.LocalInvitationState,RemoteInvitationFailureReason$1=RtmStatusCode$1.RemoteInvitationFailureReason,RemoteInvitationState$1=RtmStatusCode$1.RemoteInvitationState,MessageType$1=RtmStatusCode$1.MessageType,PeerOnlineState=RtmStatusCode$1.PeerOnlineState,PeerSubscriptionOption=RtmStatusCode$1.PeerSubscriptionOption;void 0===Number.MAX_SAFE_INTEGER&&(Number.MAX_SAFE_INTEGER=9007199254740991);var LogFilter={LOG_FILTER_OFF:{error:!1,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_ERROR:{error:!0,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_WARNING:{error:!0,warn:!0,info:!1,track:!1,debug:!1},LOG_FILTER_INFO:{error:!0,warn:!0,info:!0,track:!1,debug:!1},LOG_FILTER_DEBUG:{error:!0,warn:!0,info:!0,track:!0,debug:!0}};function createInstance(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.enableLogUpload,r=void 0!==n&&n,i=t.logFilter,o=void 0===i?LogFilter.LOG_FILTER_INFO:i;if(!isValidAppId(e))throw new RtmInvalidArgumentError([invalidArgumentMessage,getName({appId:e})],CREATE_INSTANCE_ERR_INVALID_ARGUMENT);var a={enableLogUpload:r,logFilter:o},s=initLoggerId(),u=genInfoLogger(a),c=genWarnLogger(a),l=genErrorLogger(a),d=trackLoggerGenerator(s,a),p=debugLoggerGenerator(s,a),f=p("RTM:DEBUG","<Entry> ");return u("The Agora RTM Web SDK version is %s",version),f("Creating an RtmClient instance"),f('The Git commit ID is "'.concat(BUILD,'"')),f("The App ID is %s",e),u("The process ID is %s",processId),f("process.env.NODE_ENV is %s","production"),new Client(e,{genLogger:p,genTracker:d,info:u,warn:c,logError:l,loggerId:s},a,(function(e){var t=function(e,t){a[e]=t},n=getKeys(e),r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}var s=o,u=e[s];null!=u&&t(s,u)}}))}var index=_objectSpread$3({createInstance:createInstance,BUILD:BUILD,VERSION:version,END_CALL_PREFIX:END_CALL_PREFIX,processId:processId,ConnectionChangeReason:ConnectionChangeReason$1,ConnectionState:ConnectionState$2,LocalInvitationFailureReason:LocalInvitationFailureReason$1,LocalInvitationState:LocalInvitationState$1,RemoteInvitationFailureReason:RemoteInvitationFailureReason$1,RemoteInvitationState:RemoteInvitationState$1,MessageType:MessageType$1,PeerOnlineState:PeerOnlineState,PeerSubscriptionOption:PeerSubscriptionOption},LogFilter);return index})),
/**
  @license
                                 Apache License
                         Version 2.0, January 2004
                      http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

    "License" shall mean the terms and conditions for use, reproduction,
    and distribution as defined by Sections 1 through 9 of this document.

    "Licensor" shall mean the copyright owner or entity authorized by
    the copyright owner that is granting the License.

    "Legal Entity" shall mean the union of the acting entity and all
    other entities that control, are controlled by, or are under common
    control with that entity. For the purposes of this definition,
    "control" means (i) the power, direct or indirect, to cause the
    direction or management of such entity, whether by contract or
    otherwise, or (ii) ownership of fifty percent (50%) or more of the
    outstanding shares, or (iii) beneficial ownership of such entity.

    "You" (or "Your") shall mean an individual or Legal Entity
    exercising permissions granted by this License.

    "Source" form shall mean the preferred form for making modifications,
    including but not limited to software source code, documentation
    source, and configuration files.

    "Object" form shall mean any form resulting from mechanical
    transformation or translation of a Source form, including but
    not limited to compiled object code, generated documentation,
    and conversions to other media types.

    "Work" shall mean the work of authorship, whether in Source or
    Object form, made available under the License, as indicated by a
    copyright notice that is included in or attached to the work
    (an example is provided in the Appendix below).

    "Derivative Works" shall mean any work, whether in Source or Object
    form, that is based on (or derived from) the Work and for which the
    editorial revisions, annotations, elaborations, or other modifications
    represent, as a whole, an original work of authorship. For the purposes
    of this License, Derivative Works shall not include works that remain
    separable from, or merely link (or bind by name) to the interfaces of,
    the Work and Derivative Works thereof.

    "Contribution" shall mean any work of authorship, including
    the original version of the Work and any modifications or additions
    to that Work or Derivative Works thereof, that is intentionally
    submitted to Licensor for inclusion in the Work by the copyright owner
    or by an individual or Legal Entity authorized to submit on behalf of
    the copyright owner. For the purposes of this definition, "submitted"
    means any form of electronic, verbal, or written communication sent
    to the Licensor or its representatives, including but not limited to
    communication on electronic mailing lists, source code control systems,
    and issue tracking systems that are managed by, or on behalf of, the
    Licensor for the purpose of discussing and improving the Work, but
    excluding communication that is conspicuously marked or otherwise
    designated in writing by the copyright owner as "Not a Contribution."

    "Contributor" shall mean Licensor and any individual or Legal Entity
    on behalf of whom a Contribution has been received by Licensor and
    subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
    this License, each Contributor hereby grants to You a perpetual,
    worldwide, non-exclusive, no-charge, royalty-free, irrevocable
    copyright license to reproduce, prepare Derivative Works of,
    publicly display, publicly perform, sublicense, and distribute the
    Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
    this License, each Contributor hereby grants to You a perpetual,
    worldwide, non-exclusive, no-charge, royalty-free, irrevocable
    (except as stated in this section) patent license to make, have made,
    use, offer to sell, sell, import, and otherwise transfer the Work,
    where such license applies only to those patent claims licensable
    by such Contributor that are necessarily infringed by their
    Contribution(s) alone or by combination of their Contribution(s)
    with the Work to which such Contribution(s) was submitted. If You
    institute patent litigation against any entity (including a
    cross-claim or counterclaim in a lawsuit) alleging that the Work
    or a Contribution incorporated within the Work constitutes direct
    or contributory patent infringement, then any patent licenses
    granted to You under this License for that Work shall terminate
    as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
    Work or Derivative Works thereof in any medium, with or without
    modifications, and in Source or Object form, provided that You
    meet the following conditions:

    (a) You must give any other recipients of the Work or
        Derivative Works a copy of this License; and

    (b) You must cause any modified files to carry prominent notices
        stating that You changed the files; and

    (c) You must retain, in the Source form of any Derivative Works
        that You distribute, all copyright, patent, trademark, and
        attribution notices from the Source form of the Work,
        excluding those notices that do not pertain to any part of
        the Derivative Works; and

    (d) If the Work includes a "NOTICE" text file as part of its
        distribution, then any Derivative Works that You distribute must
        include a readable copy of the attribution notices contained
        within such NOTICE file, excluding those notices that do not
        pertain to any part of the Derivative Works, in at least one
        of the following places: within a NOTICE text file distributed
        as part of the Derivative Works; within the Source form or
        documentation, if provided along with the Derivative Works; or,
        within a display generated by the Derivative Works, if and
        wherever such third-party notices normally appear. The contents
        of the NOTICE file are for informational purposes only and
        do not modify the License. You may add Your own attribution
        notices within Derivative Works that You distribute, alongside
        or as an addendum to the NOTICE text from the Work, provided
        that such additional attribution notices cannot be construed
        as modifying the License.

    You may add Your own copyright statement to Your modifications and
    may provide additional or different license terms and conditions
    for use, reproduction, or distribution of Your modifications, or
    for any such Derivative Works as a whole, provided Your use,
    reproduction, and distribution of the Work otherwise complies with
    the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
    any Contribution intentionally submitted for inclusion in the Work
    by You to the Licensor shall be under the terms and conditions of
    this License, without any additional terms or conditions.
    Notwithstanding the above, nothing herein shall supersede or modify
    the terms of any separate license agreement you may have executed
    with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
    names, trademarks, service marks, or product names of the Licensor,
    except as required for reasonable and customary use in describing the
    origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
    agreed to in writing, Licensor provides the Work (and each
    Contributor provides its Contributions) on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
    implied, including, without limitation, any warranties or conditions
    of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
    PARTICULAR PURPOSE. You are solely responsible for determining the
    appropriateness of using or redistributing the Work and assume any
    risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
    whether in tort (including negligence), contract, or otherwise,
    unless required by applicable law (such as deliberate and grossly
    negligent acts) or agreed to in writing, shall any Contributor be
    liable to You for damages, including any direct, indirect, special,
    incidental, or consequential damages of any character arising as a
    result of this License or out of the use or inability to use the
    Work (including but not limited to damages for loss of goodwill,
    work stoppage, computer failure or malfunction, or any and all
    other commercial damages or losses), even if such Contributor
    has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
    the Work or Derivative Works thereof, You may choose to offer,
    and charge a fee for, acceptance of support, warranty, indemnity,
    or other liability obligations and/or rights consistent with this
    License. However, in accepting such obligations, You may act only
    on Your own behalf and on Your sole responsibility, not on behalf
    of any other Contributor, and only if You agree to indemnify,
    defend, and hold each Contributor harmless for any liability
    incurred by, or claims asserted against, such Contributor by reason
    of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

    To apply the Apache License to your work, attach the following
    boilerplate notice, with the fields enclosed by brackets "[]"
    replaced with your own identifying information. (Don't include
    the brackets!)  The text should be enclosed in the appropriate
    comment syntax for the file format. We also recommend that a
    file or class name and description of purpose be included on the
    same "printed page" as the copyright notice for easier
    identification within third-party archives.

 Copyright (c) 2015-2018 Google, Inc., Netflix, Inc., Microsoft Corp. and contributors

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 

 **/
/**
  @license
                                 Apache License
                         Version 2.0, January 2004
                      http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

    "License" shall mean the terms and conditions for use, reproduction,
    and distribution as defined by Sections 1 through 9 of this document.

    "Licensor" shall mean the copyright owner or entity authorized by
    the copyright owner that is granting the License.

    "Legal Entity" shall mean the union of the acting entity and all
    other entities that control, are controlled by, or are under common
    control with that entity. For the purposes of this definition,
    "control" means (i) the power, direct or indirect, to cause the
    direction or management of such entity, whether by contract or
    otherwise, or (ii) ownership of fifty percent (50%) or more of the
    outstanding shares, or (iii) beneficial ownership of such entity.

    "You" (or "Your") shall mean an individual or Legal Entity
    exercising permissions granted by this License.

    "Source" form shall mean the preferred form for making modifications,
    including but not limited to software source code, documentation
    source, and configuration files.

    "Object" form shall mean any form resulting from mechanical
    transformation or translation of a Source form, including but
    not limited to compiled object code, generated documentation,
    and conversions to other media types.

    "Work" shall mean the work of authorship, whether in Source or
    Object form, made available under the License, as indicated by a
    copyright notice that is included in or attached to the work
    (an example is provided in the Appendix below).

    "Derivative Works" shall mean any work, whether in Source or Object
    form, that is based on (or derived from) the Work and for which the
    editorial revisions, annotations, elaborations, or other modifications
    represent, as a whole, an original work of authorship. For the purposes
    of this License, Derivative Works shall not include works that remain
    separable from, or merely link (or bind by name) to the interfaces of,
    the Work and Derivative Works thereof.

    "Contribution" shall mean any work of authorship, including
    the original version of the Work and any modifications or additions
    to that Work or Derivative Works thereof, that is intentionally
    submitted to Licensor for inclusion in the Work by the copyright owner
    or by an individual or Legal Entity authorized to submit on behalf of
    the copyright owner. For the purposes of this definition, "submitted"
    means any form of electronic, verbal, or written communication sent
    to the Licensor or its representatives, including but not limited to
    communication on electronic mailing lists, source code control systems,
    and issue tracking systems that are managed by, or on behalf of, the
    Licensor for the purpose of discussing and improving the Work, but
    excluding communication that is conspicuously marked or otherwise
    designated in writing by the copyright owner as "Not a Contribution."

    "Contributor" shall mean Licensor and any individual or Legal Entity
    on behalf of whom a Contribution has been received by Licensor and
    subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
    this License, each Contributor hereby grants to You a perpetual,
    worldwide, non-exclusive, no-charge, royalty-free, irrevocable
    copyright license to reproduce, prepare Derivative Works of,
    publicly display, publicly perform, sublicense, and distribute the
    Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
    this License, each Contributor hereby grants to You a perpetual,
    worldwide, non-exclusive, no-charge, royalty-free, irrevocable
    (except as stated in this section) patent license to make, have made,
    use, offer to sell, sell, import, and otherwise transfer the Work,
    where such license applies only to those patent claims licensable
    by such Contributor that are necessarily infringed by their
    Contribution(s) alone or by combination of their Contribution(s)
    with the Work to which such Contribution(s) was submitted. If You
    institute patent litigation against any entity (including a
    cross-claim or counterclaim in a lawsuit) alleging that the Work
    or a Contribution incorporated within the Work constitutes direct
    or contributory patent infringement, then any patent licenses
    granted to You under this License for that Work shall terminate
    as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
    Work or Derivative Works thereof in any medium, with or without
    modifications, and in Source or Object form, provided that You
    meet the following conditions:

    (a) You must give any other recipients of the Work or
        Derivative Works a copy of this License; and

    (b) You must cause any modified files to carry prominent notices
        stating that You changed the files; and

    (c) You must retain, in the Source form of any Derivative Works
        that You distribute, all copyright, patent, trademark, and
        attribution notices from the Source form of the Work,
        excluding those notices that do not pertain to any part of
        the Derivative Works; and

    (d) If the Work includes a "NOTICE" text file as part of its
        distribution, then any Derivative Works that You distribute must
        include a readable copy of the attribution notices contained
        within such NOTICE file, excluding those notices that do not
        pertain to any part of the Derivative Works, in at least one
        of the following places: within a NOTICE text file distributed
        as part of the Derivative Works; within the Source form or
        documentation, if provided along with the Derivative Works; or,
        within a display generated by the Derivative Works, if and
        wherever such third-party notices normally appear. The contents
        of the NOTICE file are for informational purposes only and
        do not modify the License. You may add Your own attribution
        notices within Derivative Works that You distribute, alongside
        or as an addendum to the NOTICE text from the Work, provided
        that such additional attribution notices cannot be construed
        as modifying the License.

    You may add Your own copyright statement to Your modifications and
    may provide additional or different license terms and conditions
    for use, reproduction, or distribution of Your modifications, or
    for any such Derivative Works as a whole, provided Your use,
    reproduction, and distribution of the Work otherwise complies with
    the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
    any Contribution intentionally submitted for inclusion in the Work
    by You to the Licensor shall be under the terms and conditions of
    this License, without any additional terms or conditions.
    Notwithstanding the above, nothing herein shall supersede or modify
    the terms of any separate license agreement you may have executed
    with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
    names, trademarks, service marks, or product names of the Licensor,
    except as required for reasonable and customary use in describing the
    origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
    agreed to in writing, Licensor provides the Work (and each
    Contributor provides its Contributions) on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
    implied, including, without limitation, any warranties or conditions
    of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
    PARTICULAR PURPOSE. You are solely responsible for determining the
    appropriateness of using or redistributing the Work and assume any
    risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
    whether in tort (including negligence), contract, or otherwise,
    unless required by applicable law (such as deliberate and grossly
    negligent acts) or agreed to in writing, shall any Contributor be
    liable to You for damages, including any direct, indirect, special,
    incidental, or consequential damages of any character arising as a
    result of this License or out of the use or inability to use the
    Work (including but not limited to damages for loss of goodwill,
    work stoppage, computer failure or malfunction, or any and all
    other commercial damages or losses), even if such Contributor
    has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
    the Work or Derivative Works thereof, You may choose to offer,
    and charge a fee for, acceptance of support, warranty, indemnity,
    or other liability obligations and/or rights consistent with this
    License. However, in accepting such obligations, You may act only
    on Your own behalf and on Your sole responsibility, not on behalf
    of any other Contributor, and only if You agree to indemnify,
    defend, and hold each Contributor harmless for any liability
    incurred by, or claims asserted against, such Contributor by reason
    of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

    To apply the Apache License to your work, attach the following
    boilerplate notice, with the fields enclosed by brackets "[]"
    replaced with your own identifying information. (Don't include
    the brackets!)  The text should be enclosed in the appropriate
    comment syntax for the file format. We also recommend that a
    file or class name and description of purpose be included on the
    same "printed page" as the copyright notice for easier
    identification within third-party archives.

 Copyright (c) 2015-2018 Google, Inc., Netflix, Inc., Microsoft Corp. and contributors

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 

 **/
function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("rxjs",["exports"],t):t(e.rxjs={})}(this,(function(e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function n(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};function i(e){return"function"==typeof e}var o=!1,a={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else o&&console.log("RxJS: Back to a better error behavior. Thank you. <3");o=e},get useDeprecatedSynchronousErrorHandling(){return o}};function s(e){setTimeout((function(){throw e}),0)}var u={closed:!0,next:function(e){},error:function(e){if(a.useDeprecatedSynchronousErrorHandling)throw e;s(e)},complete:function(){}},c=Array.isArray||function(e){return e&&"number"==typeof e.length};function l(e){return null!==e&&"object"==typeof e}var d=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),p=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,r=n._parentOrParents,o=n._unsubscribe,a=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var s=0;s<r.length;++s){r[s].remove(this)}if(i(o))try{o.call(this)}catch(e){t=e instanceof d?f(e.errors):[e]}if(c(a)){s=-1;for(var u=a.length;++s<u;){var p=a[s];if(l(p))try{p.unsubscribe()}catch(e){t=t||[],e instanceof d?t=t.concat(f(e.errors)):t.push(e)}}}if(t)throw new d(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function f(e){return e.reduce((function(e,t){return e.concat(t instanceof d?t.errors:t)}),[])}var h="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),g=function(e){function t(n,r,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=u;break;case 1:if(!n){o.destination=u;break}if("object"==typeof n){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new m(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new m(o,n,r,i)}return o}return n(t,e),t.prototype[h]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(p),m=function(e){function t(t,n,r,o){var a,s=e.call(this)||this;s._parentSubscriber=t;var c=s;return i(n)?a=n:n&&(a=n.next,r=n.error,o=n.complete,n!==u&&(i((c=Object.create(n)).unsubscribe)&&s.add(c.unsubscribe.bind(c)),c.unsubscribe=s.unsubscribe.bind(s))),s._context=c,s._next=a,s._error=r,s._complete=o,s}return n(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=a.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):s(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;s(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),a.useDeprecatedSynchronousErrorHandling)throw e;s(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return a.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(s(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(g);function v(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof g?r:null}return!0}var y="function"==typeof Symbol&&Symbol.observable||"@@observable";function _(e){return e}function b(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return S(e)}function S(e){return 0===e.length?_:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var E=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=function(e,t,n){if(e){if(e instanceof g)return e;if(e[h])return e[h]()}return e||t||n?new g(e,t,n):new g(u)}(e,t,n);if(r?i.add(r.call(i,this.source)):i.add(this.source||a.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),a.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){a.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),v(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=w(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[y]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:S(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=w(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function w(e){if(e||(e=a.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var I=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),T=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return n(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(p),O=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return n(t,e),t}(g),x=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return n(t,e),t.prototype[h]=function(){return new O(this)},t.prototype.lift=function(e){var t=new R(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new I;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new I;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new I;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new I;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new I;return this.hasError?(e.error(this.thrownError),p.EMPTY):this.isStopped?(e.complete(),p.EMPTY):(this.observers.push(e),new T(this,e))},t.prototype.asObservable=function(){var e=new E;return e.source=this,e},t.create=function(e,t){return new R(e,t)},t}(E),R=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return n(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):p.EMPTY},t}(x);function A(){return function(e){return e.lift(new C(e))}}var L,C=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var n=this.connectable;n._refCount++;var r=new N(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i},e}(),N=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return n(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},t}(g),M=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return n(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new p).add(this.source.subscribe(new $(this.getSubject(),this))),e.closed&&(this._connection=null,e=p.EMPTY)),e},t.prototype.refCount=function(){return A()(this)},t}(E),P={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:(L=M.prototype)._subscribe},_isComplete:{value:L._isComplete,writable:!0},getSubject:{value:L.getSubject},connect:{value:L.connect},refCount:{value:L.refCount}},$=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return n(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(O);!function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}n(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}(g);var k=function(){function e(e,t,n,r){this.keySelector=e,this.elementSelector=t,this.durationSelector=n,this.subjectSelector=r}return e.prototype.call=function(e,t){return t.subscribe(new D(e,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},e}(),D=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a.keySelector=n,a.elementSelector=r,a.durationSelector=i,a.subjectSelector=o,a.groups=null,a.attemptedToUnsubscribe=!1,a.count=0,a}return n(t,e),t.prototype._next=function(e){var t;try{t=this.keySelector(e)}catch(e){return void this.error(e)}this._group(e,t)},t.prototype._group=function(e,t){var n=this.groups;n||(n=this.groups=new Map);var r,i=n.get(t);if(this.elementSelector)try{r=this.elementSelector(e)}catch(e){this.error(e)}else r=e;if(!i){i=this.subjectSelector?this.subjectSelector():new x,n.set(t,i);var o=new j(t,i,this);if(this.destination.next(o),this.durationSelector){var a=void 0;try{a=this.durationSelector(new j(t,i))}catch(e){return void this.error(e)}this.add(a.subscribe(new U(t,i,this)))}}i.closed||i.next(r)},t.prototype._error=function(e){var t=this.groups;t&&(t.forEach((function(t,n){t.error(e)})),t.clear()),this.destination.error(e)},t.prototype._complete=function(){var e=this.groups;e&&(e.forEach((function(e,t){e.complete()})),e.clear()),this.destination.complete()},t.prototype.removeGroup=function(e){this.groups.delete(e)},t.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&e.prototype.unsubscribe.call(this))},t}(g),U=function(e){function t(t,n,r){var i=e.call(this,n)||this;return i.key=t,i.group=n,i.parent=r,i}return n(t,e),t.prototype._next=function(e){this.complete()},t.prototype._unsubscribe=function(){var e=this.parent,t=this.key;this.key=this.parent=null,e&&e.removeGroup(t)},t}(g),j=function(e){function t(t,n,r){var i=e.call(this)||this;return i.key=t,i.groupSubject=n,i.refCountSubscription=r,i}return n(t,e),t.prototype._subscribe=function(e){var t=new p,n=this.refCountSubscription,r=this.groupSubject;return n&&!n.closed&&t.add(new B(n)),t.add(r.subscribe(e)),t},t}(E),B=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,t.count++,n}return n(t,e),t.prototype.unsubscribe=function(){var t=this.parent;t.closed||this.closed||(e.prototype.unsubscribe.call(this),t.count-=1,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())},t}(p),F=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return n(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new I;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(x),q=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return n(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return n(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(p)),G=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return n(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(q),V=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),H=function(e){function t(n,r){void 0===r&&(r=V.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return n(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(V),z=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(H))(G),W=new E((function(e){return e.complete()}));function J(e){return e?function(e){return new E((function(t){return e.schedule((function(){return t.complete()}))}))}(e):W}function Y(e){return e&&"function"==typeof e.schedule}var K,X=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}};function Z(e,t){return new E((function(n){var r=new p,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function Q(e,t){return t?Z(e,t):new E(X(e))}function ee(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return Y(n)?(e.pop(),Z(e,n)):Q(e)}function te(e,t){return new E(t?function(n){return t.schedule(ne,0,{error:e,subscriber:n})}:function(t){return t.error(e)})}function ne(e){var t=e.error;e.subscriber.error(t)}(K=e.NotificationKind||(e.NotificationKind={})).NEXT="N",K.ERROR="E",K.COMPLETE="C";var re=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){switch(this.kind){case"N":return ee(this.value);case"E":return te(this.error);case"C":return J()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}();var ie=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new oe(e,this.scheduler,this.delay))},e}(),oe=function(e){function t(t,n,r){void 0===r&&(r=0);var i=e.call(this,t)||this;return i.scheduler=n,i.delay=r,i}return n(t,e),t.dispatch=function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new ae(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(re.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(re.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(re.createComplete()),this.unsubscribe()},t}(g),ae=function(e,t){this.notification=e,this.destination=t},se=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=e.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=t<1?1:t,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return n(t,e),t.prototype.nextInfiniteTimeWindow=function(t){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift(),e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this._events.push(new ue(this._getNow(),t)),this._trimBufferThenGetEvents(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new I;if(this.isStopped||this.hasError?t=p.EMPTY:(this.observers.push(e),t=new T(this,e)),i&&e.add(e=new oe(e,i)),n)for(var a=0;a<o&&!e.closed;a++)e.next(r[a]);else for(a=0;a<o&&!e.closed;a++)e.next(r[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||z).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),o>0&&r.splice(0,o),r},t}(x),ue=function(e,t){this.time=e,this.value=t},ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return n(t,e),t.prototype._subscribe=function(t){return this.hasError?(t.error(this.thrownError),p.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),p.EMPTY):e.prototype._subscribe.call(this,t)},t.prototype.next=function(e){this.hasCompleted||(this.value=e,this.hasNext=!0)},t.prototype.error=function(t){this.hasCompleted||e.prototype.error.call(this,t)},t.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)},t}(x),le=1,de=Promise.resolve(),pe={};function fe(e){return e in pe&&(delete pe[e],!0)}var he=function(e){var t=le++;return pe[t]=!0,de.then((function(){return fe(t)&&e()})),t},ge=function(e){fe(e)},me=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return n(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=he(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(ge(n),t.scheduled=void 0)},t}(q),ve=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}},t}(H))(me),ye=new H(q),_e=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return n(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame((function(){return t.flush(null)}))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(cancelAnimationFrame(n),t.scheduled=void 0)},t}(q),be=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}},t}(H))(_e),Se=function(e){function t(t,n){void 0===t&&(t=Ee),void 0===n&&(n=Number.POSITIVE_INFINITY);var r=e.call(this,t,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}return n(t,e),t.prototype.flush=function(){for(var e,t,n=this.actions,r=this.maxFrames;(t=n[0])&&t.delay<=r&&(n.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=n.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10,t}(H),Ee=function(e){function t(t,n,r){void 0===r&&(r=t.index+=1);var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.index=r,i.active=!0,i.index=t.index=r,i}return n(t,e),t.prototype.schedule=function(n,r){if(void 0===r&&(r=0),!this.id)return e.prototype.schedule.call(this,n,r);this.active=!1;var i=new t(this.scheduler,this.work);return this.add(i),i.schedule(n,r)},t.prototype.requestAsyncId=function(e,n,r){void 0===r&&(r=0),this.delay=e.frame+r;var i=e.actions;return i.push(this),i.sort(t.sortActions),!0},t.prototype.recycleAsyncId=function(e,t,n){void 0===n&&(n=0)},t.prototype._execute=function(t,n){if(!0===this.active)return e.prototype._execute.call(this,t,n)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(q);function we(){}var Ie=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),Te=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),Oe=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}();function xe(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new Re(e,t))}}var Re=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new Ae(e,this.project,this.thisArg))},e}(),Ae=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return n(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(g);function Le(e){var t=this,n=e.args,r=e.subscriber,i=e.params,o=i.callbackFunc,a=i.context,s=i.scheduler,u=i.subject;if(!u){u=i.subject=new ce;try{o.apply(a,n.concat([function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.length<=1?e[0]:e;t.add(s.schedule(Ce,0,{value:r,subject:u}))}]))}catch(e){u.error(e)}}this.add(u.subscribe(r))}function Ce(e){var t=e.value,n=e.subject;n.next(t),n.complete()}function Ne(e){var t=this,n=e.params,r=e.subscriber,i=e.context,o=n.callbackFunc,a=n.args,s=n.scheduler,u=n.subject;if(!u){u=n.subject=new ce;try{o.apply(i,a.concat([function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=e.shift();if(r)t.add(s.schedule(Pe,0,{err:r,subject:u}));else{var i=e.length<=1?e[0]:e;t.add(s.schedule(Me,0,{value:i,subject:u}))}}]))}catch(e){this.add(s.schedule(Pe,0,{err:e,subject:u}))}}this.add(u.subscribe(r))}function Me(e){var t=e.value,n=e.subject;n.next(t),n.complete()}function Pe(e){var t=e.err;e.subject.error(t)}var $e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(g),ke=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return n(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(g);var De="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",Ue=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function je(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var Be=function(e){if(e&&"function"==typeof e[y])return r=e,function(e){var t=r[y]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(Ue(e))return X(e);if(je(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,s),e};if(e&&"function"==typeof e[De])return t=e,function(e){for(var n=t[De]();;){var r=n.next();if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,r,i=l(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function Fe(e,t,n,r,i){if(void 0===i&&(i=new ke(e,n,r)),!i.closed)return t instanceof E?t.subscribe(i):Be(t)(i)}var qe={};var Ge=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Ve(e,this.resultSelector))},e}(),Ve=function(e){function t(t,n){var r=e.call(this,t)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return n(t,e),t.prototype._next=function(e){this.values.push(qe),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(Fe(this,r,r,n))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n,r,i){var o=this.values,a=o[n],s=this.toRespond?a===qe?--this.toRespond:this.toRespond:0;o[n]=t,0===s&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}($e);function He(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[y]}(e))return function(e,t){return new E((function(n){var r=new p;return r.add(t.schedule((function(){var i=e[y]();r.add(i.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}(e,t);if(je(e))return function(e,t){return new E((function(n){var r=new p;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}))}(e,t);if(Ue(e))return Z(e,t);if(function(e){return e&&"function"==typeof e[De]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new E((function(n){var r,i=new p;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(t.schedule((function(){r=e[De](),i.add(t.schedule((function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(e){return void n.error(e)}t?n.complete():(n.next(e),this.schedule())}})))}))),i}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function ze(e,t){return t?He(e,t):e instanceof E?e:new E(Be(e))}function We(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(r){return r.pipe(We((function(n,r){return ze(e(n,r)).pipe(xe((function(e,i){return t(n,e,r,i)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new Je(e,n))})}var Je=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new Ye(e,this.project,this.concurrent))},e}(),Ye=function(e){function t(t,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=e.call(this,t)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return n(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t,e,n)},t.prototype._innerSub=function(e,t,n){var r=new ke(this,t,n),i=this.destination;i.add(r);var o=Fe(this,e,void 0,void 0,r);o!==r&&i.add(o)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}($e);function Ke(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),We(_,e)}function Xe(){return Ke(1)}function Ze(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Xe()(ee.apply(void 0,e))}function Qe(e){return new E((function(t){var n;try{n=e()}catch(e){return void t.error(e)}return(n?ze(n):J()).subscribe(t)}))}function et(e,t){return new E((function(n){var r=e.length;if(0!==r)for(var i=new Array(r),o=0,a=0,s=function(s){var u=ze(e[s]),c=!1;n.add(u.subscribe({next:function(e){c||(c=!0,a++),i[s]=e},error:function(e){return n.error(e)},complete:function(){++o!==r&&c||(a===r&&n.next(t?t.reduce((function(e,t,n){return e[t]=i[n],e}),{}):i),n.complete())}}))},u=0;u<r;u++)s(u);else n.complete()}))}function tt(e,t,n,r,i){var o;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){var a=e;e.addEventListener(t,n,i),o=function(){return a.removeEventListener(t,n,i)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){var s=e;e.on(t,n),o=function(){return s.off(t,n)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){var u=e;e.addListener(t,n),o=function(){return u.removeListener(t,n)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var c=0,l=e.length;c<l;c++)tt(e[c],t,n,r,i)}r.add(o)}function nt(e){var t=e.subscriber,n=e.condition;if(!t.closed){if(e.needIterate)try{e.state=e.iterate(e.state)}catch(e){return void t.error(e)}else e.needIterate=!0;if(n){var r=void 0;try{r=n(e.state)}catch(e){return void t.error(e)}if(!r)return void t.complete();if(t.closed)return}var i;try{i=e.resultSelector(e.state)}catch(e){return void t.error(e)}if(!t.closed&&(t.next(i),!t.closed))return this.schedule(e)}}function rt(e){return!c(e)&&e-parseFloat(e)+1>=0}function it(e){var t=e.subscriber,n=e.counter,r=e.period;t.next(n),this.schedule({subscriber:t,counter:n+1,period:r},r)}function ot(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Number.POSITIVE_INFINITY,r=null,i=e[e.length-1];return Y(i)?(r=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(n=e.pop())):"number"==typeof i&&(n=e.pop()),null===r&&1===e.length&&e[0]instanceof E?e[0]:Ke(n)(Q(e,r))}var at=new E(we);function st(e){var t=e.keys,n=e.index,r=e.subscriber,i=e.subscription,o=e.obj;if(!r.closed)if(n<t.length){var a=t[n];r.next([a,o[a]]),i.add(this.schedule({keys:t,index:n+1,subscriber:r,subscription:i,obj:o}))}else r.complete()}function ut(e,t){function n(){return!n.pred.apply(n.thisArg,arguments)}return n.pred=e,n.thisArg=t,n}function ct(e,t){return function(n){return n.lift(new lt(e,t))}}var lt=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new dt(e,this.predicate,this.thisArg))},e}(),dt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return n(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(g);function pt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){if(!c(e[0]))return e[0];e=e[0]}return Q(e,void 0).lift(new ft)}var ft=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new ht(e))},e}(),ht=function(e){function t(t){var n=e.call(this,t)||this;return n.hasFirst=!1,n.observables=[],n.subscriptions=[],n}return n(t,e),t.prototype._next=function(e){this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(var n=0;n<t&&!this.hasFirst;n++){var r=e[n],i=Fe(this,r,r,n);this.subscriptions&&this.subscriptions.push(i),this.add(i)}this.observables=null}},t.prototype.notifyNext=function(e,t,n,r,i){if(!this.hasFirst){this.hasFirst=!0;for(var o=0;o<this.subscriptions.length;o++)if(o!==n){var a=this.subscriptions[o];a.unsubscribe(),this.remove(a)}this.subscriptions=null}this.destination.next(t)},t}($e);function gt(e){var t=e.start,n=e.index,r=e.count,i=e.subscriber;n>=r?i.complete():(i.next(t),i.closed||(e.index=n+1,e.start=t+1,this.schedule(e)))}function mt(e,t,n){void 0===e&&(e=0);var r=-1;return rt(t)?r=Number(t)<1?1:Number(t):Y(t)&&(n=t),Y(n)||(n=ye),new E((function(t){var i=rt(e)?e:+e-n.now();return n.schedule(vt,i,{index:0,period:r,subscriber:t})}))}function vt(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}function yt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return"function"==typeof n&&e.pop(),Q(e,void 0).lift(new _t(n))}var _t=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new bt(e,this.resultSelector))},e}(),bt=function(e){function t(t,n,r){void 0===r&&(r=Object.create(null));var i=e.call(this,t)||this;return i.iterators=[],i.active=0,i.resultSelector="function"==typeof n?n:null,i.values=r,i}return n(t,e),t.prototype._next=function(e){var t=this.iterators;c(e)?t.push(new Et(e)):"function"==typeof e[De]?t.push(new St(e[De]())):t.push(new wt(this.destination,this,e))},t.prototype._complete=function(){var e=this.iterators,t=e.length;if(this.unsubscribe(),0!==t){this.active=t;for(var n=0;n<t;n++){var r=e[n];if(r.stillUnsubscribed)this.destination.add(r.subscribe(r,n));else this.active--}}else this.destination.complete()},t.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},t.prototype.checkIterators=function(){for(var e=this.iterators,t=e.length,n=this.destination,r=0;r<t;r++){if("function"==typeof(a=e[r]).hasValue&&!a.hasValue())return}var i=!1,o=[];for(r=0;r<t;r++){var a,s=(a=e[r]).next();if(a.hasCompleted()&&(i=!0),s.done)return void n.complete();o.push(s.value)}this.resultSelector?this._tryresultSelector(o):n.next(o),i&&n.complete()},t.prototype._tryresultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(g),St=function(){function e(e){this.iterator=e,this.nextResult=e.next()}return e.prototype.hasValue=function(){return!0},e.prototype.next=function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e},e.prototype.hasCompleted=function(){var e=this.nextResult;return e&&e.done},e}(),Et=function(){function e(e){this.array=e,this.index=0,this.length=0,this.length=e.length}return e.prototype[De]=function(){return this},e.prototype.next=function(e){var t=this.index++,n=this.array;return t<this.length?{value:n[t],done:!1}:{value:null,done:!0}},e.prototype.hasValue=function(){return this.array.length>this.index},e.prototype.hasCompleted=function(){return this.array.length===this.index},e}(),wt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.parent=n,i.observable=r,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return n(t,e),t.prototype[De]=function(){return this},t.prototype.next=function(){var e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}},t.prototype.hasValue=function(){return this.buffer.length>0},t.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},t.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},t.prototype.notifyNext=function(e,t,n,r,i){this.buffer.push(t),this.parent.checkIterators()},t.prototype.subscribe=function(e,t){return Fe(this,this.observable,this,t)},t}($e);function It(e){return function(t){return t.lift(new Tt(e))}}var Tt=function(){function e(e){this.durationSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Ot(e,this.durationSelector))},e}(),Ot=function(e){function t(t,n){var r=e.call(this,t)||this;return r.durationSelector=n,r.hasValue=!1,r}return n(t,e),t.prototype._next=function(e){if(this.value=e,this.hasValue=!0,!this.throttled){var t=void 0;try{t=(0,this.durationSelector)(e)}catch(e){return this.destination.error(e)}var n=Fe(this,t);!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}},t.prototype.clearThrottle=function(){var e=this,t=e.value,n=e.hasValue,r=e.throttled;r&&(this.remove(r),this.throttled=null,r.unsubscribe()),n&&(this.value=null,this.hasValue=!1,this.destination.next(t))},t.prototype.notifyNext=function(e,t,n,r){this.clearThrottle()},t.prototype.notifyComplete=function(){this.clearThrottle()},t}($e);var xt=function(){function e(e){this.closingNotifier=e}return e.prototype.call=function(e,t){return t.subscribe(new Rt(e,this.closingNotifier))},e}(),Rt=function(e){function t(t,n){var r=e.call(this,t)||this;return r.buffer=[],r.add(Fe(r,n)),r}return n(t,e),t.prototype._next=function(e){this.buffer.push(e)},t.prototype.notifyNext=function(e,t,n,r,i){var o=this.buffer;this.buffer=[],this.destination.next(o)},t}($e);var At=function(){function e(e,t){this.bufferSize=e,this.startBufferEvery=t,this.subscriberClass=t&&e!==t?Ct:Lt}return e.prototype.call=function(e,t){return t.subscribe(new this.subscriberClass(e,this.bufferSize,this.startBufferEvery))},e}(),Lt=function(e){function t(t,n){var r=e.call(this,t)||this;return r.bufferSize=n,r.buffer=[],r}return n(t,e),t.prototype._next=function(e){var t=this.buffer;t.push(e),t.length==this.bufferSize&&(this.destination.next(t),this.buffer=[])},t.prototype._complete=function(){var t=this.buffer;t.length>0&&this.destination.next(t),e.prototype._complete.call(this)},t}(g),Ct=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.bufferSize=n,i.startBufferEvery=r,i.buffers=[],i.count=0,i}return n(t,e),t.prototype._next=function(e){var t=this,n=t.bufferSize,r=t.startBufferEvery,i=t.buffers,o=t.count;this.count++,o%r==0&&i.push([]);for(var a=i.length;a--;){var s=i[a];s.push(e),s.length===n&&(i.splice(a,1),this.destination.next(s))}},t.prototype._complete=function(){for(var t=this.buffers,n=this.destination;t.length>0;){var r=t.shift();r.length>0&&n.next(r)}e.prototype._complete.call(this)},t}(g);var Nt=function(){function e(e,t,n,r){this.bufferTimeSpan=e,this.bufferCreationInterval=t,this.maxBufferSize=n,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new Pt(e,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},e}(),Mt=function(){this.buffer=[]},Pt=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;a.bufferTimeSpan=n,a.bufferCreationInterval=r,a.maxBufferSize=i,a.scheduler=o,a.contexts=[];var s=a.openContext();if(a.timespanOnly=null==r||r<0,a.timespanOnly){var u={subscriber:a,context:s,bufferTimeSpan:n};a.add(s.closeAction=o.schedule($t,n,u))}else{var c={subscriber:a,context:s},l={bufferTimeSpan:n,bufferCreationInterval:r,subscriber:a,scheduler:o};a.add(s.closeAction=o.schedule(Dt,n,c)),a.add(o.schedule(kt,r,l))}return a}return n(t,e),t.prototype._next=function(e){for(var t,n=this.contexts,r=n.length,i=0;i<r;i++){var o=n[i],a=o.buffer;a.push(e),a.length==this.maxBufferSize&&(t=o)}t&&this.onBufferFull(t)},t.prototype._error=function(t){this.contexts.length=0,e.prototype._error.call(this,t)},t.prototype._complete=function(){for(var t=this.contexts,n=this.destination;t.length>0;){var r=t.shift();n.next(r.buffer)}e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.contexts=null},t.prototype.onBufferFull=function(e){this.closeContext(e);var t=e.closeAction;if(t.unsubscribe(),this.remove(t),!this.closed&&this.timespanOnly){e=this.openContext();var n=this.bufferTimeSpan,r={subscriber:this,context:e,bufferTimeSpan:n};this.add(e.closeAction=this.scheduler.schedule($t,n,r))}},t.prototype.openContext=function(){var e=new Mt;return this.contexts.push(e),e},t.prototype.closeContext=function(e){this.destination.next(e.buffer);var t=this.contexts;(t?t.indexOf(e):-1)>=0&&t.splice(t.indexOf(e),1)},t}(g);function $t(e){var t=e.subscriber,n=e.context;n&&t.closeContext(n),t.closed||(e.context=t.openContext(),e.context.closeAction=this.schedule(e,e.bufferTimeSpan))}function kt(e){var t=e.bufferCreationInterval,n=e.bufferTimeSpan,r=e.subscriber,i=e.scheduler,o=r.openContext();r.closed||(r.add(o.closeAction=i.schedule(Dt,n,{subscriber:r,context:o})),this.schedule(e,t))}function Dt(e){var t=e.subscriber,n=e.context;t.closeContext(n)}var Ut=function(){function e(e,t){this.openings=e,this.closingSelector=t}return e.prototype.call=function(e,t){return t.subscribe(new jt(e,this.openings,this.closingSelector))},e}(),jt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.openings=n,i.closingSelector=r,i.contexts=[],i.add(Fe(i,n)),i}return n(t,e),t.prototype._next=function(e){for(var t=this.contexts,n=t.length,r=0;r<n;r++)t[r].buffer.push(e)},t.prototype._error=function(t){for(var n=this.contexts;n.length>0;){var r=n.shift();r.subscription.unsubscribe(),r.buffer=null,r.subscription=null}this.contexts=null,e.prototype._error.call(this,t)},t.prototype._complete=function(){for(var t=this.contexts;t.length>0;){var n=t.shift();this.destination.next(n.buffer),n.subscription.unsubscribe(),n.buffer=null,n.subscription=null}this.contexts=null,e.prototype._complete.call(this)},t.prototype.notifyNext=function(e,t,n,r,i){e?this.closeBuffer(e):this.openBuffer(t)},t.prototype.notifyComplete=function(e){this.closeBuffer(e.context)},t.prototype.openBuffer=function(e){try{var t=this.closingSelector.call(this,e);t&&this.trySubscribe(t)}catch(e){this._error(e)}},t.prototype.closeBuffer=function(e){var t=this.contexts;if(t&&e){var n=e.buffer,r=e.subscription;this.destination.next(n),t.splice(t.indexOf(e),1),this.remove(r),r.unsubscribe()}},t.prototype.trySubscribe=function(e){var t=this.contexts,n=new p,r={buffer:[],subscription:n};t.push(r);var i=Fe(this,e,r);!i||i.closed?this.closeBuffer(r):(i.context=r,this.add(i),n.add(i))},t}($e);var Bt=function(){function e(e){this.closingSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Ft(e,this.closingSelector))},e}(),Ft=function(e){function t(t,n){var r=e.call(this,t)||this;return r.closingSelector=n,r.subscribing=!1,r.openBuffer(),r}return n(t,e),t.prototype._next=function(e){this.buffer.push(e)},t.prototype._complete=function(){var t=this.buffer;t&&this.destination.next(t),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.buffer=null,this.subscribing=!1},t.prototype.notifyNext=function(e,t,n,r,i){this.openBuffer()},t.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},t.prototype.openBuffer=function(){var e=this.closingSubscription;e&&(this.remove(e),e.unsubscribe());var t,n=this.buffer;this.buffer&&this.destination.next(n),this.buffer=[];try{t=(0,this.closingSelector)()}catch(e){return this.error(e)}e=new p,this.closingSubscription=e,this.add(e),this.subscribing=!0,e.add(Fe(this,t)),this.subscribing=!1},t}($e);var qt=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new Gt(e,this.selector,this.caught))},e}(),Gt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.selector=n,i.caught=r,i}return n(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=void 0;try{n=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle();var r=new ke(this,void 0,void 0);this.add(r);var i=Fe(this,n,void 0,void 0,r);i!==r&&this.add(i)}},t}($e);function Vt(e,t){return We(e,t,1)}var Ht=function(){function e(e,t){this.predicate=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new zt(e,this.predicate,this.source))},e}(),zt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.source=r,i.count=0,i.index=0,i}return n(t,e),t.prototype._next=function(e){this.predicate?this._tryPredicate(e):this.count++},t.prototype._tryPredicate=function(e){var t;try{t=this.predicate(e,this.index++,this.source)}catch(e){return void this.destination.error(e)}t&&this.count++},t.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},t}(g);var Wt=function(){function e(e){this.durationSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new Jt(e,this.durationSelector))},e}(),Jt=function(e){function t(t,n){var r=e.call(this,t)||this;return r.durationSelector=n,r.hasValue=!1,r.durationSubscription=null,r}return n(t,e),t.prototype._next=function(e){try{var t=this.durationSelector.call(this,e);t&&this._tryNext(e,t)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){this.emitValue(),this.destination.complete()},t.prototype._tryNext=function(e,t){var n=this.durationSubscription;this.value=e,this.hasValue=!0,n&&(n.unsubscribe(),this.remove(n)),(n=Fe(this,t))&&!n.closed&&this.add(this.durationSubscription=n)},t.prototype.notifyNext=function(e,t,n,r,i){this.emitValue()},t.prototype.notifyComplete=function(){this.emitValue()},t.prototype.emitValue=function(){if(this.hasValue){var t=this.value,n=this.durationSubscription;n&&(this.durationSubscription=null,n.unsubscribe(),this.remove(n)),this.value=null,this.hasValue=!1,e.prototype._next.call(this,t)}},t}($e);var Yt=function(){function e(e,t){this.dueTime=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new Kt(e,this.dueTime,this.scheduler))},e}(),Kt=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.dueTime=n,i.scheduler=r,i.debouncedSubscription=null,i.lastValue=null,i.hasValue=!1,i}return n(t,e),t.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(Xt,this.dueTime,this))},t.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},t.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var e=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(e)}},t.prototype.clearDebounce=function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},t}(g);function Xt(e){e.debouncedNext()}function Zt(e){return void 0===e&&(e=null),function(t){return t.lift(new Qt(e))}}var Qt=function(){function e(e){this.defaultValue=e}return e.prototype.call=function(e,t){return t.subscribe(new en(e,this.defaultValue))},e}(),en=function(e){function t(t,n){var r=e.call(this,t)||this;return r.defaultValue=n,r.isEmpty=!0,r}return n(t,e),t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(g);function tn(e){return e instanceof Date&&!isNaN(+e)}var nn=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new rn(e,this.delay,this.scheduler))},e}(),rn=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return n(t,e),t.dispatch=function(e){for(var t=e.source,n=t.queue,r=e.scheduler,i=e.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var o=Math.max(0,n[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1},t.prototype._schedule=function(e){this.active=!0,this.destination.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},t.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler,n=new on(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}},t.prototype._next=function(e){this.scheduleNotification(re.createNext(e))},t.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.scheduleNotification(re.createComplete()),this.unsubscribe()},t}(g),on=function(e,t){this.time=e,this.notification=t};var an=function(){function e(e){this.delayDurationSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new sn(e,this.delayDurationSelector))},e}(),sn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.delayDurationSelector=n,r.completed=!1,r.delayNotifierSubscriptions=[],r.index=0,r}return n(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(e),this.removeSubscription(i),this.tryComplete()},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype.notifyComplete=function(e){var t=this.removeSubscription(e);t&&this.destination.next(t),this.tryComplete()},t.prototype._next=function(e){var t=this.index++;try{var n=this.delayDurationSelector(e,t);n&&this.tryDelay(n,e)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},t.prototype.removeSubscription=function(e){e.unsubscribe();var t=this.delayNotifierSubscriptions.indexOf(e);return-1!==t&&this.delayNotifierSubscriptions.splice(t,1),e.outerValue},t.prototype.tryDelay=function(e,t){var n=Fe(this,e,t);n&&!n.closed&&(this.destination.add(n),this.delayNotifierSubscriptions.push(n))},t.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},t}($e),un=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subscriptionDelay=n,r}return n(t,e),t.prototype._subscribe=function(e){this.subscriptionDelay.subscribe(new cn(e,this.source))},t}(E),cn=function(e){function t(t,n){var r=e.call(this)||this;return r.parent=t,r.source=n,r.sourceSubscribed=!1,r}return n(t,e),t.prototype._next=function(e){this.subscribeToSource()},t.prototype._error=function(e){this.unsubscribe(),this.parent.error(e)},t.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},t.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},t}(g);var ln=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new dn(e))},e}(),dn=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype._next=function(e){e.observe(this.destination)},t}(g);var pn=function(){function e(e,t){this.keySelector=e,this.flushes=t}return e.prototype.call=function(e,t){return t.subscribe(new fn(e,this.keySelector,this.flushes))},e}(),fn=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.keySelector=n,i.values=new Set,r&&i.add(Fe(i,r)),i}return n(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.values.clear()},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype._next=function(e){this.keySelector?this._useKeySelector(e):this._finalizeNext(e,e)},t.prototype._useKeySelector=function(e){var t,n=this.destination;try{t=this.keySelector(e)}catch(e){return void n.error(e)}this._finalizeNext(t,e)},t.prototype._finalizeNext=function(e,t){var n=this.values;n.has(e)||(n.add(e),this.destination.next(t))},t}($e);function hn(e,t){return function(n){return n.lift(new gn(e,t))}}var gn=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new mn(e,this.compare,this.keySelector))},e}(),mn=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.keySelector=r,i.hasKey=!1,"function"==typeof n&&(i.compare=n),i}return n(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t;try{var n=this.keySelector;t=n?n(e):e}catch(e){return this.destination.error(e)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,t)}catch(e){return this.destination.error(e)}else this.hasKey=!0;r||(this.key=t,this.destination.next(e))},t}(g);function vn(e){return void 0===e&&(e=bn),function(t){return t.lift(new yn(e))}}var yn=function(){function e(e){this.errorFactory=e}return e.prototype.call=function(e,t){return t.subscribe(new _n(e,this.errorFactory))},e}(),_n=function(e){function t(t,n){var r=e.call(this,t)||this;return r.errorFactory=n,r.hasValue=!1,r}return n(t,e),t.prototype._next=function(e){this.hasValue=!0,this.destination.next(e)},t.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var e=void 0;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)},t}(g);function bn(){return new Te}function Sn(e){return function(t){return 0===e?J():t.lift(new En(e))}}var En=function(){function e(e){if(this.total=e,this.total<0)throw new Ie}return e.prototype.call=function(e,t){return t.subscribe(new wn(e,this.total))},e}(),wn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return n(t,e),t.prototype._next=function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))},t}(g);var In=function(){function e(e,t,n){this.predicate=e,this.thisArg=t,this.source=n}return e.prototype.call=function(e,t){return t.subscribe(new Tn(e,this.predicate,this.thisArg,this.source))},e}(),Tn=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.predicate=n,o.thisArg=r,o.source=i,o.index=0,o.thisArg=r||o,o}return n(t,e),t.prototype.notifyComplete=function(e){this.destination.next(e),this.destination.complete()},t.prototype._next=function(e){var t=!1;try{t=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(e){return void this.destination.error(e)}t||this.notifyComplete(!1)},t.prototype._complete=function(){this.notifyComplete(!0)},t}(g);var On=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new xn(e))},e}(),xn=function(e){function t(t){var n=e.call(this,t)||this;return n.hasCompleted=!1,n.hasSubscription=!1,n}return n(t,e),t.prototype._next=function(e){this.hasSubscription||(this.hasSubscription=!0,this.add(Fe(this,e)))},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},t.prototype.notifyComplete=function(e){this.remove(e),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},t}($e);var Rn=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new An(e,this.project))},e}(),An=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.hasSubscription=!1,r.hasCompleted=!1,r.index=0,r}return n(t,e),t.prototype._next=function(e){this.hasSubscription||this.tryNext(e)},t.prototype.tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.hasSubscription=!0,this._innerSub(t,e,n)},t.prototype._innerSub=function(e,t,n){var r=new ke(this,t,n),i=this.destination;i.add(r);var o=Fe(this,e,void 0,void 0,r);o!==r&&i.add(o)},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.remove(e),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},t}($e);var Ln=function(){function e(e,t,n){this.project=e,this.concurrent=t,this.scheduler=n}return e.prototype.call=function(e,t){return t.subscribe(new Cn(e,this.project,this.concurrent,this.scheduler))},e}(),Cn=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.project=n,o.concurrent=r,o.scheduler=i,o.index=0,o.active=0,o.hasCompleted=!1,r<Number.POSITIVE_INFINITY&&(o.buffer=[]),o}return n(t,e),t.dispatch=function(e){var t=e.subscriber,n=e.result,r=e.value,i=e.index;t.subscribeToProjection(n,r,i)},t.prototype._next=function(e){var n=this.destination;if(n.closed)this._complete();else{var r=this.index++;if(this.active<this.concurrent){n.next(e);try{var i=(0,this.project)(e,r);if(this.scheduler){var o={subscriber:this,result:i,value:e,index:r};this.destination.add(this.scheduler.schedule(t.dispatch,0,o))}else this.subscribeToProjection(i,e,r)}catch(e){n.error(e)}}else this.buffer.push(e)}},t.prototype.subscribeToProjection=function(e,t,n){this.active++,this.destination.add(Fe(this,e,t,n))},t.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e,t,n,r,i){this._next(t)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.destination.remove(e),this.active--,t&&t.length>0&&this._next(t.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},t}($e);var Nn=function(){function e(e){this.callback=e}return e.prototype.call=function(e,t){return t.subscribe(new Mn(e,this.callback))},e}(),Mn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.add(new p(n)),r}return n(t,e),t}(g);var Pn=function(){function e(e,t,n,r){this.predicate=e,this.source=t,this.yieldIndex=n,this.thisArg=r}return e.prototype.call=function(e,t){return t.subscribe(new $n(e,this.predicate,this.source,this.yieldIndex,this.thisArg))},e}(),$n=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a.predicate=n,a.source=r,a.yieldIndex=i,a.thisArg=o,a.index=0,a}return n(t,e),t.prototype.notifyComplete=function(e){var t=this.destination;t.next(e),t.complete(),this.unsubscribe()},t.prototype._next=function(e){var t=this.predicate,n=this.thisArg,r=this.index++;try{t.call(n||this,e,r,this.source)&&this.notifyComplete(this.yieldIndex?r:e)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},t}(g);var kn=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new Dn(e))},e}(),Dn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype._next=function(e){},t}(g);var Un=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new jn(e))},e}(),jn=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype.notifyComplete=function(e){var t=this.destination;t.next(e),t.complete()},t.prototype._next=function(e){this.notifyComplete(!1)},t.prototype._complete=function(){this.notifyComplete(!0)},t}(g);function Bn(e){return function(t){return 0===e?J():t.lift(new Fn(e))}}var Fn=function(){function e(e){if(this.total=e,this.total<0)throw new Ie}return e.prototype.call=function(e,t){return t.subscribe(new qn(e,this.total))},e}(),qn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.ring=new Array,r.count=0,r}return n(t,e),t.prototype._next=function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e},t.prototype._complete=function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=t++%n;e.next(r[o])}e.complete()},t}(g);var Gn=function(){function e(e){this.value=e}return e.prototype.call=function(e,t){return t.subscribe(new Vn(e,this.value))},e}(),Vn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.value=n,r}return n(t,e),t.prototype._next=function(e){this.destination.next(this.value)},t}(g);var Hn=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new zn(e))},e}(),zn=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype._next=function(e){this.destination.next(re.createNext(e))},t.prototype._error=function(e){var t=this.destination;t.next(re.createError(e)),t.complete()},t.prototype._complete=function(){var e=this.destination;e.next(re.createComplete()),e.complete()},t}(g);function Wn(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Jn(e,t,n))}}var Jn=function(){function e(e,t,n){void 0===n&&(n=!1),this.accumulator=e,this.seed=t,this.hasSeed=n}return e.prototype.call=function(e,t){return t.subscribe(new Yn(e,this.accumulator,this.seed,this.hasSeed))},e}(),Yn=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.accumulator=n,o._seed=r,o.hasSeed=i,o.index=0,o}return n(t,e),Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),t.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(e){this.destination.error(e)}this.seed=t,this.destination.next(t)},t}(g);function Kn(e,t){return arguments.length>=2?function(n){return b(Wn(e,t),Bn(1),Zt(t))(n)}:function(t){return b(Wn((function(t,n,r){return e(t,n,r+1)})),Bn(1))(t)}}var Xn=function(){function e(e,t,n){this.accumulator=e,this.seed=t,this.concurrent=n}return e.prototype.call=function(e,t){return t.subscribe(new Zn(e,this.accumulator,this.seed,this.concurrent))},e}(),Zn=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.accumulator=n,o.acc=r,o.concurrent=i,o.hasValue=!1,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return n(t,e),t.prototype._next=function(e){if(this.active<this.concurrent){var t=this.index++,n=this.destination,r=void 0;try{r=(0,this.accumulator)(this.acc,e,t)}catch(e){return n.error(e)}this.active++,this._innerSub(r,e,t)}else this.buffer.push(e)},t.prototype._innerSub=function(e,t,n){var r=new ke(this,t,n),i=this.destination;i.add(r);var o=Fe(this,e,void 0,void 0,r);o!==r&&i.add(o)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},t.prototype.notifyNext=function(e,t,n,r,i){var o=this.destination;this.acc=t,this.hasValue=!0,o.next(t)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.destination.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},t}($e);function Qn(e,t){return function(n){var r;if(r="function"==typeof e?e:function(){return e},"function"==typeof t)return n.lift(new er(r,t));var i=Object.create(n,P);return i.source=n,i.subjectFactory=r,i}}var er=function(){function e(e,t){this.subjectFactory=e,this.selector=t}return e.prototype.call=function(e,t){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(e);return i.add(t.subscribe(r)),i},e}();var tr=function(){function e(e){this.nextSources=e}return e.prototype.call=function(e,t){return t.subscribe(new nr(e,this.nextSources))},e}(),nr=function(e){function t(t,n){var r=e.call(this,t)||this;return r.destination=t,r.nextSources=n,r}return n(t,e),t.prototype.notifyError=function(e,t){this.subscribeToNextSource()},t.prototype.notifyComplete=function(e){this.subscribeToNextSource()},t.prototype._error=function(e){this.subscribeToNextSource(),this.unsubscribe()},t.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},t.prototype.subscribeToNextSource=function(){var e=this.nextSources.shift();if(e){var t=new ke(this,void 0,void 0),n=this.destination;n.add(t);var r=Fe(this,e,void 0,void 0,t);r!==t&&n.add(r)}else this.destination.complete()},t}($e);var rr=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new ir(e))},e}(),ir=function(e){function t(t){var n=e.call(this,t)||this;return n.hasPrev=!1,n}return n(t,e),t.prototype._next=function(e){var t;this.hasPrev?t=[this.prev,e]:this.hasPrev=!0,this.prev=e,t&&this.destination.next(t)},t}(g);function or(e,t){return function(n){for(var r=n,i=0;i<t;i++){var o=r[e[i]];if(void 0===o)return;r=o}return r}}var ar=function(){function e(e,t){this.count=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new sr(e,this.count,this.source))},e}(),sr=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.count=n,i.source=r,i}return n(t,e),t.prototype.complete=function(){if(!this.isStopped){var t=this.source,n=this.count;if(0===n)return e.prototype.complete.call(this);n>-1&&(this.count=n-1),t.subscribe(this._unsubscribeAndRecycle())}},t}(g);var ur=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){return t.subscribe(new cr(e,this.notifier,t))},e}(),cr=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.notifier=n,i.source=r,i.sourceIsBeingSubscribedTo=!0,i}return n(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},t.prototype.notifyComplete=function(t){if(!1===this.sourceIsBeingSubscribedTo)return e.prototype.complete.call(this)},t.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return e.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next()}},t.prototype._unsubscribe=function(){var e=this.notifications,t=this.retriesSubscription;e&&(e.unsubscribe(),this.notifications=null),t&&(t.unsubscribe(),this.retriesSubscription=null),this.retries=null},t.prototype._unsubscribeAndRecycle=function(){var t=this._unsubscribe;return this._unsubscribe=null,e.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=t,this},t.prototype.subscribeToRetries=function(){var t;this.notifications=new x;try{t=(0,this.notifier)(this.notifications)}catch(t){return e.prototype.complete.call(this)}this.retries=t,this.retriesSubscription=Fe(this,t)},t}($e);var lr=function(){function e(e,t){this.count=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new dr(e,this.count,this.source))},e}(),dr=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.count=n,i.source=r,i}return n(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=this.source,r=this.count;if(0===r)return e.prototype.error.call(this,t);r>-1&&(this.count=r-1),n.subscribe(this._unsubscribeAndRecycle())}},t}(g);var pr=function(){function e(e,t){this.notifier=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new fr(e,this.notifier,this.source))},e}(),fr=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.notifier=n,i.source=r,i}return n(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=this.errors,r=this.retries,i=this.retriesSubscription;if(r)this.errors=null,this.retriesSubscription=null;else{n=new x;try{r=(0,this.notifier)(n)}catch(t){return e.prototype.error.call(this,t)}i=Fe(this,r)}this._unsubscribeAndRecycle(),this.errors=n,this.retries=r,this.retriesSubscription=i,n.next(t)}},t.prototype._unsubscribe=function(){var e=this.errors,t=this.retriesSubscription;e&&(e.unsubscribe(),this.errors=null),t&&(t.unsubscribe(),this.retriesSubscription=null),this.retries=null},t.prototype.notifyNext=function(e,t,n,r,i){var o=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=o,this.source.subscribe(this)},t}($e);var hr=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var n=new gr(e),r=t.subscribe(n);return r.add(Fe(n,this.notifier)),r},e}(),gr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasValue=!1,t}return n(t,e),t.prototype._next=function(e){this.value=e,this.hasValue=!0},t.prototype.notifyNext=function(e,t,n,r,i){this.emitValue()},t.prototype.notifyComplete=function(){this.emitValue()},t.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},t}($e);var mr=function(){function e(e,t){this.period=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new vr(e,this.period,this.scheduler))},e}(),vr=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.period=n,i.scheduler=r,i.hasValue=!1,i.add(r.schedule(yr,n,{subscriber:i,period:n})),i}return n(t,e),t.prototype._next=function(e){this.lastValue=e,this.hasValue=!0},t.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},t}(g);function yr(e){var t=e.subscriber,n=e.period;t.notifyNext(),this.schedule(e,n)}var _r=function(){function e(e,t){this.compareTo=e,this.comparator=t}return e.prototype.call=function(e,t){return t.subscribe(new br(e,this.compareTo,this.comparator))},e}(),br=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.compareTo=n,i.comparator=r,i._a=[],i._b=[],i._oneComplete=!1,i.destination.add(n.subscribe(new Sr(t,i))),i}return n(t,e),t.prototype._next=function(e){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(e),this.checkValues())},t.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0,this.unsubscribe()},t.prototype.checkValues=function(){for(var e=this,t=e._a,n=e._b,r=e.comparator;t.length>0&&n.length>0;){var i=t.shift(),o=n.shift(),a=!1;try{a=r?r(i,o):i===o}catch(e){this.destination.error(e)}a||this.emit(!1)}},t.prototype.emit=function(e){var t=this.destination;t.next(e),t.complete()},t.prototype.nextB=function(e){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(e),this.checkValues())},t.prototype.completeB=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},t}(g),Sr=function(e){function t(t,n){var r=e.call(this,t)||this;return r.parent=n,r}return n(t,e),t.prototype._next=function(e){this.parent.nextB(e)},t.prototype._error=function(e){this.parent.error(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},t}(g);function Er(){return new x}var wr=function(){function e(e,t){this.predicate=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new Ir(e,this.predicate,this.source))},e}(),Ir=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.source=r,i.seenValue=!1,i.index=0,i}return n(t,e),t.prototype.applySingleValue=function(e){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=e)},t.prototype._next=function(e){var t=this.index++;this.predicate?this.tryNext(e,t):this.applySingleValue(e)},t.prototype.tryNext=function(e,t){try{this.predicate(e,t,this.source)&&this.applySingleValue(e)}catch(e){this.destination.error(e)}},t.prototype._complete=function(){var e=this.destination;this.index>0?(e.next(this.seenValue?this.singleValue:void 0),e.complete()):e.error(new Te)},t}(g);var Tr=function(){function e(e){this.total=e}return e.prototype.call=function(e,t){return t.subscribe(new Or(e,this.total))},e}(),Or=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return n(t,e),t.prototype._next=function(e){++this.count>this.total&&this.destination.next(e)},t}(g);var xr=function(){function e(e){if(this._skipCount=e,this._skipCount<0)throw new Ie}return e.prototype.call=function(e,t){return 0===this._skipCount?t.subscribe(new g(e)):t.subscribe(new Rr(e,this._skipCount))},e}(),Rr=function(e){function t(t,n){var r=e.call(this,t)||this;return r._skipCount=n,r._count=0,r._ring=new Array(n),r}return n(t,e),t.prototype._next=function(e){var t=this._skipCount,n=this._count++;if(n<t)this._ring[n]=e;else{var r=n%t,i=this._ring,o=i[r];i[r]=e,this.destination.next(o)}},t}(g);var Ar=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){return t.subscribe(new Lr(e,this.notifier))},e}(),Lr=function(e){function t(t,n){var r=e.call(this,t)||this;r.hasValue=!1;var i=new ke(r,void 0,void 0);r.add(i),r.innerSubscription=i;var o=Fe(r,n,void 0,void 0,i);return o!==i&&(r.add(o),r.innerSubscription=o),r}return n(t,e),t.prototype._next=function(t){this.hasValue&&e.prototype._next.call(this,t)},t.prototype.notifyNext=function(e,t,n,r,i){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},t.prototype.notifyComplete=function(){},t}($e);var Cr=function(){function e(e){this.predicate=e}return e.prototype.call=function(e,t){return t.subscribe(new Nr(e,this.predicate))},e}(),Nr=function(e){function t(t,n){var r=e.call(this,t)||this;return r.predicate=n,r.skipping=!0,r.index=0,r}return n(t,e),t.prototype._next=function(e){var t=this.destination;this.skipping&&this.tryCallPredicate(e),this.skipping||t.next(e)},t.prototype.tryCallPredicate=function(e){try{var t=this.predicate(e,this.index++);this.skipping=Boolean(t)}catch(e){this.destination.error(e)}},t}(g);var Mr=function(e){function t(t,n,r){void 0===n&&(n=0),void 0===r&&(r=ve);var i=e.call(this)||this;return i.source=t,i.delayTime=n,i.scheduler=r,(!rt(n)||n<0)&&(i.delayTime=0),r&&"function"==typeof r.schedule||(i.scheduler=ve),i}return n(t,e),t.create=function(e,n,r){return void 0===n&&(n=0),void 0===r&&(r=ve),new t(e,n,r)},t.dispatch=function(e){var t=e.source,n=e.subscriber;return this.add(t.subscribe(n))},t.prototype._subscribe=function(e){var n=this.delayTime,r=this.source;return this.scheduler.schedule(t.dispatch,n,{source:r,subscriber:e})},t}(E);var Pr=function(){function e(e,t){this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return new Mr(t,this.delay,this.scheduler).subscribe(e)},e}();function $r(e,t){return"function"==typeof t?function(n){return n.pipe($r((function(n,r){return ze(e(n,r)).pipe(xe((function(e,i){return t(n,e,r,i)})))})))}:function(t){return t.lift(new kr(e))}}var kr=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new Dr(e,this.project))},e}(),Dr=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.index=0,r}return n(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this._innerSub(t,e,n)},t.prototype._innerSub=function(e,t,n){var r=this.innerSubscription;r&&r.unsubscribe();var i=new ke(this,t,n),o=this.destination;o.add(i),this.innerSubscription=Fe(this,e,void 0,void 0,i),this.innerSubscription!==i&&o.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=null},t.prototype.notifyComplete=function(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t}($e);var Ur=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var n=new jr(e),r=Fe(n,this.notifier);return r&&!n.seenValue?(n.add(r),t.subscribe(n)):n},e}(),jr=function(e){function t(t){var n=e.call(this,t)||this;return n.seenValue=!1,n}return n(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}($e);var Br=function(){function e(e,t){this.predicate=e,this.inclusive=t}return e.prototype.call=function(e,t){return t.subscribe(new Fr(e,this.predicate,this.inclusive))},e}(),Fr=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.inclusive=r,i.index=0,i}return n(t,e),t.prototype._next=function(e){var t,n=this.destination;try{t=this.predicate(e,this.index++)}catch(e){return void n.error(e)}this.nextOrComplete(e,t)},t.prototype.nextOrComplete=function(e,t){var n=this.destination;Boolean(t)?n.next(e):(this.inclusive&&n.next(e),n.complete())},t}(g);var qr=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new Gr(e,this.nextOrObserver,this.error,this.complete))},e}(),Gr=function(e){function t(t,n,r,o){var a=e.call(this,t)||this;return a._tapNext=we,a._tapError=we,a._tapComplete=we,a._tapError=r||we,a._tapComplete=o||we,i(n)?(a._context=a,a._tapNext=n):n&&(a._context=n,a._tapNext=n.next||we,a._tapError=n.error||we,a._tapComplete=n.complete||we),a}return n(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(g),Vr={leading:!0,trailing:!1};var Hr=function(){function e(e,t,n){this.durationSelector=e,this.leading=t,this.trailing=n}return e.prototype.call=function(e,t){return t.subscribe(new zr(e,this.durationSelector,this.leading,this.trailing))},e}(),zr=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.destination=t,o.durationSelector=n,o._leading=r,o._trailing=i,o._hasValue=!1,o}return n(t,e),t.prototype._next=function(e){this._hasValue=!0,this._sendValue=e,this._throttled||(this._leading?this.send():this.throttle(e))},t.prototype.send=function(){var e=this._hasValue,t=this._sendValue;e&&(this.destination.next(t),this.throttle(t)),this._hasValue=!1,this._sendValue=null},t.prototype.throttle=function(e){var t=this.tryDurationSelector(e);t&&this.add(this._throttled=Fe(this,t))},t.prototype.tryDurationSelector=function(e){try{return this.durationSelector(e)}catch(e){return this.destination.error(e),null}},t.prototype.throttlingDone=function(){var e=this._throttled,t=this._trailing;e&&e.unsubscribe(),this._throttled=null,t&&this.send()},t.prototype.notifyNext=function(e,t,n,r,i){this.throttlingDone()},t.prototype.notifyComplete=function(){this.throttlingDone()},t}($e);var Wr=function(){function e(e,t,n,r){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=r}return e.prototype.call=function(e,t){return t.subscribe(new Jr(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),Jr=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a.duration=n,a.scheduler=r,a.leading=i,a.trailing=o,a._hasTrailingValue=!1,a._trailingValue=null,a}return n(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Yr,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(g);function Yr(e){e.subscriber.clearThrottle()}var Kr=function(e,t){this.value=e,this.interval=t};function Xr(e,t,n){return void 0===n&&(n=ye),function(r){var i=tn(e),o=i?+e-n.now():Math.abs(e);return r.lift(new Zr(o,i,t,n))}}var Zr=function(){function e(e,t,n,r){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=n,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new Qr(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),Qr=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a.absoluteTimeout=n,a.waitFor=r,a.withObservable=i,a.scheduler=o,a.action=null,a.scheduleTimeout(),a}return n(t,e),t.dispatchTimeout=function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(Fe(e,t))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},t.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.withObservable=null},t}($e);var ei=function(e,t){this.value=e,this.timestamp=t};function ti(e,t,n){return 0===n?[t]:(e.push(t),e)}var ni=function(){function e(e){this.windowBoundaries=e}return e.prototype.call=function(e,t){var n=new ri(e),r=t.subscribe(n);return r.closed||n.add(Fe(n,this.windowBoundaries)),r},e}(),ri=function(e){function t(t){var n=e.call(this,t)||this;return n.window=new x,t.next(n.window),n}return n(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.openWindow()},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype.notifyComplete=function(e){this._complete()},t.prototype._next=function(e){this.window.next(e)},t.prototype._error=function(e){this.window.error(e),this.destination.error(e)},t.prototype._complete=function(){this.window.complete(),this.destination.complete()},t.prototype._unsubscribe=function(){this.window=null},t.prototype.openWindow=function(){var e=this.window;e&&e.complete();var t=this.destination,n=this.window=new x;t.next(n)},t}($e);var ii=function(){function e(e,t){this.windowSize=e,this.startWindowEvery=t}return e.prototype.call=function(e,t){return t.subscribe(new oi(e,this.windowSize,this.startWindowEvery))},e}(),oi=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.destination=t,i.windowSize=n,i.startWindowEvery=r,i.windows=[new x],i.count=0,t.next(i.windows[0]),i}return n(t,e),t.prototype._next=function(e){for(var t=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,n=this.destination,r=this.windowSize,i=this.windows,o=i.length,a=0;a<o&&!this.closed;a++)i[a].next(e);var s=this.count-r+1;if(s>=0&&s%t==0&&!this.closed&&i.shift().complete(),++this.count%t==0&&!this.closed){var u=new x;i.push(u),n.next(u)}},t.prototype._error=function(e){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().error(e);this.destination.error(e)},t.prototype._complete=function(){var e=this.windows;if(e)for(;e.length>0&&!this.closed;)e.shift().complete();this.destination.complete()},t.prototype._unsubscribe=function(){this.count=0,this.windows=null},t}(g);var ai=function(){function e(e,t,n,r){this.windowTimeSpan=e,this.windowCreationInterval=t,this.maxWindowSize=n,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new ui(e,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},e}(),si=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._numberOfNextedValues=0,t}return n(t,e),t.prototype.next=function(t){this._numberOfNextedValues++,e.prototype.next.call(this,t)},Object.defineProperty(t.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),t}(x),ui=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;a.destination=t,a.windowTimeSpan=n,a.windowCreationInterval=r,a.maxWindowSize=i,a.scheduler=o,a.windows=[];var s=a.openWindow();if(null!==r&&r>=0){var u={subscriber:a,window:s,context:null},c={windowTimeSpan:n,windowCreationInterval:r,subscriber:a,scheduler:o};a.add(o.schedule(di,n,u)),a.add(o.schedule(li,r,c))}else{var l={subscriber:a,window:s,windowTimeSpan:n};a.add(o.schedule(ci,n,l))}return a}return n(t,e),t.prototype._next=function(e){for(var t=this.windows,n=t.length,r=0;r<n;r++){var i=t[r];i.closed||(i.next(e),i.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(i))}},t.prototype._error=function(e){for(var t=this.windows;t.length>0;)t.shift().error(e);this.destination.error(e)},t.prototype._complete=function(){for(var e=this.windows;e.length>0;){var t=e.shift();t.closed||t.complete()}this.destination.complete()},t.prototype.openWindow=function(){var e=new si;return this.windows.push(e),this.destination.next(e),e},t.prototype.closeWindow=function(e){e.complete();var t=this.windows;t.splice(t.indexOf(e),1)},t}(g);function ci(e){var t=e.subscriber,n=e.windowTimeSpan,r=e.window;r&&t.closeWindow(r),e.window=t.openWindow(),this.schedule(e,n)}function li(e){var t=e.windowTimeSpan,n=e.subscriber,r=e.scheduler,i=e.windowCreationInterval,o=n.openWindow(),a=this,s={action:a,subscription:null},u={subscriber:n,window:o,context:s};s.subscription=r.schedule(di,t,u),a.add(s.subscription),a.schedule(e,i)}function di(e){var t=e.subscriber,n=e.window,r=e.context;r&&r.action&&r.subscription&&r.action.remove(r.subscription),t.closeWindow(n)}var pi=function(){function e(e,t){this.openings=e,this.closingSelector=t}return e.prototype.call=function(e,t){return t.subscribe(new fi(e,this.openings,this.closingSelector))},e}(),fi=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.openings=n,i.closingSelector=r,i.contexts=[],i.add(i.openSubscription=Fe(i,n,n)),i}return n(t,e),t.prototype._next=function(e){var t=this.contexts;if(t)for(var n=t.length,r=0;r<n;r++)t[r].window.next(e)},t.prototype._error=function(t){var n=this.contexts;if(this.contexts=null,n)for(var r=n.length,i=-1;++i<r;){var o=n[i];o.window.error(t),o.subscription.unsubscribe()}e.prototype._error.call(this,t)},t.prototype._complete=function(){var t=this.contexts;if(this.contexts=null,t)for(var n=t.length,r=-1;++r<n;){var i=t[r];i.window.complete(),i.subscription.unsubscribe()}e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.contexts;if(this.contexts=null,e)for(var t=e.length,n=-1;++n<t;){var r=e[n];r.window.unsubscribe(),r.subscription.unsubscribe()}},t.prototype.notifyNext=function(e,t,n,r,i){if(e===this.openings){var o=void 0;try{o=(0,this.closingSelector)(t)}catch(e){return this.error(e)}var a=new x,s=new p,u={window:a,subscription:s};this.contexts.push(u);var c=Fe(this,o,u);c.closed?this.closeWindow(this.contexts.length-1):(c.context=u,s.add(c)),this.destination.next(a)}else this.closeWindow(this.contexts.indexOf(e))},t.prototype.notifyError=function(e){this.error(e)},t.prototype.notifyComplete=function(e){e!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(e.context))},t.prototype.closeWindow=function(e){if(-1!==e){var t=this.contexts,n=t[e],r=n.window,i=n.subscription;t.splice(e,1),r.complete(),i.unsubscribe()}},t}($e);var hi=function(){function e(e){this.closingSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new gi(e,this.closingSelector))},e}(),gi=function(e){function t(t,n){var r=e.call(this,t)||this;return r.destination=t,r.closingSelector=n,r.openWindow(),r}return n(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.openWindow(i)},t.prototype.notifyError=function(e,t){this._error(e)},t.prototype.notifyComplete=function(e){this.openWindow(e)},t.prototype._next=function(e){this.window.next(e)},t.prototype._error=function(e){this.window.error(e),this.destination.error(e),this.unsubscribeClosingNotification()},t.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},t.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},t.prototype.openWindow=function(e){void 0===e&&(e=null),e&&(this.remove(e),e.unsubscribe());var t=this.window;t&&t.complete();var n,r=this.window=new x;this.destination.next(r);try{n=(0,this.closingSelector)()}catch(e){return this.destination.error(e),void this.window.error(e)}this.add(this.closingNotification=Fe(this,n))},t}($e);var mi=function(){function e(e,t){this.observables=e,this.project=t}return e.prototype.call=function(e,t){return t.subscribe(new vi(e,this.observables,this.project))},e}(),vi=function(e){function t(t,n,r){var i=e.call(this,t)||this;i.observables=n,i.project=r,i.toRespond=[];var o=n.length;i.values=new Array(o);for(var a=0;a<o;a++)i.toRespond.push(a);for(a=0;a<o;a++){var s=n[a];i.add(Fe(i,s,s,a))}return i}return n(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.values[n]=t;var o=this.toRespond;if(o.length>0){var a=o.indexOf(n);-1!==a&&o.splice(a,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(0===this.toRespond.length){var t=[e].concat(this.values);this.project?this._tryProject(t):this.destination.next(t)}},t.prototype._tryProject=function(e){var t;try{t=this.project.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}($e);var yi=Object.freeze({audit:It,auditTime:function(e,t){return void 0===t&&(t=ye),It((function(){return mt(e,t)}))},buffer:function(e){return function(t){return t.lift(new xt(e))}},bufferCount:function(e,t){return void 0===t&&(t=null),function(n){return n.lift(new At(e,t))}},bufferTime:function(e){var t=arguments.length,n=ye;Y(arguments[arguments.length-1])&&(n=arguments[arguments.length-1],t--);var r=null;t>=2&&(r=arguments[1]);var i=Number.POSITIVE_INFINITY;return t>=3&&(i=arguments[2]),function(t){return t.lift(new Nt(e,r,i,n))}},bufferToggle:function(e,t){return function(n){return n.lift(new Ut(e,t))}},bufferWhen:function(e){return function(t){return t.lift(new Bt(e))}},catchError:function(e){return function(t){var n=new qt(e),r=t.lift(n);return n.caught=r}},combineAll:function(e){return function(t){return t.lift(new Ge(e))}},combineLatest:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=null;return"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&c(e[0])&&(e=e[0].slice()),function(t){return t.lift.call(ze([t].concat(e)),new Ge(n))}},concat:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return t.lift.call(Ze.apply(void 0,[t].concat(e)))}},concatAll:Xe,concatMap:Vt,concatMapTo:function(e,t){return Vt((function(){return e}),t)},count:function(e){return function(t){return t.lift(new Ht(e,t))}},debounce:function(e){return function(t){return t.lift(new Wt(e))}},debounceTime:function(e,t){return void 0===t&&(t=ye),function(n){return n.lift(new Yt(e,t))}},defaultIfEmpty:Zt,delay:function(e,t){void 0===t&&(t=ye);var n=tn(e)?+e-t.now():Math.abs(e);return function(e){return e.lift(new nn(n,t))}},delayWhen:function(e,t){return t?function(n){return new un(n,t).lift(new an(e))}:function(t){return t.lift(new an(e))}},dematerialize:function(){return function(e){return e.lift(new ln)}},distinct:function(e,t){return function(n){return n.lift(new pn(e,t))}},distinctUntilChanged:hn,distinctUntilKeyChanged:function(e,t){return hn((function(n,r){return t?t(n[e],r[e]):n[e]===r[e]}))},elementAt:function(e,t){if(e<0)throw new Ie;var n=arguments.length>=2;return function(r){return r.pipe(ct((function(t,n){return n===e})),Sn(1),n?Zt(t):vn((function(){return new Ie})))}},endWith:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return Ze(t,ee.apply(void 0,e))}},every:function(e,t){return function(n){return n.lift(new In(e,t,n))}},exhaust:function(){return function(e){return e.lift(new On)}},exhaustMap:function e(t,n){return n?function(r){return r.pipe(e((function(e,r){return ze(t(e,r)).pipe(xe((function(t,i){return n(e,t,r,i)})))})))}:function(e){return e.lift(new Rn(t))}},expand:function(e,t,n){return void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=void 0),t=(t||0)<1?Number.POSITIVE_INFINITY:t,function(r){return r.lift(new Ln(e,t,n))}},filter:ct,finalize:function(e){return function(t){return t.lift(new Nn(e))}},find:function(e,t){if("function"!=typeof e)throw new TypeError("predicate is not a function");return function(n){return n.lift(new Pn(e,n,!1,t))}},findIndex:function(e,t){return function(n){return n.lift(new Pn(e,n,!0,t))}},first:function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?ct((function(t,n){return e(t,n,r)})):_,Sn(1),n?Zt(t):vn((function(){return new Te})))}},groupBy:function(e,t,n,r){return function(i){return i.lift(new k(e,t,n,r))}},ignoreElements:function(){return function(e){return e.lift(new kn)}},isEmpty:function(){return function(e){return e.lift(new Un)}},last:function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?ct((function(t,n){return e(t,n,r)})):_,Bn(1),n?Zt(t):vn((function(){return new Te})))}},map:xe,mapTo:function(e){return function(t){return t.lift(new Gn(e))}},materialize:function(){return function(e){return e.lift(new Hn)}},max:function(e){return Kn("function"==typeof e?function(t,n){return e(t,n)>0?t:n}:function(e,t){return e>t?e:t})},merge:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return t.lift.call(ot.apply(void 0,[t].concat(e)))}},mergeAll:Ke,mergeMap:We,flatMap:We,mergeMapTo:function(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?We((function(){return e}),t,n):("number"==typeof t&&(n=t),We((function(){return e}),n))},mergeScan:function(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),function(r){return r.lift(new Xn(e,t,n))}},min:function(e){return Kn("function"==typeof e?function(t,n){return e(t,n)<0?t:n}:function(e,t){return e<t?e:t})},multicast:Qn,observeOn:function(e,t){return void 0===t&&(t=0),function(n){return n.lift(new ie(e,t))}},onErrorResumeNext:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===e.length&&c(e[0])&&(e=e[0]),function(t){return t.lift(new tr(e))}},pairwise:function(){return function(e){return e.lift(new rr)}},partition:function(e,t){return function(n){return[ct(e,t)(n),ct(ut(e,t))(n)]}},pluck:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.length;if(0===n)throw new Error("list of properties cannot be empty.");return function(t){return xe(or(e,n))(t)}},publish:function(e){return e?Qn((function(){return new x}),e):Qn(new x)},publishBehavior:function(e){return function(t){return Qn(new F(e))(t)}},publishLast:function(){return function(e){return Qn(new ce)(e)}},publishReplay:function(e,t,n,r){n&&"function"!=typeof n&&(r=n);var i="function"==typeof n?n:void 0,o=new se(e,t,r);return function(e){return Qn((function(){return o}),i)(e)}},race:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return 1===e.length&&c(e[0])&&(e=e[0]),t.lift.call(pt.apply(void 0,[t].concat(e)))}},reduce:Kn,repeat:function(e){return void 0===e&&(e=-1),function(t){return 0===e?J():e<0?t.lift(new ar(-1,t)):t.lift(new ar(e-1,t))}},repeatWhen:function(e){return function(t){return t.lift(new ur(e))}},retry:function(e){return void 0===e&&(e=-1),function(t){return t.lift(new lr(e,t))}},retryWhen:function(e){return function(t){return t.lift(new pr(e,t))}},refCount:A,sample:function(e){return function(t){return t.lift(new hr(e))}},sampleTime:function(e,t){return void 0===t&&(t=ye),function(n){return n.lift(new mr(e,t))}},scan:Wn,sequenceEqual:function(e,t){return function(n){return n.lift(new _r(e,t))}},share:function(){return function(e){return A()(Qn(Er)(e))}},shareReplay:function(e,t,n){var r;return r=e&&"object"==typeof e?e:{bufferSize:e,windowTime:t,refCount:!1,scheduler:n},function(e){return e.lift(function(e){var t,n,r=e.bufferSize,i=void 0===r?Number.POSITIVE_INFINITY:r,o=e.windowTime,a=void 0===o?Number.POSITIVE_INFINITY:o,s=e.refCount,u=e.scheduler,c=0,l=!1,d=!1;return function(e){c++,t&&!l||(l=!1,t=new se(i,a,u),n=e.subscribe({next:function(e){t.next(e)},error:function(e){l=!0,t.error(e)},complete:function(){d=!0,n=void 0,t.complete()}}));var r=t.subscribe(this);this.add((function(){c--,r.unsubscribe(),n&&!d&&s&&0===c&&(n.unsubscribe(),n=void 0,t=void 0)}))}}(r))}},single:function(e){return function(t){return t.lift(new wr(e,t))}},skip:function(e){return function(t){return t.lift(new Tr(e))}},skipLast:function(e){return function(t){return t.lift(new xr(e))}},skipUntil:function(e){return function(t){return t.lift(new Ar(e))}},skipWhile:function(e){return function(t){return t.lift(new Cr(e))}},startWith:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return Y(n)?(e.pop(),function(t){return Ze(e,t,n)}):function(t){return Ze(e,t)}},subscribeOn:function(e,t){return void 0===t&&(t=0),function(n){return n.lift(new Pr(e,t))}},switchAll:function(){return $r(_)},switchMap:$r,switchMapTo:function(e,t){return t?$r((function(){return e}),t):$r((function(){return e}))},take:Sn,takeLast:Bn,takeUntil:function(e){return function(t){return t.lift(new Ur(e))}},takeWhile:function(e,t){return void 0===t&&(t=!1),function(n){return n.lift(new Br(e,t))}},tap:function(e,t,n){return function(r){return r.lift(new qr(e,t,n))}},throttle:function(e,t){return void 0===t&&(t=Vr),function(n){return n.lift(new Hr(e,t.leading,t.trailing))}},throttleTime:function(e,t,n){return void 0===t&&(t=ye),void 0===n&&(n=Vr),function(r){return r.lift(new Wr(e,t,n.leading,n.trailing))}},throwIfEmpty:vn,timeInterval:function(e){return void 0===e&&(e=ye),function(t){return Qe((function(){return t.pipe(Wn((function(t,n){var r=t.current;return{value:n,current:e.now(),last:r}}),{current:e.now(),value:void 0,last:void 0}),xe((function(e){var t=e.current,n=e.last,r=e.value;return new Kr(r,t-n)})))}))}},timeout:function(e,t){return void 0===t&&(t=ye),Xr(e,te(new Oe),t)},timeoutWith:Xr,timestamp:function(e){return void 0===e&&(e=ye),xe((function(t){return new ei(t,e.now())}))},toArray:function(){return Kn(ti,[])},window:function(e){return function(t){return t.lift(new ni(e))}},windowCount:function(e,t){return void 0===t&&(t=0),function(n){return n.lift(new ii(e,t))}},windowTime:function(e){var t=ye,n=null,r=Number.POSITIVE_INFINITY;return Y(arguments[3])&&(t=arguments[3]),Y(arguments[2])?t=arguments[2]:rt(arguments[2])&&(r=arguments[2]),Y(arguments[1])?t=arguments[1]:rt(arguments[1])&&(n=arguments[1]),function(i){return i.lift(new ai(e,n,r,t))}},windowToggle:function(e,t){return function(n){return n.lift(new pi(e,t))}},windowWhen:function(e){return function(t){return t.lift(new hi(e))}},withLatestFrom:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n;"function"==typeof e[e.length-1]&&(n=e.pop());var r=e;return t.lift(new mi(r,n))}},zip:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return t.lift.call(yt.apply(void 0,[t].concat(e)))}},zipAll:function(e){return function(t){return t.lift(new _t(e))}}}),_i=function(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.subscribedFrame=e,this.unsubscribedFrame=t},bi=function(){function e(){this.subscriptions=[]}return e.prototype.logSubscribedFrame=function(){return this.subscriptions.push(new _i(this.scheduler.now())),this.subscriptions.length-1},e.prototype.logUnsubscribedFrame=function(e){var t=this.subscriptions,n=t[e];t[e]=new _i(n.subscribedFrame,this.scheduler.now())},e}();function Si(e,t){for(var n=0,r=t.length;n<r;n++)for(var i=t[n],o=Object.getOwnPropertyNames(i.prototype),a=0,s=o.length;a<s;a++){var u=o[a];e.prototype[u]=i.prototype[u]}}var Ei=function(e){function t(t,n){var r=e.call(this,(function(e){var t=this,n=t.logSubscribedFrame(),r=new p;return r.add(new p((function(){t.logUnsubscribedFrame(n)}))),t.scheduleMessages(e),r}))||this;return r.messages=t,r.subscriptions=[],r.scheduler=n,r}return n(t,e),t.prototype.scheduleMessages=function(e){for(var t=this.messages.length,n=0;n<t;n++){var r=this.messages[n];e.add(this.scheduler.schedule((function(e){var t=e.message,n=e.subscriber;t.notification.observe(n)}),r.frame,{message:r,subscriber:e}))}},t}(E);Si(Ei,[bi]);var wi=function(e){function t(t,n){var r=e.call(this)||this;return r.messages=t,r.subscriptions=[],r.scheduler=n,r}return n(t,e),t.prototype._subscribe=function(t){var n=this,r=n.logSubscribedFrame(),i=new p;return i.add(new p((function(){n.logUnsubscribedFrame(r)}))),i.add(e.prototype._subscribe.call(this,t)),i},t.prototype.setup=function(){for(var e=this,t=e.messages.length,n=0;n<t;n++)!function(){var t=e.messages[n];e.scheduler.schedule((function(){t.notification.observe(e)}),t.frame)}()},t}(x);Si(wi,[bi]);var Ii=function(e){function t(t){var n=e.call(this,Ee,750)||this;return n.assertDeepEqual=t,n.hotObservables=[],n.coldObservables=[],n.flushTests=[],n.runMode=!1,n}return n(t,e),t.prototype.createTime=function(e){var n=e.indexOf("|");if(-1===n)throw new Error('marble diagram for time should have a completion marker "|"');return n*t.frameTimeFactor},t.prototype.createColdObservable=function(e,n,r){if(-1!==e.indexOf("^"))throw new Error('cold observable cannot have subscription offset "^"');if(-1!==e.indexOf("!"))throw new Error('cold observable cannot have unsubscription marker "!"');var i=t.parseMarbles(e,n,r,void 0,this.runMode),o=new Ei(i,this);return this.coldObservables.push(o),o},t.prototype.createHotObservable=function(e,n,r){if(-1!==e.indexOf("!"))throw new Error('hot observable cannot have unsubscription marker "!"');var i=t.parseMarbles(e,n,r,void 0,this.runMode),o=new wi(i,this);return this.hotObservables.push(o),o},t.prototype.materializeInnerObservable=function(e,t){var n=this,r=[];return e.subscribe((function(e){r.push({frame:n.frame-t,notification:re.createNext(e)})}),(function(e){r.push({frame:n.frame-t,notification:re.createError(e)})}),(function(){r.push({frame:n.frame-t,notification:re.createComplete()})})),r},t.prototype.expectObservable=function(e,n){var r=this;void 0===n&&(n=null);var i,o=[],a={actual:o,ready:!1},s=t.parseMarblesAsSubscriptions(n,this.runMode),u=s.subscribedFrame===Number.POSITIVE_INFINITY?0:s.subscribedFrame,c=s.unsubscribedFrame;this.schedule((function(){i=e.subscribe((function(e){var t=e;e instanceof E&&(t=r.materializeInnerObservable(t,r.frame)),o.push({frame:r.frame,notification:re.createNext(t)})}),(function(e){o.push({frame:r.frame,notification:re.createError(e)})}),(function(){o.push({frame:r.frame,notification:re.createComplete()})}))}),u),c!==Number.POSITIVE_INFINITY&&this.schedule((function(){return i.unsubscribe()}),c),this.flushTests.push(a);var l=this.runMode;return{toBe:function(e,n,r){a.ready=!0,a.expected=t.parseMarbles(e,n,r,!0,l)}}},t.prototype.expectSubscriptions=function(e){var n={actual:e,ready:!1};this.flushTests.push(n);var r=this.runMode;return{toBe:function(e){var i="string"==typeof e?[e]:e;n.ready=!0,n.expected=i.map((function(e){return t.parseMarblesAsSubscriptions(e,r)}))}}},t.prototype.flush=function(){for(var t=this,n=this.hotObservables;n.length>0;)n.shift().setup();e.prototype.flush.call(this),this.flushTests=this.flushTests.filter((function(e){return!e.ready||(t.assertDeepEqual(e.actual,e.expected),!1)}))},t.parseMarblesAsSubscriptions=function(e,t){var n=this;if(void 0===t&&(t=!1),"string"!=typeof e)return new _i(Number.POSITIVE_INFINITY);for(var r,i=e.length,o=-1,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,u=0,c=function(i){var c=u,d=function(e){c+=e*n.frameTimeFactor},p=e[i];switch(p){case" ":t||d(1);break;case"-":d(1);break;case"(":o=u,d(1);break;case")":o=-1,d(1);break;case"^":if(a!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");a=o>-1?o:u,d(1);break;case"!":if(s!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");s=o>-1?o:u;break;default:if(t&&p.match(/^[0-9]$/)&&(0===i||" "===e[i-1])){var f=e.slice(i).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(f){i+=f[0].length-1;var h=parseFloat(f[1]),g=void 0;switch(f[2]){case"ms":g=h;break;case"s":g=1e3*h;break;case"m":g=1e3*h*60}d(g/l.frameTimeFactor);break}}throw new Error("there can only be '^' and '!' markers in a subscription marble diagram. Found instead '"+p+"'.")}u=c,r=i},l=this,d=0;d<i;d++)c(d),d=r;return s<0?new _i(a):new _i(a,s)},t.parseMarbles=function(e,t,n,r,i){var o=this;if(void 0===r&&(r=!1),void 0===i&&(i=!1),-1!==e.indexOf("!"))throw new Error('conventional marble diagrams cannot have the unsubscription marker "!"');for(var a,s=e.length,u=[],c=i?e.replace(/^[ ]+/,"").indexOf("^"):e.indexOf("^"),l=-1===c?0:c*-this.frameTimeFactor,d="object"!=typeof t?function(e){return e}:function(e){return r&&t[e]instanceof Ei?t[e].messages:t[e]},p=-1,f=function(t){var r=l,s=function(e){r+=e*o.frameTimeFactor},c=void 0,f=e[t];switch(f){case" ":i||s(1);break;case"-":s(1);break;case"(":p=l,s(1);break;case")":p=-1,s(1);break;case"|":c=re.createComplete(),s(1);break;case"^":s(1);break;case"#":c=re.createError(n||"error"),s(1);break;default:if(i&&f.match(/^[0-9]$/)&&(0===t||" "===e[t-1])){var g=e.slice(t).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(g){t+=g[0].length-1;var m=parseFloat(g[1]),v=void 0;switch(g[2]){case"ms":v=m;break;case"s":v=1e3*m;break;case"m":v=1e3*m*60}s(v/h.frameTimeFactor);break}}c=re.createNext(d(f)),s(1)}c&&u.push({frame:p>-1?p:l,notification:c}),l=r,a=t},h=this,g=0;g<s;g++)f(g),g=a;return u},t.prototype.run=function(e){var n=t.frameTimeFactor,r=this.maxFrames;t.frameTimeFactor=1,this.maxFrames=Number.POSITIVE_INFINITY,this.runMode=!0,H.delegate=this;var i={cold:this.createColdObservable.bind(this),hot:this.createHotObservable.bind(this),flush:this.flush.bind(this),expectObservable:this.expectObservable.bind(this),expectSubscriptions:this.expectSubscriptions.bind(this)};try{var o=e(i);return this.flush(),o}finally{t.frameTimeFactor=n,this.maxFrames=r,this.runMode=!1,H.delegate=void 0}},t}(Se),Ti=Object.freeze({TestScheduler:Ii}),Oi="undefined"!=typeof window&&window,xi="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ri="undefined"!=typeof global&&global,Ai=Oi||Ri||xi;function Li(e,t){return void 0===t&&(t=null),new Di({method:"GET",url:e,headers:t})}function Ci(e,t,n){return new Di({method:"POST",url:e,body:t,headers:n})}function Ni(e,t){return new Di({method:"DELETE",url:e,headers:t})}function Mi(e,t,n){return new Di({method:"PUT",url:e,body:t,headers:n})}function Pi(e,t,n){return new Di({method:"PATCH",url:e,body:t,headers:n})}!function(){if(!Ai)throw new Error("RxJS could not find any global context (window, self, global)")}();var $i=xe((function(e,t){return e.response}));function ki(e,t){return $i(new Di({method:"GET",url:e,responseType:"json",headers:t}))}var Di=function(e){function t(t){var n=e.call(this)||this,r={async:!0,createXHR:function(){return this.crossDomain?function(){if(Ai.XMLHttpRequest)return new Ai.XMLHttpRequest;if(Ai.XDomainRequest)return new Ai.XDomainRequest;throw new Error("CORS is not supported by your browser")}():function(){if(Ai.XMLHttpRequest)return new Ai.XMLHttpRequest;var e=void 0;try{for(var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=0;n<3;n++)try{if(e=t[n],new Ai.ActiveXObject(e))break}catch(e){}return new Ai.ActiveXObject(e)}catch(e){throw new Error("XMLHttpRequest is not supported by your browser")}}()},crossDomain:!0,withCredentials:!1,headers:{},method:"GET",responseType:"json",timeout:0};if("string"==typeof t)r.url=t;else for(var i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return n.request=r,n}var r;return n(t,e),t.prototype._subscribe=function(e){return new Ui(e,this.request)},t.create=((r=function(e){return new t(e)}).get=Li,r.post=Ci,r.delete=Ni,r.put=Mi,r.patch=Pi,r.getJSON=ki,r),t}(E),Ui=function(e){function t(t,n){var r=e.call(this,t)||this;r.request=n,r.done=!1;var i=n.headers=n.headers||{};return n.crossDomain||r.getHeader(i,"X-Requested-With")||(i["X-Requested-With"]="XMLHttpRequest"),r.getHeader(i,"Content-Type")||Ai.FormData&&n.body instanceof Ai.FormData||void 0===n.body||(i["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),n.body=r.serializeBody(n.body,r.getHeader(n.headers,"Content-Type")),r.send(),r}return n(t,e),t.prototype.next=function(e){this.done=!0;var t,n=this,r=n.xhr,i=n.request,o=n.destination;try{t=new ji(e,r,i)}catch(e){return o.error(e)}o.next(t)},t.prototype.send=function(){var e=this.request,t=this.request,n=t.user,r=t.method,i=t.url,o=t.async,a=t.password,s=t.headers,u=t.body;try{var c=this.xhr=e.createXHR();this.setupEvents(c,e),n?c.open(r,i,o,n,a):c.open(r,i,o),o&&(c.timeout=e.timeout,c.responseType=e.responseType),"withCredentials"in c&&(c.withCredentials=!!e.withCredentials),this.setHeaders(c,s),u?c.send(u):c.send()}catch(e){this.error(e)}},t.prototype.serializeBody=function(e,t){if(!e||"string"==typeof e)return e;if(Ai.FormData&&e instanceof Ai.FormData)return e;if(t){var n=t.indexOf(";");-1!==n&&(t=t.substring(0,n))}switch(t){case"application/x-www-form-urlencoded":return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&");case"application/json":return JSON.stringify(e);default:return e}},t.prototype.setHeaders=function(e,t){for(var n in t)t.hasOwnProperty(n)&&e.setRequestHeader(n,t[n])},t.prototype.getHeader=function(e,t){for(var n in e)if(n.toLowerCase()===t.toLowerCase())return e[n]},t.prototype.setupEvents=function(e,t){var n=t.progressSubscriber;function r(e){var t,n=r,i=n.subscriber,o=n.progressSubscriber,a=n.request;o&&o.error(e);try{t=new qi(this,a)}catch(e){t=e}i.error(t)}if(e.ontimeout=r,r.request=t,r.subscriber=this,r.progressSubscriber=n,e.upload&&"withCredentials"in e){var i,o;if(n)i=function(e){i.progressSubscriber.next(e)},Ai.XDomainRequest?e.onprogress=i:e.upload.onprogress=i,i.progressSubscriber=n;o=function(e){var t,n=o,r=n.progressSubscriber,i=n.subscriber,a=n.request;r&&r.error(e);try{t=new Bi("ajax error",this,a)}catch(e){t=e}i.error(t)},e.onerror=o,o.request=t,o.subscriber=this,o.progressSubscriber=n}function a(e){}function s(e){var t=s,n=t.subscriber,r=t.progressSubscriber,i=t.request;if(4===this.readyState){var o=1223===this.status?204:this.status,a="text"===this.responseType?this.response||this.responseText:this.response;if(0===o&&(o=a?200:0),o<400)r&&r.complete(),n.next(e),n.complete();else{r&&r.error(e);var u=void 0;try{u=new Bi("ajax error "+o,this,i)}catch(e){u=e}n.error(u)}}}e.onreadystatechange=a,a.subscriber=this,a.progressSubscriber=n,a.request=t,e.onload=s,s.subscriber=this,s.progressSubscriber=n,s.request=t},t.prototype.unsubscribe=function(){var t=this.done,n=this.xhr;!t&&n&&4!==n.readyState&&"function"==typeof n.abort&&n.abort(),e.prototype.unsubscribe.call(this)},t}(g),ji=function(e,t,n){this.originalEvent=e,this.xhr=t,this.request=n,this.status=t.status,this.responseType=t.responseType||n.responseType,this.response=Fi(this.responseType,t)},Bi=function(){function e(e,t,n){return Error.call(this),this.message=e,this.name="AjaxError",this.xhr=t,this.request=n,this.status=t.status,this.responseType=t.responseType||n.responseType,this.response=Fi(this.responseType,t),this}return e.prototype=Object.create(Error.prototype),e}();function Fi(e,t){switch(e){case"json":return function(e){return"response"in e?e.responseType?e.response:JSON.parse(e.response||e.responseText||"null"):JSON.parse(e.responseText||"null")}(t);case"xml":return t.responseXML;case"text":default:return"response"in t?t.response:t.responseText}}var qi=function(e,t){return Bi.call(this,"ajax timeout",e,t),this.name="AjaxTimeoutError",this},Gi=Di.create,Vi=Object.freeze({ajax:Gi,AjaxResponse:ji,AjaxError:Bi,AjaxTimeoutError:qi}),Hi={url:"",deserializer:function(e){return JSON.parse(e.data)},serializer:function(e){return JSON.stringify(e)}},zi=function(e){function t(t,n){var i=e.call(this)||this;if(t instanceof E)i.destination=n,i.source=t;else{var o=i._config=r({},Hi);if(i._output=new x,"string"==typeof t)o.url=t;else for(var a in t)t.hasOwnProperty(a)&&(o[a]=t[a]);if(!o.WebSocketCtor&&WebSocket)o.WebSocketCtor=WebSocket;else if(!o.WebSocketCtor)throw new Error("no WebSocket constructor can be found");i.destination=new se}return i}return n(t,e),t.prototype.lift=function(e){var n=new t(this._config,this.destination);return n.operator=e,n.source=this,n},t.prototype._resetState=function(){this._socket=null,this.source||(this.destination=new se),this._output=new x},t.prototype.multiplex=function(e,t,n){var r=this;return new E((function(i){try{r.next(e())}catch(e){i.error(e)}var o=r.subscribe((function(e){try{n(e)&&i.next(e)}catch(e){i.error(e)}}),(function(e){return i.error(e)}),(function(){return i.complete()}));return function(){try{r.next(t())}catch(e){i.error(e)}o.unsubscribe()}}))},t.prototype._connectSocket=function(){var e=this,t=this._config,n=t.WebSocketCtor,r=t.protocol,i=t.url,o=t.binaryType,a=this._output,s=null;try{s=r?new n(i,r):new n(i),this._socket=s,o&&(this._socket.binaryType=o)}catch(e){return void a.error(e)}var u=new p((function(){e._socket=null,s&&1===s.readyState&&s.close()}));s.onopen=function(t){if(!e._socket)return s.close(),void e._resetState();var n=e._config.openObserver;n&&n.next(t);var r=e.destination;e.destination=g.create((function(t){if(1===s.readyState)try{var n=e._config.serializer;s.send(n(t))}catch(t){e.destination.error(t)}}),(function(t){var n=e._config.closingObserver;n&&n.next(void 0),t&&t.code?s.close(t.code,t.reason):a.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),e._resetState()}),(function(){var t=e._config.closingObserver;t&&t.next(void 0),s.close(),e._resetState()})),r&&r instanceof se&&u.add(r.subscribe(e.destination))},s.onerror=function(t){e._resetState(),a.error(t)},s.onclose=function(t){e._resetState();var n=e._config.closeObserver;n&&n.next(t),t.wasClean?a.complete():a.error(t)},s.onmessage=function(t){try{var n=e._config.deserializer;a.next(n(t))}catch(e){a.error(e)}}},t.prototype._subscribe=function(e){var t=this,n=this.source;return n?n.subscribe(e):(this._socket||this._connectSocket(),this._output.subscribe(e),e.add((function(){var e=t._socket;0===t._output.observers.length&&(e&&1===e.readyState&&e.close(),t._resetState())})),e)},t.prototype.unsubscribe=function(){var t=this._socket;t&&1===t.readyState&&t.close(),this._resetState(),e.prototype.unsubscribe.call(this)},t}(R);var Wi=yi,Ji=Ti,Yi=Vi,Ki=Object.freeze({webSocket:function(e){return new zi(e)},WebSocketSubject:zi}),Xi=Object.freeze({fromFetch:function(e,t){return new E((function(n){var i,o=new AbortController,a=o.signal,s=!0,u=!1,c=new p;if(c.add((function(){u=!0,s&&o.abort()})),t){if(t.signal)if(t.signal.aborted)o.abort();else{var l=t.signal,d=function(){a.aborted||o.abort()};l.addEventListener("abort",d),c.add((function(){return l.removeEventListener("abort",d)}))}i=r({},t,{signal:a})}else i={signal:a};return fetch(e,i).then((function(e){s=!1,n.next(e),n.complete()})).catch((function(e){s=!1,u||n.error(e)})),c}))}});e.operators=Wi,e.testing=Ji,e.ajax=Yi,e.webSocket=Ki,e.fetch=Xi,e.Observable=E,e.ConnectableObservable=M,e.GroupedObservable=j,e.observable=y,e.Subject=x,e.BehaviorSubject=F,e.ReplaySubject=se,e.AsyncSubject=ce,e.asapScheduler=ve,e.asyncScheduler=ye,e.queueScheduler=z,e.animationFrameScheduler=be,e.VirtualTimeScheduler=Se,e.VirtualAction=Ee,e.Scheduler=V,e.Subscription=p,e.Subscriber=g,e.Notification=re,e.pipe=b,e.noop=we,e.identity=_,e.isObservable=function(e){return!!e&&(e instanceof E||"function"==typeof e.lift&&"function"==typeof e.subscribe)},e.ArgumentOutOfRangeError=Ie,e.EmptyError=Te,e.ObjectUnsubscribedError=I,e.UnsubscriptionError=d,e.TimeoutError=Oe,e.bindCallback=function e(t,n,r){if(n){if(!Y(n))return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return e(t,r).apply(void 0,i).pipe(xe((function(e){return c(e)?n.apply(void 0,e):n(e)})))};r=n}return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i,o=this,a={context:o,subject:i,callbackFunc:t,scheduler:r};return new E((function(n){if(r){var s={args:e,subscriber:n,params:a};return r.schedule(Le,0,s)}if(!i){i=new ce;try{t.apply(o,e.concat([function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.next(e.length<=1?e[0]:e),i.complete()}]))}catch(e){v(i)?i.error(e):console.warn(e)}}return i.subscribe(n)}))}},e.bindNodeCallback=function e(t,n,r){if(n){if(!Y(n))return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return e(t,r).apply(void 0,i).pipe(xe((function(e){return c(e)?n.apply(void 0,e):n(e)})))};r=n}return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i={subject:void 0,args:e,callbackFunc:t,scheduler:r,context:this};return new E((function(n){var o=i.context,a=i.subject;if(r)return r.schedule(Ne,0,{params:i,subscriber:n,context:o});if(!a){a=i.subject=new ce;try{t.apply(o,e.concat([function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.shift();n?a.error(n):(a.next(e.length<=1?e[0]:e),a.complete())}]))}catch(e){v(a)?a.error(e):console.warn(e)}}return a.subscribe(n)}))}},e.combineLatest=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=null,r=null;return Y(e[e.length-1])&&(r=e.pop()),"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&c(e[0])&&(e=e[0]),Q(e,r).lift(new Ge(n))},e.concat=Ze,e.defer=Qe,e.empty=J,e.forkJoin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var n=e[0];if(c(n))return et(n,null);if(l(n)&&Object.getPrototypeOf(n)===Object.prototype){var r=Object.keys(n);return et(r.map((function(e){return n[e]})),r)}}if("function"==typeof e[e.length-1]){var i=e.pop();return et(e=1===e.length&&c(e[0])?e[0]:e,null).pipe(xe((function(e){return i.apply(void 0,e)})))}return et(e,null)},e.from=ze,e.fromEvent=function e(t,n,r,o){return i(r)&&(o=r,r=void 0),o?e(t,n,r).pipe(xe((function(e){return c(e)?o.apply(void 0,e):o(e)}))):new E((function(e){tt(t,n,(function(t){arguments.length>1?e.next(Array.prototype.slice.call(arguments)):e.next(t)}),e,r)}))},e.fromEventPattern=function e(t,n,r){return r?e(t,n).pipe(xe((function(e){return c(e)?r.apply(void 0,e):r(e)}))):new E((function(e){var r,o=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1===t.length?t[0]:t)};try{r=t(o)}catch(t){return void e.error(t)}if(i(n))return function(){return n(o,r)}}))},e.generate=function(e,t,n,r,i){var o,a;if(1==arguments.length){var s=e;a=s.initialState,t=s.condition,n=s.iterate,o=s.resultSelector||_,i=s.scheduler}else void 0===r||Y(r)?(a=e,o=_,i=r):(a=e,o=r);return new E((function(e){var r=a;if(i)return i.schedule(nt,0,{subscriber:e,iterate:n,condition:t,resultSelector:o,state:r});for(;;){if(t){var s=void 0;try{s=t(r)}catch(t){return void e.error(t)}if(!s){e.complete();break}}var u=void 0;try{u=o(r)}catch(t){return void e.error(t)}if(e.next(u),e.closed)break;try{r=n(r)}catch(t){return void e.error(t)}}}))},e.iif=function(e,t,n){return void 0===t&&(t=W),void 0===n&&(n=W),Qe((function(){return e()?t:n}))},e.interval=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=ye),(!rt(e)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=ye),new E((function(n){return n.add(t.schedule(it,e,{subscriber:n,counter:0,period:e})),n}))},e.merge=ot,e.never=function(){return at},e.of=ee,e.onErrorResumeNext=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)return W;var r=t[0],i=t.slice(1);return 1===t.length&&c(r)?e.apply(void 0,r):new E((function(t){var n=function(){return t.add(e.apply(void 0,i).subscribe(t))};return ze(r).subscribe({next:function(e){t.next(e)},error:n,complete:n})}))},e.pairs=function(e,t){return new E(t?function(n){var r=Object.keys(e),i=new p;return i.add(t.schedule(st,0,{keys:r,index:0,subscriber:n,subscription:i,obj:e})),i}:function(t){for(var n=Object.keys(e),r=0;r<n.length&&!t.closed;r++){var i=n[r];e.hasOwnProperty(i)&&t.next([i,e[i]])}t.complete()})},e.partition=function(e,t,n){return[ct(t,n)(new E(Be(e))),ct(ut(t,n))(new E(Be(e)))]},e.race=pt,e.range=function(e,t,n){return void 0===e&&(e=0),new E((function(r){void 0===t&&(t=e,e=0);var i=0,o=e;if(n)return n.schedule(gt,0,{index:i,count:t,start:e,subscriber:r});for(;;){if(i++>=t){r.complete();break}if(r.next(o++),r.closed)break}}))},e.throwError=te,e.timer=mt,e.using=function(e,t){return new E((function(n){var r,i;try{r=e()}catch(e){return void n.error(e)}try{i=t(r)}catch(e){return void n.error(e)}var o=(i?ze(i):W).subscribe(n);return function(){o.unsubscribe(),r&&r.unsubscribe()}}))},e.zip=yt,e.scheduled=He,e.EMPTY=W,e.NEVER=at,e.config=a,Object.defineProperty(e,"__esModule",{value:!0})}));
/**
 * @license rxcomp v1.0.0-beta.10
 * (c) 2020 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
var rxcomp=function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function u(e,t,n){return(u=s()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&a(i,n.prototype),i}).apply(null,arguments)}var c={},l={},d=function(){function e(){this.rxcompId=-1,this.unsubscribe$=new t.Subject,this.changes$=new t.ReplaySubject(1)}var n=e.prototype;return n.onInit=function(){},n.onChanges=function(e){},n.onView=function(){},n.onDestroy=function(){},n.pushChanges=function(){this.changes$.next(this),this.onView()},e}();function p(e){return c[e.rxcompId]}var f=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(d),h=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).class="",t.keys=[],t}o(t,e);var n=t.prototype;return n.onInit=function(){var e=this,t=p(this).node;Array.prototype.slice.call(t.classList).forEach((function(t){return e.keys.push(t)}))},n.onChanges=function(){var e=p(this).node,t=[],n=this.class;if("object"==typeof n)for(var r in n)n[r]&&t.push(r);else"string"==typeof n&&(t=n.split(/\s+/));t=t.concat(this.keys),e.setAttribute("class",t.join(" "))},t}(f);h.meta={selector:"[[class]]",inputs:["class"]};var g=function(e){function r(){var t;return(t=e.apply(this,arguments)||this).event="",t}return o(r,e),r.prototype.onInit=function(){var e=p(this),r=e.module,i=e.node,o=e.parentInstance,a=e.selector,s=this.event=a.replace(/\[|\]|\(|\)/g,""),u=t.fromEvent(i,s).pipe(n.shareReplay(1)),c=i.getAttribute("("+s+")");if(c){var l=r.makeFunction(c,["$event"]);u.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(e){r.resolve(l,o,e)}))}else o[s+"$"]=u},r}(f);g.meta={selector:"[("+["mousedown","mouseup","mousemove","click","dblclick","mouseover","mouseout","mouseenter","mouseleave","contextmenu","touchstart","touchmove","touchend","keydown","keyup","input","change","loaded"].join(")],[(")+")]"};var m=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(d),v=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.prototype.pushChanges=function(){var e=p(this),t=e.module,n=e.node;this.changes$.next(this),t.parse(n,this),this.onView()},t}(d),y=["constructor","rxcompId","onInit","onChanges","onDestroy","pushChanges","changes$","unsubscribe$"],_=function(e){function t(n,r){var i;return void 0===r&&(r={}),i=e.call(this)||this,r=t.mergeDescriptors(n,n,r),r=t.mergeDescriptors(Object.getPrototypeOf(n),n,r),Object.defineProperties(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i),r),i}return o(t,e),t.mergeDescriptors=function(e,t,n){void 0===n&&(n={});for(var r=Object.getOwnPropertyNames(e),i=function(){var i=r.shift();if(-1===y.indexOf(i)&&!n.hasOwnProperty(i)){var o=Object.getOwnPropertyDescriptor(e,i);"function"==typeof o.value&&(o.value=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t[i].apply(t,n)}),n[i]=o}};r.length;)i();return n},t}(v),b=function(e){function t(t,n,r,i,o,a,s){var u;return(u=e.call(this,s)||this)[t]=n,u[r]=i,u.index=o,u.count=a,u}return o(t,e),i(t,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),t}(_),S=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).instances=[],t}o(t,e);var n=t.prototype;return n.onInit=function(){var e=p(this),t=e.module,n=e.node,r=document.createComment("*for begin");r.rxcompId=n.rxcompId,n.parentNode.replaceChild(r,n);var i=this.forend=document.createComment("*for end");r.parentNode.insertBefore(i,r.nextSibling);var o=n.getAttribute("*for");n.removeAttribute("*for");var a=this.token=this.getExpressionToken(o);this.forFunction=t.makeFunction(a.iterable)},n.onChanges=function(e){for(var t=p(this),n=t.module,r=t.node,i=this.token,o=n.resolve(this.forFunction,e,this)||[],a=Array.isArray(o),s=a?o:Object.keys(o),u=s.length,c=this.instances.length,l=0;l<Math.max(c,u);l++)if(l<u){var d=a?l:s[l],f=a?s[d]:o[d];if(l<c){var h=this.instances[l];h[i.key]=d,h[i.value]=f}else{var g=r.cloneNode(!0);delete g.rxcompId,this.forend.parentNode.insertBefore(g,this.forend);var m=[i.key,d,i.value,f,l,u,t.parentInstance],v=n.makeInstance(g,b,t.selector,t.parentInstance,m);if(v){var y=p(v);n.compile(g,y.instance),this.instances.push(v)}}}else{var _=p(this.instances[l]).node;_.parentNode.removeChild(_),n.remove(_)}this.instances.length=s.length},n.getExpressionToken=function(e){if(null===e)throw"invalid for";if(-1===e.trim().indexOf("let ")||-1===e.trim().indexOf(" of "))throw"invalid for";var t=e.split(";").map((function(e){return e.trim()})).filter((function(e){return""!==e})),n=t[0].split(" of ").map((function(e){return e.trim()})),r=n[0].replace(/\s*let\s*/,""),i=n[1],o="index",a=r.match(/\[(.+)\s*,\s*(.+)\]/);if(a&&(o=a[1],r=a[2]),t.length>1){var s=t[1].split(/\s*let\s*|\s*=\s*index/).map((function(e){return e.trim()}));3===s.length&&(o=s[1])}return{key:o,value:r,iterable:i}},t}(m);S.meta={selector:"[*for]"};var E=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),i(t,[{key:"href",set:function(e){if(this.href_!==e){this.href_=e;var t=p(this).node;e?t.setAttribute("href",e):t.removeAttribute("href")}},get:function(){return this.href_}}]),t}(f);E.meta={selector:"[[href]]",inputs:["href"]};var w=function(e){function t(){return e.apply(this,arguments)||this}o(t,e);var n=t.prototype;return n.onInit=function(){var e=p(this),t=e.module,n=e.node,r=this.ifbegin=document.createComment("*if begin");r.rxcompId=n.rxcompId,n.parentNode.replaceChild(r,n);var i=this.ifend=document.createComment("*if end");r.parentNode.insertBefore(i,r.nextSibling);var o=n.getAttribute("*if");this.ifFunction=t.makeFunction(o);var a=n.cloneNode(!0);a.removeAttribute("*if"),this.clonedNode=a,this.element=a.cloneNode(!0)},n.onChanges=function(e){var t=p(this).module,n=t.resolve(this.ifFunction,e,this),r=this.element;if(n){if(!r.parentNode){var i=this.ifend;i.parentNode.insertBefore(r,i),t.compile(r)}}else r.parentNode&&(t.remove(r,this),r.parentNode.removeChild(r),this.element=this.clonedNode.cloneNode(!0))},t}(m);w.meta={selector:"[*if]"};var I=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),i(t,[{key:"innerHTML",set:function(e){this.innerHTML_!==e&&(this.innerHTML_=e,p(this).node.innerHTML=null==e?"":e)},get:function(){return this.innerHTML_}}]),t}(f);I.meta={selector:"[innerHTML]",inputs:["innerHTML"]};var T=function(){function e(){}return e.transform=function(e){return e},e}(),O=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.transform=function(e){return JSON.stringify(e,null,"\t")},t}(T);O.meta={name:"json"};var x=0,R=function(){function e(){}var r=e.prototype;return r.compile=function(t,n){var r,i=this;return e.querySelectorsAll(t,this.meta.selectors,[]).map((function(e){r&&r!==e.node&&(n=void 0);var t=i.makeInstance(e.node,e.factory,e.selector,n);return e.factory.prototype instanceof v&&(r=e.node),t})).filter((function(e){return void 0!==e}))},r.makeInstance=function(t,r,i,o,a){var s=this;if(o||t.parentNode){var c=r.meta;if(!(o=o||this.getParentInstance(t.parentNode)))return;var l=u(r,a||[]),p=e.makeContext(this,l,o,t,r,i);return c&&(this.makeHosts(c,l,t),p.inputs=this.makeInputs(c,l),p.outputs=this.makeOutputs(c,l),o instanceof d&&this.resolveInputsOutputs(l,o)),l.onInit(),o instanceof d&&o.changes$.pipe(n.takeUntil(l.unsubscribe$)).subscribe((function(e){c&&s.resolveInputsOutputs(l,e),l.onChanges(e),l.pushChanges()})),l}},r.makeFunction=function(t,n){if(void 0===n&&(n=["$instance"]),t){t=e.parseExpression(t);var r=n.join(",");return new Function("with(this) {\n\t\t\t\treturn (function ("+r+", $$module) {\n\t\t\t\t\tconst $$pipes = $$module.meta.pipes;\n\t\t\t\t\treturn "+t+";\n\t\t\t\t}.bind(this)).apply(this, arguments);\n\t\t\t}")}return function(){return null}},r.resolve=function(e,t,n){return e.apply(t,[n,this])},r.parse=function(e,t){for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType){var i=r;A(i)||this.parse(i,t)}else if(3===r.nodeType){var o=r;this.parseTextNode(o,t)}}},r.remove=function(t,n){var r=n?p(n):void 0;return e.traverseDown(t,(function(t){var n=t.rxcompId;n&&(0===e.deleteContext(n,r).length&&delete t.rxcompId)})),t},r.destroy=function(){this.remove(this.meta.node),this.meta.node.innerHTML=this.meta.nodeInnerHTML},r.makeContext=function(t,n,r,i){return e.makeContext(this,t,n,r,t.constructor,i)},r.getInstance=function(e){if(e instanceof Document)return window;var t=A(e);return t?t.instance:void 0},r.getParentInstance=function(t){var n=this;return e.traverseUp(t,(function(e){return n.getInstance(e)}))},r.parseTextNode=function(e,t){var n=this,r=e.nodeExpressions;r||(r=this.parseTextNodeExpression(e.wholeText));var i=r.reduce((function(e,r){var i;return"function"==typeof r?null==(i=n.resolve(r,t,t))&&(i=""):i=r,e+i}),"");if(e.nodeValue!==i){var o=document.createTextNode(i);o.nodeExpressions=r,e.parentNode.replaceChild(o,e)}},r.pushFragment=function(e,t,n,r){var i=e.substring(t,n);r.push(i)},r.parseTextNodeExpression=function(e){for(var t,n=[],r=/\{{2}((([^{}])|(\{([^{}]|(\{.*?\}))+?\}))*?)\}{2}/g,i=0;null!==(t=r.exec(e));){var o=r.lastIndex-t[0].length;o>i&&this.pushFragment(e,o,i,n),i=r.lastIndex;var a=this.makeFunction(t[1]);n.push(a)}var s=e.length;return s>i&&this.pushFragment(e,i,s,n),n},r.makeHosts=function(e,t,n){e.hosts&&Object.keys(e.hosts).forEach((function(r){var i=e.hosts[r];t[r]=L(t,i,n)}))},r.makeInput=function(e,t){var n=p(e).node,r=null,i=null;if(n.hasAttribute("["+t+"]"))i=n.getAttribute("["+t+"]");else if(n.hasAttribute(t)){i='"'+n.getAttribute(t).replace(/({{)|(}})|(")/g,(function(e,t,n,r){return t?'"+':n?'+"':r?'"':""}))+'"'}return i&&(r=this.makeFunction(i)),r},r.makeInputs=function(e,t){var n=this,r={};return e.inputs&&e.inputs.forEach((function(e,i){var o=n.makeInput(t,e);o&&(r[e]=o)})),r},r.makeOutput=function(e,r){var i=this,o=p(e),a=o.node,s=o.parentInstance,u=a.getAttribute("("+r+")"),c=u?this.makeFunction(u,["$event"]):null,l=(new t.Subject).pipe(n.tap((function(e){c&&i.resolve(c,s,e)})));return l.pipe(n.takeUntil(e.unsubscribe$)).subscribe(),e[r]=l,l},r.makeOutputs=function(e,t){var n=this,r={};return e.outputs&&e.outputs.forEach((function(e){var i=n.makeOutput(t,e);i&&(r[e]=i)})),r},r.resolveInputsOutputs=function(e,t){var n=p(e),r=n.parentInstance,i=n.inputs;for(var o in i){var a=i[o],s=this.resolve(a,r,e);e[o]=s}},e.parseExpression=function(t){for(var n=/(\()([^\(\)]*)(\))/;t.match(n);)t=t.replace(n,(function(t){return""+e.parsePipes(arguments.length<=2?void 0:arguments[2])+""}));return t=(t=e.parsePipes(t)).replace(/()|()/g,(function(e){return(arguments.length<=1?void 0:arguments[1])?"(":")"})),e.parseOptionalChaining(t)},e.parsePipes=function(t){for(var n=/(.*?[^\|])\|([^\|]+)/;t.match(n);)t=t.replace(n,(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=r[0].trim(),a=e.parsePipeParams(r[1]),s=a.shift().trim();return"$$pipes."+s+".transform"+[o].concat(a)+""}));return t},e.parsePipeParams=function(e){for(var t=[],n=0,r="",i=0,o=e.length;n<o;){var a=e.substr(n,1);"{"!==a&&"("!==a&&"["!==a||i++,"}"!==a&&")"!==a&&"]"!==a||i--,":"===a&&0===i?(r.length&&t.push(r.trim()),r=""):r+=a,n++}return r.length&&t.push(r.trim()),t},e.parseOptionalChaining=function(e){var t;return e=e.replace(/(\w+(\?\.))+([\.|\w]+)/g,(function(e){for(var n=e.split("?."),r=0;r<n.length-1;r++){var i=r>0?"("+n[r]+" = "+t+")":n[r],o=n[r+1];t=r>0?i+"."+o:"("+i+" ? "+i+"."+o+" : void 0)"}return t||""}))},e.makeContext=function(e,t,n,r,i,o){t.rxcompId=++x;var a={module:e,instance:t,parentInstance:n,node:r,factory:i,selector:o},s=r.rxcompId=r.rxcompId||t.rxcompId;return(l[s]||(l[s]=[])).push(a),c[t.rxcompId]=a,a},e.deleteContext=function(e,t){var n=[],r=l[e];return r&&(r.forEach((function(e){if(e===t)n.push(t);else{var r=e.instance;r.unsubscribe$.next(),r.unsubscribe$.complete(),r.onDestroy(),delete c[r.rxcompId]}})),n.length?l[e]=n:delete l[e]),n},e.matchSelectors=function(e,t,n){for(var r=0;r<t.length;r++){var i=t[r](e);if(i){var o=i.factory;if(o.prototype instanceof v&&o.meta.template&&(e.innerHTML=o.meta.template),n.push(i),o.prototype instanceof m)break}}return n},e.querySelectorsAll=function(e,t,n){if(1===e.nodeType){var r=this.matchSelectors(e,t,[]);if(n=n.concat(r),r.find((function(e){return e.factory.prototype instanceof m})))return n;for(var i=e.childNodes,o=0;o<i.length;o++)n=this.querySelectorsAll(i[o],t,n)}return n},e.traverseUp=function(e,t,n){if(void 0===n&&(n=0),e){var r=t(e,n);return r||this.traverseUp(e.parentNode,t,n+1)}},e.traverseDown=function(e,t,n){if(void 0===n&&(n=0),e){var r=t(e,n);if(r)return r;if(1===e.nodeType)for(var i=0,o=e.childNodes.length;i<o&&!r;)r=this.traverseDown(e.childNodes[i],t,n+1),i++;return r}},e.traversePrevious=function(e,t,n){if(void 0===n&&(n=0),e){var r=t(e,n);return r||this.traversePrevious(e.previousSibling,t,n+1)}},e.traverseNext=function(e,t,n){if(void 0===n&&(n=0),e){var r=t(e,n);return r||this.traverseNext(e.nextSibling,t,n+1)}},e}();function A(e){var t,n=e.rxcompId;if(n){var r=l[n];r&&(t=r.reduce((function(e,t){return t.factory.prototype instanceof v?t:t.factory.prototype instanceof _?e||t:e}),void 0))}return t}function L(e,t,n){if(n||(n=p(e).node),n.rxcompId){var r=l[n.rxcompId];if(r)for(var i=0;i<r.length;i++){var o=r[i];if(o.instance!==e&&o.instance instanceof t)return o.instance}}return n.parentNode?L(e,t,n.parentNode):void 0}var C=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),i(t,[{key:"src",set:function(e){if(this.src_!==e){this.src_=e;var t=p(this).node;e?t.setAttribute("src",e):t.removeAttribute("src")}},get:function(){return this.src_}}]),t}(f);C.meta={selector:"[[src]]",inputs:["src"]};var N=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t.prototype.onChanges=function(){var e=p(this).node,t=this.style,n=this.previousStyle;if(n)for(var r in n)if(!t||!t[r]){var i=r.split(".").shift();e.style.removeProperty(i)}if(t)for(var o in t)if(!n||n[o]!==t[o]){var a=o.split("."),s=a.shift(),u=t[o]+(a.length?a[0]:"");e.style.setProperty(s,u)}this.previousStyle=t},t}(f);N.meta={selector:"[[style]]",inputs:["style"]};var M=[h,g,S,E,w,I,C,N],P=[O],$=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(R);$.meta={declarations:[].concat(M,P),exports:[].concat(M,P)};var k=[m,v,f],D=function(){function e(){}return e.bootstrap=function(e){if(!e)throw"missing moduleFactory";if(!e.meta)throw"missing moduleFactory meta";if(!e.meta.bootstrap)throw"missing bootstrap";if(!e.meta.bootstrap.meta)throw"missing bootstrap meta";if(!e.meta.bootstrap.meta.selector)throw"missing bootstrap meta selector";var t=this.resolveMeta(e),n=new e;return n.meta=t,n.compile(t.node,window)[0].pushChanges(),n},e.isBrowser=function(){return Boolean(window)},e.querySelector=function(e){return document.querySelector(e)},e.resolveMeta=function(e){var t=this.resolveImportedMeta(e),n=e.meta.bootstrap,r=this.querySelector(n.meta.selector);if(!r)throw"missing node "+n.meta.selector;var i=r.innerHTML,o=this.resolvePipes(t),a=this.resolveFactories(t);return this.sortFactories(a),a.unshift(n),{factories:a,pipes:o,selectors:this.unwrapSelectors(a),bootstrap:n,node:r,nodeInnerHTML:i}},e.resolveImportedMeta=function(e){var t=this,n=Object.assign({imports:[],declarations:[],pipes:[],exports:[]},e.meta);return n.imports=(e.meta.imports||[]).map((function(e){return t.resolveImportedMeta(e)})),n},e.resolvePipes=function(e,t){var n=this,r=e.imports.map((function(e){return n.resolvePipes(e,!0)})),i={};return(t?e.exports:e.declarations).filter((function(e){return e.prototype instanceof T})).forEach((function(e){return i[e.meta.name]=e})),Object.assign.apply(Object,[{}].concat(r,[i]))},e.resolveFactories=function(e,t){var n,r=this,i=e.imports.map((function(e){return r.resolveFactories(e,!0)})),o=(t?e.exports:e.declarations).filter((function(e){return e.prototype instanceof d}));return(n=Array.prototype.concat).call.apply(n,[o].concat(i))},e.sortFactories=function(e){e.sort((function(e,t){var n=k.reduce((function(t,n,r){return e.prototype instanceof n?r:t}),-1)-k.reduce((function(e,n,r){return t.prototype instanceof n?r:e}),-1);return 0===n?(e.meta.hosts?1:0)-(t.meta.hosts?1:0):n}))},e.getExpressions=function(e){var t=[];return e.replace(/\.([\w\-\_]+)|\[(.+?\]*)(\=)(.*?)\]|\[(.+?\]*)\]|([\w\-\_]+)/g,(function(e,n,r,i,o,a,s){return n&&t.push((function(e){return e.classList.contains(n)})),r&&t.push((function(e){return e.hasAttribute(r)&&e.getAttribute(r)===o||e.hasAttribute("["+r+"]")&&e.getAttribute("["+r+"]")===o})),a&&t.push((function(e){return e.hasAttribute(a)||e.hasAttribute("["+a+"]")})),s&&t.push((function(e){return e.nodeName.toLowerCase()===s.toLowerCase()})),""})),t},e.unwrapSelectors=function(e){var t=this,n=[];return e.forEach((function(e){e.meta&&e.meta.selector&&e.meta.selector.split(",").forEach((function(r){r=r.trim();var i=[],o=r.replace(/\:not\((.+?)\)/g,(function(e,n){return i=t.getExpressions(n),""})),a=t.getExpressions(o);n.push((function(t){var n=a.reduce((function(e,n){return e&&n(t)}),!0),o=i.reduce((function(e,n){return e||n(t)}),!1);return!(!n||o)&&{node:t,factory:e,selector:r}}))}))})),n},e}(),U=function(e){function t(){return e.apply(this,arguments)||this}return o(t,e),t}(D);return e.Browser=U,e.ClassDirective=h,e.Component=v,e.Context=_,e.CoreModule=$,e.Directive=f,e.EventDirective=g,e.Factory=d,e.ForItem=b,e.ForStructure=S,e.HrefDirective=E,e.IfStructure=w,e.InnerHtmlDirective=I,e.JsonPipe=O,e.Module=R,e.Pipe=T,e.Platform=D,e.SrcDirective=C,e.Structure=m,e.StyleDirective=N,e.getContext=p,e.getContextByNode=A,e.getHost=L,e}({},rxjs,rxjs.operators);
/**
 * @license rxcomp-form v1.0.0-beta.9
 * (c) 2020 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */this.rxcomp=this.rxcomp||{},this.rxcomp.form=function(e,t,n,r){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var s=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onChanges=function(e){var n=t.getContext(this).node,r=this.control.flags;Object.keys(r).forEach((function(e){r[e]?n.classList.add(e):n.classList.remove(e)}))},o(n,[{key:"control",get:function(){return{}}}]),n}(t.Directive);s.meta={selector:"",hosts:{host:s}};var u=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),o(t,[{key:"control",get:function(){if(this.formArray)return this.formArray;if(!this.host)throw"missing form collection";return this.host.control.get(this.formArrayName)}}]),t}(s);u.meta={selector:"[formArray],[formArrayName]",inputs:["formArray","formArrayName"],hosts:{host:s}};var c=function(e){function i(){return e.apply(this,arguments)||this}a(i,e);var s=i.prototype;return s.onInit=function(){var e=this,i=t.getContext(this).node;n.fromEvent(i,"input").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onChange(t)})),n.fromEvent(i,"change").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onChange(t)})),n.fromEvent(i,"blur").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onBlur(t)}))},s.onChanges=function(e){var n=t.getContext(this).node;this.formControlName&&(n.name=this.formControlName);var r=this.control,i=r.flags;Object.keys(i).forEach((function(e){i[e]?n.classList.add(e):n.classList.remove(e)})),this.writeValue(r.value)},s.writeValue=function(e){t.getContext(this).node.value=null==e?"":e},s.onChange=function(e){var n=t.getContext(this).node;this.control.value=""===n.value?null:n.value},s.onBlur=function(e){this.control.touched=!0},s.setDisabledState=function(e){t.getContext(this).node.disabled=e},o(i,[{key:"control",get:function(){if(this.formControl)return this.formControl;if(!this.host)throw"missing form collection";return this.host.control.get(this.formControlName)}}]),i}(t.Directive);c.meta={selector:"",inputs:["formControl","formControlName","value"],hosts:{host:s}};var l=function(e){function i(){return e.apply(this,arguments)||this}a(i,e);var o=i.prototype;return o.onInit=function(){var e=this,i=t.getContext(this).node;n.fromEvent(i,"change").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onChange(t)})),n.fromEvent(i,"blur").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onBlur(t)}))},o.writeValue=function(e){var n=t.getContext(this).node;e===this.value?n.setAttribute("checked",e):n.removeAttribute("checked")},o.setDisabledState=function(e){t.getContext(this).node.disabled=e},o.onChange=function(e){var n=t.getContext(this).node;this.control.value=n.checked?this.value:!0!==this.value&&null},o.onBlur=function(e){this.control.touched=!0},i}(c);l.meta={selector:"input[type=checkbox][formControl],input[type=checkbox][formControlName]",inputs:["formControl","formControlName","value"],hosts:{host:s}};var d=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onChanges=function(e){var n=t.getContext(this).node,r=this.control.flags;Object.keys(r).forEach((function(e){r[e]?n.classList.add(e):n.classList.remove(e)}))},o(n,[{key:"control",get:function(){if(this.formField)return this.formField;if(!this.host)throw"missing form collection";return this.host.control.get(this.formFieldName)}}]),n}(t.Component);d.meta={selector:"[formField],[formFieldName]",inputs:["formField","formFieldName"],hosts:{host:s}};var p=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),o(t,[{key:"control",get:function(){if(this.formGroup)return this.formGroup;if(!this.host)throw"missing form collection";return this.host.control.get(this.formGroupName)}}]),t}(s);p.meta={selector:"[formGroup],[formGroupName]",inputs:["formGroup","formGroupName"],hosts:{host:s}};var f=function(e){function n(){return e.apply(this,arguments)||this}a(n,e);var r=n.prototype;return r.writeValue=function(e){t.getContext(this).node.value=null==e?"":e},r.onChange=function(e){var n=t.getContext(this).node;this.control.value=""===n.value?null:n.value},r.onBlur=function(e){this.control.touched=!0},n}(c);f.meta={selector:"input[type=text][formControl],input[type=text][formControlName],input[type=email][formControl],input[type=email][formControlName],input[type=password][formControl],input[type=password][formControlName],textarea[formControl],textarea[formControlName]",inputs:["formControl","formControlName"],hosts:{host:s}};var h=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onChanges=function(e){t.getContext(this).node.setAttribute("placeholder",this.placeholder||"")},n}(t.Directive);h.meta={selector:"input[placeholder],textarea[placeholder]",inputs:["placeholder"]};var g=function(e){function i(){return e.apply(this,arguments)||this}a(i,e);var o=i.prototype;return o.onInit=function(){var e=this,i=t.getContext(this).node;n.fromEvent(i,"change").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onChange(t)})),n.fromEvent(i,"blur").pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(t){return e.onBlur(t)}))},o.writeValue=function(e){var n=t.getContext(this).node;n.checked=n.value===e},o.setDisabledState=function(e){t.getContext(this).node.disabled=e},o.onChange=function(e){var n=t.getContext(this).node;n.checked&&(this.control.value=n.value)},o.onBlur=function(e){this.control.touched=!0},i}(c);g.meta={selector:"input[type=radio][formControl],input[type=radio][formControlName]",inputs:["formControl","formControlName"],hosts:{host:s}};var m=function(e){function n(){return e.apply(this,arguments)||this}a(n,e);var r=n.prototype;return r.writeValue=function(e){t.getContext(this).node.value=null==e?"":e},r.setDisabledState=function(e){t.getContext(this).node.disabled=e},r.onChange=function(e){var n=t.getContext(this).node;this.control.value=""===n.value?null:n.value},r.onBlur=function(e){this.control.touched=!0},n}(c);m.meta={selector:"select[formControl],select[formControlName]",inputs:["formControl","formControlName"],hosts:{host:s}};var v=function(e){function i(){return e.apply(this,arguments)||this}return a(i,e),i.prototype.onInit=function(){var e=t.getContext(this),i=e.module,o=e.node,a=e.selector,s=e.parentInstance,u=this.event=a.replace(/\[|\]|\(|\)/g,""),c=o,l=this.event$=n.fromEvent(c,"submit").pipe(r.tap((function(e){e.preventDefault()})),r.shareReplay(1)),d=o.getAttribute("("+u+")");if(d){var p=i.makeFunction(d,["$event"]);l.pipe(r.takeUntil(this.unsubscribe$)).subscribe((function(e){i.resolve(p,s,e)}))}else s[u+"$"]=l},i}(t.Directive);v.meta={selector:"[(submit)]"};var y=function(){function e(e,t){this.validator=e,this.params$=new n.BehaviorSubject(t)}return e.prototype.validate=function(e){return this.validator(e,this.params)},o(e,[{key:"params",get:function(){return this.params$.getValue()},set:function(e){if(e){var t=this.params;Object.keys(e).reduce((function(n,r){return n||!t||t[r]!==e[r]}),!1)&&this.params$.next(e)}}}]),e}();function _(){return new y((function(e,t){return null}))}function b(){return new y((function(e,t){return null==e||0===e.length?{required:!0}:null}))}function S(){return new y((function(e,t){return!0===e?null:{required:!0}}))}function E(e){return new y((function(e,t){var n=t.min;return e&&n?(e=parseFloat(e),!isNaN(e)&&e<n?{min:{min:n,actual:e}}:null):null}),{min:e})}function w(e){return new y((function(e,t){var n=t.max;return e&&n?(e=parseFloat(e),!isNaN(e)&&e>n?{max:{max:n,actual:e}}:null):null}),{max:e})}function I(e){return new y((function(e,t){var n=t.minlength;if(!e||!n)return null;var r=e?e.length:0;return r<n?{minlength:{requiredLength:n,actualLength:r}}:null}),{minlength:e})}function T(e){return new y((function(e,t){var n=t.maxlength;if(!e||!n)return null;var r=e?e.length:0;return r>n?{minlength:{requiredLength:n,actualLength:r}}:null}),{maxlength:e})}function O(e){return new y((function(e,t){var n=t.pattern;if(!e||!n)return null;var r=function(e){var t;e instanceof RegExp?t=e:"string"==typeof e&&(e="$"===(e="^"===e.charAt(0)?e:"^"+e).charAt(e.length-1)?e:e+"$",t=new RegExp(e));return t||new RegExp("")}(n);return r.test(e)?null:{pattern:{requiredPattern:r.toString(),actualValue:e}}}),{pattern:e})}function x(){var e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;return new y((function(t,n){return t?e.test(t)?null:{email:!0}:null}))}var R=Object.freeze({__proto__:null,NullValidator:_,RequiredValidator:b,RequiredTrueValidator:S,MinValidator:E,MaxValidator:w,MinLengthValidator:I,MaxLengthValidator:T,PatternValidator:O,EmailValidator:x}),A=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t.prototype.onInit=function(){var e=this.validator=x();this.host&&this.host.control.addValidators(e)},t}(t.Directive);A.meta={selector:"[email][formControl],[email][formControlName]",inputs:["email"],hosts:{host:c}};var L=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).maxlength=Number.POSITIVE_INFINITY,t}a(t,e);var n=t.prototype;return n.onInit=function(){this.validator=T(this.maxlength),this.host&&this.host.control.addValidators(this.validator)},n.onChanges=function(e){this.validator&&(this.validator.params={maxlength:this.maxlength})},t}(t.Directive);L.meta={selector:"[maxlength][formControl],[maxlength][formControlName]",inputs:["maxlength"],hosts:{host:c}};var C=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).max=Number.POSITIVE_INFINITY,t}a(t,e);var n=t.prototype;return n.onInit=function(){this.validator=w(this.max),this.host&&this.host.control.addValidators(this.validator)},n.onChanges=function(e){this.validator&&(this.validator.params={max:this.max})},t}(t.Directive);C.meta={selector:"[max][formControl],[max][formControlName]",inputs:["max"],hosts:{host:c}};var N=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).minlength=Number.NEGATIVE_INFINITY,t}a(t,e);var n=t.prototype;return n.onInit=function(){this.validator=I(this.minlength),this.host&&this.host.control.addValidators(this.validator)},n.onChanges=function(e){this.validator&&(this.validator.params={minlength:this.minlength})},t}(t.Directive);N.meta={selector:"[minlength][formControl],[minlength][formControlName]",inputs:["minlength"],hosts:{host:c}};var M=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).min=Number.NEGATIVE_INFINITY,t}a(t,e);var n=t.prototype;return n.onInit=function(){this.validator=E(this.min),this.host&&this.host.control.addValidators(this.validator)},n.onChanges=function(e){this.validator&&(this.validator.params={min:this.min})},t}(t.Directive);M.meta={selector:"[min][formControl],[min][formControlName]",inputs:["min"],hosts:{host:c}};var P=function(e){function t(){return e.apply(this,arguments)||this}a(t,e);var n=t.prototype;return n.onInit=function(){this.pattern&&(this.validator=O(this.pattern),this.host&&this.host.control.addValidators(this.validator))},n.onChanges=function(e){this.validator&&(this.validator.params={pattern:this.pattern})},t}(t.Directive);P.meta={selector:"[pattern][formControl],[pattern][formControlName]",inputs:["pattern"],hosts:{host:c}};var $=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t.prototype.onInit=function(){this.validator=S(),this.host&&this.host.control.addValidators(this.validator)},t}(t.Directive);$.meta={selector:"[requiredTrue][formControl],[requiredTrue][formControlName]",inputs:["requiredTrue"],hosts:{host:c}};var k=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t.prototype.onInit=function(){this.validator=b(),this.host&&this.host.control.addValidators(this.validator)},t}(t.Directive);k.meta={selector:"[required][formControl],[required][formControlName]",inputs:["required"],hosts:{host:c}};var D,U=[u,l,d,p,f,h,g,m,v,A,C,L,M,N,P,k,$],j=[],B=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t}(t.Module);B.meta={declarations:[].concat(U,j),exports:[].concat(U,j)},function(e){e.Pending="pending",e.Valid="valid",e.Invalid="invalid",e.Disabled="disabled",e.Hidden="hidden"}(D||(D={}));var F=D,q=function(){function e(e){var t=this;this.value_=void 0,this.submitted_=!1,this.touched_=!1,this.dirty_=!1,this.valueSubject=new n.BehaviorSubject(null),this.statusSubject=new n.BehaviorSubject(null),this.validatorsSubject=(new n.ReplaySubject).pipe(r.switchAll()),this.value$=this.valueSubject.pipe(r.distinctUntilChanged(),r.skip(1),r.tap((function(){t.submitted_=!1,t.dirty_=!0,t.statusSubject.next(null)})),r.shareReplay(1)),this.status$=n.merge(this.statusSubject,this.validatorsSubject).pipe(r.switchMap((function(){return t.validate$(t.value)})),r.shareReplay(1)),this.changes$=n.merge(this.value$,this.status$).pipe(r.map((function(){return t.value})),r.auditTime(1),r.shareReplay(1)),this.validators=e?Array.isArray(e)?e:[e]:[]}var t=e.prototype;return t.initSubjects_=function(){this.switchValidators_()},t.switchValidators_=function(){var e=this.validators.map((function(e){return e.params$})),t=e.length?n.combineLatest(e):n.of(e);this.validatorsSubject.next(t)},t.initObservables_=function(){},t.validate$=function(e){var t=this;return this.status===F.Disabled||this.status===F.Hidden||this.submitted_||!this.validators.length?(this.errors={},this.status===F.Invalid&&(this.status=F.Valid),n.of(this.errors)):n.combineLatest(this.validators.map((function(t){var r=t.validate(e);return n.isObservable(r)?r:n.of(r)}))).pipe(r.map((function(e){return t.errors=Object.assign.apply(Object,[{}].concat(e)),t.status=0===Object.keys(t.errors).length?F.Valid:F.Invalid,t.errors})))},t.reset=function(e){this.status=e||F.Pending,this.value_=null,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(null)},t.patch=function(e){this.value_=e,this.dirty_=!0,this.submitted_=!1,this.statusSubject.next(null)},t.addValidators=function(){var e;(e=this.validators).push.apply(e,arguments),this.switchValidators_()},t.replaceValidators=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.validators=t,this.switchValidators_()},t.clearValidators=function(){this.validators=[],this.switchValidators_()},o(e,[{key:"pending",get:function(){return this.status===F.Pending}},{key:"valid",get:function(){return this.status!==F.Invalid}},{key:"invalid",get:function(){return this.status===F.Invalid}},{key:"disabled",get:function(){return this.status===F.Disabled},set:function(e){e?this.status!==F.Disabled&&(this.status=F.Disabled,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(null)):this.status===F.Disabled&&(this.status=F.Pending,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(null))}},{key:"enabled",get:function(){return this.status!==F.Disabled}},{key:"hidden",get:function(){return this.status===F.Hidden},set:function(e){e?this.status!==F.Hidden&&(this.status=F.Hidden,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(null)):this.status===F.Hidden&&(this.status=F.Pending,this.dirty_=!1,this.touched_=!1,this.submitted_=!1,this.statusSubject.next(null))}},{key:"visible",get:function(){return this.status!==F.Hidden}},{key:"submitted",get:function(){return this.submitted_},set:function(e){this.submitted_=e,this.statusSubject.next(null)}},{key:"dirty",get:function(){return this.dirty_}},{key:"pristine",get:function(){return!this.dirty_}},{key:"touched",get:function(){return this.touched_},set:function(e){this.touched_=e,this.statusSubject.next(null)}},{key:"untouched",get:function(){return!this.touched_}},{key:"flags",get:function(){return{untouched:this.untouched,touched:this.touched,pristine:this.pristine,dirty:this.dirty,pending:this.pending,enabled:this.enabled,disabled:this.disabled,hidden:this.hidden,visible:this.visible,valid:this.valid,invalid:this.invalid,submitted:this.submitted}}},{key:"value",get:function(){return this.value_},set:function(e){this.value_=e,this.valueSubject.next(e)}}]),e}(),G=function(e){function t(t,n){var r;return void 0===t&&(t=null),(r=e.call(this,n)||this).value_=t,r.status=F.Pending,r.errors={},r.initSubjects_(),r.initObservables_(),r.statusSubject.next(null),r}return a(t,e),t}(q),V=function(e){function t(t,r){var i;return(i=e.call(this,r)||this).changesChildren=new n.BehaviorSubject(void 0),i.controls=t,i.initControls_(),i.initSubjects_(),i.initObservables_(),i}a(t,e);var i=t.prototype;return i.initControl_=function(e,t){var n=e instanceof q?e:new G(e);return n.addValidators.apply(n,this.validators),n.name=t,n},i.initControls_=function(){var e=this;return this.forEach_((function(t,n){e.init(t,n)})),this.controls},i.initSubjects_=function(){this.changesChildren=this.changesChildren.pipe(r.switchAll()),this.switchSubjects_()},i.switchSubjects_=function(){var e=this.reduce_((function(e,t){return e.push(t.changes$),e}),[]),t=e.length?n.combineLatest(e):n.of(e);this.changesChildren.next(t)},i.initObservables_=function(){var e=this;this.changes$=this.changesChildren.pipe(r.map((function(){return e.value})),r.shareReplay(1))},i.validate=function(e){var t;if(this.status===F.Disabled||this.status===F.Hidden)t=[];else{var n=this.validators.map((function(t){return t.validate(e)})).filter((function(e){return null!==e}));t=this.reduce_((function(e,t){return e.concat(t.errors)}),n),this.status=0===t.length?F.Valid:F.Invalid}return t},i.forEach_=function(e){var t=this;Object.keys(this.controls).forEach((function(n){return e(t.controls[n],n)}))},i.reduce_=function(e,t){return this.forEach_((function(n,r){t=e(t,n,r)})),t},i.all_=function(e,t){return this.reduce_((function(n,r){return n&&r[e]===t}),!0)},i.any_=function(e,t){return this.reduce_((function(n,r){return n||r[e]===t}),!1)},i.reset=function(){this.forEach_((function(e){return e.reset()}))},i.patch=function(e){e&&this.forEach_((function(t,n){null!=e[n]&&t.patch(e[n])}))},i.init=function(e,t){this.controls[t]=this.initControl_(e,t)},i.get=function(e){return this.controls[e]},i.set=function(e,t){delete this.controls[t],this.controls[t]=this.initControl_(e,t),this.switchSubjects_()},i.add=function(e,t){this.controls[t]=this.initControl_(e,t),this.switchSubjects_()},i.remove=function(e){var t=this,n=Object.keys(this.controls).find((function(n){return t.controls[n]===e?n:null}));n&&this.removeKey(n)},i.removeKey=function(e){var t=void 0!==this.controls[e];delete this.controls[e],t&&this.switchSubjects_()},i.addValidators=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.forEach_((function(e){return e.addValidators.apply(e,t)}))},i.replaceValidators=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.forEach_((function(e){return e.replaceValidators.apply(e,t)}))},i.clearValidators=function(){this.forEach_((function(e){return e.clearValidators()}))},o(t,[{key:"valid",get:function(){return this.all_("valid",!0)}},{key:"invalid",get:function(){return this.any_("invalid",!0)}},{key:"pending",get:function(){return this.any_("pending",!0)}},{key:"disabled",get:function(){return this.all_("disabled",!0)},set:function(e){this.forEach_((function(t){t.disabled=e}))}},{key:"enabled",get:function(){return this.any_("enabled",!0)}},{key:"hidden",get:function(){return this.all_("hidden",!0)},set:function(e){this.forEach_((function(t){t.hidden=e}))}},{key:"visible",get:function(){return this.any_("visible",!0)}},{key:"submitted",get:function(){return this.all_("submitted",!0)},set:function(e){this.forEach_((function(t){t.submitted=e}))}},{key:"dirty",get:function(){return this.any_("dirty",!0)}},{key:"pristine",get:function(){return this.all_("pristine",!0)}},{key:"touched",get:function(){return this.all_("touched",!0)},set:function(e){this.forEach_((function(t){t.touched=e}))}},{key:"untouched",get:function(){return this.any_("untouched",!0)}},{key:"value",get:function(){return this.reduce_((function(e,t,n){return e[n]=t.value,e}),{})},set:function(e){this.forEach_((function(t,n){t.value=e[n]}))}},{key:"errors",get:function(){return this.reduce_((function(e,t){return Object.assign(e,t.errors)}),{})}}]),t}(q),H=function(e){function t(t,n){return void 0===t&&(t=[]),e.call(this,t,n)||this}a(t,e);var n=t.prototype;return n.forEach_=function(e){this.controls.forEach((function(t,n){return e(t,n)}))},n.init=function(e,t){this.controls.length=Math.max(this.controls.length,t),this.controls[t]=this.initControl_(e,t)},n.set=function(e,t){this.controls.splice(t,1,this.initControl_(e,t)),this.switchSubjects_()},n.add=function(e,t){this.controls.length=Math.max(this.controls.length,t),this.controls[t]=this.initControl_(e,t),this.switchSubjects_()},n.push=function(e){this.controls.push(this.initControl_(e,this.controls.length)),this.switchSubjects_()},n.insert=function(e,t){this.controls.splice(t,0,this.initControl_(e,t)),this.switchSubjects_()},n.remove=function(e){var t=this.controls.indexOf(e);-1!==t&&this.removeKey(t)},n.removeKey=function(e){this.controls.length>e&&(this.controls.splice(e,1),this.switchSubjects_())},n.at=function(e){return this.controls[e]},o(t,[{key:"value",get:function(){return this.reduce_((function(e,t,n){return e[n]=t.value,e}),[])}},{key:"length",get:function(){return this.controls.length}}]),t}(V);var z=function(e){function t(t,n){return void 0===t&&(t={}),e.call(this,t,n)||this}return a(t,e),t}(V);return e.EmailValidator=x,e.FormAbstract=q,e.FormAbstractCollection=V,e.FormAbstractCollectionDirective=s,e.FormArray=H,e.FormArrayDirective=u,e.FormCheckboxDirective=l,e.FormControl=G,e.FormEmailDirective=A,e.FormFieldComponent=d,e.FormGroup=z,e.FormGroupDirective=p,e.FormInputDirective=f,e.FormMaxDirective=C,e.FormMaxLengthDirective=L,e.FormMinDirective=M,e.FormMinLengthDirective=N,e.FormModule=B,e.FormPatternDirective=P,e.FormPlaceholderDirective=h,e.FormRadioDirective=g,e.FormRequiredDirective=k,e.FormRequiredTrueDirective=$,e.FormSelectDirective=m,e.FormStatus=F,e.FormValidator=y,e.MaxLengthValidator=T,e.MaxValidator=w,e.MinLengthValidator=I,e.MinValidator=E,e.NullValidator=_,e.PatternValidator=O,e.RequiredTrueValidator=S,e.RequiredValidator=b,e.Validators=R,e.formArray=function(e,t){return void 0===e&&(e=[]),new H(e,t)},e.formGroup=function(e,t){return void 0===e&&(e={}),new z(e,t)},e}({},rxcomp,rxjs,rxjs.operators),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).window=e.window||{})}(this,(function(e){"use strict";
/*!
	 * EasePack 3.6.0
	 * https://greensock.com
	 *
	 * @license Copyright 2008-2021, GreenSock. All rights reserved.
	 * Subject to the terms at https://greensock.com/standard-license or for
	 * Club GreenSock members, the agreement issued with that membership.
	 * @author: Jack Doyle, jack@greensock.com
	*/var t,n,r=function(){return t||"undefined"!=typeof window&&(t=window.gsap)&&t.registerPlugin&&t},i=function(e,t){return!!(void 0===e?t:e&&!~(e+"").indexOf("false"))},o=function(e){if(t=e||r()){n=t.registerEase;var i,o=t.parseEase(),a=function(e){return function(t){var n=.5+t/2;e.config=function(t){return e(2*(1-t)*t*n+t*t)}}};for(i in o)o[i].config||a(o[i]);for(i in n("slow",l),n("expoScale",d),n("rough",p),f)"version"!==i&&t.core.globals(i,f[i])}},a=function(e,t,n){var r=(e=Math.min(1,e||.7))<1?t||0===t?t:.7:0,o=(1-e)/2,a=o+e,s=i(n);return function(e){var t=e+(.5-e)*r;return e<o?s?1-(e=1-e/o)*e:t-(e=1-e/o)*e*e*e*t:e>a?s?1===e?0:1-(e=(e-a)/o)*e:t+(e-t)*(e=(e-a)/o)*e*e*e:s?1:t}},s=function(e,n,r){var i=Math.log(n/e),o=n-e;return r&&(r=t.parseEase(r)),function(t){return(e*Math.exp(i*(r?r(t):t))-e)/o}},u=function(e,t,n){this.t=e,this.v=t,n&&(this.next=n,n.prev=this,this.c=n.v-t,this.gap=n.t-e)},c=function(e){"object"!=typeof e&&(e={points:+e||20});for(var n,r,o,a,s,c,l,d=e.taper||"none",p=[],f=0,h=0|(+e.points||20),g=h,m=i(e.randomize,!0),v=i(e.clamp),y=t?t.parseEase(e.template):0,_=.4*(+e.strength||1);--g>-1;)n=m?Math.random():1/h*g,r=y?y(n):n,o="none"===d?_:"out"===d?(a=1-n)*a*_:"in"===d?n*n*_:n<.5?(a=2*n)*a*.5*_:(a=2*(1-n))*a*.5*_,m?r+=Math.random()*o-.5*o:g%2?r+=.5*o:r-=.5*o,v&&(r>1?r=1:r<0&&(r=0)),p[f++]={x:n,y:r};for(p.sort((function(e,t){return e.x-t.x})),c=new u(1,1,null),g=h;g--;)s=p[g],c=new u(s.x,s.y,c);return l=new u(0,0,c.t?c:c.next),function(e){var t=l;if(e>t.t){for(;t.next&&e>=t.t;)t=t.next;t=t.prev}else for(;t.prev&&e<=t.t;)t=t.prev;return l=t,t.v+(e-t.t)/t.gap*t.c}},l=a(.7);l.ease=l,l.config=a;var d=s(1,2);d.config=s;var p=c();p.ease=p,p.config=c;var f={SlowMo:l,RoughEase:p,ExpoScaleEase:d};for(var h in f)f[h].register=o,f[h].version="3.6.0";r()&&t.registerPlugin(l),e.EasePack=f,e.ExpoScaleEase=d,e.RoughEase=p,e.SlowMo=l,e.default=f,Object.defineProperty(e,"__esModule",{value:!0})})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).window=e.window||{})}(this,(function(e){"use strict";function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}
/*!
   * GSAP 3.6.0
   * https://greensock.com
   *
   * @license Copyright 2008-2021, GreenSock. All rights reserved.
   * Subject to the terms at https://greensock.com/standard-license or for
   * Club GreenSock members, the agreement issued with that membership.
   * @author: Jack Doyle, jack@greensock.com
  */var r,i,o,a,s,u,c,l,d,p,f,h,g,m,v,y,_,b,S,E,w,I,T,O,x,R,A,L,C={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},N={duration:.5,overwrite:!1,delay:0},M=1e8,P=1e-8,$=2*Math.PI,k=$/4,D=0,U=Math.sqrt,j=Math.cos,B=Math.sin,F=function(e){return"string"==typeof e},q=function(e){return"function"==typeof e},G=function(e){return"number"==typeof e},V=function(e){return void 0===e},H=function(e){return"object"==typeof e},z=function(e){return!1!==e},W=function(){return"undefined"!=typeof window},J=function(e){return q(e)||F(e)},Y="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},K=Array.isArray,X=/(?:-?\.?\d|\.)+/gi,Z=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Q=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ee=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,te=/[+-]=-?[.\d]+/,ne=/[#\-+.]*\b[a-z\d-=+%.]+/gi,re=/[\d.+\-=]+(?:e[-+]\d*)*/i,ie={},oe={},ae=function(e){return(oe=Ne(e,ie))&&yn},se=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},ue=function(e,t){return!t&&console.warn(e)},ce=function(e,t){return e&&(ie[e]=t)&&oe&&(oe[e]=t)||ie},le=function(){return 0},de={},pe=[],fe={},he={},ge={},me=30,ve=[],ye="",_e=function(e){var t,n,r=e[0];if(H(r)||q(r)||(e=[e]),!(t=(r._gsap||{}).harness)){for(n=ve.length;n--&&!ve[n].targetTest(r););t=ve[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new qt(e[n],t)))||e.splice(n,1);return e},be=function(e){return e._gsap||_e(st(e))[0]._gsap},Se=function(e,t,n){return(n=e[t])&&q(n)?e[t]():V(n)&&e.getAttribute&&e.getAttribute(t)||n},Ee=function(e,t){return(e=e.split(",")).forEach(t)||e},we=function(e){return Math.round(1e5*e)/1e5||0},Ie=function(e,t){for(var n=t.length,r=0;e.indexOf(t[r])<0&&++r<n;);return r<n},Te=function(e,t,n){var r,i=G(e[1]),o=(i?2:1)+(t<2?0:1),a=e[o];if(i&&(a.duration=e[1]),a.parent=n,t){for(r=a;n&&!("immediateRender"in r);)r=n.vars.defaults||{},n=z(n.vars.inherit)&&n.parent;a.immediateRender=z(r.immediateRender),t<2?a.runBackwards=1:a.startAt=e[o-1]}return a},Oe=function(){var e,t,n=pe.length,r=pe.slice(0);for(fe={},pe.length=0,e=0;e<n;e++)(t=r[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},xe=function(e,t,n,r){pe.length&&Oe(),e.render(t,n,r),pe.length&&Oe()},Re=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(ne).length<2?t:F(e)?e.trim():e},Ae=function(e){return e},Le=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},Ce=function(e,t){for(var n in t)n in e||"duration"===n||"ease"===n||(e[n]=t[n])},Ne=function(e,t){for(var n in t)e[n]=t[n];return e},Me=function e(t,n){for(var r in n)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(t[r]=H(n[r])?e(t[r]||(t[r]={}),n[r]):n[r]);return t},Pe=function(e,t){var n,r={};for(n in e)n in t||(r[n]=e[n]);return r},$e=function(e){var t=e.parent||i,n=e.keyframes?Ce:Le;if(z(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},ke=function(e,t,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=t._prev,o=t._next;i?i._next=o:e[n]===t&&(e[n]=o),o?o._prev=i:e[r]===t&&(e[r]=i),t._next=t._prev=t.parent=null},De=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},Ue=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},je=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},Be=function e(t){return!t||t._ts&&e(t.parent)},Fe=function(e){return e._repeat?qe(e._tTime,e=e.duration()+e._rDelay)*e:0},qe=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},Ge=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Ve=function(e){return e._end=we(e._start+(e._tDur/Math.abs(e._ts||e._rts||P)||0))},He=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=we(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Ve(e),n._dirty||Ue(n,e)),e},ze=function(e,t){var n;if((t._time||t._initted&&!t._dur)&&(n=Ge(e.rawTime(),t),(!t._dur||nt(0,t.totalDuration(),n)-t._tTime>P)&&t.render(n,!0)),Ue(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-1e-8}},We=function(e,t,n,r){return t.parent&&De(t),t._start=we(n+t._delay),t._end=we(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),function(e,t,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var o,a=e[r];if(i)for(o=t[i];a&&a[i]>o;)a=a._prev;a?(t._next=a._next,a._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[r]=t,t._prev=a,t.parent=t._dp=e}(e,t,"_first","_last",e._sort?"_start":0),e._recent=t,r||ze(e,t),e},Je=function(e,t){return(ie.ScrollTrigger||se("scrollTrigger",t))&&ie.ScrollTrigger.create(t,e)},Ye=function(e,t,n,r){return Yt(e,t),e._initted?!n&&e._pt&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&c!==At.frame?(pe.push(e),e._lazy=[t,r],1):void 0:1},Ke=function e(t){var n=t.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||e(n))},Xe=function(e,t,n,r){var i=e._repeat,o=we(t)||0,a=e._tTime/e._tDur;return a&&!r&&(e._time*=o/e._dur),e._dur=o,e._tDur=i?i<0?1e10:we(o*(i+1)+e._rDelay*i):o,a&&!r?He(e,e._tTime=e._tDur*a):e.parent&&Ve(e),n||Ue(e.parent,e),e},Ze=function(e){return e instanceof Vt?Ue(e):Xe(e,e._dur)},Qe={_start:0,endTime:le},et=function e(t,n){var r,i,o=t.labels,a=t._recent||Qe,s=t.duration()>=M?a.endTime(!1):t._dur;return F(n)&&(isNaN(n)||n in o)?"<"===(r=n.charAt(0))||">"===r?("<"===r?a._start:a.endTime(a._repeat>=0))+(parseFloat(n.substr(1))||0):(r=n.indexOf("="))<0?(n in o||(o[n]=s),o[n]):(i=+(n.charAt(r-1)+n.substr(r+1)),r>1?e(t,n.substr(0,r-1))+i:s+i):null==n?s:+n},tt=function(e,t){return e||0===e?t(e):t},nt=function(e,t,n){return n<e?e:n>t?t:n},rt=function(e){if("string"!=typeof e)return"";var t=re.exec(e);return t?e.substr(t.index+t[0].length):""},it=[].slice,ot=function(e,t){return e&&H(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&H(e[0]))&&!e.nodeType&&e!==o},at=function(e,t,n){return void 0===n&&(n=[]),e.forEach((function(e){var r;return F(e)&&!t||ot(e,1)?(r=n).push.apply(r,st(e)):n.push(e)}))||n},st=function(e,t){return!F(e)||t||!a&&Lt()?K(e)?at(e,t):ot(e)?it.call(e,0):e?[e]:[]:it.call(s.querySelectorAll(e),0)},ut=function(e){return e.sort((function(){return.5-Math.random()}))},ct=function(e){if(q(e))return e;var t=H(e)?e:{each:e},n=Dt(t.ease),r=t.from||0,i=parseFloat(t.base)||0,o={},a=r>0&&r<1,s=isNaN(r)||a,u=t.axis,c=r,l=r;return F(r)?c=l={center:.5,edges:.5,end:1}[r]||0:!a&&s&&(c=r[0],l=r[1]),function(e,a,d){var p,f,h,g,m,v,y,_,b,S=(d||t).length,E=o[S];if(!E){if(!(b="auto"===t.grid?0:(t.grid||[1,M])[1])){for(y=-M;y<(y=d[b++].getBoundingClientRect().left)&&b<S;);b--}for(E=o[S]=[],p=s?Math.min(b,S)*c-.5:r%b,f=s?S*l/b-.5:r/b|0,y=0,_=M,v=0;v<S;v++)h=v%b-p,g=f-(v/b|0),E[v]=m=u?Math.abs("y"===u?g:h):U(h*h+g*g),m>y&&(y=m),m<_&&(_=m);"random"===r&&ut(E),E.max=y-_,E.min=_,E.v=S=(parseFloat(t.amount)||parseFloat(t.each)*(b>S?S-1:u?"y"===u?S/b:b:Math.max(b,S/b))||0)*("edges"===r?-1:1),E.b=S<0?i-S:i,E.u=rt(t.amount||t.each)||0,n=n&&S<0?$t(n):n}return S=(E[e]-E.min)/E.max||0,we(E.b+(n?n(S):S)*E.v)+E.u}},lt=function(e){var t=e<1?Math.pow(10,(e+"").length-2):1;return function(n){var r=Math.round(parseFloat(n)/e)*e*t;return(r-r%1)/t+(G(n)?0:rt(n))}},dt=function(e,t){var n,r,i=K(e);return!i&&H(e)&&(n=i=e.radius||M,e.values?(e=st(e.values),(r=!G(e[0]))&&(n*=n)):e=lt(e.increment)),tt(t,i?q(e)?function(t){return r=e(t),Math.abs(r-t)<=n?r:t}:function(t){for(var i,o,a=parseFloat(r?t.x:t),s=parseFloat(r?t.y:0),u=M,c=0,l=e.length;l--;)(i=r?(i=e[l].x-a)*i+(o=e[l].y-s)*o:Math.abs(e[l]-a))<u&&(u=i,c=l);return c=!n||u<=n?e[c]:t,r||c===t||G(t)?c:c+rt(t)}:lt(e))},pt=function(e,t,n,r){return tt(K(e)?!t:!0===n?!!(n=0):!r,(function(){return K(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+.99*n))/n)*n*r)/r}))},ft=function(e,t,n){return tt(n,(function(n){return e[~~t(n)]}))},ht=function(e){for(var t,n,r,i,o=0,a="";~(t=e.indexOf("random(",o));)r=e.indexOf(")",t),i="["===e.charAt(t+7),n=e.substr(t+7,r-t-7).match(i?ne:X),a+=e.substr(o,t-o)+pt(i?n:+n[0],i?0:+n[1],+n[2]||1e-5),o=r+1;return a+e.substr(o,e.length-o)},gt=function(e,t,n,r,i){var o=t-e,a=r-n;return tt(i,(function(t){return n+((t-e)/o*a||0)}))},mt=function(e,t,n){var r,i,o,a=e.labels,s=M;for(r in a)(i=a[r]-t)<0==!!n&&i&&s>(i=Math.abs(i))&&(o=r,s=i);return o},vt=function(e,t,n){var r,i,o=e.vars,a=o[t];if(a)return r=o[t+"Params"],i=o.callbackScope||e,n&&pe.length&&Oe(),r?a.apply(i,r):a.call(i)},yt=function(e){return De(e),e.progress()<1&&vt(e,"onInterrupt"),e},_t=function(e){var t=(e=!e.name&&e.default||e).name,n=q(e),r=t&&!n&&e.init?function(){this._props=[]}:e,i={init:le,render:cn,add:Wt,kill:dn,modifier:ln,rawVars:0},o={targetTest:0,get:0,getSetter:on,aliases:{},register:0};if(Lt(),e!==r){if(he[t])return;Le(r,Le(Pe(e,i),o)),Ne(r.prototype,Ne(i,Pe(e,o))),he[r.prop=t]=r,e.targetTest&&(ve.push(r),de[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}ce(t,r),e.register&&e.register(yn,r,hn)},bt=255,St={aqua:[0,bt,bt],lime:[0,bt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,bt],navy:[0,0,128],white:[bt,bt,bt],olive:[128,128,0],yellow:[bt,bt,0],orange:[bt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[bt,0,0],pink:[bt,192,203],cyan:[0,bt,bt],transparent:[bt,bt,bt,0]},Et=function(e,t,n){return(6*(e=e<0?e+1:e>1?e-1:e)<1?t+(n-t)*e*6:e<.5?n:3*e<2?t+(n-t)*(2/3-e)*6:t)*bt+.5|0},wt=function(e,t,n){var r,i,o,a,s,u,c,l,d,p,f=e?G(e)?[e>>16,e>>8&bt,e&bt]:0:St.black;if(!f){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),St[e])f=St[e];else if("#"===e.charAt(0)){if(e.length<6&&(r=e.charAt(1),i=e.charAt(2),o=e.charAt(3),e="#"+r+r+i+i+o+o+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(f=parseInt(e.substr(1,6),16))>>16,f>>8&bt,f&bt,parseInt(e.substr(7),16)/255];f=[(e=parseInt(e.substr(1),16))>>16,e>>8&bt,e&bt]}else if("hsl"===e.substr(0,3))if(f=p=e.match(X),t){if(~e.indexOf("="))return f=e.match(Z),n&&f.length<4&&(f[3]=1),f}else a=+f[0]%360/360,s=+f[1]/100,r=2*(u=+f[2]/100)-(i=u<=.5?u*(s+1):u+s-u*s),f.length>3&&(f[3]*=1),f[0]=Et(a+1/3,r,i),f[1]=Et(a,r,i),f[2]=Et(a-1/3,r,i);else f=e.match(X)||St.transparent;f=f.map(Number)}return t&&!p&&(r=f[0]/bt,i=f[1]/bt,o=f[2]/bt,u=((c=Math.max(r,i,o))+(l=Math.min(r,i,o)))/2,c===l?a=s=0:(d=c-l,s=u>.5?d/(2-c-l):d/(c+l),a=c===r?(i-o)/d+(i<o?6:0):c===i?(o-r)/d+2:(r-i)/d+4,a*=60),f[0]=~~(a+.5),f[1]=~~(100*s+.5),f[2]=~~(100*u+.5)),n&&f.length<4&&(f[3]=1),f},It=function(e){var t=[],n=[],r=-1;return e.split(Ot).forEach((function(e){var i=e.match(Q)||[];t.push.apply(t,i),n.push(r+=i.length+1)})),t.c=n,t},Tt=function(e,t,n){var r,i,o,a,s="",u=(e+s).match(Ot),c=t?"hsla(":"rgba(",l=0;if(!u)return e;if(u=u.map((function(e){return(e=wt(e,t,1))&&c+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"})),n&&(o=It(e),(r=n.c).join(s)!==o.c.join(s)))for(a=(i=e.replace(Ot,"1").split(Q)).length-1;l<a;l++)s+=i[l]+(~r.indexOf(l)?u.shift()||c+"0,0,0,0)":(o.length?o:u.length?u:n).shift());if(!i)for(a=(i=e.split(Ot)).length-1;l<a;l++)s+=i[l]+u[l];return s+i[a]},Ot=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in St)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),xt=/hsl[a]?\(/,Rt=function(e){var t,n=e.join(" ");if(Ot.lastIndex=0,Ot.test(n))return t=xt.test(n),e[1]=Tt(e[1],t),e[0]=Tt(e[0],t,It(e[1])),!0},At=(y=Date.now,_=500,b=33,S=y(),E=S,I=w=1e3/240,O=function e(t){var n,r,i,o,a=y()-E,s=!0===t;if(a>_&&(S+=a-b),((n=(i=(E+=a)-S)-I)>0||s)&&(o=++g.frame,m=i-1e3*g.time,g.time=i/=1e3,I+=n+(n>=w?4:w-n),r=1),s||(p=f(e)),r)for(v=0;v<T.length;v++)T[v](i,m,o,t)},g={time:0,frame:0,tick:function(){O(!0)},deltaRatio:function(e){return m/(1e3/(e||60))},wake:function(){u&&(!a&&W()&&(o=a=window,s=o.document||{},ie.gsap=yn,(o.gsapVersions||(o.gsapVersions=[])).push(yn.version),ae(oe||o.GreenSockGlobals||!o.gsap&&o||{}),h=o.requestAnimationFrame),p&&g.sleep(),f=h||function(e){return setTimeout(e,I-1e3*g.time+1|0)},d=1,O(2))},sleep:function(){(h?o.cancelAnimationFrame:clearTimeout)(p),d=0,f=le},lagSmoothing:function(e,t){_=e||1e8,b=Math.min(t,_,0)},fps:function(e){w=1e3/(e||240),I=1e3*g.time+w},add:function(e){T.indexOf(e)<0&&T.push(e),Lt()},remove:function(e){var t;~(t=T.indexOf(e))&&T.splice(t,1)&&v>=t&&v--},_listeners:T=[]}),Lt=function(){return!d&&At.wake()},Ct={},Nt=/^[\d.\-M][\d.\-,\s]/,Mt=/["']/g,Pt=function(e){for(var t,n,r,i={},o=e.substr(1,e.length-3).split(":"),a=o[0],s=1,u=o.length;s<u;s++)n=o[s],t=s!==u-1?n.lastIndexOf(","):n.length,r=n.substr(0,t),i[a]=isNaN(r)?r.replace(Mt,"").trim():+r,a=n.substr(t+1).trim();return i},$t=function(e){return function(t){return 1-e(1-t)}},kt=function e(t,n){for(var r,i=t._first;i;)i instanceof Vt?e(i,n):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===n||(i.timeline?e(i.timeline,n):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=n)),i=i._next},Dt=function(e,t){return e&&(q(e)?e:Ct[e]||function(e){var t,n,r,i,o=(e+"").split("("),a=Ct[o[0]];return a&&o.length>1&&a.config?a.config.apply(null,~e.indexOf("{")?[Pt(o[1])]:(t=e,n=t.indexOf("(")+1,r=t.indexOf(")"),i=t.indexOf("(",n),t.substring(n,~i&&i<r?t.indexOf(")",r+1):r)).split(",").map(Re)):Ct._CE&&Nt.test(e)?Ct._CE("",e):a}(e))||t},Ut=function(e,t,n,r){void 0===n&&(n=function(e){return 1-t(1-e)}),void 0===r&&(r=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var i,o={easeIn:t,easeOut:n,easeInOut:r};return Ee(e,(function(e){for(var t in Ct[e]=ie[e]=o,Ct[i=e.toLowerCase()]=n,o)Ct[i+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=Ct[e+"."+t]=o[t]})),o},jt=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},Bt=function e(t,n,r){var i=n>=1?n:1,o=(r||(t?.3:.45))/(n<1?n:1),a=o/$*(Math.asin(1/i)||0),s=function(e){return 1===e?1:i*Math.pow(2,-10*e)*B((e-a)*o)+1},u="out"===t?s:"in"===t?function(e){return 1-s(1-e)}:jt(s);return o=$/o,u.config=function(n,r){return e(t,n,r)},u},Ft=function e(t,n){void 0===n&&(n=1.70158);var r=function(e){return e?--e*e*((n+1)*e+n)+1:0},i="out"===t?r:"in"===t?function(e){return 1-r(1-e)}:jt(r);return i.config=function(n){return e(t,n)},i};Ee("Linear,Quad,Cubic,Quart,Quint,Strong",(function(e,t){var n=t<5?t+1:t;Ut(e+",Power"+(n-1),t?function(e){return Math.pow(e,n)}:function(e){return e},(function(e){return 1-Math.pow(1-e,n)}),(function(e){return e<.5?Math.pow(2*e,n)/2:1-Math.pow(2*(1-e),n)/2}))})),Ct.Linear.easeNone=Ct.none=Ct.Linear.easeIn,Ut("Elastic",Bt("in"),Bt("out"),Bt()),x=7.5625,A=1/(R=2.75),Ut("Bounce",(function(e){return 1-L(1-e)}),L=function(e){return e<A?x*e*e:e<.7272727272727273?x*Math.pow(e-1.5/R,2)+.75:e<.9090909090909092?x*(e-=2.25/R)*e+.9375:x*Math.pow(e-2.625/R,2)+.984375}),Ut("Expo",(function(e){return e?Math.pow(2,10*(e-1)):0})),Ut("Circ",(function(e){return-(U(1-e*e)-1)})),Ut("Sine",(function(e){return 1===e?1:1-j(e*k)})),Ut("Back",Ft("in"),Ft("out"),Ft()),Ct.SteppedEase=Ct.steps=ie.SteppedEase={config:function(e,t){void 0===e&&(e=1);var n=1/e,r=e+(t?0:1),i=t?1:0;return function(e){return((r*nt(0,.99999999,e)|0)+i)*n}}},N.ease=Ct["quad.out"],Ee("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(e){return ye+=e+","+e+"Params,"}));var qt=function(e,t){this.id=D++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Se,this.set=t?t.getSetter:on},Gt=function(){function e(e,t){var n=e.parent||i;this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,Xe(this,+e.duration,1,1),this.data=e.data,d||At.wake(),n&&We(n,this,t||0===t?t:n._time,1),e.reversed&&this.reverse(),e.paused&&this.paused(!0)}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,Xe(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(Lt(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(He(this,e),!n._dp||n.parent||ze(n,this);n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&We(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===P||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),xe(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+Fe(this))%this._dur||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+Fe(this),t):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(e,t){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*n,t):this._repeat?qe(this._tTime,n)+1:1},t.timeScale=function(e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===e)return this;var t=this.parent&&this._ts?Ge(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-1e-8===e?0:this._rts,je(this.totalTime(nt(-this._delay,this._tDur,t),!0))},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Lt(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&(this._tTime-=P)&&Math.abs(this._zTime)!==P))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&We(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(z(e)?this.totalDuration():this.duration())/Math.abs(this._ts)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Ge(t.rawTime(e),this):this._tTime:this._tTime},t.globalTime=function(e){for(var t=this,n=arguments.length?e:t.rawTime();t;)n=t._start+n/(t._ts||1),t=t._dp;return n},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,Ze(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){return arguments.length?(this._rDelay=e,Ze(this)):this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(et(this,e),z(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,z(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var e,t=this.parent||this._dp,n=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=n&&e<this.endTime(!0)-P))},t.eventCallback=function(e,t,n){var r=this.vars;return arguments.length>1?(t?(r[e]=t,n&&(r[e+"Params"]=n),"onUpdate"===e&&(this._onUpdate=t)):delete r[e],this):r[e]},t.then=function(e){var t=this;return new Promise((function(n){var r=q(e)?e:Ae,i=function(){var e=t.then;t.then=null,q(r)&&(r=r(t))&&(r.then||r===t)&&(t.then=e),n(r),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?i():t._prom=i}))},t.kill=function(){yt(this)},e}();Le(Gt.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Vt=function(e){function r(t,r){var i;return void 0===t&&(t={}),(i=e.call(this,t,r)||this).labels={},i.smoothChildTiming=!!t.smoothChildTiming,i.autoRemoveChildren=!!t.autoRemoveChildren,i._sort=z(t.sortChildren),i.parent&&ze(i.parent,n(i)),t.scrollTrigger&&Je(n(i),t.scrollTrigger),i}t(r,e);var o=r.prototype;return o.to=function(e,t,n){return new Qt(e,Te(arguments,0,this),et(this,G(t)?arguments[3]:n)),this},o.from=function(e,t,n){return new Qt(e,Te(arguments,1,this),et(this,G(t)?arguments[3]:n)),this},o.fromTo=function(e,t,n,r){return new Qt(e,Te(arguments,2,this),et(this,G(t)?arguments[4]:r)),this},o.set=function(e,t,n){return t.duration=0,t.parent=this,$e(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new Qt(e,t,et(this,n),1),this},o.call=function(e,t,n){return We(this,Qt.delayedCall(0,e,t),et(this,n))},o.staggerTo=function(e,t,n,r,i,o,a){return n.duration=t,n.stagger=n.stagger||r,n.onComplete=o,n.onCompleteParams=a,n.parent=this,new Qt(e,n,et(this,i)),this},o.staggerFrom=function(e,t,n,r,i,o,a){return n.runBackwards=1,$e(n).immediateRender=z(n.immediateRender),this.staggerTo(e,t,n,r,i,o,a)},o.staggerFromTo=function(e,t,n,r,i,o,a,s){return r.startAt=n,$e(r).immediateRender=z(r.immediateRender),this.staggerTo(e,t,r,i,o,a,s)},o.render=function(e,t,n){var r,o,a,s,u,c,l,d,p,f,h,g,m=this._time,v=this._dirty?this.totalDuration():this._tDur,y=this._dur,_=this!==i&&e>v-P&&e>=0?v:e<P?0:e,b=this._zTime<0!=e<0&&(this._initted||!y);if(_!==this._tTime||n||b){if(m!==this._time&&y&&(_+=this._time-m,e+=this._time-m),r=_,p=this._start,c=!(d=this._ts),b&&(y||(m=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(h=this._yoyo,u=y+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*u+e,t,n);if(r=we(_%u),_===v?(s=this._repeat,r=y):((s=~~(_/u))&&s===_/u&&(r=y,s--),r>y&&(r=y)),f=qe(this._tTime,u),!m&&this._tTime&&f!==s&&(f=s),h&&1&s&&(r=y-r,g=1),s!==f&&!this._lock){var S=h&&1&f,E=S===(h&&1&s);if(s<f&&(S=!S),m=S?0:y,this._lock=1,this.render(m||(g?0:we(s*u)),t,!y)._lock=0,!t&&this.parent&&vt(this,"onRepeat"),this.vars.repeatRefresh&&!g&&(this.invalidate()._lock=1),m!==this._time||c!==!this._ts)return this;if(y=this._dur,v=this._tDur,E&&(this._lock=2,m=S?y:-1e-4,this.render(m,!0),this.vars.repeatRefresh&&!g&&this.invalidate()),this._lock=0,!this._ts&&!c)return this;kt(this,g)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(l=function(e,t,n){var r;if(n>t)for(r=e._first;r&&r._start<=n;){if(!r._dur&&"isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if(!r._dur&&"isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,we(m),we(r)))&&(_-=r-(r=l._start)),this._tTime=_,this._time=r,this._act=!d,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,m=0),!m&&(r||!y&&e>=0)&&!t&&vt(this,"onStart"),r>=m&&e>=0)for(o=this._first;o;){if(a=o._next,(o._act||r>=o._start)&&o._ts&&l!==o){if(o.parent!==this)return this.render(e,t,n);if(o.render(o._ts>0?(r-o._start)*o._ts:(o._dirty?o.totalDuration():o._tDur)+(r-o._start)*o._ts,t,n),r!==this._time||!this._ts&&!c){l=0,a&&(_+=this._zTime=-1e-8);break}}o=a}else{o=this._last;for(var w=e<0?e:r;o;){if(a=o._prev,(o._act||w<=o._end)&&o._ts&&l!==o){if(o.parent!==this)return this.render(e,t,n);if(o.render(o._ts>0?(w-o._start)*o._ts:(o._dirty?o.totalDuration():o._tDur)+(w-o._start)*o._ts,t,n),r!==this._time||!this._ts&&!c){l=0,a&&(_+=this._zTime=w?-1e-8:P);break}}o=a}}if(l&&!t&&(this.pause(),l.render(r>=m?0:-1e-8)._zTime=r>=m?1:-1,this._ts))return this._start=p,Ve(this),this.render(e,t,n);this._onUpdate&&!t&&vt(this,"onUpdate",!0),(_===v&&v>=this.totalDuration()||!_&&m)&&(p!==this._start&&Math.abs(d)===Math.abs(this._ts)||this._lock||((e||!y)&&(_===v&&this._ts>0||!_&&this._ts<0)&&De(this,1),t||e<0&&!m||!_&&!m||(vt(this,_===v?"onComplete":"onReverseComplete",!0),this._prom&&!(_<v&&this.timeScale()>0)&&this._prom())))}return this},o.add=function(e,t){var n=this;if(G(t)||(t=et(this,t)),!(e instanceof Gt)){if(K(e))return e.forEach((function(e){return n.add(e,t)})),this;if(F(e))return this.addLabel(e,t);if(!q(e))return this;e=Qt.delayedCall(0,e)}return this!==e?We(this,e,t):this},o.getChildren=function(e,t,n,r){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=-M);for(var i=[],o=this._first;o;)o._start>=r&&(o instanceof Qt?t&&i.push(o):(n&&i.push(o),e&&i.push.apply(i,o.getChildren(!0,t,n)))),o=o._next;return i},o.getById=function(e){for(var t=this.getChildren(1,1,1),n=t.length;n--;)if(t[n].vars.id===e)return t[n]},o.remove=function(e){return F(e)?this.removeLabel(e):q(e)?this.killTweensOf(e):(ke(this,e),e===this._recent&&(this._recent=this._last),Ue(this))},o.totalTime=function(t,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=we(At.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,n),this._forcing=0,this):this._tTime},o.addLabel=function(e,t){return this.labels[e]=et(this,t),this},o.removeLabel=function(e){return delete this.labels[e],this},o.addPause=function(e,t,n){var r=Qt.delayedCall(0,t||le,n);return r.data="isPause",this._hasPause=1,We(this,r,et(this,e))},o.removePause=function(e){var t=this._first;for(e=et(this,e);t;)t._start===e&&"isPause"===t.data&&De(t),t=t._next},o.killTweensOf=function(e,t,n){for(var r=this.getTweensOf(e,n),i=r.length;i--;)Ht!==r[i]&&r[i].kill(e,t);return this},o.getTweensOf=function(e,t){for(var n,r=[],i=st(e),o=this._first,a=G(t);o;)o instanceof Qt?Ie(o._targets,i)&&(a?(!Ht||o._initted&&o._ts)&&o.globalTime(0)<=t&&o.globalTime(o.totalDuration())>t:!t||o.isActive())&&r.push(o):(n=o.getTweensOf(i,t)).length&&r.push.apply(r,n),o=o._next;return r},o.tweenTo=function(e,t){t=t||{};var n=this,r=et(n,e),i=t,o=i.startAt,a=i.onStart,s=i.onStartParams,u=i.immediateRender,c=Qt.to(n,Le({ease:"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:t.duration||Math.abs((r-(o&&"time"in o?o.time:n._time))/n.timeScale())||P,onStart:function(){n.pause();var e=t.duration||Math.abs((r-n._time)/n.timeScale());c._dur!==e&&Xe(c,e,0,1).render(c._time,!0,!0),a&&a.apply(c,s||[])}},t));return u?c.render(0):c},o.tweenFromTo=function(e,t,n){return this.tweenTo(t,Le({startAt:{time:et(this,e)}},n))},o.recent=function(){return this._recent},o.nextLabel=function(e){return void 0===e&&(e=this._time),mt(this,et(this,e))},o.previousLabel=function(e){return void 0===e&&(e=this._time),mt(this,et(this,e),1)},o.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+P)},o.shiftChildren=function(e,t,n){void 0===n&&(n=0);for(var r,i=this._first,o=this.labels;i;)i._start>=n&&(i._start+=e,i._end+=e),i=i._next;if(t)for(r in o)o[r]>=n&&(o[r]+=e);return Ue(this)},o.invalidate=function(){var t=this._first;for(this._lock=0;t;)t.invalidate(),t=t._next;return e.prototype.invalidate.call(this)},o.clear=function(e){void 0===e&&(e=!0);for(var t,n=this._first;n;)t=n._next,this.remove(n),n=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),Ue(this)},o.totalDuration=function(e){var t,n,r,o=0,a=this,s=a._last,u=M;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-e:e));if(a._dirty){for(r=a.parent;s;)t=s._prev,s._dirty&&s.totalDuration(),(n=s._start)>u&&a._sort&&s._ts&&!a._lock?(a._lock=1,We(a,s,n-s._delay,1)._lock=0):u=n,n<0&&s._ts&&(o-=n,(!r&&!a._dp||r&&r.smoothChildTiming)&&(a._start+=n/a._ts,a._time-=n,a._tTime-=n),a.shiftChildren(-n,!1,-Infinity),u=0),s._end>o&&s._ts&&(o=s._end),s=t;Xe(a,a===i&&a._time>o?a._time:o,1,1),a._dirty=0}return a._tDur},r.updateRoot=function(e){if(i._ts&&(xe(i,Ge(e,i)),c=At.frame),At.frame>=me){me+=C.autoSleep||120;var t=i._first;if((!t||!t._ts)&&C.autoSleep&&At._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||At.sleep()}}},r}(Gt);Le(Vt.prototype,{_lock:0,_hasPause:0,_forcing:0});var Ht,zt=function(e,t,n,r,i,o,a){var s,u,c,l,d,p,f,h,g=new hn(this._pt,e,t,0,1,un,null,i),m=0,v=0;for(g.b=n,g.e=r,n+="",(f=~(r+="").indexOf("random("))&&(r=ht(r)),o&&(o(h=[n,r],e,t),n=h[0],r=h[1]),u=n.match(ee)||[];s=ee.exec(r);)l=s[0],d=r.substring(m,s.index),c?c=(c+1)%5:"rgba("===d.substr(-5)&&(c=1),l!==u[v++]&&(p=parseFloat(u[v-1])||0,g._pt={_next:g._pt,p:d||1===v?d:",",s:p,c:"="===l.charAt(1)?parseFloat(l.substr(2))*("-"===l.charAt(0)?-1:1):parseFloat(l)-p,m:c&&c<4?Math.round:0},m=ee.lastIndex);return g.c=m<r.length?r.substring(m,r.length):"",g.fp=a,(te.test(r)||f)&&(g.e=0),this._pt=g,g},Wt=function(e,t,n,r,i,o,a,s,u){q(r)&&(r=r(i||0,e,o));var c,l=e[t],d="get"!==n?n:q(l)?u?e[t.indexOf("set")||!q(e["get"+t.substr(3)])?t:"get"+t.substr(3)](u):e[t]():l,p=q(l)?u?nn:tn:en;if(F(r)&&(~r.indexOf("random(")&&(r=ht(r)),"="===r.charAt(1)&&(r=parseFloat(d)+parseFloat(r.substr(2))*("-"===r.charAt(0)?-1:1)+(rt(d)||0))),d!==r)return isNaN(d*r)?(!l&&!(t in e)&&se(t,r),zt.call(this,e,t,d,r,p,s||C.stringFilter,u)):(c=new hn(this._pt,e,t,+d||0,r-(d||0),"boolean"==typeof l?sn:an,0,p),u&&(c.fp=u),a&&c.modifier(a,this,e),this._pt=c)},Jt=function(e,t,n,r,i,o){var a,s,u,c;if(he[e]&&!1!==(a=new he[e]).init(i,a.rawVars?t[e]:function(e,t,n,r,i){if(q(e)&&(e=Kt(e,i,t,n,r)),!H(e)||e.style&&e.nodeType||K(e)||Y(e))return F(e)?Kt(e,i,t,n,r):e;var o,a={};for(o in e)a[o]=Kt(e[o],i,t,n,r);return a}(t[e],r,i,o,n),n,r,o)&&(n._pt=s=new hn(n._pt,i,e,0,1,a.render,a,0,a.priority),n!==l))for(u=n._ptLookup[n._targets.indexOf(i)],c=a._props.length;c--;)u[a._props[c]]=s;return a},Yt=function e(t,n){var o,a,s,u,c,l,d,p,f,h,g,m,v,y=t.vars,_=y.ease,b=y.startAt,S=y.immediateRender,E=y.lazy,w=y.onUpdate,I=y.onUpdateParams,T=y.callbackScope,O=y.runBackwards,x=y.yoyoEase,R=y.keyframes,A=y.autoRevert,L=t._dur,C=t._startAt,M=t._targets,$=t.parent,k=$&&"nested"===$.data?$.parent._targets:M,D="auto"===t._overwrite&&!r,U=t.timeline;if(U&&(!R||!_)&&(_="none"),t._ease=Dt(_,N.ease),t._yEase=x?$t(Dt(!0===x?_:x,N.ease)):0,x&&t._yoyo&&!t._repeat&&(x=t._yEase,t._yEase=t._ease,t._ease=x),!U){if(m=(p=M[0]?be(M[0]).harness:0)&&y[p.prop],o=Pe(y,de),C&&C.render(-1,!0).kill(),b){if(De(t._startAt=Qt.set(M,Le({data:"isStart",overwrite:!1,parent:$,immediateRender:!0,lazy:z(E),startAt:null,delay:0,onUpdate:w,onUpdateParams:I,callbackScope:T,stagger:0},b))),S)if(n>0)A||(t._startAt=0);else if(L&&!(n<0&&C))return void(n&&(t._zTime=n))}else if(O&&L)if(C)!A&&(t._startAt=0);else if(n&&(S=!1),s=Le({overwrite:!1,data:"isFromStart",lazy:S&&z(E),immediateRender:S,stagger:0,parent:$},o),m&&(s[p.prop]=m),De(t._startAt=Qt.set(M,s)),S){if(!n)return}else e(t._startAt,P);for(t._pt=0,E=L&&z(E)||E&&!L,a=0;a<M.length;a++){if(d=(c=M[a])._gsap||_e(M)[a]._gsap,t._ptLookup[a]=h={},fe[d.id]&&pe.length&&Oe(),g=k===M?a:k.indexOf(c),p&&!1!==(f=new p).init(c,m||o,t,g,k)&&(t._pt=u=new hn(t._pt,c,f.name,0,1,f.render,f,0,f.priority),f._props.forEach((function(e){h[e]=u})),f.priority&&(l=1)),!p||m)for(s in o)he[s]&&(f=Jt(s,o,t,g,c,k))?f.priority&&(l=1):h[s]=u=Wt.call(t,c,s,"get",o[s],g,k,0,y.stringFilter);t._op&&t._op[a]&&t.kill(c,t._op[a]),D&&t._pt&&(Ht=t,i.killTweensOf(c,h,t.globalTime(0)),v=!t.parent,Ht=0),t._pt&&E&&(fe[d.id]=1)}l&&fn(t),t._onInit&&t._onInit(t)}t._from=!U&&!!y.runBackwards,t._onUpdate=w,t._initted=(!t._op||t._pt)&&!v},Kt=function(e,t,n,r,i){return q(e)?e.call(t,n,r,i):F(e)&&~e.indexOf("random(")?ht(e):e},Xt=ye+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",Zt=(Xt+",id,stagger,delay,duration,paused,scrollTrigger").split(","),Qt=function(e){function o(t,o,a,s){var u;"number"==typeof o&&(a.duration=o,o=a,a=null);var c,l,d,p,f,h,g,m,v=(u=e.call(this,s?o:$e(o),a)||this).vars,y=v.duration,_=v.delay,b=v.immediateRender,S=v.stagger,E=v.overwrite,w=v.keyframes,I=v.defaults,T=v.scrollTrigger,O=v.yoyoEase,x=u.parent,R=(K(t)||Y(t)?G(t[0]):"length"in o)?[t]:st(t);if(u._targets=R.length?_e(R):ue("GSAP target "+t+" not found. https://greensock.com",!C.nullTargetWarn)||[],u._ptLookup=[],u._overwrite=E,w||S||J(y)||J(_)){if(o=u.vars,(c=u.timeline=new Vt({data:"nested",defaults:I||{}})).kill(),c.parent=c._dp=n(u),c._start=0,w)Le(c.vars.defaults,{ease:"none"}),w.forEach((function(e){return c.to(R,e,">")}));else{if(p=R.length,g=S?ct(S):le,H(S))for(f in S)~Xt.indexOf(f)&&(m||(m={}),m[f]=S[f]);for(l=0;l<p;l++){for(f in d={},o)Zt.indexOf(f)<0&&(d[f]=o[f]);d.stagger=0,O&&(d.yoyoEase=O),m&&Ne(d,m),h=R[l],d.duration=+Kt(y,n(u),l,h,R),d.delay=(+Kt(_,n(u),l,h,R)||0)-u._delay,!S&&1===p&&d.delay&&(u._delay=_=d.delay,u._start+=_,d.delay=0),c.to(h,d,g(l,h,R))}c.duration()?y=_=0:u.timeline=0}y||u.duration(y=c.duration())}else u.timeline=0;return!0!==E||r||(Ht=n(u),i.killTweensOf(R),Ht=0),x&&ze(x,n(u)),(b||!y&&!w&&u._start===we(x._time)&&z(b)&&Be(n(u))&&"nested"!==x.data)&&(u._tTime=-1e-8,u.render(Math.max(0,-_))),T&&Je(n(u),T),u}t(o,e);var a=o.prototype;return a.render=function(e,t,n){var r,i,o,a,s,u,c,l,d,p=this._time,f=this._tDur,h=this._dur,g=e>f-P&&e>=0?f:e<P?0:e;if(h){if(g!==this._tTime||!e||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=e<0){if(r=g,l=this.timeline,this._repeat){if(a=h+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*a+e,t,n);if(r=we(g%a),g===f?(o=this._repeat,r=h):((o=~~(g/a))&&o===g/a&&(r=h,o--),r>h&&(r=h)),(u=this._yoyo&&1&o)&&(d=this._yEase,r=h-r),s=qe(this._tTime,a),r===p&&!n&&this._initted)return this;o!==s&&(l&&this._yEase&&kt(l,u),!this.vars.repeatRefresh||u||this._lock||(this._lock=n=1,this.render(we(a*o),!0).invalidate()._lock=0))}if(!this._initted){if(Ye(this,e<0?e:r,n,t))return this._tTime=0,this;if(h!==this._dur)return this.render(e,t,n)}for(this._tTime=g,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(d||this._ease)(r/h),this._from&&(this.ratio=c=1-c),r&&!p&&!t&&vt(this,"onStart"),i=this._pt;i;)i.r(c,i.d),i=i._next;l&&l.render(e<0?e:!r&&u?-1e-8:l._dur*c,t,n)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(e<0&&this._startAt&&this._startAt.render(e,!0,n),vt(this,"onUpdate")),this._repeat&&o!==s&&this.vars.onRepeat&&!t&&this.parent&&vt(this,"onRepeat"),g!==this._tDur&&g||this._tTime!==g||(e<0&&this._startAt&&!this._onUpdate&&this._startAt.render(e,!0,!0),(e||!h)&&(g===this._tDur&&this._ts>0||!g&&this._ts<0)&&De(this,1),t||e<0&&!p||!g&&!p||(vt(this,g===f?"onComplete":"onReverseComplete",!0),this._prom&&!(g<f&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,n,r){var i,o,a,s=e.ratio,u=t<0||!t&&(!e._start&&Ke(e)||(e._ts<0||e._dp._ts<0)&&"isFromStart"!==e.data&&"isStart"!==e.data)?0:1,c=e._rDelay,l=0;if(c&&e._repeat&&(l=nt(0,e._tDur,t),o=qe(l,c),a=qe(e._tTime,c),e._yoyo&&1&o&&(u=1-u),o!==a&&(s=1-u,e.vars.repeatRefresh&&e._initted&&e.invalidate())),u!==s||r||e._zTime===P||!t&&e._zTime){if(!e._initted&&Ye(e,t,r,n))return;for(a=e._zTime,e._zTime=t||(n?P:0),n||(n=t&&!a),e.ratio=u,e._from&&(u=1-u),e._time=0,e._tTime=l,n||vt(e,"onStart"),i=e._pt;i;)i.r(u,i.d),i=i._next;e._startAt&&t<0&&e._startAt.render(t,!0,!0),e._onUpdate&&!n&&vt(e,"onUpdate"),l&&e._repeat&&!n&&e.parent&&vt(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===u&&(u&&De(e,1),n||(vt(e,u?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,n);return this},a.targets=function(){return this._targets},a.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),e.prototype.invalidate.call(this)},a.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?yt(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,Ht&&!0!==Ht.vars.overwrite)._first||yt(this),this.parent&&n!==this.timeline.totalDuration()&&Xe(this,this._dur*this.timeline._tDur/n,0,1),this}var r,i,o,a,s,u,c,l=this._targets,d=e?st(e):l,p=this._ptLookup,f=this._pt;if((!t||"all"===t)&&function(e,t){for(var n=e.length,r=n===t.length;r&&n--&&e[n]===t[n];);return n<0}(l,d))return"all"===t&&(this._pt=0),yt(this);for(r=this._op=this._op||[],"all"!==t&&(F(t)&&(s={},Ee(t,(function(e){return s[e]=1})),t=s),t=function(e,t){var n,r,i,o,a=e[0]?be(e[0]).harness:0,s=a&&a.aliases;if(!s)return t;for(r in n=Ne({},t),s)if(r in n)for(i=(o=s[r].split(",")).length;i--;)n[o[i]]=n[r];return n}(l,t)),c=l.length;c--;)if(~d.indexOf(l[c]))for(s in i=p[c],"all"===t?(r[c]=t,a=i,o={}):(o=r[c]=r[c]||{},a=t),a)(u=i&&i[s])&&("kill"in u.d&&!0!==u.d.kill(s)||ke(this,u,"_pt"),delete i[s]),"all"!==o&&(o[s]=1);return this._initted&&!this._pt&&f&&yt(this),this},o.to=function(e,t){return new o(e,t,arguments[2])},o.from=function(e,t){return new o(e,Te(arguments,1))},o.delayedCall=function(e,t,n,r){return new o(t,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:t,onReverseComplete:t,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:r})},o.fromTo=function(e,t,n){return new o(e,Te(arguments,2))},o.set=function(e,t){return t.duration=0,t.repeatDelay||(t.repeat=0),new o(e,t)},o.killTweensOf=function(e,t,n){return i.killTweensOf(e,t,n)},o}(Gt);Le(Qt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Ee("staggerTo,staggerFrom,staggerFromTo",(function(e){Qt[e]=function(){var t=new Vt,n=it.call(arguments,0);return n.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,n)}}));var en=function(e,t,n){return e[t]=n},tn=function(e,t,n){return e[t](n)},nn=function(e,t,n,r){return e[t](r.fp,n)},rn=function(e,t,n){return e.setAttribute(t,n)},on=function(e,t){return q(e[t])?tn:V(e[t])&&e.setAttribute?rn:en},an=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4,t)},sn=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},un=function(e,t){var n=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+r,n=n._next;r+=t.c}t.set(t.t,t.p,r,t)},cn=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},ln=function(e,t,n,r){for(var i,o=this._pt;o;)i=o._next,o.p===r&&o.modifier(e,t,n),o=i},dn=function(e){for(var t,n,r=this._pt;r;)n=r._next,r.p===e&&!r.op||r.op===e?ke(this,r,"_pt"):r.dep||(t=1),r=n;return!t},pn=function(e,t,n,r){r.mSet(e,t,r.m.call(r.tween,n,r.mt),r)},fn=function(e){for(var t,n,r,i,o=e._pt;o;){for(t=o._next,n=r;n&&n.pr>o.pr;)n=n._next;(o._prev=n?n._prev:i)?o._prev._next=o:r=o,(o._next=n)?n._prev=o:i=o,o=t}e._pt=r},hn=function(){function e(e,t,n,r,i,o,a,s,u){this.t=t,this.s=r,this.c=i,this.p=n,this.r=o||an,this.d=a||this,this.set=s||en,this.pr=u||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,n){this.mSet=this.mSet||this.set,this.set=pn,this.m=e,this.mt=n,this.tween=t},e}();Ee(ye+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(e){return de[e]=1})),ie.TweenMax=ie.TweenLite=Qt,ie.TimelineLite=ie.TimelineMax=Vt,i=new Vt({sortChildren:!1,defaults:N,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),C.stringFilter=Rt;var gn={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){return _t(e)}))},timeline:function(e){return new Vt(e)},getTweensOf:function(e,t){return i.getTweensOf(e,t)},getProperty:function(e,t,n,r){F(e)&&(e=st(e)[0]);var i=be(e||{}).get,o=n?Ae:Re;return"native"===n&&(n=""),e?t?o((he[t]&&he[t].get||i)(e,t,n,r)):function(t,n,r){return o((he[t]&&he[t].get||i)(e,t,n,r))}:e},quickSetter:function(e,t,n){if((e=st(e)).length>1){var r=e.map((function(e){return yn.quickSetter(e,t,n)})),i=r.length;return function(e){for(var t=i;t--;)r[t](e)}}e=e[0]||{};var o=he[t],a=be(e),s=a.harness&&(a.harness.aliases||{})[t]||t,u=o?function(t){var r=new o;l._pt=0,r.init(e,n?t+n:t,l,0,[e]),r.render(1,r),l._pt&&cn(1,l)}:a.set(e,s);return o?u:function(t){return u(e,s,n?t+n:t,a,1)}},isTweening:function(e){return i.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Dt(e.ease,N.ease)),Me(N,e||{})},config:function(e){return Me(C,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,r=e.plugins,i=e.defaults,o=e.extendTimeline;(r||"").split(",").forEach((function(e){return e&&!he[e]&&!ie[e]&&ue(t+" effect requires "+e+" plugin.")})),ge[t]=function(e,t,r){return n(st(e),Le(t||{},i),r)},o&&(Vt.prototype[t]=function(e,n,r){return this.add(ge[t](e,H(n)?n:(r=n)&&{},this),r)})},registerEase:function(e,t){Ct[e]=Dt(t)},parseEase:function(e,t){return arguments.length?Dt(e,t):Ct},getById:function(e){return i.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var n,r,o=new Vt(e);for(o.smoothChildTiming=z(e.smoothChildTiming),i.remove(o),o._dp=0,o._time=o._tTime=i._time,n=i._first;n;)r=n._next,!t&&!n._dur&&n instanceof Qt&&n.vars.onComplete===n._targets[0]||We(o,n,n._start-n._delay),n=r;return We(i,o,0),o},utils:{wrap:function e(t,n,r){var i=n-t;return K(t)?ft(t,e(0,t.length),n):tt(r,(function(e){return(i+(e-t)%i)%i+t}))},wrapYoyo:function e(t,n,r){var i=n-t,o=2*i;return K(t)?ft(t,e(0,t.length-1),n):tt(r,(function(e){return t+((e=(o+(e-t)%o)%o||0)>i?o-e:e)}))},distribute:ct,random:pt,snap:dt,normalize:function(e,t,n){return gt(e,t,0,1,n)},getUnit:rt,clamp:function(e,t,n){return tt(n,(function(n){return nt(e,t,n)}))},splitColor:wt,toArray:st,mapRange:gt,pipe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},unitize:function(e,t){return function(n){return e(parseFloat(n))+(t||rt(n))}},interpolate:function e(t,n,r,i){var o=isNaN(t+n)?0:function(e){return(1-e)*t+e*n};if(!o){var a,s,u,c,l,d=F(t),p={};if(!0===r&&(i=1)&&(r=null),d)t={p:t},n={p:n};else if(K(t)&&!K(n)){for(u=[],c=t.length,l=c-2,s=1;s<c;s++)u.push(e(t[s-1],t[s]));c--,o=function(e){e*=c;var t=Math.min(l,~~e);return u[t](e-t)},r=n}else i||(t=Ne(K(t)?[]:{},t));if(!u){for(a in n)Wt.call(p,t,a,"get",n[a]);o=function(e){return cn(e,p)||(d?t.p:t)}}}return tt(r,o)},shuffle:ut},install:ae,effects:ge,ticker:At,updateRoot:Vt.updateRoot,plugins:he,globalTimeline:i,core:{PropTween:hn,globals:ce,Tween:Qt,Timeline:Vt,Animation:Gt,getCache:be,_removeLinkedListItem:ke,suppressOverwrites:function(e){return r=e}}};Ee("to,from,fromTo,delayedCall,set,killTweensOf",(function(e){return gn[e]=Qt[e]})),At.add(Vt.updateRoot),l=gn.to({},{duration:0});var mn=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},vn=function(e,t){return{name:e,rawVars:1,init:function(e,n,r){r._onInit=function(e){var r,i;if(F(n)&&(r={},Ee(n,(function(e){return r[e]=1})),n=r),t){for(i in r={},n)r[i]=t(n[i]);n=r}!function(e,t){var n,r,i,o=e._targets;for(n in t)for(r=o.length;r--;)(i=e._ptLookup[r][n])&&(i=i.d)&&(i._pt&&(i=mn(i,n)),i&&i.modifier&&i.modifier(t[n],e,o[r],n))}(e,n)}}}},yn=gn.registerPlugin({name:"attr",init:function(e,t,n,r,i){var o,a;for(o in t)(a=this.add(e,"setAttribute",(e.getAttribute(o)||0)+"",t[o],r,i,0,0,o))&&(a.op=o),this._props.push(o)}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n])}},vn("roundProps",lt),vn("modifiers"),vn("snap",dt))||gn;Qt.version=Vt.version=yn.version="3.6.0",u=1,W()&&Lt();var _n,bn,Sn,En,wn,In,Tn,On,xn=Ct.Power0,Rn=Ct.Power1,An=Ct.Power2,Ln=Ct.Power3,Cn=Ct.Power4,Nn=Ct.Linear,Mn=Ct.Quad,Pn=Ct.Cubic,$n=Ct.Quart,kn=Ct.Quint,Dn=Ct.Strong,Un=Ct.Elastic,jn=Ct.Back,Bn=Ct.SteppedEase,Fn=Ct.Bounce,qn=Ct.Sine,Gn=Ct.Expo,Vn=Ct.Circ,Hn={},zn=180/Math.PI,Wn=Math.PI/180,Jn=Math.atan2,Yn=/([A-Z])/g,Kn=/(?:left|right|width|margin|padding|x)/i,Xn=/[\s,\(]\S/,Zn={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Qn=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},er=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},tr=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},nr=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},rr=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},ir=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},or=function(e,t,n){return e.style[t]=n},ar=function(e,t,n){return e.style.setProperty(t,n)},sr=function(e,t,n){return e._gsap[t]=n},ur=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},cr=function(e,t,n,r,i){var o=e._gsap;o.scaleX=o.scaleY=n,o.renderTransform(i,o)},lr=function(e,t,n,r,i){var o=e._gsap;o[t]=n,o.renderTransform(i,o)},dr="transform",pr=dr+"Origin",fr=function(e,t){var n=bn.createElementNS?bn.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):bn.createElement(e);return n.style?n:bn.createElement(e)},hr=function e(t,n,r){var i=getComputedStyle(t);return i[n]||i.getPropertyValue(n.replace(Yn,"-$1").toLowerCase())||i.getPropertyValue(n)||!r&&e(t,mr(n)||n,1)||""},gr="O,Moz,ms,Ms,Webkit".split(","),mr=function(e,t,n){var r=(t||wn).style,i=5;if(e in r&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);i--&&!(gr[i]+e in r););return i<0?null:(3===i?"ms":i>=0?gr[i]:"")+e},vr=function(){"undefined"!=typeof window&&window.document&&(_n=window,bn=_n.document,Sn=bn.documentElement,wn=fr("div")||{style:{}},In=fr("div"),dr=mr(dr),pr=dr+"Origin",wn.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",On=!!mr("perspective"),En=1)},yr=function e(t){var n,r=fr("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,o=this.nextSibling,a=this.style.cssText;if(Sn.appendChild(r),r.appendChild(this),this.style.display="block",t)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch(e){}else this._gsapBBox&&(n=this._gsapBBox());return i&&(o?i.insertBefore(this,o):i.appendChild(this)),Sn.removeChild(r),this.style.cssText=a,n},_r=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},br=function(e){var t;try{t=e.getBBox()}catch(n){t=yr.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===yr||(t=yr.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+_r(e,["x","cx","x1"])||0,y:+_r(e,["y","cy","y1"])||0,width:0,height:0}},Sr=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!br(e))},Er=function(e,t){if(t){var n=e.style;t in Hn&&t!==pr&&(t=dr),n.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),n.removeProperty(t.replace(Yn,"-$1").toLowerCase())):n.removeAttribute(t)}},wr=function(e,t,n,r,i,o){var a=new hn(e._pt,t,n,0,1,o?ir:rr);return e._pt=a,a.b=r,a.e=i,e._props.push(n),a},Ir={deg:1,rad:1,turn:1},Tr=function e(t,n,r,i){var o,a,s,u,c=parseFloat(r)||0,l=(r+"").trim().substr((c+"").length)||"px",d=wn.style,p=Kn.test(n),f="svg"===t.tagName.toLowerCase(),h=(f?"client":"offset")+(p?"Width":"Height"),g=100,m="px"===i,v="%"===i;return i===l||!c||Ir[i]||Ir[l]?c:("px"!==l&&!m&&(c=e(t,n,r,"px")),u=t.getCTM&&Sr(t),!v&&"%"!==l||!Hn[n]&&!~n.indexOf("adius")?(d[p?"width":"height"]=g+(m?l:i),a=~n.indexOf("adius")||"em"===i&&t.appendChild&&!f?t:t.parentNode,u&&(a=(t.ownerSVGElement||{}).parentNode),a&&a!==bn&&a.appendChild||(a=bn.body),(s=a._gsap)&&v&&s.width&&p&&s.time===At.time?we(c/s.width*g):((v||"%"===l)&&(d.position=hr(t,"position")),a===t&&(d.position="static"),a.appendChild(wn),o=wn[h],a.removeChild(wn),d.position="absolute",p&&v&&((s=be(a)).time=At.time,s.width=a[h]),we(m?o*c/g:o&&c?g/o*c:0))):(o=u?t.getBBox()[p?"width":"height"]:t[h],we(v?c/o*g:c/100*o)))},Or=function(e,t,n,r){var i;return En||vr(),t in Zn&&"transform"!==t&&~(t=Zn[t]).indexOf(",")&&(t=t.split(",")[0]),Hn[t]&&"transform"!==t?(i=Dr(e,r),i="transformOrigin"!==t?i[t]:Ur(hr(e,pr))+" "+i.zOrigin+"px"):(!(i=e.style[t])||"auto"===i||r||~(i+"").indexOf("calc("))&&(i=Lr[t]&&Lr[t](e,t,n)||hr(e,t)||Se(e,t)||("opacity"===t?1:0)),n&&!~(i+"").trim().indexOf(" ")?Tr(e,t,i,n)+n:i},xr=function(e,t,n,r){if(!n||"none"===n){var i=mr(t,e,1),o=i&&hr(e,i,1);o&&o!==n?(t=i,n=o):"borderColor"===t&&(n=hr(e,"borderTopColor"))}var a,s,u,c,l,d,p,f,h,g,m,v,y=new hn(this._pt,e.style,t,0,1,un),_=0,b=0;if(y.b=n,y.e=r,n+="","auto"===(r+="")&&(e.style[t]=r,r=hr(e,t)||r,e.style[t]=n),Rt(a=[n,r]),r=a[1],u=(n=a[0]).match(Q)||[],(r.match(Q)||[]).length){for(;s=Q.exec(r);)p=s[0],h=r.substring(_,s.index),l?l=(l+1)%5:"rgba("!==h.substr(-5)&&"hsla("!==h.substr(-5)||(l=1),p!==(d=u[b++]||"")&&(c=parseFloat(d)||0,m=d.substr((c+"").length),(v="="===p.charAt(1)?+(p.charAt(0)+"1"):0)&&(p=p.substr(2)),f=parseFloat(p),g=p.substr((f+"").length),_=Q.lastIndex-g.length,g||(g=g||C.units[t]||m,_===r.length&&(r+=g,y.e+=g)),m!==g&&(c=Tr(e,t,d,g)||0),y._pt={_next:y._pt,p:h||1===b?h:",",s:c,c:v?v*f:f-c,m:l&&l<4||"zIndex"===t?Math.round:0});y.c=_<r.length?r.substring(_,r.length):""}else y.r="display"===t&&"none"===r?ir:rr;return te.test(r)&&(y.e=0),this._pt=y,y},Rr={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Ar=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n,r,i,o=t.t,a=o.style,s=t.u,u=o._gsap;if("all"===s||!0===s)a.cssText="",r=1;else for(i=(s=s.split(",")).length;--i>-1;)n=s[i],Hn[n]&&(r=1,n="transformOrigin"===n?pr:dr),Er(o,n);r&&(Er(o,dr),u&&(u.svg&&o.removeAttribute("transform"),Dr(o,1),u.uncache=1))}},Lr={clearProps:function(e,t,n,r,i){if("isFromStart"!==i.data){var o=e._pt=new hn(e._pt,t,n,0,0,Ar);return o.u=r,o.pr=-10,o.tween=i,e._props.push(n),1}}},Cr=[1,0,0,1,0,0],Nr={},Mr=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},Pr=function(e){var t=hr(e,dr);return Mr(t)?Cr:t.substr(7).match(Z).map(we)},$r=function(e,t){var n,r,i,o,a=e._gsap||be(e),s=e.style,u=Pr(e);return a.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(u=[(i=e.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?Cr:u:(u!==Cr||e.offsetParent||e===Sn||a.svg||(i=s.display,s.display="block",(n=e.parentNode)&&e.offsetParent||(o=1,r=e.nextSibling,Sn.appendChild(e)),u=Pr(e),i?s.display=i:Er(e,"display"),o&&(r?n.insertBefore(e,r):n?n.appendChild(e):Sn.removeChild(e))),t&&u.length>6?[u[0],u[1],u[4],u[5],u[12],u[13]]:u)},kr=function(e,t,n,r,i,o){var a,s,u,c=e._gsap,l=i||$r(e,!0),d=c.xOrigin||0,p=c.yOrigin||0,f=c.xOffset||0,h=c.yOffset||0,g=l[0],m=l[1],v=l[2],y=l[3],_=l[4],b=l[5],S=t.split(" "),E=parseFloat(S[0])||0,w=parseFloat(S[1])||0;n?l!==Cr&&(s=g*y-m*v)&&(u=E*(-m/s)+w*(g/s)-(g*b-m*_)/s,E=E*(y/s)+w*(-v/s)+(v*b-y*_)/s,w=u):(E=(a=br(e)).x+(~S[0].indexOf("%")?E/100*a.width:E),w=a.y+(~(S[1]||S[0]).indexOf("%")?w/100*a.height:w)),r||!1!==r&&c.smooth?(_=E-d,b=w-p,c.xOffset=f+(_*g+b*v)-_,c.yOffset=h+(_*m+b*y)-b):c.xOffset=c.yOffset=0,c.xOrigin=E,c.yOrigin=w,c.smooth=!!r,c.origin=t,c.originIsAbsolute=!!n,e.style[pr]="0px 0px",o&&(wr(o,c,"xOrigin",d,E),wr(o,c,"yOrigin",p,w),wr(o,c,"xOffset",f,c.xOffset),wr(o,c,"yOffset",h,c.yOffset)),e.setAttribute("data-svg-origin",E+" "+w)},Dr=function(e,t){var n=e._gsap||new qt(e);if("x"in n&&!t&&!n.uncache)return n;var r,i,o,a,s,u,c,l,d,p,f,h,g,m,v,y,_,b,S,E,w,I,T,O,x,R,A,L,N,M,P,$,k=e.style,D=n.scaleX<0,U="px",j="deg",B=hr(e,pr)||"0";return r=i=o=u=c=l=d=p=f=0,a=s=1,n.svg=!(!e.getCTM||!Sr(e)),m=$r(e,n.svg),n.svg&&(O=!n.uncache&&e.getAttribute("data-svg-origin"),kr(e,O||B,!!O||n.originIsAbsolute,!1!==n.smooth,m)),h=n.xOrigin||0,g=n.yOrigin||0,m!==Cr&&(b=m[0],S=m[1],E=m[2],w=m[3],r=I=m[4],i=T=m[5],6===m.length?(a=Math.sqrt(b*b+S*S),s=Math.sqrt(w*w+E*E),u=b||S?Jn(S,b)*zn:0,(d=E||w?Jn(E,w)*zn+u:0)&&(s*=Math.cos(d*Wn)),n.svg&&(r-=h-(h*b+g*E),i-=g-(h*S+g*w))):($=m[6],M=m[7],A=m[8],L=m[9],N=m[10],P=m[11],r=m[12],i=m[13],o=m[14],c=(v=Jn($,N))*zn,v&&(O=I*(y=Math.cos(-v))+A*(_=Math.sin(-v)),x=T*y+L*_,R=$*y+N*_,A=I*-_+A*y,L=T*-_+L*y,N=$*-_+N*y,P=M*-_+P*y,I=O,T=x,$=R),l=(v=Jn(-E,N))*zn,v&&(y=Math.cos(-v),P=w*(_=Math.sin(-v))+P*y,b=O=b*y-A*_,S=x=S*y-L*_,E=R=E*y-N*_),u=(v=Jn(S,b))*zn,v&&(O=b*(y=Math.cos(v))+S*(_=Math.sin(v)),x=I*y+T*_,S=S*y-b*_,T=T*y-I*_,b=O,I=x),c&&Math.abs(c)+Math.abs(u)>359.9&&(c=u=0,l=180-l),a=we(Math.sqrt(b*b+S*S+E*E)),s=we(Math.sqrt(T*T+$*$)),v=Jn(I,T),d=Math.abs(v)>2e-4?v*zn:0,f=P?1/(P<0?-P:P):0),n.svg&&(O=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!Mr(hr(e,dr)),O&&e.setAttribute("transform",O))),Math.abs(d)>90&&Math.abs(d)<270&&(D?(a*=-1,d+=u<=0?180:-180,u+=u<=0?180:-180):(s*=-1,d+=d<=0?180:-180)),n.x=r-((n.xPercent=r&&(n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-r)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+U,n.y=i-((n.yPercent=i&&(n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-i)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+U,n.z=o+U,n.scaleX=we(a),n.scaleY=we(s),n.rotation=we(u)+j,n.rotationX=we(c)+j,n.rotationY=we(l)+j,n.skewX=d+j,n.skewY=p+j,n.transformPerspective=f+U,(n.zOrigin=parseFloat(B.split(" ")[2])||0)&&(k[pr]=Ur(B)),n.xOffset=n.yOffset=0,n.force3D=C.force3D,n.renderTransform=n.svg?Hr:On?Vr:Br,n.uncache=0,n},Ur=function(e){return(e=e.split(" "))[0]+" "+e[1]},jr=function(e,t,n){var r=rt(t);return we(parseFloat(t)+parseFloat(Tr(e,"x",n+"px",r)))+r},Br=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Vr(e,t)},Fr="0deg",qr="0px",Gr=") ",Vr=function(e,t){var n=t||this,r=n.xPercent,i=n.yPercent,o=n.x,a=n.y,s=n.z,u=n.rotation,c=n.rotationY,l=n.rotationX,d=n.skewX,p=n.skewY,f=n.scaleX,h=n.scaleY,g=n.transformPerspective,m=n.force3D,v=n.target,y=n.zOrigin,_="",b="auto"===m&&e&&1!==e||!0===m;if(y&&(l!==Fr||c!==Fr)){var S,E=parseFloat(c)*Wn,w=Math.sin(E),I=Math.cos(E);E=parseFloat(l)*Wn,S=Math.cos(E),o=jr(v,o,w*S*-y),a=jr(v,a,-Math.sin(E)*-y),s=jr(v,s,I*S*-y+y)}g!==qr&&(_+="perspective("+g+Gr),(r||i)&&(_+="translate("+r+"%, "+i+"%) "),(b||o!==qr||a!==qr||s!==qr)&&(_+=s!==qr||b?"translate3d("+o+", "+a+", "+s+") ":"translate("+o+", "+a+Gr),u!==Fr&&(_+="rotate("+u+Gr),c!==Fr&&(_+="rotateY("+c+Gr),l!==Fr&&(_+="rotateX("+l+Gr),d===Fr&&p===Fr||(_+="skew("+d+", "+p+Gr),1===f&&1===h||(_+="scale("+f+", "+h+Gr),v.style[dr]=_||"translate(0, 0)"},Hr=function(e,t){var n,r,i,o,a,s=t||this,u=s.xPercent,c=s.yPercent,l=s.x,d=s.y,p=s.rotation,f=s.skewX,h=s.skewY,g=s.scaleX,m=s.scaleY,v=s.target,y=s.xOrigin,_=s.yOrigin,b=s.xOffset,S=s.yOffset,E=s.forceCSS,w=parseFloat(l),I=parseFloat(d);p=parseFloat(p),f=parseFloat(f),(h=parseFloat(h))&&(f+=h=parseFloat(h),p+=h),p||f?(p*=Wn,f*=Wn,n=Math.cos(p)*g,r=Math.sin(p)*g,i=Math.sin(p-f)*-m,o=Math.cos(p-f)*m,f&&(h*=Wn,a=Math.tan(f-h),i*=a=Math.sqrt(1+a*a),o*=a,h&&(a=Math.tan(h),n*=a=Math.sqrt(1+a*a),r*=a)),n=we(n),r=we(r),i=we(i),o=we(o)):(n=g,o=m,r=i=0),(w&&!~(l+"").indexOf("px")||I&&!~(d+"").indexOf("px"))&&(w=Tr(v,"x",l,"px"),I=Tr(v,"y",d,"px")),(y||_||b||S)&&(w=we(w+y-(y*n+_*i)+b),I=we(I+_-(y*r+_*o)+S)),(u||c)&&(a=v.getBBox(),w=we(w+u/100*a.width),I=we(I+c/100*a.height)),a="matrix("+n+","+r+","+i+","+o+","+w+","+I+")",v.setAttribute("transform",a),E&&(v.style[dr]=a)},zr=function(e,t,n,r,i,o){var a,s,u=360,c=F(i),l=parseFloat(i)*(c&&~i.indexOf("rad")?zn:1),d=o?l*o:l-r,p=r+d+"deg";return c&&("short"===(a=i.split("_")[1])&&(d%=u)!==d%180&&(d+=d<0?u:-360),"cw"===a&&d<0?d=(d+36e9)%u-~~(d/u)*u:"ccw"===a&&d>0&&(d=(d-36e9)%u-~~(d/u)*u)),e._pt=s=new hn(e._pt,t,n,r,d,er),s.e=p,s.u="deg",e._props.push(n),s},Wr=function(e,t,n){var r,i,o,a,s,u,c,l=In.style,d=n._gsap;for(i in l.cssText=getComputedStyle(n).cssText+";position:absolute;display:block;",l[dr]=t,bn.body.appendChild(In),r=Dr(In,1),Hn)(o=d[i])!==(a=r[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(s=rt(o)!==(c=rt(a))?Tr(n,i,o,c):parseFloat(o),u=parseFloat(a),e._pt=new hn(e._pt,d,i,s,u-s,Qn),e._pt.u=c||0,e._props.push(i));bn.body.removeChild(In)};Ee("padding,margin,Width,Radius",(function(e,t){var n="Top",r="Right",i="Bottom",o="Left",a=(t<3?[n,r,i,o]:[n+o,n+r,i+r,i+o]).map((function(n){return t<2?e+n:"border"+n+e}));Lr[t>1?"border"+e:e]=function(e,t,n,r,i){var o,s;if(arguments.length<4)return o=a.map((function(t){return Or(e,t,n)})),5===(s=o.join(" ")).split(o[0]).length?o[0]:s;o=(r+"").split(" "),s={},a.forEach((function(e,t){return s[e]=o[t]=o[t]||o[(t-1)/2|0]})),e.init(t,s,i)}}));var Jr,Yr,Kr,Xr={name:"css",register:vr,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,r,i){var o,a,s,u,c,l,d,p,f,h,g,m,v,y,_,b,S,E,w,I=this._props,T=e.style,O=n.vars.startAt;for(d in En||vr(),t)if("autoRound"!==d&&(a=t[d],!he[d]||!Jt(d,t,n,r,e,i)))if(c=typeof a,l=Lr[d],"function"===c&&(c=typeof(a=a.call(n,r,e,i))),"string"===c&&~a.indexOf("random(")&&(a=ht(a)),l)l(this,e,d,a,n)&&(_=1);else if("--"===d.substr(0,2))o=(getComputedStyle(e).getPropertyValue(d)+"").trim(),a+="",p=rt(o),(f=rt(a))?p!==f&&(o=Tr(e,d,o,f)+f):p&&(a+=p),this.add(T,"setProperty",o,a,r,i,0,0,d);else if("undefined"!==c){if(O&&d in O?(o="function"==typeof O[d]?O[d].call(n,r,e,i):O[d],d in C.units&&!rt(o)&&(o+=C.units[d]),"="===(o+"").charAt(1)&&(o=Or(e,d))):o=Or(e,d),u=parseFloat(o),(h="string"===c&&"="===a.charAt(1)?+(a.charAt(0)+"1"):0)&&(a=a.substr(2)),s=parseFloat(a),d in Zn&&("autoAlpha"===d&&(1===u&&"hidden"===Or(e,"visibility")&&s&&(u=0),wr(this,T,"visibility",u?"inherit":"hidden",s?"inherit":"hidden",!s)),"scale"!==d&&"transform"!==d&&~(d=Zn[d]).indexOf(",")&&(d=d.split(",")[0])),g=d in Hn)if(m||((v=e._gsap).renderTransform&&!t.parseTransform||Dr(e,t.parseTransform),y=!1!==t.smoothOrigin&&v.smooth,(m=this._pt=new hn(this._pt,T,dr,0,1,v.renderTransform,v,0,-1)).dep=1),"scale"===d)this._pt=new hn(this._pt,v,"scaleY",v.scaleY,h?h*s:s-v.scaleY),I.push("scaleY",d),d+="X";else{if("transformOrigin"===d){S=void 0,E=void 0,w=void 0,S=(b=a).split(" "),E=S[0],w=S[1]||"50%","top"!==E&&"bottom"!==E&&"left"!==w&&"right"!==w||(b=E,E=w,w=b),S[0]=Rr[E]||E,S[1]=Rr[w]||w,a=S.join(" "),v.svg?kr(e,a,0,y,0,this):((f=parseFloat(a.split(" ")[2])||0)!==v.zOrigin&&wr(this,v,"zOrigin",v.zOrigin,f),wr(this,T,d,Ur(o),Ur(a)));continue}if("svgOrigin"===d){kr(e,a,1,y,0,this);continue}if(d in Nr){zr(this,v,d,u,a,h);continue}if("smoothOrigin"===d){wr(this,v,"smooth",v.smooth,a);continue}if("force3D"===d){v[d]=a;continue}if("transform"===d){Wr(this,a,e);continue}}else d in T||(d=mr(d)||d);if(g||(s||0===s)&&(u||0===u)&&!Xn.test(a)&&d in T)s||(s=0),(p=(o+"").substr((u+"").length))!==(f=rt(a)||(d in C.units?C.units[d]:p))&&(u=Tr(e,d,o,f)),this._pt=new hn(this._pt,g?v:T,d,u,h?h*s:s-u,g||"px"!==f&&"zIndex"!==d||!1===t.autoRound?Qn:nr),this._pt.u=f||0,p!==f&&(this._pt.b=o,this._pt.r=tr);else if(d in T)xr.call(this,e,d,o,a);else{if(!(d in e)){se(d,a);continue}this.add(e,d,e[d],a,r,i)}I.push(d)}_&&fn(this)},get:Or,aliases:Zn,getSetter:function(e,t,n){var r=Zn[t];return r&&r.indexOf(",")<0&&(t=r),t in Hn&&t!==pr&&(e._gsap.x||Or(e,"x"))?n&&Tn===n?"scale"===t?ur:sr:(Tn=n||{})&&("scale"===t?cr:lr):e.style&&!V(e.style[t])?or:~t.indexOf("-")?ar:on(e,t)},core:{_removeProperty:Er,_getMatrix:$r}};yn.utils.checkPrefix=mr,Kr=Ee((Jr="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(Yr="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(e){Hn[e]=1})),Ee(Yr,(function(e){C.units[e]="deg",Nr[e]=1})),Zn[Kr[13]]=Jr+","+Yr,Ee("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(e){var t=e.split(":");Zn[t[1]]=Kr[t[0]]})),Ee("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(e){C.units[e]="px"})),yn.registerPlugin(Xr);var Zr=yn.registerPlugin(Xr)||yn,Qr=Zr.core.Tween;e.Back=jn,e.Bounce=Fn,e.CSSPlugin=Xr,e.Circ=Vn,e.Cubic=Pn,e.Elastic=Un,e.Expo=Gn,e.Linear=Nn,e.Power0=xn,e.Power1=Rn,e.Power2=An,e.Power3=Ln,e.Power4=Cn,e.Quad=Mn,e.Quart=$n,e.Quint=kn,e.Sine=qn,e.SteppedEase=Bn,e.Strong=Dn,e.TimelineLite=Vt,e.TimelineMax=Vt,e.TweenLite=Qt,e.TweenMax=Qr,e.default=Zr,e.gsap=Zr,"undefined"==typeof window||window!==e?Object.defineProperty(e,"__esModule",{value:!0}):delete window.default})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).THREE={})}(this,(function(e){"use strict";void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t});var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,o=Object.create(i.prototype),a=new R(r||[]);return o._invoke=function(e,t,n){var r=d;return function(i,o){if(r===f)throw new Error("Generator is already running");if(r===h){if("throw"===i)throw o;return L()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var u=l(e,t,n);if("normal"===u.type){if(r=n.done?h:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=h,n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d="suspendedStart",p="suspendedYield",f="executing",h="completed",g={};function m(){}function v(){}function y(){}var _={};_[o]=function(){return this};var b=Object.getPrototypeOf,S=b&&b(b(A([])));S&&S!==n&&r.call(S,o)&&(_=S);var E=y.prototype=m.prototype=Object.create(_);function w(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(i,o,a,s){var u=l(e[i],e,o);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function T(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function A(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:L}}function L(){return{value:t,done:!0}}return v.prototype=E.constructor=y,y.constructor=v,v.displayName=u(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,u(e,s,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},w(I.prototype),I.prototype[a]=function(){return this},e.AsyncIterator=I,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new I(c(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(E),u(E,s,"Generator"),E[o]=function(){return this},E.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;x(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}("object"==typeof module?module.exports:{});try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}var n="125dev",r=100,i=300,o=301,a=302,s=303,u=304,c=306,l=307,d=1e3,p=1001,f=1002,h=1003,g=1004,m=1005,v=1006,y=1007,_=1008,b=1009,S=1012,E=1014,w=1015,I=1016,T=1020,O=1022,x=1023,R=1026,A=1027,L=33776,C=33777,N=33778,M=33779,P=35840,$=35841,k=35842,D=35843,U=37492,j=37496,B=2300,F=2301,q=2302,G=2400,V=2401,H=2402,z=2500,W=2501,J=3e3,Y=3001,K=3007,X=3002,Z=3004,Q=3005,ee=3006,te=7680,ne=35044,re=35048,ie="300 es";function oe(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function se(e,t,n){return t&&ae(e.prototype,t),n&&ae(e,n),e}function ue(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function de(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?le(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function pe(){}Object.assign(pe.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});for(var fe=[],he=0;he<256;he++)fe[he]=(he<16?"0":"")+he.toString(16);var ge,me=1234567,ve={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(fe[255&e]+fe[e>>8&255]+fe[e>>16&255]+fe[e>>24&255]+"-"+fe[255&t]+fe[t>>8&255]+"-"+fe[t>>16&15|64]+fe[t>>24&255]+"-"+fe[63&n|128]+fe[n>>8&255]+"-"+fe[n>>16&255]+fe[n>>24&255]+fe[255&r]+fe[r>>8&255]+fe[r>>16&255]+fe[r>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},damp:function(e,t,n,r){return ve.lerp(e,t,1-Math.exp(-n*r))},pingpong:function(e,t){return void 0===t&&(t=1),t-Math.abs(ve.euclideanModulo(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(me=e%2147483647),((me=16807*me%2147483647)-1)/2147483646},degToRad:function(e){return e*ve.DEG2RAD},radToDeg:function(e){return e*ve.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){var o=Math.cos,a=Math.sin,s=o(n/2),u=a(n/2),c=o((t+r)/2),l=a((t+r)/2),d=o((t-r)/2),p=a((t-r)/2),f=o((r-t)/2),h=a((r-t)/2);switch(i){case"XYX":e.set(s*l,u*d,u*p,s*c);break;case"YZY":e.set(u*p,s*l,u*d,s*c);break;case"ZXZ":e.set(u*d,u*p,s*l,s*c);break;case"XZX":e.set(s*l,u*h,u*f,s*c);break;case"YXY":e.set(u*f,s*l,u*h,s*c);break;case"ZYZ":e.set(u*h,u*f,s*l,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}},ye=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=e,this.y=t}var t=e.prototype;return t.set=function(e,t){return this.x=e,this.y=t,this},t.setScalar=function(e){return this.x=e,this.y=e,this},t.setX=function(e){return this.x=e,this},t.setY=function(e){return this.y=e,this},t.setComponent=function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},t.getComponent=function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},t.clone=function(){return new this.constructor(this.x,this.y)},t.copy=function(e){return this.x=e.x,this.y=e.y,this},t.add=function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},t.addScalar=function(e){return this.x+=e,this.y+=e,this},t.addVectors=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},t.addScaledVector=function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},t.sub=function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},t.subScalar=function(e){return this.x-=e,this.y-=e,this},t.subVectors=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},t.multiply=function(e){return this.x*=e.x,this.y*=e.y,this},t.multiplyScalar=function(e){return this.x*=e,this.y*=e,this},t.divide=function(e){return this.x/=e.x,this.y/=e.y,this},t.divideScalar=function(e){return this.multiplyScalar(1/e)},t.applyMatrix3=function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},t.min=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},t.max=function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},t.clamp=function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},t.clampScalar=function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},t.clampLength=function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.dot=function(e){return this.x*e.x+this.y*e.y},t.cross=function(e){return this.x*e.y-this.y*e.x},t.lengthSq=function(){return this.x*this.x+this.y*this.y},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.angle=function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e},t.distanceTo=function(e){return Math.sqrt(this.distanceToSquared(e))},t.distanceToSquared=function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},t.manhattanDistanceTo=function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},t.setLength=function(e){return this.normalize().multiplyScalar(e)},t.lerp=function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},t.lerpVectors=function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this},t.equals=function(e){return e.x===this.x&&e.y===this.y},t.fromArray=function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},t.fromBufferAttribute=function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},t.rotateAround=function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this},se(e,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}}]),e}(),_e=function(){function e(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var t=e.prototype;return t.set=function(e,t,n,r,i,o,a,s,u){var c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=i,c[5]=s,c[6]=n,c[7]=o,c[8]=u,this},t.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},t.clone=function(){return(new this.constructor).fromArray(this.elements)},t.copy=function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},t.extractBasis=function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},t.setFromMatrix4=function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},t.multiply=function(e){return this.multiplyMatrices(this,e)},t.premultiply=function(e){return this.multiplyMatrices(e,this)},t.multiplyMatrices=function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],c=n[4],l=n[7],d=n[2],p=n[5],f=n[8],h=r[0],g=r[3],m=r[6],v=r[1],y=r[4],_=r[7],b=r[2],S=r[5],E=r[8];return i[0]=o*h+a*v+s*b,i[3]=o*g+a*y+s*S,i[6]=o*m+a*_+s*E,i[1]=u*h+c*v+l*b,i[4]=u*g+c*y+l*S,i[7]=u*m+c*_+l*E,i[2]=d*h+p*v+f*b,i[5]=d*g+p*y+f*S,i[8]=d*m+p*_+f*E,this},t.multiplyScalar=function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},t.determinant=function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8];return t*o*c-t*a*u-n*i*c+n*a*s+r*i*u-r*o*s},t.invert=function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=c*o-a*u,d=a*s-c*i,p=u*i-o*s,f=t*l+n*d+r*p;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);var h=1/f;return e[0]=l*h,e[1]=(r*u-c*n)*h,e[2]=(a*n-r*o)*h,e[3]=d*h,e[4]=(c*t-r*s)*h,e[5]=(r*i-a*t)*h,e[6]=p*h,e[7]=(n*s-u*t)*h,e[8]=(o*t-n*i)*h,this},t.transpose=function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},t.getNormalMatrix=function(e){return this.setFromMatrix4(e).copy(this).invert().transpose()},t.transposeIntoArray=function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},t.setUvTransform=function(e,t,n,r,i,o,a){var s=Math.cos(i),u=Math.sin(i);return this.set(n*s,n*u,-n*(s*o+u*a)+o+e,-r*u,r*s,-r*(-u*o+s*a)+a+t,0,0,1),this},t.scale=function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},t.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],u=r[4],c=r[7];return r[0]=t*i+n*s,r[3]=t*o+n*u,r[6]=t*a+n*c,r[1]=-n*i+t*s,r[4]=-n*o+t*u,r[7]=-n*a+t*c,this},t.translate=function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},t.equals=function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},t.fromArray=function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},t.toArray=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e},e}(),be={getDataURL:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===ge&&(ge=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),ge.width=e.width,ge.height=e.height;var n=ge.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ge}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},Se=0;function Ee(e,t,n,r,i,o,a,s,u,c){void 0===e&&(e=Ee.DEFAULT_IMAGE),void 0===t&&(t=Ee.DEFAULT_MAPPING),void 0===n&&(n=p),void 0===r&&(r=p),void 0===i&&(i=v),void 0===o&&(o=_),void 0===a&&(a=x),void 0===s&&(s=b),void 0===u&&(u=1),void 0===c&&(c=J),Object.defineProperty(this,"id",{value:Se++}),this.uuid=ve.generateUUID(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=s,this.offset=new ye(0,0),this.repeat=new ye(1,1),this.center=new ye(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new _e,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.version=0,this.onUpdate=null}function we(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?be.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Ee.DEFAULT_IMAGE=void 0,Ee.DEFAULT_MAPPING=i,Ee.prototype=Object.assign(Object.create(pe.prototype),{constructor:Ee,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=ve.generateUUID()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)r[o].isDataTexture?i.push(we(r[o].image)):i.push(we(r[o]))}else i=we(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==i)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case d:e.x=e.x-Math.floor(e.x);break;case p:e.x=e.x<0?0:1;break;case f:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case d:e.y=e.y-Math.floor(e.y);break;case p:e.y=e.y<0?0:1;break;case f:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Ee.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});var Ie=function(){function e(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=e,this.y=t,this.z=n,this.w=r}var t=e.prototype;return t.set=function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},t.setScalar=function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},t.setX=function(e){return this.x=e,this},t.setY=function(e){return this.y=e,this},t.setZ=function(e){return this.z=e,this},t.setW=function(e){return this.w=e,this},t.setComponent=function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},t.getComponent=function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},t.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},t.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},t.add=function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},t.addScalar=function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},t.addVectors=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},t.addScaledVector=function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},t.sub=function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},t.subScalar=function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},t.subVectors=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},t.multiply=function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this},t.multiplyScalar=function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},t.applyMatrix4=function(e){var t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this},t.divideScalar=function(e){return this.multiplyScalar(1/e)},t.setAxisAngleFromQuaternion=function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},t.setAxisAngleFromRotationMatrix=function(e){var t,n,r,i,o=.01,a=.1,s=e.elements,u=s[0],c=s[4],l=s[8],d=s[1],p=s[5],f=s[9],h=s[2],g=s[6],m=s[10];if(Math.abs(c-d)<o&&Math.abs(l-h)<o&&Math.abs(f-g)<o){if(Math.abs(c+d)<a&&Math.abs(l+h)<a&&Math.abs(f+g)<a&&Math.abs(u+p+m-3)<a)return this.set(1,0,0,0),this;t=Math.PI;var v=(u+1)/2,y=(p+1)/2,_=(m+1)/2,b=(c+d)/4,S=(l+h)/4,E=(f+g)/4;return v>y&&v>_?v<o?(n=0,r=.707106781,i=.707106781):(r=b/(n=Math.sqrt(v)),i=S/n):y>_?y<o?(n=.707106781,r=0,i=.707106781):(n=b/(r=Math.sqrt(y)),i=E/r):_<o?(n=.707106781,r=.707106781,i=0):(n=S/(i=Math.sqrt(_)),r=E/i),this.set(n,r,i,t),this}var w=Math.sqrt((g-f)*(g-f)+(l-h)*(l-h)+(d-c)*(d-c));return Math.abs(w)<.001&&(w=1),this.x=(g-f)/w,this.y=(l-h)/w,this.z=(d-c)/w,this.w=Math.acos((u+p+m-1)/2),this},t.min=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},t.max=function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},t.clamp=function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},t.clampScalar=function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},t.clampLength=function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},t.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.setLength=function(e){return this.normalize().multiplyScalar(e)},t.lerp=function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},t.lerpVectors=function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this},t.equals=function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},t.fromArray=function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},t.fromBufferAttribute=function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},se(e,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}}]),e}(),Te=function(e){function t(t,n,r){var i;return i=e.call(this)||this,Object.defineProperty(ce(i),"isWebGLRenderTarget",{value:!0}),i.width=t,i.height=n,i.scissor=new Ie(0,0,t,n),i.scissorTest=!1,i.viewport=new Ie(0,0,t,n),r=r||{},i.texture=new Ee(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),i.texture.image={},i.texture.image.width=t,i.texture.image.height=n,i.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,i.texture.minFilter=void 0!==r.minFilter?r.minFilter:v,i.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,i.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,i.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,i}ue(t,e);var n=t.prototype;return n.setSize=function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},n.clone=function(){return(new this.constructor).copy(this)},n.copy=function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},n.dispose=function(){this.dispatchEvent({type:"dispose"})},t}(pe),Oe=function(e){function t(t,n,r){var i;return i=e.call(this,t,n,r)||this,Object.defineProperty(ce(i),"isWebGLMultisampleRenderTarget",{value:!0}),i.samples=4,i}return ue(t,e),t.prototype.copy=function(t){return e.prototype.copy.call(this,t),this.samples=t.samples,this},t}(Te),xe=function(){function e(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=e,this._y=t,this._z=n,this._w=r}e.slerp=function(e,t,n,r){return n.copy(e).slerp(t,r)},e.slerpFlat=function(e,t,n,r,i,o,a){var s=n[r+0],u=n[r+1],c=n[r+2],l=n[r+3],d=i[o+0],p=i[o+1],f=i[o+2],h=i[o+3];if(l!==h||s!==d||u!==p||c!==f){var g=1-a,m=s*d+u*p+c*f+l*h,v=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){var _=Math.sqrt(y),b=Math.atan2(_,m*v);g=Math.sin(g*b)/_,a=Math.sin(a*b)/_}var S=a*v;if(s=s*g+d*S,u=u*g+p*S,c=c*g+f*S,l=l*g+h*S,g===1-a){var E=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=E,u*=E,c*=E,l*=E}}e[t]=s,e[t+1]=u,e[t+2]=c,e[t+3]=l},e.multiplyQuaternionsFlat=function(e,t,n,r,i,o){var a=n[r],s=n[r+1],u=n[r+2],c=n[r+3],l=i[o],d=i[o+1],p=i[o+2],f=i[o+3];return e[t]=a*f+c*l+s*p-u*d,e[t+1]=s*f+c*d+u*l-a*p,e[t+2]=u*f+c*p+a*d-s*l,e[t+3]=c*f-a*l-s*d-u*p,e};var t=e.prototype;return t.set=function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this},t.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},t.copy=function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},t.setFromEuler=function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,o=e._order,a=Math.cos,s=Math.sin,u=a(n/2),c=a(r/2),l=a(i/2),d=s(n/2),p=s(r/2),f=s(i/2);switch(o){case"XYZ":this._x=d*c*l+u*p*f,this._y=u*p*l-d*c*f,this._z=u*c*f+d*p*l,this._w=u*c*l-d*p*f;break;case"YXZ":this._x=d*c*l+u*p*f,this._y=u*p*l-d*c*f,this._z=u*c*f-d*p*l,this._w=u*c*l+d*p*f;break;case"ZXY":this._x=d*c*l-u*p*f,this._y=u*p*l+d*c*f,this._z=u*c*f+d*p*l,this._w=u*c*l-d*p*f;break;case"ZYX":this._x=d*c*l-u*p*f,this._y=u*p*l+d*c*f,this._z=u*c*f-d*p*l,this._w=u*c*l+d*p*f;break;case"YZX":this._x=d*c*l+u*p*f,this._y=u*p*l+d*c*f,this._z=u*c*f-d*p*l,this._w=u*c*l-d*p*f;break;case"XZY":this._x=d*c*l-u*p*f,this._y=u*p*l-d*c*f,this._z=u*c*f+d*p*l,this._w=u*c*l+d*p*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this},t.setFromAxisAngle=function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},t.setFromRotationMatrix=function(e){var t=e.elements,n=t[0],r=t[4],i=t[8],o=t[1],a=t[5],s=t[9],u=t[2],c=t[6],l=t[10],d=n+a+l;if(d>0){var p=.5/Math.sqrt(d+1);this._w=.25/p,this._x=(c-s)*p,this._y=(i-u)*p,this._z=(o-r)*p}else if(n>a&&n>l){var f=2*Math.sqrt(1+n-a-l);this._w=(c-s)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(i+u)/f}else if(a>l){var h=2*Math.sqrt(1+a-n-l);this._w=(i-u)/h,this._x=(r+o)/h,this._y=.25*h,this._z=(s+c)/h}else{var g=2*Math.sqrt(1+l-n-a);this._w=(o-r)/g,this._x=(i+u)/g,this._y=(s+c)/g,this._z=.25*g}return this._onChangeCallback(),this},t.setFromUnitVectors=function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()},t.angleTo=function(e){return 2*Math.acos(Math.abs(ve.clamp(this.dot(e),-1,1)))},t.rotateTowards=function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this},t.identity=function(){return this.set(0,0,0,1)},t.invert=function(){return this.conjugate()},t.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},t.dot=function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},t.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},t.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},t.normalize=function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},t.multiply=function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},t.premultiply=function(e){return this.multiplyQuaternions(e,this)},t.multiplyQuaternions=function(e,t){var n=e._x,r=e._y,i=e._z,o=e._w,a=t._x,s=t._y,u=t._z,c=t._w;return this._x=n*c+o*a+r*u-i*s,this._y=r*c+o*s+i*a-n*u,this._z=i*c+o*u+n*s-r*a,this._w=o*c-n*a-r*s-i*u,this._onChangeCallback(),this},t.slerp=function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var u=1-t;return this._w=u*o+t*this._w,this._x=u*n+t*this._x,this._y=u*r+t*this._y,this._z=u*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),l=Math.atan2(c,a),d=Math.sin((1-t)*l)/c,p=Math.sin(t*l)/c;return this._w=o*d+this._w*p,this._x=n*d+this._x*p,this._y=r*d+this._y*p,this._z=i*d+this._z*p,this._onChangeCallback(),this},t.equals=function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},t.fromArray=function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},t.fromBufferAttribute=function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this},t._onChange=function(e){return this._onChangeCallback=e,this},t._onChangeCallback=function(){},se(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}]),e}(),Re=function(){function e(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=e,this.y=t,this.z=n}var t=e.prototype;return t.set=function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this},t.setScalar=function(e){return this.x=e,this.y=e,this.z=e,this},t.setX=function(e){return this.x=e,this},t.setY=function(e){return this.y=e,this},t.setZ=function(e){return this.z=e,this},t.setComponent=function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},t.getComponent=function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},t.clone=function(){return new this.constructor(this.x,this.y,this.z)},t.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},t.add=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},t.addScalar=function(e){return this.x+=e,this.y+=e,this.z+=e,this},t.addVectors=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},t.addScaledVector=function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},t.sub=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},t.subScalar=function(e){return this.x-=e,this.y-=e,this.z-=e,this},t.subVectors=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},t.multiply=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},t.multiplyScalar=function(e){return this.x*=e,this.y*=e,this.z*=e,this},t.multiplyVectors=function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},t.applyEuler=function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Le.setFromEuler(e))},t.applyAxisAngle=function(e,t){return this.applyQuaternion(Le.setFromAxisAngle(e,t))},t.applyMatrix3=function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},t.applyNormalMatrix=function(e){return this.applyMatrix3(e).normalize()},t.applyMatrix4=function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this},t.applyQuaternion=function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,u=s*t+o*r-a*n,c=s*n+a*t-i*r,l=s*r+i*n-o*t,d=-i*t-o*n-a*r;return this.x=u*s+d*-i+c*-a-l*-o,this.y=c*s+d*-o+l*-i-u*-a,this.z=l*s+d*-a+u*-o-c*-i,this},t.project=function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},t.unproject=function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},t.transformDirection=function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},t.divide=function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},t.divideScalar=function(e){return this.multiplyScalar(1/e)},t.min=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},t.max=function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},t.clamp=function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},t.clampScalar=function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},t.clampLength=function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},t.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.setLength=function(e){return this.normalize().multiplyScalar(e)},t.lerp=function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},t.lerpVectors=function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this},t.cross=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},t.crossVectors=function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},t.projectOnVector=function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)},t.projectOnPlane=function(e){return Ae.copy(this).projectOnVector(e),this.sub(Ae)},t.reflect=function(e){return this.sub(Ae.copy(e).multiplyScalar(2*this.dot(e)))},t.angleTo=function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(ve.clamp(n,-1,1))},t.distanceTo=function(e){return Math.sqrt(this.distanceToSquared(e))},t.distanceToSquared=function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},t.manhattanDistanceTo=function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},t.setFromSpherical=function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},t.setFromSphericalCoords=function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},t.setFromCylindrical=function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},t.setFromCylindricalCoords=function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},t.setFromMatrixPosition=function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},t.setFromMatrixScale=function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},t.setFromMatrixColumn=function(e,t){return this.fromArray(e.elements,4*t)},t.setFromMatrix3Column=function(e,t){return this.fromArray(e.elements,3*t)},t.equals=function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},t.fromArray=function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},t.fromBufferAttribute=function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},e}(),Ae=new Re,Le=new xe,Ce=function(){function e(e,t){Object.defineProperty(this,"isBox3",{value:!0}),this.min=void 0!==e?e:new Re(1/0,1/0,1/0),this.max=void 0!==t?t:new Re(-1/0,-1/0,-1/0)}var t=e.prototype;return t.set=function(e,t){return this.min.copy(e),this.max.copy(t),this},t.setFromArray=function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=e.length;s<u;s+=3){var c=e[s],l=e[s+1],d=e[s+2];c<t&&(t=c),l<n&&(n=l),d<r&&(r=d),c>i&&(i=c),l>o&&(o=l),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(i,o,a),this},t.setFromBufferAttribute=function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=e.count;s<u;s++){var c=e.getX(s),l=e.getY(s),d=e.getZ(s);c<t&&(t=c),l<n&&(n=l),d<r&&(r=d),c>i&&(i=c),l>o&&(o=l),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(i,o,a),this},t.setFromPoints=function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},t.setFromCenterAndSize=function(e,t){var n=Pe.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},t.setFromObject=function(e){return this.makeEmpty(),this.expandByObject(e)},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.min.copy(e.min),this.max.copy(e.max),this},t.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},t.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},t.getCenter=function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Re),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},t.getSize=function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Re),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},t.expandByPoint=function(e){return this.min.min(e),this.max.max(e),this},t.expandByVector=function(e){return this.min.sub(e),this.max.add(e),this},t.expandByScalar=function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},t.expandByObject=function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),$e.copy(t.boundingBox),$e.applyMatrix4(e.matrixWorld),this.union($e));for(var n=e.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},t.containsPoint=function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},t.containsBox=function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},t.getParameter=function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Re),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},t.intersectsBox=function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},t.intersectsSphere=function(e){return this.clampPoint(e.center,Pe),Pe.distanceToSquared(e.center)<=e.radius*e.radius},t.intersectsPlane=function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},t.intersectsTriangle=function(e){if(this.isEmpty())return!1;this.getCenter(qe),Ge.subVectors(this.max,qe),ke.subVectors(e.a,qe),De.subVectors(e.b,qe),Ue.subVectors(e.c,qe),je.subVectors(De,ke),Be.subVectors(Ue,De),Fe.subVectors(ke,Ue);var t=[0,-je.z,je.y,0,-Be.z,Be.y,0,-Fe.z,Fe.y,je.z,0,-je.x,Be.z,0,-Be.x,Fe.z,0,-Fe.x,-je.y,je.x,0,-Be.y,Be.x,0,-Fe.y,Fe.x,0];return!!Ne(t,ke,De,Ue,Ge)&&(!!Ne(t=[1,0,0,0,1,0,0,0,1],ke,De,Ue,Ge)&&(Ve.crossVectors(je,Be),Ne(t=[Ve.x,Ve.y,Ve.z],ke,De,Ue,Ge)))},t.clampPoint=function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Re),t.copy(e).clamp(this.min,this.max)},t.distanceToPoint=function(e){return Pe.copy(e).clamp(this.min,this.max).sub(e).length()},t.getBoundingSphere=function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Pe).length(),e},t.intersect=function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},t.union=function(e){return this.min.min(e.min),this.max.max(e.max),this},t.applyMatrix4=function(e){return this.isEmpty()||(Me[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Me[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Me[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Me[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Me[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Me[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Me[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Me[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Me)),this},t.translate=function(e){return this.min.add(e),this.max.add(e),this},t.equals=function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},e}();function Ne(e,t,n,r,i){for(var o=0,a=e.length-3;o<=a;o+=3){He.fromArray(e,o);var s=i.x*Math.abs(He.x)+i.y*Math.abs(He.y)+i.z*Math.abs(He.z),u=t.dot(He),c=n.dot(He),l=r.dot(He);if(Math.max(-Math.max(u,c,l),Math.min(u,c,l))>s)return!1}return!0}var Me=[new Re,new Re,new Re,new Re,new Re,new Re,new Re,new Re],Pe=new Re,$e=new Ce,ke=new Re,De=new Re,Ue=new Re,je=new Re,Be=new Re,Fe=new Re,qe=new Re,Ge=new Re,Ve=new Re,He=new Re,ze=new Ce,We=function(){function e(e,t){this.center=void 0!==e?e:new Re,this.radius=void 0!==t?t:-1}var t=e.prototype;return t.set=function(e,t){return this.center.copy(e),this.radius=t,this},t.setFromPoints=function(e,t){var n=this.center;void 0!==t?n.copy(t):ze.setFromPoints(e).getCenter(n);for(var r=0,i=0,o=e.length;i<o;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.center.copy(e.center),this.radius=e.radius,this},t.isEmpty=function(){return this.radius<0},t.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},t.containsPoint=function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},t.distanceToPoint=function(e){return e.distanceTo(this.center)-this.radius},t.intersectsSphere=function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},t.intersectsBox=function(e){return e.intersectsSphere(this)},t.intersectsPlane=function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},t.clampPoint=function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Re),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},t.getBoundingBox=function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Ce),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)},t.applyMatrix4=function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},t.translate=function(e){return this.center.add(e),this},t.equals=function(e){return e.center.equals(this.center)&&e.radius===this.radius},e}(),Je=new Re,Ye=new Re,Ke=new Re,Xe=new Re,Ze=new Re,Qe=new Re,et=new Re,tt=function(){function e(e,t){this.origin=void 0!==e?e:new Re,this.direction=void 0!==t?t:new Re(0,0,-1)}var t=e.prototype;return t.set=function(e,t){return this.origin.copy(e),this.direction.copy(t),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},t.at=function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Re),t.copy(this.direction).multiplyScalar(e).add(this.origin)},t.lookAt=function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},t.recast=function(e){return this.origin.copy(this.at(e,Je)),this},t.closestPointToPoint=function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Re),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},t.distanceToPoint=function(e){return Math.sqrt(this.distanceSqToPoint(e))},t.distanceSqToPoint=function(e){var t=Je.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Je.copy(this.direction).multiplyScalar(t).add(this.origin),Je.distanceToSquared(e))},t.distanceSqToSegment=function(e,t,n,r){Ye.copy(e).add(t).multiplyScalar(.5),Ke.copy(t).sub(e).normalize(),Xe.copy(this.origin).sub(Ye);var i,o,a,s,u=.5*e.distanceTo(t),c=-this.direction.dot(Ke),l=Xe.dot(this.direction),d=-Xe.dot(Ke),p=Xe.lengthSq(),f=Math.abs(1-c*c);if(f>0)if(o=c*l-d,s=u*f,(i=c*d-l)>=0)if(o>=-s)if(o<=s){var h=1/f;a=(i*=h)*(i+c*(o*=h)+2*l)+o*(c*i+o+2*d)+p}else o=u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*d)+p;else o=-u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*d)+p;else o<=-s?a=-(i=Math.max(0,-(-c*u+l)))*i+(o=i>0?-u:Math.min(Math.max(-u,-d),u))*(o+2*d)+p:o<=s?(i=0,a=(o=Math.min(Math.max(-u,-d),u))*(o+2*d)+p):a=-(i=Math.max(0,-(c*u+l)))*i+(o=i>0?u:Math.min(Math.max(-u,-d),u))*(o+2*d)+p;else o=c>0?-u:u,a=-(i=Math.max(0,-(c*o+l)))*i+o*(o+2*d)+p;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(Ke).multiplyScalar(o).add(Ye),a},t.intersectSphere=function(e,t){Je.subVectors(e.center,this.origin);var n=Je.dot(this.direction),r=Je.dot(Je)-n*n,i=e.radius*e.radius;if(r>i)return null;var o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,t):this.at(a,t)},t.intersectsSphere=function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},t.distanceToPlane=function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},t.intersectPlane=function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},t.intersectsPlane=function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},t.intersectBox=function(e,t){var n,r,i,o,a,s,u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,d=this.origin;return u>=0?(n=(e.min.x-d.x)*u,r=(e.max.x-d.x)*u):(n=(e.max.x-d.x)*u,r=(e.min.x-d.x)*u),c>=0?(i=(e.min.y-d.y)*c,o=(e.max.y-d.y)*c):(i=(e.max.y-d.y)*c,o=(e.min.y-d.y)*c),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),l>=0?(a=(e.min.z-d.z)*l,s=(e.max.z-d.z)*l):(a=(e.max.z-d.z)*l,s=(e.min.z-d.z)*l),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))},t.intersectsBox=function(e){return null!==this.intersectBox(e,Je)},t.intersectTriangle=function(e,t,n,r,i){Ze.subVectors(t,e),Qe.subVectors(n,e),et.crossVectors(Ze,Qe);var o,a=this.direction.dot(et);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Xe.subVectors(this.origin,e);var s=o*this.direction.dot(Qe.crossVectors(Xe,Qe));if(s<0)return null;var u=o*this.direction.dot(Ze.cross(Xe));if(u<0)return null;if(s+u>a)return null;var c=-o*Xe.dot(et);return c<0?null:this.at(c/a,i)},t.applyMatrix4=function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},t.equals=function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},e}(),nt=function(){function e(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var t=e.prototype;return t.set=function(e,t,n,r,i,o,a,s,u,c,l,d,p,f,h,g){var m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=i,m[5]=o,m[9]=a,m[13]=s,m[2]=u,m[6]=c,m[10]=l,m[14]=d,m[3]=p,m[7]=f,m[11]=h,m[15]=g,this},t.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},t.clone=function(){return(new e).fromArray(this.elements)},t.copy=function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},t.copyPosition=function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},t.setFromMatrix3=function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this},t.extractBasis=function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},t.makeBasis=function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},t.extractRotation=function(e){var t=this.elements,n=e.elements,r=1/rt.setFromMatrixColumn(e,0).length(),i=1/rt.setFromMatrixColumn(e,1).length(),o=1/rt.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},t.makeRotationFromEuler=function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),u=Math.sin(r),c=Math.cos(i),l=Math.sin(i);if("XYZ"===e.order){var d=o*c,p=o*l,f=a*c,h=a*l;t[0]=s*c,t[4]=-s*l,t[8]=u,t[1]=p+f*u,t[5]=d-h*u,t[9]=-a*s,t[2]=h-d*u,t[6]=f+p*u,t[10]=o*s}else if("YXZ"===e.order){var g=s*c,m=s*l,v=u*c,y=u*l;t[0]=g+y*a,t[4]=v*a-m,t[8]=o*u,t[1]=o*l,t[5]=o*c,t[9]=-a,t[2]=m*a-v,t[6]=y+g*a,t[10]=o*s}else if("ZXY"===e.order){var _=s*c,b=s*l,S=u*c,E=u*l;t[0]=_-E*a,t[4]=-o*l,t[8]=S+b*a,t[1]=b+S*a,t[5]=o*c,t[9]=E-_*a,t[2]=-o*u,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){var w=o*c,I=o*l,T=a*c,O=a*l;t[0]=s*c,t[4]=T*u-I,t[8]=w*u+O,t[1]=s*l,t[5]=O*u+w,t[9]=I*u-T,t[2]=-u,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var x=o*s,R=o*u,A=a*s,L=a*u;t[0]=s*c,t[4]=L-x*l,t[8]=A*l+R,t[1]=l,t[5]=o*c,t[9]=-a*c,t[2]=-u*c,t[6]=R*l+A,t[10]=x-L*l}else if("XZY"===e.order){var C=o*s,N=o*u,M=a*s,P=a*u;t[0]=s*c,t[4]=-l,t[8]=u*c,t[1]=C*l+P,t[5]=o*c,t[9]=N*l-M,t[2]=M*l-N,t[6]=a*c,t[10]=P*l+C}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},t.makeRotationFromQuaternion=function(e){return this.compose(ot,e,at)},t.lookAt=function(e,t,n){var r=this.elements;return ct.subVectors(e,t),0===ct.lengthSq()&&(ct.z=1),ct.normalize(),st.crossVectors(n,ct),0===st.lengthSq()&&(1===Math.abs(n.z)?ct.x+=1e-4:ct.z+=1e-4,ct.normalize(),st.crossVectors(n,ct)),st.normalize(),ut.crossVectors(ct,st),r[0]=st.x,r[4]=ut.x,r[8]=ct.x,r[1]=st.y,r[5]=ut.y,r[9]=ct.y,r[2]=st.z,r[6]=ut.z,r[10]=ct.z,this},t.multiply=function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},t.premultiply=function(e){return this.multiplyMatrices(e,this)},t.multiplyMatrices=function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],c=n[1],l=n[5],d=n[9],p=n[13],f=n[2],h=n[6],g=n[10],m=n[14],v=n[3],y=n[7],_=n[11],b=n[15],S=r[0],E=r[4],w=r[8],I=r[12],T=r[1],O=r[5],x=r[9],R=r[13],A=r[2],L=r[6],C=r[10],N=r[14],M=r[3],P=r[7],$=r[11],k=r[15];return i[0]=o*S+a*T+s*A+u*M,i[4]=o*E+a*O+s*L+u*P,i[8]=o*w+a*x+s*C+u*$,i[12]=o*I+a*R+s*N+u*k,i[1]=c*S+l*T+d*A+p*M,i[5]=c*E+l*O+d*L+p*P,i[9]=c*w+l*x+d*C+p*$,i[13]=c*I+l*R+d*N+p*k,i[2]=f*S+h*T+g*A+m*M,i[6]=f*E+h*O+g*L+m*P,i[10]=f*w+h*x+g*C+m*$,i[14]=f*I+h*R+g*N+m*k,i[3]=v*S+y*T+_*A+b*M,i[7]=v*E+y*O+_*L+b*P,i[11]=v*w+y*x+_*C+b*$,i[15]=v*I+y*R+_*N+b*k,this},t.multiplyScalar=function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},t.determinant=function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],u=e[13],c=e[2],l=e[6],d=e[10],p=e[14];return e[3]*(+i*s*l-r*u*l-i*a*d+n*u*d+r*a*p-n*s*p)+e[7]*(+t*s*p-t*u*d+i*o*d-r*o*p+r*u*c-i*s*c)+e[11]*(+t*u*l-t*a*p-i*o*l+n*o*p+i*a*c-n*u*c)+e[15]*(-r*a*c-t*s*l+t*a*d+r*o*l-n*o*d+n*s*c)},t.transpose=function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},t.setPosition=function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this},t.invert=function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],d=e[10],p=e[11],f=e[12],h=e[13],g=e[14],m=e[15],v=l*g*u-h*d*u+h*s*p-a*g*p-l*s*m+a*d*m,y=f*d*u-c*g*u-f*s*p+o*g*p+c*s*m-o*d*m,_=c*h*u-f*l*u+f*a*p-o*h*p-c*a*m+o*l*m,b=f*l*s-c*h*s-f*a*d+o*h*d+c*a*g-o*l*g,S=t*v+n*y+r*_+i*b;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var E=1/S;return e[0]=v*E,e[1]=(h*d*i-l*g*i-h*r*p+n*g*p+l*r*m-n*d*m)*E,e[2]=(a*g*i-h*s*i+h*r*u-n*g*u-a*r*m+n*s*m)*E,e[3]=(l*s*i-a*d*i-l*r*u+n*d*u+a*r*p-n*s*p)*E,e[4]=y*E,e[5]=(c*g*i-f*d*i+f*r*p-t*g*p-c*r*m+t*d*m)*E,e[6]=(f*s*i-o*g*i-f*r*u+t*g*u+o*r*m-t*s*m)*E,e[7]=(o*d*i-c*s*i+c*r*u-t*d*u-o*r*p+t*s*p)*E,e[8]=_*E,e[9]=(f*l*i-c*h*i-f*n*p+t*h*p+c*n*m-t*l*m)*E,e[10]=(o*h*i-f*a*i+f*n*u-t*h*u-o*n*m+t*a*m)*E,e[11]=(c*a*i-o*l*i-c*n*u+t*l*u+o*n*p-t*a*p)*E,e[12]=b*E,e[13]=(c*h*r-f*l*r+f*n*d-t*h*d-c*n*g+t*l*g)*E,e[14]=(f*a*r-o*h*r-f*n*s+t*h*s+o*n*g-t*a*g)*E,e[15]=(o*l*r-c*a*r+c*n*s-t*l*s-o*n*d+t*a*d)*E,this},t.scale=function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},t.getMaxScaleOnAxis=function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},t.makeTranslation=function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},t.makeRotationX=function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},t.makeRotationY=function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},t.makeRotationZ=function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},t.makeRotationAxis=function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,a=e.y,s=e.z,u=i*o,c=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,c*a+n,c*s-r*o,0,u*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this},t.makeScale=function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},t.makeShear=function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},t.compose=function(e,t,n){var r=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,u=i+i,c=o+o,l=a+a,d=i*u,p=i*c,f=i*l,h=o*c,g=o*l,m=a*l,v=s*u,y=s*c,_=s*l,b=n.x,S=n.y,E=n.z;return r[0]=(1-(h+m))*b,r[1]=(p+_)*b,r[2]=(f-y)*b,r[3]=0,r[4]=(p-_)*S,r[5]=(1-(d+m))*S,r[6]=(g+v)*S,r[7]=0,r[8]=(f+y)*E,r[9]=(g-v)*E,r[10]=(1-(d+h))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},t.decompose=function(e,t,n){var r=this.elements,i=rt.set(r[0],r[1],r[2]).length(),o=rt.set(r[4],r[5],r[6]).length(),a=rt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],it.copy(this);var s=1/i,u=1/o,c=1/a;return it.elements[0]*=s,it.elements[1]*=s,it.elements[2]*=s,it.elements[4]*=u,it.elements[5]*=u,it.elements[6]*=u,it.elements[8]*=c,it.elements[9]*=c,it.elements[10]*=c,t.setFromRotationMatrix(it),n.x=i,n.y=o,n.z=a,this},t.makePerspective=function(e,t,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),u=2*i/(n-r),c=(t+e)/(t-e),l=(n+r)/(n-r),d=-(o+i)/(o-i),p=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},t.makeOrthographic=function(e,t,n,r,i,o){var a=this.elements,s=1/(t-e),u=1/(n-r),c=1/(o-i),l=(t+e)*s,d=(n+r)*u,p=(o+i)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},t.equals=function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},t.fromArray=function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},t.toArray=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e},e}(),rt=new Re,it=new nt,ot=new Re(0,0,0),at=new Re(1,1,1),st=new Re,ut=new Re,ct=new Re,lt=function(){function e(t,n,r,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=e.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=t,this._y=n,this._z=r,this._order=i}var t=e.prototype;return t.set=function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},t.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},t.copy=function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},t.setFromRotationMatrix=function(e,t,n){var r=ve.clamp,i=e.elements,o=i[0],a=i[4],s=i[8],u=i[1],c=i[5],l=i[9],d=i[2],p=i[6],f=i[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(p,c),this._z=0);break;case"YXZ":this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(s,f),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(r(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(u,o));break;case"ZYX":this._y=Math.asin(-r(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(p,f),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(s,f));break;case"XZY":this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(p,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this},t.setFromQuaternion=function(e,t,n){return dt.makeRotationFromQuaternion(e),this.setFromRotationMatrix(dt,t,n)},t.setFromVector3=function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},t.reorder=function(e){return pt.setFromEuler(this),this.setFromQuaternion(pt,e)},t.equals=function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},t.fromArray=function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},t.toVector3=function(e){return e?e.set(this._x,this._y,this._z):new Re(this._x,this._y,this._z)},t._onChange=function(e){return this._onChangeCallback=e,this},t._onChangeCallback=function(){},se(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}]),e}();lt.DefaultOrder="XYZ",lt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var dt=new nt,pt=new xe,ft=function(){function e(){this.mask=1}var t=e.prototype;return t.set=function(e){this.mask=1<<e|0},t.enable=function(e){this.mask|=1<<e|0},t.enableAll=function(){this.mask=-1},t.toggle=function(e){this.mask^=1<<e|0},t.disable=function(e){this.mask&=~(1<<e|0)},t.disableAll=function(){this.mask=0},t.test=function(e){return 0!=(this.mask&e.mask)},e}(),ht=0,gt=new Re,mt=new xe,vt=new nt,yt=new Re,_t=new Re,bt=new Re,St=new xe,Et=new Re(1,0,0),wt=new Re(0,1,0),It=new Re(0,0,1),Tt={type:"added"},Ot={type:"removed"};function xt(){Object.defineProperty(this,"id",{value:ht++}),this.uuid=ve.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=xt.DefaultUp.clone();var e=new Re,t=new lt,n=new xe,r=new Re(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new nt},normalMatrix:{value:new _e}}),this.matrix=new nt,this.matrixWorld=new nt,this.matrixAutoUpdate=xt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ft,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}xt.DefaultUp=new Re(0,1,0),xt.DefaultMatrixAutoUpdate=!0,xt.prototype=Object.assign(Object.create(pe.prototype),{constructor:xt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return mt.setFromAxisAngle(e,t),this.quaternion.multiply(mt),this},rotateOnWorldAxis:function(e,t){return mt.setFromAxisAngle(e,t),this.quaternion.premultiply(mt),this},rotateX:function(e){return this.rotateOnAxis(Et,e)},rotateY:function(e){return this.rotateOnAxis(wt,e)},rotateZ:function(e){return this.rotateOnAxis(It,e)},translateOnAxis:function(e,t){return gt.copy(e).applyQuaternion(this.quaternion),this.position.add(gt.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(Et,e)},translateY:function(e){return this.translateOnAxis(wt,e)},translateZ:function(e){return this.translateOnAxis(It,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(vt.copy(this.matrixWorld).invert())},lookAt:function(e,t,n){e.isVector3?yt.copy(e):yt.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),_t.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?vt.lookAt(_t,yt,this.up):vt.lookAt(yt,_t,this.up),this.quaternion.setFromRotationMatrix(vt),r&&(vt.extractRotation(r.matrixWorld),mt.setFromRotationMatrix(vt),this.quaternion.premultiply(mt.invert()))},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Tt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Ot)),this},clear:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(Ot)}return this.children.length=0,this},attach:function(e){return this.updateWorldMatrix(!0,!1),vt.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),vt.multiply(e.parent.matrixWorld)),e.applyMatrix4(vt),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Re),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new xe),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_t,e,bt),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new Re),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_t,St,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Re),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,u=a.length;s<u;s++){var c=a[s];i(e.shapes,c)}else i(e.shapes,a)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var l=[],d=0,p=this.material.length;d<p;d++)l.push(i(e.materials,this.material[d]));r.material=l}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(var f=0;f<this.children.length;f++)r.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var h=0;h<this.animations.length;h++){var g=this.animations[h];r.animations.push(i(e.animations,g))}}if(t){var m=w(e.geometries),v=w(e.materials),y=w(e.textures),_=w(e.images),b=w(e.shapes),S=w(e.skeletons),E=w(e.animations);m.length>0&&(n.geometries=m),v.length>0&&(n.materials=v),y.length>0&&(n.textures=y),_.length>0&&(n.images=_),b.length>0&&(n.shapes=b),S.length>0&&(n.skeletons=S),E.length>0&&(n.animations=E)}return n.object=r,n;function w(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}});var Rt=new Re,At=new Re,Lt=new _e,Ct=function(){function e(e,t){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=void 0!==e?e:new Re(1,0,0),this.constant=void 0!==t?t:0}var t=e.prototype;return t.set=function(e,t){return this.normal.copy(e),this.constant=t,this},t.setComponents=function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},t.setFromNormalAndCoplanarPoint=function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},t.setFromCoplanarPoints=function(e,t,n){var r=Rt.subVectors(n,t).cross(At.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},t.normalize=function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},t.negate=function(){return this.constant*=-1,this.normal.negate(),this},t.distanceToPoint=function(e){return this.normal.dot(e)+this.constant},t.distanceToSphere=function(e){return this.distanceToPoint(e.center)-e.radius},t.projectPoint=function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Re),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},t.intersectLine=function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new Re);var n=e.delta(Rt),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:t.copy(n).multiplyScalar(i).add(e.start)},t.intersectsLine=function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},t.intersectsBox=function(e){return e.intersectsPlane(this)},t.intersectsSphere=function(e){return e.intersectsPlane(this)},t.coplanarPoint=function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Re),e.copy(this.normal).multiplyScalar(-this.constant)},t.applyMatrix4=function(e,t){var n=t||Lt.getNormalMatrix(e),r=this.coplanarPoint(Rt).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},t.translate=function(e){return this.constant-=e.dot(this.normal),this},t.equals=function(e){return e.normal.equals(this.normal)&&e.constant===this.constant},e}(),Nt=new Re,Mt=new Re,Pt=new Re,$t=new Re,kt=new Re,Dt=new Re,Ut=new Re,jt=new Re,Bt=new Re,Ft=new Re,qt=function(){function e(e,t,n){this.a=void 0!==e?e:new Re,this.b=void 0!==t?t:new Re,this.c=void 0!==n?n:new Re}e.getNormal=function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Re),r.subVectors(n,t),Nt.subVectors(e,t),r.cross(Nt);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},e.getBarycoord=function(e,t,n,r,i){Nt.subVectors(r,t),Mt.subVectors(n,t),Pt.subVectors(e,t);var o=Nt.dot(Nt),a=Nt.dot(Mt),s=Nt.dot(Pt),u=Mt.dot(Mt),c=Mt.dot(Pt),l=o*u-a*a;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Re),0===l)return i.set(-2,-1,-1);var d=1/l,p=(u*s-a*c)*d,f=(o*c-a*s)*d;return i.set(1-p-f,f,p)},e.containsPoint=function(e,t,n,r){return this.getBarycoord(e,t,n,r,$t),$t.x>=0&&$t.y>=0&&$t.x+$t.y<=1},e.getUV=function(e,t,n,r,i,o,a,s){return this.getBarycoord(e,t,n,r,$t),s.set(0,0),s.addScaledVector(i,$t.x),s.addScaledVector(o,$t.y),s.addScaledVector(a,$t.z),s},e.isFrontFacing=function(e,t,n,r){return Nt.subVectors(n,t),Mt.subVectors(e,t),Nt.cross(Mt).dot(r)<0};var t=e.prototype;return t.set=function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},t.setFromPointsAndIndices=function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},t.getArea=function(){return Nt.subVectors(this.c,this.b),Mt.subVectors(this.a,this.b),.5*Nt.cross(Mt).length()},t.getMidpoint=function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Re),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},t.getNormal=function(t){return e.getNormal(this.a,this.b,this.c,t)},t.getPlane=function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Ct),e.setFromCoplanarPoints(this.a,this.b,this.c)},t.getBarycoord=function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)},t.getUV=function(t,n,r,i,o){return e.getUV(t,this.a,this.b,this.c,n,r,i,o)},t.containsPoint=function(t){return e.containsPoint(t,this.a,this.b,this.c)},t.isFrontFacing=function(t){return e.isFrontFacing(this.a,this.b,this.c,t)},t.intersectsBox=function(e){return e.intersectsTriangle(this)},t.closestPointToPoint=function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Re);var n,r,i=this.a,o=this.b,a=this.c;kt.subVectors(o,i),Dt.subVectors(a,i),jt.subVectors(e,i);var s=kt.dot(jt),u=Dt.dot(jt);if(s<=0&&u<=0)return t.copy(i);Bt.subVectors(e,o);var c=kt.dot(Bt),l=Dt.dot(Bt);if(c>=0&&l<=c)return t.copy(o);var d=s*l-c*u;if(d<=0&&s>=0&&c<=0)return n=s/(s-c),t.copy(i).addScaledVector(kt,n);Ft.subVectors(e,a);var p=kt.dot(Ft),f=Dt.dot(Ft);if(f>=0&&p<=f)return t.copy(a);var h=p*u-s*f;if(h<=0&&u>=0&&f<=0)return r=u/(u-f),t.copy(i).addScaledVector(Dt,r);var g=c*f-p*l;if(g<=0&&l-c>=0&&p-f>=0)return Ut.subVectors(a,o),r=(l-c)/(l-c+(p-f)),t.copy(o).addScaledVector(Ut,r);var m=1/(g+h+d);return n=h*m,r=d*m,t.copy(i).addScaledVector(kt,n).addScaledVector(Dt,r)},t.equals=function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},e}(),Gt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Vt={h:0,s:0,l:0},Ht={h:0,s:0,l:0};function zt(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Wt(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Jt(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var Yt=function(){function e(e,t,n){return Object.defineProperty(this,"isColor",{value:!0}),void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}var t=e.prototype;return t.set=function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},t.setScalar=function(e){return this.r=e,this.g=e,this.b=e,this},t.setHex=function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},t.setRGB=function(e,t,n){return this.r=e,this.g=t,this.b=n,this},t.setHSL=function(e,t,n){if(e=ve.euclideanModulo(e,1),t=ve.clamp(t,0,1),n=ve.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=zt(i,r,e+1/3),this.g=zt(i,r,e),this.b=zt(i,r,e-1/3)}return this},t.setStyle=function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return t(r[4]),this.setHSL(a,s,u)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){var c=n[1],l=c.length;if(3===l)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},t.setColorName=function(e){var t=Gt[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},t.clone=function(){return new this.constructor(this.r,this.g,this.b)},t.copy=function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},t.copyGammaToLinear=function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},t.copyLinearToGamma=function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},t.convertGammaToLinear=function(e){return this.copyGammaToLinear(this,e),this},t.convertLinearToGamma=function(e){return this.copyLinearToGamma(this,e),this},t.copySRGBToLinear=function(e){return this.r=Wt(e.r),this.g=Wt(e.g),this.b=Wt(e.b),this},t.copyLinearToSRGB=function(e){return this.r=Jt(e.r),this.g=Jt(e.g),this.b=Jt(e.b),this},t.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},t.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},t.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},t.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},t.getHSL=function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),u=(s+a)/2;if(s===a)t=0,n=0;else{var c=a-s;switch(n=u<=.5?c/(a+s):c/(2-a-s),a){case r:t=(i-o)/c+(i<o?6:0);break;case i:t=(o-r)/c+2;break;case o:t=(r-i)/c+4}t/=6}return e.h=t,e.s=n,e.l=u,e},t.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},t.offsetHSL=function(e,t,n){return this.getHSL(Vt),Vt.h+=e,Vt.s+=t,Vt.l+=n,this.setHSL(Vt.h,Vt.s,Vt.l),this},t.add=function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},t.addColors=function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},t.addScalar=function(e){return this.r+=e,this.g+=e,this.b+=e,this},t.sub=function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},t.multiply=function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},t.multiplyScalar=function(e){return this.r*=e,this.g*=e,this.b*=e,this},t.lerp=function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},t.lerpColors=function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this},t.lerpHSL=function(e,t){this.getHSL(Vt),e.getHSL(Ht);var n=ve.lerp(Vt.h,Ht.h,t),r=ve.lerp(Vt.s,Ht.s,t),i=ve.lerp(Vt.l,Ht.l,t);return this.setHSL(n,r,i),this},t.equals=function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},t.fromArray=function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},t.fromBufferAttribute=function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},t.toJSON=function(){return this.getHex()},e}();Yt.NAMES=Gt,Yt.prototype.r=1,Yt.prototype.g=1,Yt.prototype.b=1;var Kt=function(){function e(e,t,n,r,i,o){void 0===o&&(o=0),this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new Re,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new Yt,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=o}var t=e.prototype;return t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(var r=0,i=e.vertexColors.length;r<i;r++)this.vertexColors[r]=e.vertexColors[r].clone();return this},e}(),Xt=0;function Zt(){Object.defineProperty(this,"id",{value:Xt++}),this.uuid=ve.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=r,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=te,this.stencilZFail=te,this.stencilZPass=te,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Qt(e){Zt.call(this),this.type="MeshBasicMaterial",this.color=new Yt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}Zt.prototype=Object.assign(Object.create(pe.prototype),{constructor:Zt,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),o=r(e.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Zt.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Qt.prototype=Object.create(Zt.prototype),Qt.prototype.constructor=Qt,Qt.prototype.isMeshBasicMaterial=!0,Qt.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var en=new Re,tn=new ye;function nn(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=ne,this.updateRange={offset:0,count:-1},this.version=0}function rn(e,t,n){nn.call(this,new Int8Array(e),t,n)}function on(e,t,n){nn.call(this,new Uint8Array(e),t,n)}function an(e,t,n){nn.call(this,new Uint8ClampedArray(e),t,n)}function sn(e,t,n){nn.call(this,new Int16Array(e),t,n)}function un(e,t,n){nn.call(this,new Uint16Array(e),t,n)}function cn(e,t,n){nn.call(this,new Int32Array(e),t,n)}function ln(e,t,n){nn.call(this,new Uint32Array(e),t,n)}function dn(e,t,n){nn.call(this,new Uint16Array(e),t,n)}function pn(e,t,n){nn.call(this,new Float32Array(e),t,n)}function fn(e,t,n){nn.call(this,new Float64Array(e),t,n)}function hn(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Object.defineProperty(nn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(nn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Yt),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new ye),t[n++]=o.x,t[n++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new Re),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Ie),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)tn.fromBufferAttribute(this,t),tn.applyMatrix3(e),this.setXY(t,tn.x,tn.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)en.fromBufferAttribute(this,r),en.applyMatrix3(e),this.setXYZ(r,en.x,en.y,en.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)en.x=this.getX(t),en.y=this.getY(t),en.z=this.getZ(t),en.applyMatrix4(e),this.setXYZ(t,en.x,en.y,en.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)en.x=this.getX(t),en.y=this.getY(t),en.z=this.getZ(t),en.applyNormalMatrix(e),this.setXYZ(t,en.x,en.y,en.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)en.x=this.getX(t),en.y=this.getY(t),en.z=this.getZ(t),en.transformDirection(e),this.setXYZ(t,en.x,en.y,en.z);return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),rn.prototype=Object.create(nn.prototype),rn.prototype.constructor=rn,on.prototype=Object.create(nn.prototype),on.prototype.constructor=on,an.prototype=Object.create(nn.prototype),an.prototype.constructor=an,sn.prototype=Object.create(nn.prototype),sn.prototype.constructor=sn,un.prototype=Object.create(nn.prototype),un.prototype.constructor=un,cn.prototype=Object.create(nn.prototype),cn.prototype.constructor=cn,ln.prototype=Object.create(nn.prototype),ln.prototype.constructor=ln,dn.prototype=Object.create(nn.prototype),dn.prototype.constructor=dn,dn.prototype.isFloat16BufferAttribute=!0,pn.prototype=Object.create(nn.prototype),pn.prototype.constructor=pn,fn.prototype=Object.create(nn.prototype),fn.prototype.constructor=fn;var gn={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function mn(e,t){return new gn[e](t)}var vn=0,yn=new nt,_n=new xt,bn=new Re,Sn=new Ce,En=new Ce,wn=new Re;function In(){Object.defineProperty(this,"id",{value:vn++}),this.uuid=ve.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}In.prototype=Object.assign(Object.create(pe.prototype),{constructor:In,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return Array.isArray(e)?this.index=new(hn(e)>65535?ln:un)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},hasAttribute:function(e){return void 0!==this.attributes[e]},addGroup:function(e,t,n){void 0===n&&(n=0),this.groups.push({start:e,count:t,materialIndex:n})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new _e).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return yn.makeRotationX(e),this.applyMatrix4(yn),this},rotateY:function(e){return yn.makeRotationY(e),this.applyMatrix4(yn),this},rotateZ:function(e){return yn.makeRotationZ(e),this.applyMatrix4(yn),this},translate:function(e,t,n){return yn.makeTranslation(e,t,n),this.applyMatrix4(yn),this},scale:function(e,t,n){return yn.makeScale(e,t,n),this.applyMatrix4(yn),this},lookAt:function(e){return _n.lookAt(e),_n.updateMatrix(),this.applyMatrix4(_n.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(bn).negate(),this.translate(bn.x,bn.y,bn.z),this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new pn(t,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Ce);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Re(-1/0,-1/0,-1/0),new Re(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];Sn.setFromBufferAttribute(i),this.morphTargetsRelative?(wn.addVectors(this.boundingBox.min,Sn.min),this.boundingBox.expandByPoint(wn),wn.addVectors(this.boundingBox.max,Sn.max),this.boundingBox.expandByPoint(wn)):(this.boundingBox.expandByPoint(Sn.min),this.boundingBox.expandByPoint(Sn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new We);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Re,1/0);if(e){var n=this.boundingSphere.center;if(Sn.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var o=t[r];En.setFromBufferAttribute(o),this.morphTargetsRelative?(wn.addVectors(Sn.min,En.min),Sn.expandByPoint(wn),wn.addVectors(Sn.max,En.max),Sn.expandByPoint(wn)):(Sn.expandByPoint(En.min),Sn.expandByPoint(En.max))}Sn.getCenter(n);for(var a=0,s=0,u=e.count;s<u;s++)wn.fromBufferAttribute(e,s),a=Math.max(a,n.distanceToSquared(wn));if(t)for(var c=0,l=t.length;c<l;c++)for(var d=t[c],p=this.morphTargetsRelative,f=0,h=d.count;f<h;f++)wn.fromBufferAttribute(d,f),p&&(bn.fromBufferAttribute(e,f),wn.add(bn)),a=Math.max(a,n.distanceToSquared(wn));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,i=t.normal.array,o=t.uv.array,a=r.length/3;void 0===t.tangent&&this.setAttribute("tangent",new nn(new Float32Array(4*a),4));for(var s=t.tangent.array,u=[],c=[],l=0;l<a;l++)u[l]=new Re,c[l]=new Re;var d=new Re,p=new Re,f=new Re,h=new ye,g=new ye,m=new ye,v=new Re,y=new Re,_=this.groups;0===_.length&&(_=[{start:0,count:n.length}]);for(var b=0,S=_.length;b<S;++b)for(var E=_[b],w=E.start,I=w,T=w+E.count;I<T;I+=3)k(n[I+0],n[I+1],n[I+2]);for(var O=new Re,x=new Re,R=new Re,A=new Re,L=0,C=_.length;L<C;++L)for(var N=_[L],M=N.start,P=M,$=M+N.count;P<$;P+=3)D(n[P+0]),D(n[P+1]),D(n[P+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function k(e,t,n){d.fromArray(r,3*e),p.fromArray(r,3*t),f.fromArray(r,3*n),h.fromArray(o,2*e),g.fromArray(o,2*t),m.fromArray(o,2*n),p.sub(d),f.sub(d),g.sub(h),m.sub(h);var i=1/(g.x*m.y-m.x*g.y);isFinite(i)&&(v.copy(p).multiplyScalar(m.y).addScaledVector(f,-g.y).multiplyScalar(i),y.copy(f).multiplyScalar(g.x).addScaledVector(p,-m.x).multiplyScalar(i),u[e].add(v),u[t].add(v),u[n].add(v),c[e].add(y),c[t].add(y),c[n].add(y))}function D(e){R.fromArray(i,3*e),A.copy(R);var t=u[e];O.copy(t),O.sub(R.multiplyScalar(R.dot(t))).normalize(),x.crossVectors(A,t);var n=x.dot(c[e])<0?-1:1;s[4*e]=O.x,s[4*e+1]=O.y,s[4*e+2]=O.z,s[4*e+3]=n}},computeVertexNormals:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new nn(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var o=new Re,a=new Re,s=new Re,u=new Re,c=new Re,l=new Re,d=new Re,p=new Re;if(e)for(var f=0,h=e.count;f<h;f+=3){var g=e.getX(f+0),m=e.getX(f+1),v=e.getX(f+2);o.fromBufferAttribute(t,g),a.fromBufferAttribute(t,m),s.fromBufferAttribute(t,v),d.subVectors(s,a),p.subVectors(o,a),d.cross(p),u.fromBufferAttribute(n,g),c.fromBufferAttribute(n,m),l.fromBufferAttribute(n,v),u.add(d),c.add(d),l.add(d),n.setXYZ(g,u.x,u.y,u.z),n.setXYZ(m,c.x,c.y,c.z),n.setXYZ(v,l.x,l.y,l.z)}else for(var y=0,_=t.count;y<_;y+=3)o.fromBufferAttribute(t,y+0),a.fromBufferAttribute(t,y+1),s.fromBufferAttribute(t,y+2),d.subVectors(s,a),p.subVectors(o,a),d.cross(p),n.setXYZ(y+0,d.x,d.y,d.z),n.setXYZ(y+1,d.x,d.y,d.z),n.setXYZ(y+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,o=e.attributes[r],a=o.array,s=o.itemSize*t,u=Math.min(a.length,i.length-s),c=0,l=s;c<u;c++,l++)i[l]=a[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)wn.fromBufferAttribute(e,t),wn.normalize(),e.setXYZ(t,wn.x,wn.y,wn.z)},toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=e.normalized,o=new n.constructor(t.length*r),a=0,s=0,u=0,c=t.length;u<c;u++){a=t[u]*r;for(var l=0;l<r;l++)o[s++]=n[a++]}return new nn(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new In,n=this.index.array,r=this.attributes;for(var i in r){var o=e(r[i],n);t.setAttribute(i,o)}var a=this.morphAttributes;for(var s in a){for(var u=[],c=a[s],l=0,d=c.length;l<d;l++){var p=e(c[l],n);u.push(p)}t.morphAttributes[s]=u}t.morphTargetsRelative=this.morphTargetsRelative;for(var f=this.groups,h=0,g=f.length;h<g;h++){var m=f[h];t.addGroup(m.start,m.count,m.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var o in i){var a=i[o],s=a.toJSON(e.data);""!==a.name&&(s.name=a.name),e.data.attributes[o]=s}var u={},c=!1;for(var l in this.morphAttributes){for(var d=this.morphAttributes[l],p=[],f=0,h=d.length;f<h;f++){var g=d[f],m=g.toJSON(e.data);""!==g.name&&(m.name=g.name),p.push(m)}p.length>0&&(u[l]=p,c=!0)}c&&(e.data.morphAttributes=u,e.data.morphTargetsRelative=this.morphTargetsRelative);var v=this.groups;v.length>0&&(e.data.groups=JSON.parse(JSON.stringify(v)));var y=this.boundingSphere;return null!==y&&(e.data.boundingSphere={center:y.center.toArray(),radius:y.radius}),e},clone:function(){return(new In).copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var i in r){var o=r[i];this.setAttribute(i,o.clone(t))}var a=e.morphAttributes;for(var s in a){for(var u=[],c=a[s],l=0,d=c.length;l<d;l++)u.push(c[l].clone(t));this.morphAttributes[s]=u}this.morphTargetsRelative=e.morphTargetsRelative;for(var p=e.groups,f=0,h=p.length;f<h;f++){var g=p[f];this.addGroup(g.start,g.count,g.materialIndex)}var m=e.boundingBox;null!==m&&(this.boundingBox=m.clone());var v=e.boundingSphere;return null!==v&&(this.boundingSphere=v.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Tn=new nt,On=new tt,xn=new We,Rn=new Re,An=new Re,Ln=new Re,Cn=new Re,Nn=new Re,Mn=new Re,Pn=new Re,$n=new Re,kn=new Re,Dn=new ye,Un=new ye,jn=new ye,Bn=new Re,Fn=new Re;function qn(e,t){void 0===e&&(e=new In),void 0===t&&(t=new Qt),xt.call(this),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}function Gn(e,t,n,r,i,o,a,s,u,c,l,d){Rn.fromBufferAttribute(i,c),An.fromBufferAttribute(i,l),Ln.fromBufferAttribute(i,d);var p=e.morphTargetInfluences;if(t.morphTargets&&o&&p){Pn.set(0,0,0),$n.set(0,0,0),kn.set(0,0,0);for(var f=0,h=o.length;f<h;f++){var g=p[f],m=o[f];0!==g&&(Cn.fromBufferAttribute(m,c),Nn.fromBufferAttribute(m,l),Mn.fromBufferAttribute(m,d),a?(Pn.addScaledVector(Cn,g),$n.addScaledVector(Nn,g),kn.addScaledVector(Mn,g)):(Pn.addScaledVector(Cn.sub(Rn),g),$n.addScaledVector(Nn.sub(An),g),kn.addScaledVector(Mn.sub(Ln),g)))}Rn.add(Pn),An.add($n),Ln.add(kn)}e.isSkinnedMesh&&(e.boneTransform(c,Rn),e.boneTransform(l,An),e.boneTransform(d,Ln));var v=function(e,t,n,r,i,o,a,s){if(null===(1===t.side?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,2!==t.side,s)))return null;Fn.copy(s),Fn.applyMatrix4(e.matrixWorld);var u=n.ray.origin.distanceTo(Fn);return u<n.near||u>n.far?null:{distance:u,point:Fn.clone(),object:e}}(e,t,n,r,Rn,An,Ln,Bn);if(v){s&&(Dn.fromBufferAttribute(s,c),Un.fromBufferAttribute(s,l),jn.fromBufferAttribute(s,d),v.uv=qt.getUV(Bn,Rn,An,Ln,Dn,Un,jn,new ye)),u&&(Dn.fromBufferAttribute(u,c),Un.fromBufferAttribute(u,l),jn.fromBufferAttribute(u,d),v.uv2=qt.getUV(Bn,Rn,An,Ln,Dn,Un,jn,new ye));var y=new Kt(c,l,d);qt.getNormal(Rn,An,Ln,y.normal),v.face=y}return v}qn.prototype=Object.assign(Object.create(xt.prototype),{constructor:qn,isMesh:!0,copy:function(e){return xt.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var n,r=this.geometry,i=this.material,o=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),xn.copy(r.boundingSphere),xn.applyMatrix4(o),!1!==e.ray.intersectsSphere(xn)&&(Tn.copy(o).invert(),On.copy(e.ray).applyMatrix4(Tn),null===r.boundingBox||!1!==On.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a=r.index,s=r.attributes.position,u=r.morphAttributes.position,c=r.morphTargetsRelative,l=r.attributes.uv,d=r.attributes.uv2,p=r.groups,f=r.drawRange;if(null!==a)if(Array.isArray(i))for(var h=0,g=p.length;h<g;h++)for(var m=p[h],v=i[m.materialIndex],y=Math.max(m.start,f.start),_=Math.min(m.start+m.count,f.start+f.count);y<_;y+=3){var b=a.getX(y),S=a.getX(y+1),E=a.getX(y+2);(n=Gn(this,v,e,On,s,u,c,l,d,b,S,E))&&(n.faceIndex=Math.floor(y/3),n.face.materialIndex=m.materialIndex,t.push(n))}else for(var w=Math.max(0,f.start),I=Math.min(a.count,f.start+f.count);w<I;w+=3){var T=a.getX(w),O=a.getX(w+1),x=a.getX(w+2);(n=Gn(this,i,e,On,s,u,c,l,d,T,O,x))&&(n.faceIndex=Math.floor(w/3),t.push(n))}else if(void 0!==s)if(Array.isArray(i))for(var R=0,A=p.length;R<A;R++)for(var L=p[R],C=i[L.materialIndex],N=Math.max(L.start,f.start),M=Math.min(L.start+L.count,f.start+f.count);N<M;N+=3){(n=Gn(this,C,e,On,s,u,c,l,d,N,N+1,N+2))&&(n.faceIndex=Math.floor(N/3),n.face.materialIndex=L.materialIndex,t.push(n))}else for(var P=Math.max(0,f.start),$=Math.min(s.count,f.start+f.count);P<$;P+=3){(n=Gn(this,i,e,On,s,u,c,l,d,P,P+1,P+2))&&(n.faceIndex=Math.floor(P/3),t.push(n))}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});var Vn=function(e){function t(t,n,r,i,o,a){var s;void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),void 0===o&&(o=1),void 0===a&&(a=1),(s=e.call(this)||this).type="BoxGeometry",s.parameters={width:t,height:n,depth:r,widthSegments:i,heightSegments:o,depthSegments:a};var u=ce(s);i=Math.floor(i),o=Math.floor(o),a=Math.floor(a);var c=[],l=[],d=[],p=[],f=0,h=0;function g(e,t,n,r,i,o,a,s,g,m,v){for(var y=o/g,_=a/m,b=o/2,S=a/2,E=s/2,w=g+1,I=m+1,T=0,O=0,x=new Re,R=0;R<I;R++)for(var A=R*_-S,L=0;L<w;L++){var C=L*y-b;x[e]=C*r,x[t]=A*i,x[n]=E,l.push(x.x,x.y,x.z),x[e]=0,x[t]=0,x[n]=s>0?1:-1,d.push(x.x,x.y,x.z),p.push(L/g),p.push(1-R/m),T+=1}for(var N=0;N<m;N++)for(var M=0;M<g;M++){var P=f+M+w*N,$=f+M+w*(N+1),k=f+(M+1)+w*(N+1),D=f+(M+1)+w*N;c.push(P,$,D),c.push($,k,D),O+=6}u.addGroup(h,O,v),h+=O,f+=T}return g("z","y","x",-1,-1,r,n,t,a,o,0),g("z","y","x",1,-1,r,n,-t,a,o,1),g("x","z","y",1,1,t,r,n,i,a,2),g("x","z","y",1,-1,t,r,-n,i,a,3),g("x","y","z",1,-1,t,n,r,i,o,4),g("x","y","z",-1,-1,t,n,-r,i,o,5),s.setIndex(c),s.setAttribute("position",new pn(l,3)),s.setAttribute("normal",new pn(d,3)),s.setAttribute("uv",new pn(p,2)),s}return ue(t,e),t}(In);function Hn(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function zn(e){for(var t={},n=0;n<e.length;n++){var r=Hn(e[n]);for(var i in r)t[i]=r[i]}return t}var Wn={clone:Hn,merge:zn};function Jn(e){Zt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Yn(){xt.call(this),this.type="Camera",this.matrixWorldInverse=new nt,this.projectionMatrix=new nt,this.projectionMatrixInverse=new nt}function Kn(e,t,n,r){void 0===e&&(e=50),void 0===t&&(t=1),void 0===n&&(n=.1),void 0===r&&(r=2e3),Yn.call(this),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Jn.prototype=Object.create(Zt.prototype),Jn.prototype.constructor=Jn,Jn.prototype.isShaderMaterial=!0,Jn.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Hn(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this},Jn.prototype.toJSON=function(e){var t=Zt.prototype.toJSON.call(this,e);for(var n in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var i={};for(var o in this.extensions)!0===this.extensions[o]&&(i[o]=!0);return Object.keys(i).length>0&&(t.extensions=i),t},Yn.prototype=Object.assign(Object.create(xt.prototype),{constructor:Yn,isCamera:!0,copy:function(e,t){return xt.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Re),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){xt.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(e,t){xt.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),Kn.prototype=Object.assign(Object.create(Yn.prototype),{constructor:Kn,isPerspectiveCamera:!0,copy:function(e,t){return Yn.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*ve.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*ve.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*ve.RAD2DEG*Math.atan(Math.tan(.5*ve.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*ve.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,t-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var u=this.filmOffset;0!==u&&(i+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(e){var t=xt.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var Xn=90;function Zn(e,t,n){if(xt.call(this),this.type="CubeCamera",!0===n.isWebGLCubeRenderTarget){this.renderTarget=n;var r=new Kn(Xn,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Re(1,0,0)),this.add(r);var i=new Kn(Xn,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Re(-1,0,0)),this.add(i);var o=new Kn(Xn,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new Re(0,1,0)),this.add(o);var a=new Kn(Xn,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new Re(0,-1,0)),this.add(a);var s=new Kn(Xn,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Re(0,0,1)),this.add(s);var u=new Kn(Xn,1,e,t);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new Re(0,0,-1)),this.add(u),this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var c=e.xr.enabled,l=e.getRenderTarget();e.xr.enabled=!1;var d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,s),n.texture.generateMipmaps=d,e.setRenderTarget(n,5),e.render(t,u),e.setRenderTarget(l),e.xr.enabled=c}}else console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.")}function Qn(e,t,n,r,i,a,s,u,c,l){e=void 0!==e?e:[],t=void 0!==t?t:o,s=void 0!==s?s:O,Ee.call(this,e,t,n,r,i,a,s,u,c,l),this.flipY=!1,this._needsFlipEnvMap=!0}Zn.prototype=Object.create(xt.prototype),Zn.prototype.constructor=Zn,Qn.prototype=Object.create(Ee.prototype),Qn.prototype.constructor=Qn,Qn.prototype.isCubeTexture=!0,Object.defineProperty(Qn.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var er=function(e){function t(t,n,r){var i;return Number.isInteger(n)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),n=r),i=e.call(this,t,t,n)||this,Object.defineProperty(ce(i),"isWebGLCubeRenderTarget",{value:!0}),n=n||{},i.texture=new Qn(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),i.texture._needsFlipEnvMap=!1,i}ue(t,e);var n=t.prototype;return n.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=x,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new Vn(5,5,5),a=new Jn({name:"CubemapFromEquirect",uniforms:Hn(n),vertexShader:r,fragmentShader:i,side:1,blending:0});a.uniforms.tEquirect.value=t;var s=new qn(o,a),u=t.minFilter;return t.minFilter===_&&(t.minFilter=v),new Zn(1,10,this).update(e,s),t.minFilter=u,s.geometry.dispose(),s.material.dispose(),this},n.clear=function(e,t,n,r){for(var i=e.getRenderTarget(),o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(i)},t}(Te);function tr(e,t,n,r,i,o,a,s,u,c,l,d){Ee.call(this,null,o,a,s,u,c,r,i,l,d),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=void 0!==u?u:h,this.minFilter=void 0!==c?c:h,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}tr.prototype=Object.create(Ee.prototype),tr.prototype.constructor=tr,tr.prototype.isDataTexture=!0;var nr=new We,rr=new Re,ir=function(){function e(e,t,n,r,i,o){this.planes=[void 0!==e?e:new Ct,void 0!==t?t:new Ct,void 0!==n?n:new Ct,void 0!==r?r:new Ct,void 0!==i?i:new Ct,void 0!==o?o:new Ct]}var t=e.prototype;return t.set=function(e,t,n,r,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},t.setFromProjectionMatrix=function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],d=n[8],p=n[9],f=n[10],h=n[11],g=n[12],m=n[13],v=n[14],y=n[15];return t[0].setComponents(a-r,l-s,h-d,y-g).normalize(),t[1].setComponents(a+r,l+s,h+d,y+g).normalize(),t[2].setComponents(a+i,l+u,h+p,y+m).normalize(),t[3].setComponents(a-i,l-u,h-p,y-m).normalize(),t[4].setComponents(a-o,l-c,h-f,y-v).normalize(),t[5].setComponents(a+o,l+c,h+f,y+v).normalize(),this},t.intersectsObject=function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),nr.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(nr)},t.intersectsSprite=function(e){return nr.center.set(0,0,0),nr.radius=.7071067811865476,nr.applyMatrix4(e.matrixWorld),this.intersectsSphere(nr)},t.intersectsSphere=function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0},t.intersectsBox=function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(rr.x=r.normal.x>0?e.max.x:e.min.x,rr.y=r.normal.y>0?e.max.y:e.min.y,rr.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(rr)<0)return!1}return!0},t.containsPoint=function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0},e}();function or(){var e=null,t=!1,n=null,r=null;function i(t,o){n(t,o),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function ar(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){var o=r.get(t);(!o||o.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var a=r.get(t);void 0===a?r.set(t,function(t,r){var i=t.array,o=t.usage,a=e.createBuffer();e.bindBuffer(r,a),e.bufferData(r,i,o),t.onUploadCallback();var s=5126;return i instanceof Float32Array?s=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?t.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:i instanceof Int16Array?s=5122:i instanceof Uint32Array?s=5125:i instanceof Int32Array?s=5124:i instanceof Int8Array?s=5120:i instanceof Uint8Array&&(s=5121),{buffer:a,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):a.version<t.version&&(!function(t,r,i){var o=r.array,a=r.updateRange;e.bindBuffer(i,t),-1===a.count?e.bufferSubData(i,0,o):(n?e.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):e.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(a.buffer,t,i),a.version=t.version)}}}}var sr=function(e){function t(t,n,r,i){var o;void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),(o=e.call(this)||this).type="PlaneGeometry",o.parameters={width:t,height:n,widthSegments:r,heightSegments:i};for(var a=t/2,s=n/2,u=Math.floor(r),c=Math.floor(i),l=u+1,d=c+1,p=t/u,f=n/c,h=[],g=[],m=[],v=[],y=0;y<d;y++)for(var _=y*f-s,b=0;b<l;b++){var S=b*p-a;g.push(S,-_,0),m.push(0,0,1),v.push(b/u),v.push(1-y/c)}for(var E=0;E<c;E++)for(var w=0;w<u;w++){var I=w+l*E,T=w+l*(E+1),O=w+1+l*(E+1),x=w+1+l*E;h.push(I,T,x),h.push(T,O,x)}return o.setIndex(h),o.setAttribute("position",new pn(g,3)),o.setAttribute("normal",new pn(m,3)),o.setAttribute("uv",new pn(v,2)),o}return ue(t,e),t}(In),ur={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(\t\t0, 1,\t\t0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(\t1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,\t1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,\t1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},cr={common:{diffuse:{value:new Yt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new _e},uv2Transform:{value:new _e},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ye(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Yt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Yt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new _e}},sprite:{diffuse:{value:new Yt(15658734)},opacity:{value:1},center:{value:new ye(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new _e}}},lr={basic:{uniforms:zn([cr.common,cr.specularmap,cr.envmap,cr.aomap,cr.lightmap,cr.fog]),vertexShader:ur.meshbasic_vert,fragmentShader:ur.meshbasic_frag},lambert:{uniforms:zn([cr.common,cr.specularmap,cr.envmap,cr.aomap,cr.lightmap,cr.emissivemap,cr.fog,cr.lights,{emissive:{value:new Yt(0)}}]),vertexShader:ur.meshlambert_vert,fragmentShader:ur.meshlambert_frag},phong:{uniforms:zn([cr.common,cr.specularmap,cr.envmap,cr.aomap,cr.lightmap,cr.emissivemap,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.fog,cr.lights,{emissive:{value:new Yt(0)},specular:{value:new Yt(1118481)},shininess:{value:30}}]),vertexShader:ur.meshphong_vert,fragmentShader:ur.meshphong_frag},standard:{uniforms:zn([cr.common,cr.envmap,cr.aomap,cr.lightmap,cr.emissivemap,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.roughnessmap,cr.metalnessmap,cr.fog,cr.lights,{emissive:{value:new Yt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ur.meshphysical_vert,fragmentShader:ur.meshphysical_frag},toon:{uniforms:zn([cr.common,cr.aomap,cr.lightmap,cr.emissivemap,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.gradientmap,cr.fog,cr.lights,{emissive:{value:new Yt(0)}}]),vertexShader:ur.meshtoon_vert,fragmentShader:ur.meshtoon_frag},matcap:{uniforms:zn([cr.common,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.fog,{matcap:{value:null}}]),vertexShader:ur.meshmatcap_vert,fragmentShader:ur.meshmatcap_frag},points:{uniforms:zn([cr.points,cr.fog]),vertexShader:ur.points_vert,fragmentShader:ur.points_frag},dashed:{uniforms:zn([cr.common,cr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ur.linedashed_vert,fragmentShader:ur.linedashed_frag},depth:{uniforms:zn([cr.common,cr.displacementmap]),vertexShader:ur.depth_vert,fragmentShader:ur.depth_frag},normal:{uniforms:zn([cr.common,cr.bumpmap,cr.normalmap,cr.displacementmap,{opacity:{value:1}}]),vertexShader:ur.normal_vert,fragmentShader:ur.normal_frag},sprite:{uniforms:zn([cr.sprite,cr.fog]),vertexShader:ur.sprite_vert,fragmentShader:ur.sprite_frag},background:{uniforms:{uvTransform:{value:new _e},t2D:{value:null}},vertexShader:ur.background_vert,fragmentShader:ur.background_frag},cube:{uniforms:zn([cr.envmap,{opacity:{value:1}}]),vertexShader:ur.cube_vert,fragmentShader:ur.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ur.equirect_vert,fragmentShader:ur.equirect_frag},distanceRGBA:{uniforms:zn([cr.common,cr.displacementmap,{referencePosition:{value:new Re},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ur.distanceRGBA_vert,fragmentShader:ur.distanceRGBA_frag},shadow:{uniforms:zn([cr.lights,cr.fog,{color:{value:new Yt(0)},opacity:{value:1}}]),vertexShader:ur.shadow_vert,fragmentShader:ur.shadow_frag}};function dr(e,t,n,r,i){var o,a,s=new Yt(0),u=0,l=null,d=0,p=null;function f(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return s},setClearColor:function(e,t){void 0===t&&(t=1),s.set(e),f(s,u=t)},getClearAlpha:function(){return u},setClearAlpha:function(e){f(s,u=e)},render:function(n,i,h,g){var m=!0===i.isScene?i.background:null;m&&m.isTexture&&(m=t.get(m));var v=e.xr,y=v.getSession&&v.getSession();y&&"additive"===y.environmentBlendMode&&(m=null),null===m?f(s,u):m&&m.isColor&&(f(m,1),g=!0),(e.autoClear||g)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),m&&(m.isCubeTexture||m.isWebGLCubeRenderTarget||m.mapping===c)?(void 0===a&&((a=new qn(new Vn(1,1,1),new Jn({name:"BackgroundCubeMaterial",uniforms:Hn(lr.cube.uniforms),vertexShader:lr.cube.vertexShader,fragmentShader:lr.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(a)),m.isWebGLCubeRenderTarget&&(m=m.texture),a.material.uniforms.envMap.value=m,a.material.uniforms.flipEnvMap.value=m.isCubeTexture&&m._needsFlipEnvMap?-1:1,l===m&&d===m.version&&p===e.toneMapping||(a.material.needsUpdate=!0,l=m,d=m.version,p=e.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null)):m&&m.isTexture&&(void 0===o&&((o=new qn(new sr(2,2),new Jn({name:"BackgroundMaterial",uniforms:Hn(lr.background.uniforms),vertexShader:lr.background.vertexShader,fragmentShader:lr.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(o)),o.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),o.material.uniforms.uvTransform.value.copy(m.matrix),l===m&&d===m.version&&p===e.toneMapping||(o.material.needsUpdate=!0,l=m,d=m.version,p=e.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null))}}}function pr(e,t,n,r){var i=e.getParameter(34921),o=r.isWebGL2?null:t.get("OES_vertex_array_object"),a=r.isWebGL2||null!==o,s={},u=p(null),c=u;function l(t){return r.isWebGL2?e.bindVertexArray(t):o.bindVertexArrayOES(t)}function d(t){return r.isWebGL2?e.deleteVertexArray(t):o.deleteVertexArrayOES(t)}function p(e){for(var t=[],n=[],r=[],o=0;o<i;o++)t[o]=0,n[o]=0,r[o]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function f(){for(var e=c.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function h(e){g(e,0)}function g(n,i){var o=c.newAttributes,a=c.enabledAttributes,s=c.attributeDivisors;(o[n]=1,0===a[n]&&(e.enableVertexAttribArray(n),a[n]=1),s[n]!==i)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function m(){for(var t=c.newAttributes,n=c.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function v(t,n,i,o,a,s){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,o,a,s):e.vertexAttribIPointer(t,n,i,a,s)}function y(){_(),c!==u&&l((c=u).object)}function _(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function(i,u,d,y,_){var b=!1;if(a){var S=function(t,n,i){var a=!0===i.wireframe,u=s[t.id];void 0===u&&(u={},s[t.id]=u);var c=u[n.id];void 0===c&&(c={},u[n.id]=c);var l=c[a];void 0===l&&(l=p(r.isWebGL2?e.createVertexArray():o.createVertexArrayOES()),c[a]=l);return l}(y,d,u);c!==S&&l((c=S).object),(b=function(e,t){var n=c.attributes,r=e.attributes,i=0;for(var o in r){var a=n[o],s=r[o];if(void 0===a)return!0;if(a.attribute!==s)return!0;if(a.data!==s.data)return!0;i++}return c.attributesNum!==i||c.index!==t}(y,_))&&function(e,t){var n={},r=e.attributes,i=0;for(var o in r){var a=r[o],s={};s.attribute=a,a.data&&(s.data=a.data),n[o]=s,i++}c.attributes=n,c.attributesNum=i,c.index=t}(y,_)}else{var E=!0===u.wireframe;c.geometry===y.id&&c.program===d.id&&c.wireframe===E||(c.geometry=y.id,c.program=d.id,c.wireframe=E,b=!0)}!0===i.isInstancedMesh&&(b=!0),null!==_&&n.update(_,34963),b&&(!function(i,o,a,s){if(!1===r.isWebGL2&&(i.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();var u=s.attributes,c=a.getAttributes(),l=o.defaultAttributeValues;for(var d in c){var p=c[d];if(p>=0){var y=u[d];if(void 0!==y){var _=y.normalized,b=y.itemSize,S=n.get(y);if(void 0===S)continue;var E=S.buffer,w=S.type,I=S.bytesPerElement;if(y.isInterleavedBufferAttribute){var T=y.data,O=T.stride,x=y.offset;T&&T.isInstancedInterleavedBuffer?(g(p,T.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=T.meshPerAttribute*T.count)):h(p),e.bindBuffer(34962,E),v(p,b,w,_,O*I,x*I)}else y.isInstancedBufferAttribute?(g(p,y.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=y.meshPerAttribute*y.count)):h(p),e.bindBuffer(34962,E),v(p,b,w,_,0,0)}else if("instanceMatrix"===d){var R=n.get(i.instanceMatrix);if(void 0===R)continue;var A=R.buffer,L=R.type;g(p+0,1),g(p+1,1),g(p+2,1),g(p+3,1),e.bindBuffer(34962,A),e.vertexAttribPointer(p+0,4,L,!1,64,0),e.vertexAttribPointer(p+1,4,L,!1,64,16),e.vertexAttribPointer(p+2,4,L,!1,64,32),e.vertexAttribPointer(p+3,4,L,!1,64,48)}else if("instanceColor"===d){var C=n.get(i.instanceColor);if(void 0===C)continue;var N=C.buffer,M=C.type;g(p,1),e.bindBuffer(34962,N),e.vertexAttribPointer(p,3,M,!1,12,0)}else if(void 0!==l){var P=l[d];if(void 0!==P)switch(P.length){case 2:e.vertexAttrib2fv(p,P);break;case 3:e.vertexAttrib3fv(p,P);break;case 4:e.vertexAttrib4fv(p,P);break;default:e.vertexAttrib1fv(p,P)}}}}m()}(i,u,d,y),null!==_&&e.bindBuffer(34963,n.get(_).buffer))},reset:y,resetDefaultState:_,dispose:function(){for(var e in y(),s){var t=s[e];for(var n in t){var r=t[n];for(var i in r)d(r[i].object),delete r[i];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var i in r)d(r[i].object),delete r[i];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var i in r)d(r[i].object),delete r[i];delete n[e.id]}}},initAttributes:f,enableAttribute:h,disableUnusedAttributes:m}}function fr(e,t,n,r){var i,o=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=function(r,a,s){if(0!==s){var u,c;if(o)u=e,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[c](i,r,a,s),n.update(a,i,s)}}}function hr(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var u=!0===n.logarithmicDepthBuffer,c=e.getParameter(34930),l=e.getParameter(35660),d=e.getParameter(3379),p=e.getParameter(34076),f=e.getParameter(34921),h=e.getParameter(36347),g=e.getParameter(36348),m=e.getParameter(36349),v=l>0,y=o||!!t.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=t.get("EXT_texture_filter_anisotropic");return r=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:l,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:h,maxVaryings:g,maxFragmentUniforms:m,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:o?e.getParameter(36183):0}}function gr(e){var t=this,n=null,r=0,i=!1,o=!1,a=new Ct,s=new _e,u={value:null,needsUpdate:!1};function c(){u.value!==n&&(u.value=n,u.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function l(e,n,r,i){var o=null!==e?e.length:0,c=null;if(0!==o){if(c=u.value,!0!==i||null===c){var l=r+4*o,d=n.matrixWorldInverse;s.getNormalMatrix(d),(null===c||c.length<l)&&(c=new Float32Array(l));for(var p=0,f=r;p!==o;++p,f+=4)a.copy(e[p]).applyMatrix4(d,s),a.normal.toArray(c,f),c[f+3]=a.constant}u.value=c,u.needsUpdate=!0}return t.numPlanes=o,t.numIntersection=0,c}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,o){var a=0!==e.length||t||0!==r||i;return i=t,n=l(e,o,0),r=e.length,a},this.beginShadows=function(){o=!0,l(null)},this.endShadows=function(){o=!1,c()},this.setState=function(t,a,s){var d=t.clippingPlanes,p=t.clipIntersection,f=t.clipShadows,h=e.get(t);if(!i||null===d||0===d.length||o&&!f)o?l(null):c();else{var g=o?0:r,m=4*g,v=h.clippingState||null;u.value=v,v=l(d,a,m,s);for(var y=0;y!==m;++y)v[y]=n[y];h.clippingState=v,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=g}}}function mr(e){var t=new WeakMap;function n(e,t){return t===s?e.mapping=o:t===u&&(e.mapping=a),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){var o=i.mapping;if(o===s||o===u){if(t.has(i))return n(t.get(i).texture,i.mapping);var a=i.image;if(a&&a.height>0){var c=e.getRenderList(),l=e.getRenderTarget(),d=new er(a.height/2);return d.fromEquirectangularTexture(e,i),t.set(i,d),e.setRenderTarget(l),e.setRenderList(c),i.addEventListener("dispose",r),n(d.texture,i.mapping)}return null}}return i},dispose:function(){t=new WeakMap}}}function vr(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function yr(e,t,n,r){var i={},o=new WeakMap;function a(e){var s=e.target;for(var u in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[u]);s.removeEventListener("dispose",a),delete i[s.id];var c=o.get(s);c&&(t.remove(c),o.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,i=e.attributes.position,a=0;if(null!==r){var s=r.array;a=r.version;for(var u=0,c=s.length;u<c;u+=3){var l=s[u+0],d=s[u+1],p=s[u+2];n.push(l,d,d,p,p,l)}}else{var f=i.array;a=i.version;for(var h=0,g=f.length/3-1;h<g;h+=3){var m=h+0,v=h+1,y=h+2;n.push(m,v,v,y,y,m)}}var _=new(hn(n)>65535?ln:un)(n,1);_.version=a;var b=o.get(e);b&&t.remove(b),o.set(e,_)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",a),i[t.id]=!0,n.memory.geometries++),t},update:function(e){var n=e.attributes;for(var r in n)t.update(n[r],34962);var i=e.morphAttributes;for(var o in i)for(var a=i[o],s=0,u=a.length;s<u;s++)t.update(a[s],34962)},getWireframeAttribute:function(e){var t=o.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return o.get(e)}}}function _r(e,t,n,r){var i,o,a,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,o,t*a),n.update(r,i,1)},this.renderInstances=function(r,u,c){if(0!==c){var l,d;if(s)l=e,d="drawElementsInstanced";else if(d="drawElementsInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[d](i,u,o,r*a,c),n.update(u,i,c)}}}function br(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Sr(e,t){return e[0]-t[0]}function Er(e,t){return Math.abs(t[1])-Math.abs(e[1])}function wr(e){for(var t={},n=new Float32Array(8),r=[],i=0;i<8;i++)r[i]=[i,0];return{update:function(i,o,a,s){var u=i.morphTargetInfluences,c=void 0===u?0:u.length,l=t[o.id];if(void 0===l){l=[];for(var d=0;d<c;d++)l[d]=[d,0];t[o.id]=l}for(var p=0;p<c;p++){var f=l[p];f[0]=p,f[1]=u[p]}l.sort(Er);for(var h=0;h<8;h++)h<c&&l[h][1]?(r[h][0]=l[h][0],r[h][1]=l[h][1]):(r[h][0]=Number.MAX_SAFE_INTEGER,r[h][1]=0);r.sort(Sr);for(var g=a.morphTargets&&o.morphAttributes.position,m=a.morphNormals&&o.morphAttributes.normal,v=0,y=0;y<8;y++){var _=r[y],b=_[0],S=_[1];b!==Number.MAX_SAFE_INTEGER&&S?(g&&o.getAttribute("morphTarget"+y)!==g[b]&&o.setAttribute("morphTarget"+y,g[b]),m&&o.getAttribute("morphNormal"+y)!==m[b]&&o.setAttribute("morphNormal"+y,m[b]),n[y]=S,v+=S):(g&&!0===o.hasAttribute("morphTarget"+y)&&o.deleteAttribute("morphTarget"+y),m&&!0===o.hasAttribute("morphNormal"+y)&&o.deleteAttribute("morphNormal"+y),n[y]=0)}var E=o.morphTargetsRelative?1:1-v;s.getUniforms().setValue(e,"morphTargetBaseInfluence",E),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function Ir(e,t,n,r){var i=new WeakMap;function o(e){var t=e.target;t.removeEventListener("dispose",o),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){var a=r.render.frame,s=e.geometry,u=t.get(e,s);return i.get(u)!==a&&(t.update(u),i.set(u,a)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",o)&&e.addEventListener("dispose",o),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),u},dispose:function(){i=new WeakMap}}}function Tr(e,t,n,r){void 0===e&&(e=null),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=1),Ee.call(this,null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=h,this.minFilter=h,this.wrapR=p,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Or(e,t,n,r){void 0===e&&(e=null),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=1),Ee.call(this,null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=h,this.minFilter=h,this.wrapR=p,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}lr.physical={uniforms:zn([lr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ye(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Yt(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:ur.meshphysical_vert,fragmentShader:ur.meshphysical_frag},Tr.prototype=Object.create(Ee.prototype),Tr.prototype.constructor=Tr,Tr.prototype.isDataTexture2DArray=!0,Or.prototype=Object.create(Ee.prototype),Or.prototype.constructor=Or,Or.prototype.isDataTexture3D=!0;var xr=new Ee,Rr=new Tr,Ar=new Or,Lr=new Qn,Cr=[],Nr=[],Mr=new Float32Array(16),Pr=new Float32Array(9),$r=new Float32Array(4);function kr(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,o=Cr[i];if(void 0===o&&(o=new Float32Array(i),Cr[i]=o),0!==t){r.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=n,e[a].toArray(o,s)}return o}function Dr(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Ur(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function jr(e,t){var n=Nr[t];void 0===n&&(n=new Int32Array(t),Nr[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Br(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Fr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Dr(n,t))return;e.uniform2fv(this.addr,t),Ur(n,t)}}function qr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Dr(n,t))return;e.uniform3fv(this.addr,t),Ur(n,t)}}function Gr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Dr(n,t))return;e.uniform4fv(this.addr,t),Ur(n,t)}}function Vr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Dr(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Ur(n,t)}else{if(Dr(n,r))return;$r.set(r),e.uniformMatrix2fv(this.addr,!1,$r),Ur(n,r)}}function Hr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Dr(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Ur(n,t)}else{if(Dr(n,r))return;Pr.set(r),e.uniformMatrix3fv(this.addr,!1,Pr),Ur(n,r)}}function zr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Dr(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Ur(n,t)}else{if(Dr(n,r))return;Mr.set(r),e.uniformMatrix4fv(this.addr,!1,Mr),Ur(n,r)}}function Wr(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||xr,i)}function Jr(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Rr,i)}function Yr(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Ar,i)}function Kr(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||Lr,i)}function Xr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Zr(e,t){var n=this.cache;Dr(n,t)||(e.uniform2iv(this.addr,t),Ur(n,t))}function Qr(e,t){var n=this.cache;Dr(n,t)||(e.uniform3iv(this.addr,t),Ur(n,t))}function ei(e,t){var n=this.cache;Dr(n,t)||(e.uniform4iv(this.addr,t),Ur(n,t))}function ti(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function ni(e,t){e.uniform1fv(this.addr,t)}function ri(e,t){e.uniform1iv(this.addr,t)}function ii(e,t){e.uniform2iv(this.addr,t)}function oi(e,t){e.uniform3iv(this.addr,t)}function ai(e,t){e.uniform4iv(this.addr,t)}function si(e,t){var n=kr(t,this.size,2);e.uniform2fv(this.addr,n)}function ui(e,t){var n=kr(t,this.size,3);e.uniform3fv(this.addr,n)}function ci(e,t){var n=kr(t,this.size,4);e.uniform4fv(this.addr,n)}function li(e,t){var n=kr(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function di(e,t){var n=kr(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function pi(e,t){var n=kr(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function fi(e,t,n){var r=t.length,i=jr(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(t[o]||xr,i[o])}function hi(e,t,n){var r=t.length,i=jr(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(t[o]||Lr,i[o])}function gi(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Br;case 35664:return Fr;case 35665:return qr;case 35666:return Gr;case 35674:return Vr;case 35675:return Hr;case 35676:return zr;case 5124:case 35670:return Xr;case 35667:case 35671:return Zr;case 35668:case 35672:return Qr;case 35669:case 35673:return ei;case 5125:return ti;case 35678:case 36198:case 36298:case 36306:case 35682:return Wr;case 35679:case 36299:case 36307:return Yr;case 35680:case 36300:case 36308:case 36293:return Kr;case 36289:case 36303:case 36311:case 36292:return Jr}}(t.type)}function mi(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return ni;case 35664:return si;case 35665:return ui;case 35666:return ci;case 35674:return li;case 35675:return di;case 35676:return pi;case 5124:case 35670:return ri;case 35667:case 35671:return ii;case 35668:case 35672:return oi;case 35669:case 35673:return ai;case 35678:case 36198:case 36298:case 36306:case 35682:return fi;case 35680:case 36300:case 36308:case 36293:return hi}}(t.type)}function vi(e){this.id=e,this.seq=[],this.map={}}mi.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Ur(t,e)},vi.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(e,t[a.id],n)}};var yi=/(\w+)(\])?(\[|\.)?/g;function _i(e,t){e.seq.push(t),e.map[t.id]=t}function bi(e,t,n){var r=e.name,i=r.length;for(yi.lastIndex=0;;){var o=yi.exec(r),a=yi.lastIndex,s=o[1],u="]"===o[2],c=o[3];if(u&&(s|=0),void 0===c||"["===c&&a+2===i){_i(n,void 0===c?new gi(s,e,t):new mi(s,e,t));break}var l=n.map[s];void 0===l&&_i(n,l=new vi(s)),n=l}}function Si(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r);bi(i,e.getUniformLocation(t,i.name),this)}}function Ei(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}Si.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},Si.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},Si.upload=function(e,t,n,r){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}},Si.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var o=e[r];o.id in t&&n.push(o)}return n};var wi=0;function Ii(e){switch(e){case J:return["Linear","( value )"];case Y:return["sRGB","( value )"];case X:return["RGBE","( value )"];case Z:return["RGBM","( value, 7.0 )"];case Q:return["RGBM","( value, 16.0 )"];case ee:return["RGBD","( value, 256.0 )"];case K:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function Ti(e,t,n){var r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function Oi(e,t){var n=Ii(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function xi(e,t){var n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Ri(e){return""!==e}function Ai(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Li(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Ci=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ni(e){return e.replace(Ci,Mi)}function Mi(e,t){var n=ur[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Ni(n)}var Pi=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,$i=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ki(e){return e.replace($i,Ui).replace(Pi,Di)}function Di(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ui(e,t,n,r)}function Ui(e,t,n,r){for(var i="",o=parseInt(t);o<parseInt(n);o++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function ji(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Bi(e,t,n,r){var i,s,u,d,p,f=e.getContext(),h=n.defines,g=n.vertexShader,m=n.fragmentShader,v=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),y=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case o:case a:t="ENVMAP_TYPE_CUBE";break;case c:case l:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),_=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case a:case l:t="ENVMAP_MODE_REFRACTION"}return t}(n),b=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),S=e.gammaFactor>0?e.gammaFactor:1,E=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ri).join("\n")}(n),w=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(h),I=f.createProgram(),T=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((i=[w].filter(Ri).join("\n")).length>0&&(i+="\n"),(s=[E,w].filter(Ri).join("\n")).length>0&&(s+="\n")):(i=[ji(n),"#define SHADER_NAME "+n.shaderName,w,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+S,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+_:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+v:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ri).join("\n"),s=[E,ji(n),"#define SHADER_NAME "+n.shaderName,w,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+S,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+y:"",n.envMap?"#define "+_:"",n.envMap?"#define "+b:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+v:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?ur.tonemapping_pars_fragment:"",0!==n.toneMapping?xi("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",ur.encodings_pars_fragment,n.map?Oi("mapTexelToLinear",n.mapEncoding):"",n.matcap?Oi("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?Oi("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?Oi("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?Oi("lightMapTexelToLinear",n.lightMapEncoding):"",(u="linearToOutputTexel",d=n.outputEncoding,p=Ii(d),"vec4 "+u+"( vec4 value ) { return LinearTo"+p[0]+p[1]+"; }"),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ri).join("\n")),g=Li(g=Ai(g=Ni(g),n),n),m=Li(m=Ai(m=Ni(m),n),n),g=ki(g),m=ki(m),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(T="#version 300 es\n",i=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,s=["#define varying in",n.glslVersion===ie?"":"out highp vec4 pc_fragColor;",n.glslVersion===ie?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+s);var O,x,R=T+s+m,A=Ei(f,35633,T+i+g),L=Ei(f,35632,R);if(f.attachShader(I,A),f.attachShader(I,L),void 0!==n.index0AttributeName?f.bindAttribLocation(I,0,n.index0AttributeName):!0===n.morphTargets&&f.bindAttribLocation(I,0,"position"),f.linkProgram(I),e.debug.checkShaderErrors){var C=f.getProgramInfoLog(I).trim(),N=f.getShaderInfoLog(A).trim(),M=f.getShaderInfoLog(L).trim(),P=!0,$=!0;if(!1===f.getProgramParameter(I,35714)){P=!1;var k=Ti(f,A,"vertex"),D=Ti(f,L,"fragment");console.error("THREE.WebGLProgram: shader error: ",f.getError(),"35715",f.getProgramParameter(I,35715),"gl.getProgramInfoLog",C,k,D)}else""!==C?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",C):""!==N&&""!==M||($=!1);$&&(this.diagnostics={runnable:P,programLog:C,vertexShader:{log:N,prefix:i},fragmentShader:{log:M,prefix:s}})}return f.deleteShader(A),f.deleteShader(L),this.getUniforms=function(){return void 0===O&&(O=new Si(f,I)),O},this.getAttributes=function(){return void 0===x&&(x=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var o=e.getActiveAttrib(t,i).name;n[o]=e.getAttribLocation(t,o)}return n}(f,I)),x},this.destroy=function(){r.releaseStatesOfProgram(this),f.deleteProgram(I),this.program=void 0},this.name=n.shaderName,this.id=wi++,this.cacheKey=t,this.usedTimes=1,this.program=I,this.vertexShader=A,this.fragmentShader=L,this}function Fi(e,t,n,r,i,o){var a=[],s=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.floatVertexTextures,p=r.maxVertexUniforms,f=r.vertexTextures,h=r.precision,g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},m=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function v(e){var t;return e&&e.isTexture?t=e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=J,t}return{getParameters:function(i,a,m,y,_){var b,S,E=y.fog,w=i.isMeshStandardMaterial?y.environment:null,I=t.get(i.envMap||w),T=g[i.type],O=_.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(d)return 1024;var n=p,r=Math.floor((n-20)/4),i=Math.min(r,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}(_):0;if(null!==i.precision&&(h=r.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",h,"instead."),T){var x=lr[T];b=x.vertexShader,S=x.fragmentShader}else b=i.vertexShader,S=i.fragmentShader;var R=e.getRenderTarget();return{isWebGL2:s,shaderID:T,shaderName:i.type,vertexShader:b,fragmentShader:S,defines:i.defines,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:h,instancing:!0===_.isInstancedMesh,instancingColor:!0===_.isInstancedMesh&&null!==_.instanceColor,supportsVertexTextures:f,outputEncoding:null!==R?v(R.texture):e.outputEncoding,map:!!i.map,mapEncoding:v(i.map),matcap:!!i.matcap,matcapEncoding:v(i.matcap),envMap:!!I,envMapMode:I&&I.mapping,envMapEncoding:v(I),envMapCubeUV:!!I&&(I.mapping===c||I.mapping===l),lightMap:!!i.lightMap,lightMapEncoding:v(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:v(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:0===i.normalMapType,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmissionMap:!!i.transmissionMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatMap||i.clearcoatRoughnessMap||i.clearcoatNormalMap||i.displacementMap||i.transmissionMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmissionMap||!i.displacementMap),fog:!!E,useFog:i.fog,fogExp2:E&&E.isFogExp2,flatShading:i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:u,skinning:i.skinning&&O>0,maxBones:O,useVertexTexture:d,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&m.length>0,shadowMapType:e.shadowMap.type,toneMapping:i.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:2===i.side,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:s||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:s||n.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var i=0;i<m.length;i++)n.push(t[m[i]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=g[e.type];if(n){var r=lr[n];t=Wn.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,o=0,s=a.length;o<s;o++){var u=a[o];if(u.cacheKey===n){++(r=u).usedTimes;break}}return void 0===r&&(r=new Bi(e,n,t,i),a.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){var t=a.indexOf(e);a[t]=a[a.length-1],a.pop(),e.destroy()}},programs:a}}function qi(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Gi(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Vi(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Hi(e){var t=[],n=0,r=[],i=[],o={id:-1};function a(r,i,a,s,u,c){var l=t[n],d=e.get(a);return void 0===l?(l={id:r.id,object:r,geometry:i,material:a,program:d.program||o,groupOrder:s,renderOrder:r.renderOrder,z:u,group:c},t[n]=l):(l.id=r.id,l.object=r,l.geometry=i,l.material=a,l.program=d.program||o,l.groupOrder=s,l.renderOrder=r.renderOrder,l.z=u,l.group=c),n++,l}return{opaque:r,transparent:i,init:function(){n=0,r.length=0,i.length=0},push:function(e,t,n,o,s,u){var c=a(e,t,n,o,s,u);(!0===n.transparent?i:r).push(c)},unshift:function(e,t,n,o,s,u){var c=a(e,t,n,o,s,u);(!0===n.transparent?i:r).unshift(c)},finish:function(){for(var e=n,r=t.length;e<r;e++){var i=t[e];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(e,t){r.length>1&&r.sort(e||Gi),i.length>1&&i.sort(t||Vi)}}}function zi(e){var t=new WeakMap;return{get:function(n,r){var i,o=t.get(n);return void 0===o?(i=new Hi(e),t.set(n,new WeakMap),t.get(n).set(r,i)):void 0===(i=o.get(r))&&(i=new Hi(e),o.set(r,i)),i},dispose:function(){t=new WeakMap}}}function Wi(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Re,color:new Yt};break;case"SpotLight":n={position:new Re,direction:new Re,color:new Yt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Re,color:new Yt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Re,skyColor:new Yt,groundColor:new Yt};break;case"RectAreaLight":n={color:new Yt,position:new Re,halfWidth:new Re,halfHeight:new Re}}return e[t.id]=n,n}}}var Ji=0;function Yi(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Ki(e,t){for(var n,r=new Wi,i=(n={},{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ye};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ye,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},a=0;a<9;a++)o.probe.push(new Re);var s=new Re,u=new nt,c=new nt;return{setup:function(n){for(var a=0,s=0,u=0,c=0;c<9;c++)o.probe[c].set(0,0,0);var l=0,d=0,p=0,f=0,h=0,g=0,m=0,v=0;n.sort(Yi);for(var y=0,_=n.length;y<_;y++){var b=n[y],S=b.color,E=b.intensity,w=b.distance,I=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)a+=S.r*E,s+=S.g*E,u+=S.b*E;else if(b.isLightProbe)for(var T=0;T<9;T++)o.probe[T].addScaledVector(b.sh.coefficients[T],E);else if(b.isDirectionalLight){var O=r.get(b);if(O.color.copy(b.color).multiplyScalar(b.intensity),b.castShadow){var x=b.shadow,R=i.get(b);R.shadowBias=x.bias,R.shadowNormalBias=x.normalBias,R.shadowRadius=x.radius,R.shadowMapSize=x.mapSize,o.directionalShadow[l]=R,o.directionalShadowMap[l]=I,o.directionalShadowMatrix[l]=b.shadow.matrix,g++}o.directional[l]=O,l++}else if(b.isSpotLight){var A=r.get(b);if(A.position.setFromMatrixPosition(b.matrixWorld),A.color.copy(S).multiplyScalar(E),A.distance=w,A.coneCos=Math.cos(b.angle),A.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),A.decay=b.decay,b.castShadow){var L=b.shadow,C=i.get(b);C.shadowBias=L.bias,C.shadowNormalBias=L.normalBias,C.shadowRadius=L.radius,C.shadowMapSize=L.mapSize,o.spotShadow[p]=C,o.spotShadowMap[p]=I,o.spotShadowMatrix[p]=b.shadow.matrix,v++}o.spot[p]=A,p++}else if(b.isRectAreaLight){var N=r.get(b);N.color.copy(S).multiplyScalar(E),N.halfWidth.set(.5*b.width,0,0),N.halfHeight.set(0,.5*b.height,0),o.rectArea[f]=N,f++}else if(b.isPointLight){var M=r.get(b);if(M.color.copy(b.color).multiplyScalar(b.intensity),M.distance=b.distance,M.decay=b.decay,b.castShadow){var P=b.shadow,$=i.get(b);$.shadowBias=P.bias,$.shadowNormalBias=P.normalBias,$.shadowRadius=P.radius,$.shadowMapSize=P.mapSize,$.shadowCameraNear=P.camera.near,$.shadowCameraFar=P.camera.far,o.pointShadow[d]=$,o.pointShadowMap[d]=I,o.pointShadowMatrix[d]=b.shadow.matrix,m++}o.point[d]=M,d++}else if(b.isHemisphereLight){var k=r.get(b);k.skyColor.copy(b.color).multiplyScalar(E),k.groundColor.copy(b.groundColor).multiplyScalar(E),o.hemi[h]=k,h++}}f>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(o.rectAreaLTC1=cr.LTC_FLOAT_1,o.rectAreaLTC2=cr.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(o.rectAreaLTC1=cr.LTC_HALF_1,o.rectAreaLTC2=cr.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=a,o.ambient[1]=s,o.ambient[2]=u;var D=o.hash;D.directionalLength===l&&D.pointLength===d&&D.spotLength===p&&D.rectAreaLength===f&&D.hemiLength===h&&D.numDirectionalShadows===g&&D.numPointShadows===m&&D.numSpotShadows===v||(o.directional.length=l,o.spot.length=p,o.rectArea.length=f,o.point.length=d,o.hemi.length=h,o.directionalShadow.length=g,o.directionalShadowMap.length=g,o.pointShadow.length=m,o.pointShadowMap.length=m,o.spotShadow.length=v,o.spotShadowMap.length=v,o.directionalShadowMatrix.length=g,o.pointShadowMatrix.length=m,o.spotShadowMatrix.length=v,D.directionalLength=l,D.pointLength=d,D.spotLength=p,D.rectAreaLength=f,D.hemiLength=h,D.numDirectionalShadows=g,D.numPointShadows=m,D.numSpotShadows=v,o.version=Ji++)},setupView:function(e,t){for(var n=0,r=0,i=0,a=0,l=0,d=t.matrixWorldInverse,p=0,f=e.length;p<f;p++){var h=e[p];if(h.isDirectionalLight){var g=o.directional[n];g.direction.setFromMatrixPosition(h.matrixWorld),s.setFromMatrixPosition(h.target.matrixWorld),g.direction.sub(s),g.direction.transformDirection(d),n++}else if(h.isSpotLight){var m=o.spot[i];m.position.setFromMatrixPosition(h.matrixWorld),m.position.applyMatrix4(d),m.direction.setFromMatrixPosition(h.matrixWorld),s.setFromMatrixPosition(h.target.matrixWorld),m.direction.sub(s),m.direction.transformDirection(d),i++}else if(h.isRectAreaLight){var v=o.rectArea[a];v.position.setFromMatrixPosition(h.matrixWorld),v.position.applyMatrix4(d),c.identity(),u.copy(h.matrixWorld),u.premultiply(d),c.extractRotation(u),v.halfWidth.set(.5*h.width,0,0),v.halfHeight.set(0,.5*h.height,0),v.halfWidth.applyMatrix4(c),v.halfHeight.applyMatrix4(c),a++}else if(h.isPointLight){var y=o.point[r];y.position.setFromMatrixPosition(h.matrixWorld),y.position.applyMatrix4(d),r++}else if(h.isHemisphereLight){var _=o.hemi[l];_.direction.setFromMatrixPosition(h.matrixWorld),_.direction.transformDirection(d),_.direction.normalize(),l++}}},state:o}}function Xi(e,t){var n=new Ki(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function Zi(e,t){var n=new WeakMap;return{get:function(r,i){var o;return void 0===i&&(i=0),!1===n.has(r)?(o=new Xi(e,t),n.set(r,[]),n.get(r).push(o)):i>=n.get(r).length?(o=new Xi(e,t),n.get(r).push(o)):o=n.get(r)[i],o},dispose:function(){n=new WeakMap}}}function Qi(e){Zt.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function eo(e){Zt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Re,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}Qi.prototype=Object.create(Zt.prototype),Qi.prototype.constructor=Qi,Qi.prototype.isMeshDepthMaterial=!0,Qi.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},eo.prototype=Object.create(Zt.prototype),eo.prototype.constructor=eo,eo.prototype.isMeshDistanceMaterial=!0,eo.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};function to(e,t,n){var r=new ir,i=new ye,o=new ye,a=new Ie,s=[],u=[],c={},l={0:1,1:0,2:2},d=new Jn({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new ye},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;var f=new In;f.setAttribute("position",new nn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var g=new qn(f,d),m=this;function y(n,r){var i=t.update(g);d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,d,g,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,p,g,null)}function _(e,t,n){var r=e<<0|t<<1|n<<2,i=s[r];return void 0===i&&(i=new Qi({depthPacking:3201,morphTargets:e,skinning:t}),s[r]=i),i}function b(e,t,n){var r=e<<0|t<<1|n<<2,i=u[r];return void 0===i&&(i=new eo({morphTargets:e,skinning:t}),u[r]=i),i}function S(t,n,r,i,o,a,s){var u=null,d=_,p=t.customDepthMaterial;if(!0===i.isPointLight&&(d=b,p=t.customDistanceMaterial),void 0===p){var f=!1;!0===r.morphTargets&&(f=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);var h=!1;!0===t.isSkinnedMesh&&(!0===r.skinning?h=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),u=d(f,h,!0===t.isInstancedMesh)}else u=p;if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var g=u.uuid,m=r.uuid,v=c[g];void 0===v&&(v={},c[g]=v);var y=v[m];void 0===y&&(y=u.clone(),v[m]=y),u=y}return u.visible=r.visible,u.wireframe=r.wireframe,u.side=3===s?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:l[r.side],u.clipShadows=r.clipShadows,u.clippingPlanes=r.clippingPlanes,u.clipIntersection=r.clipIntersection,u.wireframeLinewidth=r.wireframeLinewidth,u.linewidth=r.linewidth,!0===i.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(i.matrixWorld),u.nearDistance=o,u.farDistance=a),u}function E(n,i,o,a,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var u=t.update(n),c=n.material;if(Array.isArray(c))for(var l=u.groups,d=0,p=l.length;d<p;d++){var f=l[d],h=c[f.materialIndex];if(h&&h.visible){var g=S(n,u,h,a,o.near,o.far,s);e.renderBufferDirect(o,null,u,g,n,f)}}else if(c.visible){var m=S(n,u,c,a,o.near,o.far,s);e.renderBufferDirect(o,null,u,m,n,null)}}for(var v=n.children,y=0,_=v.length;y<_;y++)E(v[y],i,o,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,s,u){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==t.length){var c=e.getRenderTarget(),l=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),p=e.state;p.setBlending(0),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(var f=0,g=t.length;f<g;f++){var _=t[f],b=_.shadow;if(void 0!==b){if(!1!==b.autoUpdate||!1!==b.needsUpdate){i.copy(b.mapSize);var S=b.getFrameExtents();if(i.multiply(S),o.copy(b.mapSize),(i.x>n||i.y>n)&&(i.x>n&&(o.x=Math.floor(n/S.x),i.x=o.x*S.x,b.mapSize.x=o.x),i.y>n&&(o.y=Math.floor(n/S.y),i.y=o.y*S.y,b.mapSize.y=o.y)),null===b.map&&!b.isPointLightShadow&&3===this.type){var w={minFilter:v,magFilter:v,format:x};b.map=new Te(i.x,i.y,w),b.map.texture.name=_.name+".shadowMap",b.mapPass=new Te(i.x,i.y,w),b.camera.updateProjectionMatrix()}if(null===b.map){var I={minFilter:h,magFilter:h,format:x};b.map=new Te(i.x,i.y,I),b.map.texture.name=_.name+".shadowMap",b.camera.updateProjectionMatrix()}e.setRenderTarget(b.map),e.clear();for(var T=b.getViewportCount(),O=0;O<T;O++){var R=b.getViewport(O);a.set(o.x*R.x,o.y*R.y,o.x*R.z,o.y*R.w),p.viewport(a),b.updateMatrices(_,O),r=b.getFrustum(),E(s,u,b.camera,_,this.type)}b.isPointLightShadow||3!==this.type||y(b,u),b.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",_,"has no shadow.")}m.needsUpdate=!1,e.setRenderTarget(c,l,d)}}}function no(e,t,n){var i,o,a=n.isWebGL2;var s=new function(){var t=!1,n=new Ie,r=null,i=new Ie(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,o,a,s){!0===s&&(t*=a,r*=a,o*=a),n.set(t,r,o,a),!1===i.equals(n)&&(e.clearColor(t,r,o,a),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},u=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){e?k(2929):D(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},c=new function(){var t=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null;return{setTest:function(e){t||(e?k(2960):D(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,a){r===t&&i===n&&o===a||(e.stencilFunc(t,n,a),r=t,i=n,o=a)},setOp:function(t,n,r){a===t&&s===n&&u===r||(e.stencilOp(t,n,r),a=t,s=n,u=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null}}},l={},d=null,p=null,f=null,h=null,g=null,m=null,v=null,y=null,_=null,b=!1,S=null,E=null,w=null,I=null,T=null,O=e.getParameter(35661),x=!1,R=0,A=e.getParameter(7938);-1!==A.indexOf("WebGL")?(R=parseFloat(/^WebGL (\d)/.exec(A)[1]),x=R>=1):-1!==A.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL ES (\d)/.exec(A)[1]),x=R>=2);var L=null,C={},N=new Ie,M=new Ie;function P(t,n,r){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var a=0;a<r;a++)e.texImage2D(n+a,0,6408,1,1,0,6408,5121,i);return o}var $={};function k(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function D(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}$[3553]=P(3553,3553,1),$[34067]=P(34067,34069,6),s.setClear(0,0,0,1),u.setClear(1),c.setClear(0),k(2929),u.setFunc(3),q(!1),G(1),k(2884),F(0);var U=((i={})[100]=32774,i[101]=32778,i[102]=32779,i);if(a)U[103]=32775,U[104]=32776;else{var j=t.get("EXT_blend_minmax");null!==j&&(U[103]=j.MIN_EXT,U[104]=j.MAX_EXT)}var B=((o={})[200]=0,o[201]=1,o[202]=768,o[204]=770,o[210]=776,o[208]=774,o[206]=772,o[203]=769,o[205]=771,o[209]=775,o[207]=773,o);function F(t,n,i,o,a,s,u,c){if(0!==t){if(p||(k(3042),p=!0),5===t)a=a||n,s=s||i,u=u||o,n===h&&a===v||(e.blendEquationSeparate(U[n],U[a]),h=n,v=a),i===g&&o===m&&s===y&&u===_||(e.blendFuncSeparate(B[i],B[o],B[s],B[u]),g=i,m=o,y=s,_=u),f=t,b=null;else if(t!==f||c!==b){if(h===r&&v===r||(e.blendEquation(32774),h=r,v=r),c)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}g=null,m=null,y=null,_=null,f=t,b=c}}else p&&(D(3042),p=!1)}function q(t){S!==t&&(t?e.frontFace(2304):e.frontFace(2305),S=t)}function G(t){0!==t?(k(2884),t!==E&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):D(2884),E=t}function V(t,n,r){t?(k(32823),I===n&&T===r||(e.polygonOffset(n,r),I=n,T=r)):D(32823)}function H(t){void 0===t&&(t=33984+O-1),L!==t&&(e.activeTexture(t),L=t)}return{buffers:{color:s,depth:u,stencil:c},enable:k,disable:D,useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:F,setMaterial:function(e,t){2===e.side?D(2884):k(2884);var n=1===e.side;t&&(n=!n),q(n),1===e.blending&&!1===e.transparent?F(0):F(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),u.setFunc(e.depthFunc),u.setTest(e.depthTest),u.setMask(e.depthWrite),s.setMask(e.colorWrite);var r=e.stencilWrite;c.setTest(r),r&&(c.setMask(e.stencilWriteMask),c.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),c.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),V(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:q,setCullFace:G,setLineWidth:function(t){t!==w&&(x&&e.lineWidth(t),w=t)},setPolygonOffset:V,setScissorTest:function(e){e?k(3089):D(3089)},activeTexture:H,bindTexture:function(t,n){null===L&&H();var r=C[L];void 0===r&&(r={type:void 0,texture:void 0},C[L]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||$[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=C[L];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===N.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),N.copy(t))},viewport:function(t){!1===M.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),M.copy(t))},reset:function(){l={},L=null,C={},d=null,p=null,f=null,h=null,g=null,m=null,v=null,y=null,_=null,b=!1,S=null,E=null,w=null,I=null,T=null,s.reset(),u.reset(),c.reset()}}}function ro(e,t,n,r,i,o,a){var s,u,c,l=i.isWebGL2,d=i.maxTextures,f=i.maxCubemapSize,y=i.maxTextureSize,_=i.maxSamples,b=new WeakMap,L=!1;try{L="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function C(e,t){return L?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function N(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var o=t?ve.floorPowerOfTwo:Math.floor,a=o(i*e.width),s=o(i*e.height);void 0===c&&(c=C(a,s));var u=n?C(a,s):c;return u.width=a,u.height=s,u.getContext("2d").drawImage(e,0,0,a,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+s+")."),u}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function M(e){return ve.isPowerOfTwo(e.width)&&ve.isPowerOfTwo(e.height)}function P(e,t){return e.generateMipmaps&&t&&e.minFilter!==h&&e.minFilter!==v}function $(t,n,i,o){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function k(n,r,i){if(!1===l)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var o=r;return 6403===r&&(5126===i&&(o=33326),5131===i&&(o=33325),5121===i&&(o=33321)),6407===r&&(5126===i&&(o=34837),5131===i&&(o=34843),5121===i&&(o=32849)),6408===r&&(5126===i&&(o=34836),5131===i&&(o=34842),5121===i&&(o=32856)),33325!==o&&33326!==o&&34842!==o&&34836!==o||t.get("EXT_color_buffer_float"),o}function D(e){return e===h||e===g||e===m?9728:9729}function U(t){var n=t.target;n.removeEventListener("dispose",U),function(t){var n=r.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),r.remove(t)}(n),n.isVideoTexture&&b.delete(n),a.memory.textures--}function j(t){var n=t.target;n.removeEventListener("dispose",j),function(t){var n=r.get(t),i=r.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var o=0;o<6;o++)e.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[o]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&e.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer);r.remove(t.texture),r.remove(t)}(n),a.memory.textures--}var B=0;function F(e,t){var i=r.get(e);if(e.isVideoTexture&&function(e){var t=a.render.frame;b.get(e)!==t&&(b.set(e,t),e.update())}(e),e.version>0&&i.__version!==e.version){var o=e.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==o.complete)return void W(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function q(t,i){var a=r.get(t);t.version>0&&a.__version!==t.version?function(t,r,i){if(6!==r.image.length)return;z(t,r),n.activeTexture(33984+i),n.bindTexture(34067,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment);for(var a=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),s=r.image[0]&&r.image[0].isDataTexture,u=[],c=0;c<6;c++)u[c]=a||s?s?r.image[c].image:r.image[c]:N(r.image[c],!1,!0,f);var d,p=u[0],h=M(p)||l,g=o.convert(r.format),m=o.convert(r.type),v=k(r.internalFormat,g,m);if(H(34067,r,h),a){for(var y=0;y<6;y++){d=u[y].mipmaps;for(var _=0;_<d.length;_++){var b=d[_];r.format!==x&&r.format!==O?null!==g?n.compressedTexImage2D(34069+y,_,v,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+y,_,v,b.width,b.height,0,g,m,b.data)}}t.__maxMipLevel=d.length-1}else{d=r.mipmaps;for(var S=0;S<6;S++)if(s){n.texImage2D(34069+S,0,v,u[S].width,u[S].height,0,g,m,u[S].data);for(var E=0;E<d.length;E++){var w=d[E].image[S].image;n.texImage2D(34069+S,E+1,v,w.width,w.height,0,g,m,w.data)}}else{n.texImage2D(34069+S,0,v,g,m,u[S]);for(var I=0;I<d.length;I++){var T=d[I];n.texImage2D(34069+S,I+1,v,g,m,T.image[S])}}t.__maxMipLevel=d.length}P(r,h)&&$(34067,r,p.width,p.height);t.__version=r.version,r.onUpdate&&r.onUpdate(r)}(a,t,i):(n.activeTexture(33984+i),n.bindTexture(34067,a.__webglTexture))}var G=((s={})[1e3]=10497,s[1001]=33071,s[1002]=33648,s),V=((u={})[1003]=9728,u[1004]=9984,u[1005]=9986,u[1006]=9729,u[1007]=9985,u[1008]=9987,u);function H(n,o,a){a?(e.texParameteri(n,10242,G[o.wrapS]),e.texParameteri(n,10243,G[o.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,G[o.wrapR]),e.texParameteri(n,10240,V[o.magFilter]),e.texParameteri(n,10241,V[o.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),o.wrapS===p&&o.wrapT===p||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,D(o.magFilter)),e.texParameteri(n,10241,D(o.minFilter)),o.minFilter!==h&&o.minFilter!==v&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var s=t.get("EXT_texture_filter_anisotropic");if(s){if(o.type===w&&null===t.get("OES_texture_float_linear"))return;if(o.type===I&&null===(l||t.get("OES_texture_half_float_linear")))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function z(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",U),t.__webglTexture=e.createTexture(),a.memory.textures++)}function W(t,r,i){var a=3553;r.isDataTexture2DArray&&(a=35866),r.isDataTexture3D&&(a=32879),z(t,r),n.activeTexture(33984+i),n.bindTexture(a,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment);var s,u=function(e){return!l&&(e.wrapS!==p||e.wrapT!==p||e.minFilter!==h&&e.minFilter!==v)}(r)&&!1===M(r.image),c=N(r.image,u,!1,y),d=M(c)||l,f=o.convert(r.format),g=o.convert(r.type),m=k(r.internalFormat,f,g);H(a,r,d);var _=r.mipmaps;if(r.isDepthTexture)m=6402,l?m=r.type===w?36012:r.type===E?33190:r.type===T?35056:33189:r.type===w&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===R&&6402===m&&r.type!==S&&r.type!==E&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=S,g=o.convert(r.type)),r.format===A&&6402===m&&(m=34041,r.type!==T&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=T,g=o.convert(r.type))),n.texImage2D(3553,0,m,c.width,c.height,0,f,g,null);else if(r.isDataTexture)if(_.length>0&&d){for(var b=0,I=_.length;b<I;b++)s=_[b],n.texImage2D(3553,b,m,s.width,s.height,0,f,g,s.data);r.generateMipmaps=!1,t.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,m,c.width,c.height,0,f,g,c.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(var L=0,C=_.length;L<C;L++)s=_[L],r.format!==x&&r.format!==O?null!==f?n.compressedTexImage2D(3553,L,m,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,L,m,s.width,s.height,0,f,g,s.data);t.__maxMipLevel=_.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,m,c.width,c.height,c.depth,0,f,g,c.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,m,c.width,c.height,c.depth,0,f,g,c.data),t.__maxMipLevel=0;else if(_.length>0&&d){for(var D=0,U=_.length;D<U;D++)s=_[D],n.texImage2D(3553,D,m,f,g,s);r.generateMipmaps=!1,t.__maxMipLevel=_.length-1}else n.texImage2D(3553,0,m,f,g,c),t.__maxMipLevel=0;P(r,d)&&$(a,r,c.width,c.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function J(t,i,a,s){var u=o.convert(i.texture.format),c=o.convert(i.texture.type),l=k(i.texture.internalFormat,u,c);n.texImage2D(s,0,l,i.width,i.height,0,u,c,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,a,s,r.get(i.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function Y(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){var i=33189;if(r){var a=n.depthTexture;a&&a.isDepthTexture&&(a.type===w?i=36012:a.type===E&&(i=33190));var s=X(n);e.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else e.renderbufferStorage(36161,i,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){var u=X(n);e.renderbufferStorageMultisample(36161,u,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var c=o.convert(n.texture.format),l=o.convert(n.texture.type),d=k(n.texture.internalFormat,c,l);if(r){var p=X(n);e.renderbufferStorageMultisample(36161,p,d,n.width,n.height)}else e.renderbufferStorage(36161,d,n.width,n.height)}e.bindRenderbuffer(36161,null)}function K(t){var n=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),F(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===R)e.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==A)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(36160,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=e.createRenderbuffer(),Y(n.__webglDepthbuffer[o],t,!1)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),Y(n.__webglDepthbuffer,t,!1);e.bindFramebuffer(36160,null)}function X(e){return l&&e.isWebGLMultisampleRenderTarget?Math.min(_,e.samples):0}var Z=!1,Q=!1;this.allocateTextureUnit=function(){var e=B;return e>=d&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+d),B+=1,e},this.resetTextureUnits=function(){B=0},this.setTexture2D=F,this.setTexture2DArray=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?W(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?W(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=q,this.setupRenderTarget=function(t){var i=r.get(t),s=r.get(t.texture);t.addEventListener("dispose",j),s.__webglTexture=e.createTexture(),a.memory.textures++;var u=!0===t.isWebGLCubeRenderTarget,c=!0===t.isWebGLMultisampleRenderTarget,d=M(t)||l;if(!l||t.texture.format!==O||t.texture.type!==w&&t.texture.type!==I||(t.texture.format=x,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),u){i.__webglFramebuffer=[];for(var p=0;p<6;p++)i.__webglFramebuffer[p]=e.createFramebuffer()}else if(i.__webglFramebuffer=e.createFramebuffer(),c)if(l){i.__webglMultisampledFramebuffer=e.createFramebuffer(),i.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,i.__webglColorRenderbuffer);var f=o.convert(t.texture.format),h=o.convert(t.texture.type),g=k(t.texture.internalFormat,f,h),m=X(t);e.renderbufferStorageMultisample(36161,m,g,t.width,t.height),e.bindFramebuffer(36160,i.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,i.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(i.__webglDepthRenderbuffer=e.createRenderbuffer(),Y(i.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(u){n.bindTexture(34067,s.__webglTexture),H(34067,t.texture,d);for(var v=0;v<6;v++)J(i.__webglFramebuffer[v],t,36064,34069+v);P(t.texture,d)&&$(34067,t.texture,t.width,t.height),n.bindTexture(34067,null)}else n.bindTexture(3553,s.__webglTexture),H(3553,t.texture,d),J(i.__webglFramebuffer,t,36064,3553),P(t.texture,d)&&$(3553,t.texture,t.width,t.height),n.bindTexture(3553,null);t.depthBuffer&&K(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(P(t,M(e)||l)){var i=e.isWebGLCubeRenderTarget?34067:3553,o=r.get(t).__webglTexture;n.bindTexture(i,o),$(i,t,e.width,e.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(l){var n=r.get(t);e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer);var i=t.width,o=t.height,a=16384;t.depthBuffer&&(a|=256),t.stencilBuffer&&(a|=1024),e.blitFramebuffer(0,0,i,o,0,0,i,o,a,9728),e.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===Z&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Z=!0),e=e.texture),F(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===Q&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Q=!0),e=e.texture),q(e,t)}}function io(e,t,n){var r=n.isWebGL2;return{convert:function(e){var n;if(e===b)return 5121;if(1017===e)return 32819;if(1018===e)return 32820;if(1019===e)return 33635;if(1010===e)return 5120;if(1011===e)return 5122;if(e===S)return 5123;if(1013===e)return 5124;if(e===E)return 5125;if(e===w)return 5126;if(e===I)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(1021===e)return 6406;if(e===O)return 6407;if(e===x)return 6408;if(1024===e)return 6409;if(1025===e)return 6410;if(e===R)return 6402;if(e===A)return 34041;if(1028===e)return 6403;if(1029===e)return 36244;if(1030===e)return 33319;if(1031===e)return 33320;if(1032===e)return 36248;if(1033===e)return 36249;if(e===L||e===C||e===N||e===M){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===L)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===C)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===N)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===M)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===P||e===$||e===k||e===D){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===P)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===$)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===k)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===D)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===U||e===j)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(e===U)return n.COMPRESSED_RGB8_ETC2;if(e===j)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e||37840===e||37841===e||37842===e||37843===e||37844===e||37845===e||37846===e||37847===e||37848===e||37849===e||37850===e||37851===e||37852===e||37853===e?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:36492===e?null!==(n=t.get("EXT_texture_compression_bptc"))?e:null:e===T?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function oo(e){void 0===e&&(e=[]),Kn.call(this),this.cameras=e}function ao(){xt.call(this),this.type="Group"}function so(){this._targetRay=null,this._grip=null,this._hand=null}function uo(e,t){var n=this,r=null,i=1,o=null,a="local-floor",s=null,u=[],c=new Map,l=new Kn;l.layers.enable(1),l.viewport=new Ie;var d=new Kn;d.layers.enable(2),d.viewport=new Ie;var p=[l,d],f=new oo;f.layers.enable(1),f.layers.enable(2);var h=null,g=null;function m(e){var t=c.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function v(){c.forEach((function(e,t){e.disconnect(t)})),c.clear(),h=null,g=null,e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),w.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function y(e){for(var t=r.inputSources,n=0;n<u.length;n++)c.set(t[n],u[n]);for(var i=0;i<e.removed.length;i++){var o=e.removed[i],a=c.get(o);a&&(a.dispatchEvent({type:"disconnected",data:o}),c.delete(o))}for(var s=0;s<e.added.length;s++){var l=e.added[s],d=c.get(l);d&&d.dispatchEvent({type:"connected",data:l})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){var t=u[e];return void 0===t&&(t=new so,u[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){var t=u[e];return void 0===t&&(t=new so,u[e]=t),t.getGripSpace()},this.getHand=function(e){var t=u[e];return void 0===t&&(t=new so,u[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){a=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getSession=function(){return r},this.setSession=function(){var e,s=(e=regeneratorRuntime.mark((function e(s){var u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=s)){e.next=24;break}if(r.addEventListener("select",m),r.addEventListener("selectstart",m),r.addEventListener("selectend",m),r.addEventListener("squeeze",m),r.addEventListener("squeezestart",m),r.addEventListener("squeezeend",m),r.addEventListener("end",v),r.addEventListener("inputsourceschange",y),!0===(u=t.getContextAttributes()).xrCompatible){e.next=14;break}return e.next=14,t.makeXRCompatible();case 14:return c={antialias:u.antialias,alpha:u.alpha,depth:u.depth,stencil:u.stencil,framebufferScaleFactor:i},l=new XRWebGLLayer(r,t,c),r.updateRenderState({baseLayer:l}),e.next=19,r.requestReferenceSpace(a);case 19:o=e.sent,w.setContext(r),w.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"});case 24:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){oe(o,r,i,a,s,"next",e)}function s(e){oe(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(e){return s.apply(this,arguments)}}();var _=new Re,b=new Re;function S(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.getCamera=function(e){f.near=d.near=l.near=e.near,f.far=d.far=l.far=e.far,h===f.near&&g===f.far||(r.updateRenderState({depthNear:f.near,depthFar:f.far}),h=f.near,g=f.far);var t=e.parent,n=f.cameras;S(f,t);for(var i=0;i<n.length;i++)S(n[i],t);e.matrixWorld.copy(f.matrixWorld),e.matrix.copy(f.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);for(var o=e.children,a=0,s=o.length;a<s;a++)o[a].updateMatrixWorld(!0);return 2===n.length?function(e,t,n){_.setFromMatrixPosition(t.matrixWorld),b.setFromMatrixPosition(n.matrixWorld);var r=_.distanceTo(b),i=t.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],c=(i[9]-1)/i[5],l=(i[8]-1)/i[0],d=(o[8]+1)/o[0],p=a*l,f=a*d,h=r/(-l+d),g=h*-l;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(g),e.translateZ(h),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var m=a+h,v=s+h,y=p-g,S=f+(r-g),E=u*s/v*m,w=c*s/v*m;e.projectionMatrix.makePerspective(y,S,E,w,m,v)}(f,l,d):f.projectionMatrix.copy(l.projectionMatrix),f};var E=null;var w=new or;w.setAnimationLoop((function(t,n){if(null!==(s=n.getViewerPose(o))){var i=s.views,a=r.renderState.baseLayer;e.setFramebuffer(a.framebuffer);var c=!1;i.length!==f.cameras.length&&(f.cameras.length=0,c=!0);for(var l=0;l<i.length;l++){var d=i[l],h=a.getViewport(d),g=p[l];g.matrix.fromArray(d.transform.matrix),g.projectionMatrix.fromArray(d.projectionMatrix),g.viewport.set(h.x,h.y,h.width,h.height),0===l&&f.matrix.copy(g.matrix),!0===c&&f.cameras.push(g)}}for(var m=r.inputSources,v=0;v<u.length;v++){var y=u[v],_=m[v];y.update(_,n,o)}E&&E(t,n)})),this.setAnimationLoop=function(e){E=e},this.dispose=function(){}}function co(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);var r,i,o=e.get(n).envMap;if(o){t.envMap.value=o,t.flipEnvMap.value=o.isCubeTexture&&o._needsFlipEnvMap?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio;var a=e.get(o).__maxMipLevel;void 0!==a&&(t.maxMipLevel.value=a)}n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?i=n.aoMap:n.lightMap&&(i=n.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,1===n.side&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),1===n.side&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,o){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?function(e,t){n(e,t),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap);t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate());e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap)}(e,r):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,r,i,o):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function lo(e){var t,n=void 0!==(e=e||{}).canvas?e.canvas:((t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).style.display="block",t),r=void 0!==e.context?e.context:null,i=void 0!==e.alpha&&e.alpha,o=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,u=void 0===e.premultipliedAlpha||e.premultipliedAlpha,c=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,l=void 0!==e.powerPreference?e.powerPreference:"default",d=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,p=null,f=null,h=[];this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=J,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var g=this,m=!1,v=null,y=0,_=0,S=null,E=null,T=-1,O=null,R=new Ie,A=new Ie,L=null,C=n.width,N=n.height,M=1,P=null,$=null,k=new Ie(0,0,C,N),D=new Ie(0,0,C,N),U=!1,j=new ir,B=!1,F=!1,q=new nt,G=new Re,V={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function H(){return null===S?M:1}var z,W,Y,K,X,Z,Q,ee,te,ne,re,ie,oe,ae,se,ue,ce,le,de,pe,fe,he=r;function ge(e,t){for(var r=0;r<e.length;r++){var i=e[r],o=n.getContext(i,t);if(null!==o)return o}return null}try{var me={alpha:i,depth:o,stencil:a,antialias:s,premultipliedAlpha:u,preserveDrawingBuffer:c,powerPreference:l,failIfMajorPerformanceCaveat:d};if(n.addEventListener("webglcontextlost",we,!1),n.addEventListener("webglcontextrestored",Te,!1),null===he){var _e=["webgl2","webgl","experimental-webgl"];if(!0===g.isWebGL1Renderer&&_e.shift(),null===(he=ge(_e,me)))throw ge(_e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===he.getShaderPrecisionFormat&&(he.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function be(){z=new vr(he),W=new hr(he,z,e),z.init(W),pe=new io(he,z,W),(Y=new no(he,z,W)).scissor(A.copy(D).multiplyScalar(M).floor()),Y.viewport(R.copy(k).multiplyScalar(M).floor()),K=new br(he),X=new qi,Z=new ro(he,z,Y,X,W,pe,K),Q=new mr(g),ee=new ar(he,W),fe=new pr(he,z,ee,W),te=new yr(he,ee,K,fe),ne=new Ir(he,te,ee,K),ce=new wr(he),se=new gr(X),re=new Fi(g,Q,z,W,fe,se),ie=new co(X),oe=new zi(X),ae=new Zi(z,W),ue=new dr(g,Q,Y,ne,u),le=new fr(he,z,K,W),de=new _r(he,z,K,W),K.programs=re.programs,g.capabilities=W,g.extensions=z,g.properties=X,g.renderLists=oe,g.state=Y,g.info=K}be();var Se=new uo(g,he);this.xr=Se;var Ee=new to(g,ne,W.maxTextureSize);function we(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function Te(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1,be()}function Oe(e){var t=e.target;t.removeEventListener("dispose",Oe),function(e){xe(e),X.remove(e)}(t)}function xe(e){var t=X.get(e).program;void 0!==t&&re.releaseProgram(t)}this.shadowMap=Ee,this.getContext=function(){return he},this.getContextAttributes=function(){return he.getContextAttributes()},this.forceContextLoss=function(){var e=z.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=z.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return M},this.setPixelRatio=function(e){void 0!==e&&(M=e,this.setSize(C,N,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new ye),e.set(C,N)},this.setSize=function(e,t,r){Se.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(C=e,N=t,n.width=Math.floor(e*M),n.height=Math.floor(t*M),!1!==r&&(n.style.width=e+"px",n.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new ye),e.set(C*M,N*M).floor()},this.setDrawingBufferSize=function(e,t,r){C=e,N=t,M=r,n.width=Math.floor(e*r),n.height=Math.floor(t*r),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new Ie),e.copy(R)},this.getViewport=function(e){return e.copy(k)},this.setViewport=function(e,t,n,r){e.isVector4?k.set(e.x,e.y,e.z,e.w):k.set(e,t,n,r),Y.viewport(R.copy(k).multiplyScalar(M).floor())},this.getScissor=function(e){return e.copy(D)},this.setScissor=function(e,t,n,r){e.isVector4?D.set(e.x,e.y,e.z,e.w):D.set(e,t,n,r),Y.scissor(A.copy(D).multiplyScalar(M).floor())},this.getScissorTest=function(){return U},this.setScissorTest=function(e){Y.setScissorTest(U=e)},this.setOpaqueSort=function(e){P=e},this.setTransparentSort=function(e){$=e},this.getClearColor=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),e=new Yt),e.copy(ue.getClearColor())},this.setClearColor=function(){ue.setClearColor.apply(ue,arguments)},this.getClearAlpha=function(){return ue.getClearAlpha()},this.setClearAlpha=function(){ue.setClearAlpha.apply(ue,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),he.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",we,!1),n.removeEventListener("webglcontextrestored",Te,!1),oe.dispose(),ae.dispose(),X.dispose(),Q.dispose(),ne.dispose(),fe.dispose(),Se.dispose(),Le.stop()},this.renderBufferImmediate=function(e,t){fe.initAttributes();var n=X.get(e);e.hasPositions&&!n.position&&(n.position=he.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=he.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=he.createBuffer()),e.hasColors&&!n.color&&(n.color=he.createBuffer());var r=t.getAttributes();e.hasPositions&&(he.bindBuffer(34962,n.position),he.bufferData(34962,e.positionArray,35048),fe.enableAttribute(r.position),he.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(he.bindBuffer(34962,n.normal),he.bufferData(34962,e.normalArray,35048),fe.enableAttribute(r.normal),he.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(he.bindBuffer(34962,n.uv),he.bufferData(34962,e.uvArray,35048),fe.enableAttribute(r.uv),he.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(he.bindBuffer(34962,n.color),he.bufferData(34962,e.colorArray,35048),fe.enableAttribute(r.color),he.vertexAttribPointer(r.color,3,5126,!1,0,0)),fe.disableUnusedAttributes(),he.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,o){null===t&&(t=V);var a=i.isMesh&&i.matrixWorld.determinant()<0,s=$e(e,t,r,i);Y.setMaterial(r,a);var u=n.index,c=n.attributes.position;if(null===u){if(void 0===c||0===c.count)return}else if(0===u.count)return;var l,d=1;!0===r.wireframe&&(u=te.getWireframeAttribute(n),d=2),(r.morphTargets||r.morphNormals)&&ce.update(i,n,r,s),fe.setup(i,r,s,n,u);var p=le;null!==u&&(l=ee.get(u),(p=de).setIndex(l));var f=null!==u?u.count:c.count,h=n.drawRange.start*d,g=n.drawRange.count*d,m=null!==o?o.start*d:0,v=null!==o?o.count*d:1/0,y=Math.max(h,m),_=Math.min(f,h+g,m+v)-1,b=Math.max(0,_-y+1);if(0!==b){if(i.isMesh)!0===r.wireframe?(Y.setLineWidth(r.wireframeLinewidth*H()),p.setMode(1)):p.setMode(4);else if(i.isLine){var S=r.linewidth;void 0===S&&(S=1),Y.setLineWidth(S*H()),i.isLineSegments?p.setMode(1):i.isLineLoop?p.setMode(2):p.setMode(3)}else i.isPoints?p.setMode(0):i.isSprite&&p.setMode(4);if(i.isInstancedMesh)p.renderInstances(y,b,i.count);else if(n.isInstancedBufferGeometry){var E=Math.min(n.instanceCount,n._maxInstanceCount);p.renderInstances(y,b,E)}else p.render(y,b)}},this.compile=function(e,t){(f=ae.get(e)).init(),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))})),f.setupLights();var n=new WeakMap;e.traverse((function(t){var r=t.material;if(r)if(Array.isArray(r))for(var i=0;i<r.length;i++){var o=r[i];!1===n.has(o)&&(Pe(o,e,t),n.set(o))}else!1===n.has(r)&&(Pe(r,e,t),n.set(r))}))};var Ae=null;var Le=new or;function Ce(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)f.pushLight(e),e.castShadow&&f.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||j.intersectsSprite(e)){r&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(q);var i=ne.update(e),o=e.material;o.visible&&p.push(e,i,o,n,G.z,null)}}else if(e.isImmediateRenderObject)r&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(q),p.push(e,null,e.material,n,G.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==K.render.frame&&(e.skeleton.update(),e.skeleton.frame=K.render.frame),!e.frustumCulled||j.intersectsObject(e))){r&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(q);var a=ne.update(e),s=e.material;if(Array.isArray(s))for(var u=a.groups,c=0,l=u.length;c<l;c++){var d=u[c],h=s[d.materialIndex];h&&h.visible&&p.push(e,a,h,n,G.z,d)}else s.visible&&p.push(e,a,s,n,G.z,null)}for(var g=e.children,m=0,v=g.length;m<v;m++)Ce(g[m],t,n,r)}}function Ne(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,u=a.geometry,c=null===r?a.material:r,l=a.group;if(n.isArrayCamera)for(var d=n.cameras,p=0,h=d.length;p<h;p++){var g=d[p];s.layers.test(g.layers)&&(Y.viewport(R.copy(g.viewport)),f.setupLightsView(g),Me(s,t,g,u,c,l))}else Me(s,t,n,u,c,l)}}function Me(e,t,n,r,i,o){if(e.onBeforeRender(g,t,n,r,i,o),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var a=$e(n,t,i,e);Y.setMaterial(i),fe.reset(),function(e,t){e.render((function(e){g.renderBufferImmediate(e,t)}))}(e,a)}else g.renderBufferDirect(n,t,r,i,e,o);e.onAfterRender(g,t,n,r,i,o)}function Pe(e,t,n){!0!==t.isScene&&(t=V);var r=X.get(e),i=f.state.lights,o=f.state.shadowsArray,a=i.state.version,s=re.getParameters(e,i.state,o,t,n),u=re.getProgramCacheKey(s),c=r.program,l=!0;if(r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=Q.get(e.envMap||r.environment),void 0===c)e.addEventListener("dispose",Oe);else if(c.cacheKey!==u)xe(e);else if(r.lightsStateVersion!==a)l=!1;else{if(void 0!==s.shaderID)return;l=!1}l&&(s.uniforms=re.getUniforms(e),e.onBeforeCompile(s,g),c=re.acquireProgram(s,u),r.program=c,r.uniforms=s.uniforms,r.outputEncoding=s.outputEncoding);var d=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=se.numPlanes,r.numIntersection=se.numIntersection,d.clippingPlanes=se.uniform),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=a,r.needsLights&&(d.ambientLightColor.value=i.state.ambient,d.lightProbe.value=i.state.probe,d.directionalLights.value=i.state.directional,d.directionalLightShadows.value=i.state.directionalShadow,d.spotLights.value=i.state.spot,d.spotLightShadows.value=i.state.spotShadow,d.rectAreaLights.value=i.state.rectArea,d.ltc_1.value=i.state.rectAreaLTC1,d.ltc_2.value=i.state.rectAreaLTC2,d.pointLights.value=i.state.point,d.pointLightShadows.value=i.state.pointShadow,d.hemisphereLights.value=i.state.hemi,d.directionalShadowMap.value=i.state.directionalShadowMap,d.directionalShadowMatrix.value=i.state.directionalShadowMatrix,d.spotShadowMap.value=i.state.spotShadowMap,d.spotShadowMatrix.value=i.state.spotShadowMatrix,d.pointShadowMap.value=i.state.pointShadowMap,d.pointShadowMatrix.value=i.state.pointShadowMatrix);var p=r.program.getUniforms(),h=Si.seqWithValue(p.seq,d);r.uniformsList=h}function $e(e,t,n,r){!0!==t.isScene&&(t=V),Z.resetTextureUnits();var i=t.fog,o=n.isMeshStandardMaterial?t.environment:null,a=null===S?g.outputEncoding:S.texture.encoding,s=Q.get(n.envMap||o),u=X.get(n),c=f.state.lights;if(!0===B&&(!0===F||e!==O)){var l=e===O&&n.id===T;se.setState(n,e,l)}n.version===u.__version?n.fog&&u.fog!==i||u.environment!==o||u.needsLights&&u.lightsStateVersion!==c.state.version?Pe(n,t,r):void 0===u.numClippingPlanes||u.numClippingPlanes===se.numPlanes&&u.numIntersection===se.numIntersection?(u.outputEncoding!==a||u.envMap!==s)&&Pe(n,t,r):Pe(n,t,r):(Pe(n,t,r),u.__version=n.version);var d,p,h=!1,m=!1,v=!1,y=u.program,_=y.getUniforms(),b=u.uniforms;if(Y.useProgram(y.program)&&(h=!0,m=!0,v=!0),n.id!==T&&(T=n.id,m=!0),h||O!==e){if(_.setValue(he,"projectionMatrix",e.projectionMatrix),W.logarithmicDepthBuffer&&_.setValue(he,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),O!==e&&(O=e,m=!0,v=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var E=_.map.cameraPosition;void 0!==E&&E.setValue(he,G.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&_.setValue(he,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&_.setValue(he,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){_.setOptional(he,r,"bindMatrix"),_.setOptional(he,r,"bindMatrixInverse");var I=r.skeleton;if(I){var R=I.bones;if(W.floatVertexTextures){if(null===I.boneTexture){var A=Math.sqrt(4*R.length);A=ve.ceilPowerOfTwo(A),A=Math.max(A,4);var L=new Float32Array(A*A*4);L.set(I.boneMatrices);var C=new tr(L,A,A,x,w);I.boneMatrices=L,I.boneTexture=C,I.boneTextureSize=A}_.setValue(he,"boneTexture",I.boneTexture,Z),_.setValue(he,"boneTextureSize",I.boneTextureSize)}else _.setOptional(he,I,"boneMatrices")}}return(m||u.receiveShadow!==r.receiveShadow)&&(u.receiveShadow=r.receiveShadow,_.setValue(he,"receiveShadow",r.receiveShadow)),m&&(_.setValue(he,"toneMappingExposure",g.toneMappingExposure),u.needsLights&&(p=v,(d=b).ambientLightColor.needsUpdate=p,d.lightProbe.needsUpdate=p,d.directionalLights.needsUpdate=p,d.directionalLightShadows.needsUpdate=p,d.pointLights.needsUpdate=p,d.pointLightShadows.needsUpdate=p,d.spotLights.needsUpdate=p,d.spotLightShadows.needsUpdate=p,d.rectAreaLights.needsUpdate=p,d.hemisphereLights.needsUpdate=p),i&&n.fog&&ie.refreshFogUniforms(b,i),ie.refreshMaterialUniforms(b,n,M,N),Si.upload(he,u.uniformsList,b,Z)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Si.upload(he,u.uniformsList,b,Z),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&_.setValue(he,"center",r.center),_.setValue(he,"modelViewMatrix",r.modelViewMatrix),_.setValue(he,"normalMatrix",r.normalMatrix),_.setValue(he,"modelMatrix",r.matrixWorld),y}Le.setAnimationLoop((function(e){Se.isPresenting||Ae&&Ae(e)})),"undefined"!=typeof window&&Le.setContext(window),this.setAnimationLoop=function(e){Ae=e,Se.setAnimationLoop(e),null===e?Le.stop():Le.start()},this.render=function(e,t){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0===t||!0===t.isCamera){if(!0!==m){fe.resetDefaultState(),T=-1,O=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===Se.enabled&&!0===Se.isPresenting&&(t=Se.getCamera(t)),!0===e.isScene&&e.onBeforeRender(g,e,t,n||S),(f=ae.get(e,h.length)).init(),h.push(f),q.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),j.setFromProjectionMatrix(q),F=this.localClippingEnabled,B=se.init(this.clippingPlanes,F,t),(p=oe.get(e,t)).init(),Ce(e,t,0,g.sortObjects),p.finish(),!0===g.sortObjects&&p.sort(P,$),!0===B&&se.beginShadows();var i=f.state.shadowsArray;Ee.render(i,e,t),f.setupLights(),f.setupLightsView(t),!0===B&&se.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),ue.render(p,e,t,r);var o=p.opaque,a=p.transparent;o.length>0&&Ne(o,e,t),a.length>0&&Ne(a,e,t),!0===e.isScene&&e.onAfterRender(g,e,t),null!==S&&(Z.updateRenderTargetMipmap(S),Z.updateMultisampleRenderTarget(S)),Y.buffers.depth.setTest(!0),Y.buffers.depth.setMask(!0),Y.buffers.color.setMask(!0),Y.setPolygonOffset(!1),h.pop(),f=h.length>0?h[h.length-1]:null,p=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){v!==e&&null===S&&he.bindFramebuffer(36160,e),v=e},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return _},this.getRenderList=function(){return p},this.setRenderList=function(e){p=e},this.getRenderTarget=function(){return S},this.setRenderTarget=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),S=e,y=t,_=n,e&&void 0===X.get(e).__webglFramebuffer&&Z.setupRenderTarget(e);var r=v,i=!1;if(e){var o=X.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=o[t],i=!0):r=e.isWebGLMultisampleRenderTarget?X.get(e).__webglMultisampledFramebuffer:o,R.copy(e.viewport),A.copy(e.scissor),L=e.scissorTest}else R.copy(k).multiplyScalar(M).floor(),A.copy(D).multiplyScalar(M).floor(),L=U;if(E!==r&&(he.bindFramebuffer(36160,r),E=r),Y.viewport(R),Y.scissor(A),Y.setScissorTest(L),i){var a=X.get(e.texture);he.framebufferTexture2D(36160,36064,34069+t,a.__webglTexture,n)}},this.readRenderTargetPixels=function(e,t,n,r,i,o,a){if(e&&e.isWebGLRenderTarget){var s=X.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){var u=!1;s!==E&&(he.bindFramebuffer(36160,s),u=!0);try{var c=e.texture,l=c.format,d=c.type;if(l!==x&&pe.convert(l)!==he.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var p=d===I&&(z.has("EXT_color_buffer_half_float")||W.isWebGL2&&z.has("EXT_color_buffer_float"));if(!(d===b||pe.convert(d)===he.getParameter(35738)||d===w&&(W.isWebGL2||z.has("OES_texture_float")||z.has("WEBGL_color_buffer_float"))||p))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===he.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&he.readPixels(t,n,r,i,pe.convert(l),pe.convert(d),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{u&&he.bindFramebuffer(36160,E)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(t.image.width*r),o=Math.floor(t.image.height*r),a=pe.convert(t.format);Z.setTexture2D(t,0),he.copyTexImage2D(3553,n,a,e.x,e.y,i,o,0),Y.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r){void 0===r&&(r=0);var i=t.image.width,o=t.image.height,a=pe.convert(n.format),s=pe.convert(n.type);Z.setTexture2D(n,0),he.pixelStorei(37440,n.flipY),he.pixelStorei(37441,n.premultiplyAlpha),he.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?he.texSubImage2D(3553,r,e.x,e.y,i,o,a,s,t.image.data):t.isCompressedTexture?he.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,a,t.mipmaps[0].data):he.texSubImage2D(3553,r,e.x,e.y,a,s,t.image),0===r&&n.generateMipmaps&&he.generateMipmap(3553),Y.unbindTexture()},this.initTexture=function(e){Z.setTexture2D(e,0),Y.unbindTexture()},this.resetState=function(){Y.reset(),fe.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function po(e){lo.call(this,e)}oo.prototype=Object.assign(Object.create(Kn.prototype),{constructor:oo,isArrayCamera:!0}),ao.prototype=Object.assign(Object.create(xt.prototype),{constructor:ao,isGroup:!0}),Object.assign(so.prototype,{constructor:so,getHandSpace:function(){return null===this._hand&&(this._hand=new ao,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new ao,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new ao,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(e,t,n){var r=null,i=null,o=null,a=this._targetRay,s=this._grip,u=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(u&&e.hand){o=!0;for(var c,l=de(e.hand.values());!(c=l()).done;){var d=c.value,p=t.getJointPose(d,n);if(void 0===u.joints[d.jointName]){var f=new ao;f.matrixAutoUpdate=!1,f.visible=!1,u.joints[d.jointName]=f,u.add(f)}var h=u.joints[d.jointName];null!==p&&(h.matrix.fromArray(p.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.jointRadius=p.radius),h.visible=null!==p}var g=u.joints["index-finger-tip"],m=u.joints["thumb-tip"],v=g.position.distanceTo(m.position);u.inputState.pinching&&v>.025?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&v<=.015&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&null!==(r=t.getPose(e.targetRaySpace,n))&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale)),null!==s&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale));return null!==a&&(a.visible=null!==r),null!==s&&(s.visible=null!==i),null!==u&&(u.visible=null!==o),this}}),Object.assign(uo.prototype,pe.prototype),po.prototype=Object.assign(Object.create(lo.prototype),{constructor:po,isWebGL1Renderer:!0});var fo=function(){function e(e,t){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new Yt(e),this.density=void 0!==t?t:25e-5}var t=e.prototype;return t.clone=function(){return new e(this.color,this.density)},t.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},e}(),ho=function(){function e(e,t,n){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new Yt(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}var t=e.prototype;return t.clone=function(){return new e(this.color,this.near,this.far)},t.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},e}(),go=function(e){function t(){var t;return t=e.call(this)||this,Object.defineProperty(ce(t),"isScene",{value:!0}),t.type="Scene",t.background=null,t.environment=null,t.fog=null,t.overrideMaterial=null,t.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:ce(t)})),t}ue(t,e);var n=t.prototype;return n.copy=function(t,n){return e.prototype.copy.call(this,t,n),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},n.toJSON=function(t){var n=e.prototype.toJSON.call(this,t);return null!==this.background&&(n.object.background=this.background.toJSON(t)),null!==this.environment&&(n.object.environment=this.environment.toJSON(t)),null!==this.fog&&(n.object.fog=this.fog.toJSON()),n},t}(xt);function mo(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=ne,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ve.generateUUID()}Object.defineProperty(mo.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(mo.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ve.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var t=new mo(new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ve.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var vo,yo=new Re;function _o(e,t,n,r){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}function bo(e){Zt.call(this),this.type="SpriteMaterial",this.color=new Yt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}Object.defineProperties(_o.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign(_o.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,n=this.data.count;t<n;t++)yo.x=this.getX(t),yo.y=this.getY(t),yo.z=this.getZ(t),yo.applyMatrix4(e),this.setXYZ(t,yo.x,yo.y,yo.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this},clone:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return new nn(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new _o(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),bo.prototype=Object.create(Zt.prototype),bo.prototype.constructor=bo,bo.prototype.isSpriteMaterial=!0,bo.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var So=new Re,Eo=new Re,wo=new Re,Io=new ye,To=new ye,Oo=new nt,xo=new Re,Ro=new Re,Ao=new Re,Lo=new ye,Co=new ye,No=new ye;function Mo(e){if(xt.call(this),this.type="Sprite",void 0===vo){vo=new In;var t=new mo(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);vo.setIndex([0,1,2,0,2,3]),vo.setAttribute("position",new _o(t,3,0,!1)),vo.setAttribute("uv",new _o(t,2,3,!1))}this.geometry=vo,this.material=void 0!==e?e:new bo,this.center=new ye(.5,.5)}function Po(e,t,n,r,i,o){Io.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(To.x=o*Io.x-i*Io.y,To.y=i*Io.x+o*Io.y):To.copy(Io),e.copy(t),e.x+=To.x,e.y+=To.y,e.applyMatrix4(Oo)}Mo.prototype=Object.assign(Object.create(xt.prototype),{constructor:Mo,isSprite:!0,raycast:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Eo.setFromMatrixScale(this.matrixWorld),Oo.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),wo.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Eo.multiplyScalar(-wo.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var o=this.center;Po(xo.set(-.5,-.5,0),wo,o,Eo,n,r),Po(Ro.set(.5,-.5,0),wo,o,Eo,n,r),Po(Ao.set(.5,.5,0),wo,o,Eo,n,r),Lo.set(0,0),Co.set(1,0),No.set(1,1);var a=e.ray.intersectTriangle(xo,Ro,Ao,!1,So);if(null!==a||(Po(Ro.set(-.5,.5,0),wo,o,Eo,n,r),Co.set(0,1),null!==(a=e.ray.intersectTriangle(xo,Ao,Ro,!1,So)))){var s=e.ray.origin.distanceTo(So);s<e.near||s>e.far||t.push({distance:s,point:So.clone(),uv:qt.getUV(So,xo,Ro,Ao,Lo,Co,No,new ye),face:null,object:this})}},copy:function(e){return xt.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}});var $o=new Re,ko=new Re;function Do(){xt.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}Do.prototype=Object.assign(Object.create(xt.prototype),{constructor:Do,isLOD:!0,copy:function(e){xt.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var i=t[n];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);var n,r=this.levels;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var t=this.levels;if(t.length>0){var n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null},raycast:function(e,t){if(this.levels.length>0){$o.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo($o);this.getObjectForDistance(n).raycast(e,t)}},update:function(e){var t=this.levels;if(t.length>1){$o.setFromMatrixPosition(e.matrixWorld),ko.setFromMatrixPosition(this.matrixWorld);var n,r,i=$o.distanceTo(ko)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}},toJSON:function(e){var t=xt.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}});var Uo=new Re,jo=new Ie,Bo=new Ie,Fo=new Re,qo=new nt;function Go(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),qn.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new nt,this.bindMatrixInverse=new nt}function Vo(){xt.call(this),this.type="Bone"}Go.prototype=Object.assign(Object.create(qn.prototype),{constructor:Go,isSkinnedMesh:!0,copy:function(e){return qn.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new Ie,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){qn.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(e,t){var n=this.skeleton,r=this.geometry;jo.fromBufferAttribute(r.attributes.skinIndex,e),Bo.fromBufferAttribute(r.attributes.skinWeight,e),Uo.fromBufferAttribute(r.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var i=0;i<4;i++){var o=Bo.getComponent(i);if(0!==o){var a=jo.getComponent(i);qo.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(Fo.copy(Uo).applyMatrix4(qo),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}),Vo.prototype=Object.assign(Object.create(xt.prototype),{constructor:Vo,isBone:!0});var Ho=new nt,zo=new nt;function Wo(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.uuid=ve.generateUUID(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(Wo.prototype,{init:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new nt)}},calculateInverses:function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new nt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}},pose:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,i=this.bones.length;r<i;r++){var o=this.bones[r];o&&(o.parent&&o.parent.isBone?(o.matrix.copy(o.parent.matrixWorld).invert(),o.matrix.multiply(o.matrixWorld)):o.matrix.copy(o.matrixWorld),o.matrix.decompose(o.position,o.quaternion,o.scale))}},update:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,o=e.length;i<o;i++){var a=e[i]?e[i].matrixWorld:zo;Ho.multiplyMatrices(a,t[i]),Ho.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)},clone:function(){return new Wo(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}},dispose:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var i=e.bones[n],o=t[i];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),o=new Vo),this.bones.push(o),this.boneInverses.push((new nt).fromArray(e.boneInverses[n]))}return this.init(),this},toJSON:function(){var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var t=this.bones,n=this.boneInverses,r=0,i=t.length;r<i;r++){var o=t[r];e.bones.push(o.uuid);var a=n[r];e.boneInverses.push(a.toArray())}return e}});var Jo=new nt,Yo=new nt,Ko=[],Xo=new qn;function Zo(e,t,n){qn.call(this,e,t),this.instanceMatrix=new nn(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}function Qo(e){Zt.call(this),this.type="LineBasicMaterial",this.color=new Yt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}Zo.prototype=Object.assign(Object.create(qn.prototype),{constructor:Zo,isInstancedMesh:!0,copy:function(e){return qn.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this},getColorAt:function(e,t){t.fromArray(this.instanceColor.array,3*e)},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var n=this.matrixWorld,r=this.count;if(Xo.geometry=this.geometry,Xo.material=this.material,void 0!==Xo.material)for(var i=0;i<r;i++){this.getMatrixAt(i,Jo),Yo.multiplyMatrices(n,Jo),Xo.matrixWorld=Yo,Xo.raycast(e,Ko);for(var o=0,a=Ko.length;o<a;o++){var s=Ko[o];s.instanceId=i,s.object=this,t.push(s)}Ko.length=0}},setColorAt:function(e,t){null===this.instanceColor&&(this.instanceColor=new nn(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Qo.prototype=Object.create(Zt.prototype),Qo.prototype.constructor=Qo,Qo.prototype.isLineBasicMaterial=!0,Qo.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};var ea=new Re,ta=new Re,na=new nt,ra=new tt,ia=new We;function oa(e,t){void 0===e&&(e=new In),void 0===t&&(t=new Qo),xt.call(this),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}oa.prototype=Object.assign(Object.create(xt.prototype),{constructor:oa,isLine:!0,copy:function(e){return xt.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)ea.fromBufferAttribute(t,r-1),ta.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=ea.distanceTo(ta);e.setAttribute("lineDistance",new pn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),ia.copy(n.boundingSphere),ia.applyMatrix4(r),ia.radius+=i,!1!==e.ray.intersectsSphere(ia)){na.copy(r).invert(),ra.copy(e.ray).applyMatrix4(na);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,s=new Re,u=new Re,c=new Re,l=new Re,d=this.isLineSegments?2:1;if(n.isBufferGeometry){var p=n.index,f=n.attributes.position;if(null!==p)for(var h=p.array,g=0,m=h.length-1;g<m;g+=d){var v=h[g],y=h[g+1];if(s.fromBufferAttribute(f,v),u.fromBufferAttribute(f,y),!(ra.distanceSqToSegment(s,u,l,c)>a)){l.applyMatrix4(this.matrixWorld);var _=e.ray.origin.distanceTo(l);_<e.near||_>e.far||t.push({distance:_,point:c.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}}else for(var b=0,S=f.count-1;b<S;b+=d){if(s.fromBufferAttribute(f,b),u.fromBufferAttribute(f,b+1),!(ra.distanceSqToSegment(s,u,l,c)>a)){l.applyMatrix4(this.matrixWorld);var E=e.ray.origin.distanceTo(l);E<e.near||E>e.far||t.push({distance:E,point:c.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var aa=new Re,sa=new Re;function ua(e,t){oa.call(this,e,t),this.type="LineSegments"}function ca(e,t){oa.call(this,e,t),this.type="LineLoop"}function la(e){Zt.call(this),this.type="PointsMaterial",this.color=new Yt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}ua.prototype=Object.assign(Object.create(oa.prototype),{constructor:ua,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)aa.fromBufferAttribute(t,r),sa.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+aa.distanceTo(sa);e.setAttribute("lineDistance",new pn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}),ca.prototype=Object.assign(Object.create(oa.prototype),{constructor:ca,isLineLoop:!0}),la.prototype=Object.create(Zt.prototype),la.prototype.constructor=la,la.prototype.isPointsMaterial=!0,la.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var da=new nt,pa=new tt,fa=new We,ha=new Re;function ga(e,t){void 0===e&&(e=new In),void 0===t&&(t=new la),xt.call(this),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}function ma(e,t,n,r,i,o,a){var s=pa.distanceSqToPoint(e);if(s<n){var u=new Re;pa.closestPointToPoint(e,u),u.applyMatrix4(r);var c=i.ray.origin.distanceTo(u);if(c<i.near||c>i.far)return;o.push({distance:c,distanceToRay:Math.sqrt(s),point:u,index:t,face:null,object:a})}}function va(e,t,n,r,i,o,a,s,u){Ee.call(this,e,t,n,r,i,o,a,s,u),this.format=void 0!==a?a:O,this.minFilter=void 0!==o?o:v,this.magFilter=void 0!==i?i:v,this.generateMipmaps=!1;var c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}function ya(e,t,n,r,i,o,a,s,u,c,l,d){Ee.call(this,null,o,a,s,u,c,r,i,l,d),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function _a(e,t,n,r,i,o,a,s,u){Ee.call(this,e,t,n,r,i,o,a,s,u),this.needsUpdate=!0}function ba(e,t,n,r,i,o,a,s,u,c){if((c=void 0!==c?c:R)!==R&&c!==A)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===R&&(n=S),void 0===n&&c===A&&(n=T),Ee.call(this,null,r,i,o,a,s,c,n,u),this.image={width:e,height:t},this.magFilter=void 0!==a?a:h,this.minFilter=void 0!==s?s:h,this.flipY=!1,this.generateMipmaps=!1}ga.prototype=Object.assign(Object.create(xt.prototype),{constructor:ga,isPoints:!0,copy:function(e){return xt.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),fa.copy(n.boundingSphere),fa.applyMatrix4(r),fa.radius+=i,!1!==e.ray.intersectsSphere(fa)){da.copy(r).invert(),pa.copy(e.ray).applyMatrix4(da);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){var s=n.index,u=n.attributes.position;if(null!==s)for(var c=s.array,l=0,d=c.length;l<d;l++){var p=c[l];ha.fromBufferAttribute(u,p),ma(ha,p,a,r,e,t,this)}else for(var f=0,h=u.count;f<h;f++)ha.fromBufferAttribute(u,f),ma(ha,f,a,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,o=r.length;i<o;i++){var a=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),va.prototype=Object.assign(Object.create(Ee.prototype),{constructor:va,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){var e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),ya.prototype=Object.create(Ee.prototype),ya.prototype.constructor=ya,ya.prototype.isCompressedTexture=!0,_a.prototype=Object.create(Ee.prototype),_a.prototype.constructor=_a,_a.prototype.isCanvasTexture=!0,ba.prototype=Object.create(Ee.prototype),ba.prototype.constructor=ba,ba.prototype.isDepthTexture=!0;var Sa=function(e){function t(t,n,r,i){var o;void 0===t&&(t=1),void 0===n&&(n=8),void 0===r&&(r=0),void 0===i&&(i=2*Math.PI),(o=e.call(this)||this).type="CircleGeometry",o.parameters={radius:t,segments:n,thetaStart:r,thetaLength:i},n=Math.max(3,n);var a=[],s=[],u=[],c=[],l=new Re,d=new ye;s.push(0,0,0),u.push(0,0,1),c.push(.5,.5);for(var p=0,f=3;p<=n;p++,f+=3){var h=r+p/n*i;l.x=t*Math.cos(h),l.y=t*Math.sin(h),s.push(l.x,l.y,l.z),u.push(0,0,1),d.x=(s[f]/t+1)/2,d.y=(s[f+1]/t+1)/2,c.push(d.x,d.y)}for(var g=1;g<=n;g++)a.push(g,g+1,0);return o.setIndex(a),o.setAttribute("position",new pn(s,3)),o.setAttribute("normal",new pn(u,3)),o.setAttribute("uv",new pn(c,2)),o}return ue(t,e),t}(In),Ea=function(e){function t(t,n,r,i,o,a,s,u){var c;void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=8),void 0===o&&(o=1),void 0===a&&(a=!1),void 0===s&&(s=0),void 0===u&&(u=2*Math.PI),(c=e.call(this)||this).type="CylinderGeometry",c.parameters={radiusTop:t,radiusBottom:n,height:r,radialSegments:i,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:u};var l=ce(c);i=Math.floor(i),o=Math.floor(o);var d=[],p=[],f=[],h=[],g=0,m=[],v=r/2,y=0;function _(e){for(var r=g,o=new ye,a=new Re,c=0,m=!0===e?t:n,_=!0===e?1:-1,b=1;b<=i;b++)p.push(0,v*_,0),f.push(0,_,0),h.push(.5,.5),g++;for(var S=g,E=0;E<=i;E++){var w=E/i*u+s,I=Math.cos(w),T=Math.sin(w);a.x=m*T,a.y=v*_,a.z=m*I,p.push(a.x,a.y,a.z),f.push(0,_,0),o.x=.5*I+.5,o.y=.5*T*_+.5,h.push(o.x,o.y),g++}for(var O=0;O<i;O++){var x=r+O,R=S+O;!0===e?d.push(R,R+1,x):d.push(R+1,R,x),c+=3}l.addGroup(y,c,!0===e?1:2),y+=c}return function(){for(var e=new Re,a=new Re,c=0,_=(n-t)/r,b=0;b<=o;b++){for(var S=[],E=b/o,w=E*(n-t)+t,I=0;I<=i;I++){var T=I/i,O=T*u+s,x=Math.sin(O),R=Math.cos(O);a.x=w*x,a.y=-E*r+v,a.z=w*R,p.push(a.x,a.y,a.z),e.set(x,_,R).normalize(),f.push(e.x,e.y,e.z),h.push(T,1-E),S.push(g++)}m.push(S)}for(var A=0;A<i;A++)for(var L=0;L<o;L++){var C=m[L][A],N=m[L+1][A],M=m[L+1][A+1],P=m[L][A+1];d.push(C,N,P),d.push(N,M,P),c+=6}l.addGroup(y,c,0),y+=c}(),!1===a&&(t>0&&_(!0),n>0&&_(!1)),c.setIndex(d),c.setAttribute("position",new pn(p,3)),c.setAttribute("normal",new pn(f,3)),c.setAttribute("uv",new pn(h,2)),c}return ue(t,e),t}(In),wa=function(e){function t(t,n,r,i,o,a,s){var u;return void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=8),void 0===i&&(i=1),void 0===o&&(o=!1),void 0===a&&(a=0),void 0===s&&(s=2*Math.PI),(u=e.call(this,0,t,n,r,i,o,a,s)||this).type="ConeGeometry",u.parameters={radius:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},u}return ue(t,e),t}(Ea),Ia=function(e){function t(t,n,r,i){var o;void 0===r&&(r=1),void 0===i&&(i=0),(o=e.call(this)||this).type="PolyhedronGeometry",o.parameters={vertices:t,indices:n,radius:r,detail:i};var a=[],s=[];function u(e,t,n,r){for(var i=r+1,o=[],a=0;a<=i;a++){o[a]=[];for(var s=e.clone().lerp(n,a/i),u=t.clone().lerp(n,a/i),l=i-a,d=0;d<=l;d++)o[a][d]=0===d&&a===i?s:s.clone().lerp(u,d/l)}for(var p=0;p<i;p++)for(var f=0;f<2*(i-p)-1;f++){var h=Math.floor(f/2);f%2==0?(c(o[p][h+1]),c(o[p+1][h]),c(o[p][h])):(c(o[p][h+1]),c(o[p+1][h+1]),c(o[p+1][h]))}}function c(e){a.push(e.x,e.y,e.z)}function l(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function d(e,t,n,r){r<0&&1===e.x&&(s[t]=e.x-1),0===n.x&&0===n.z&&(s[t]=r/2/Math.PI+.5)}function p(e){return Math.atan2(e.z,-e.x)}return function(e){for(var t=new Re,r=new Re,i=new Re,o=0;o<n.length;o+=3)l(n[o+0],t),l(n[o+1],r),l(n[o+2],i),u(t,r,i,e)}(i),function(e){for(var t=new Re,n=0;n<a.length;n+=3)t.x=a[n+0],t.y=a[n+1],t.z=a[n+2],t.normalize().multiplyScalar(e),a[n+0]=t.x,a[n+1]=t.y,a[n+2]=t.z}(r),function(){for(var e=new Re,t=0;t<a.length;t+=3){e.x=a[t+0],e.y=a[t+1],e.z=a[t+2];var n=p(e)/2/Math.PI+.5,r=(i=e,Math.atan2(-i.y,Math.sqrt(i.x*i.x+i.z*i.z))/Math.PI+.5);s.push(n,1-r)}var i;(function(){for(var e=new Re,t=new Re,n=new Re,r=new Re,i=new ye,o=new ye,u=new ye,c=0,l=0;c<a.length;c+=9,l+=6){e.set(a[c+0],a[c+1],a[c+2]),t.set(a[c+3],a[c+4],a[c+5]),n.set(a[c+6],a[c+7],a[c+8]),i.set(s[l+0],s[l+1]),o.set(s[l+2],s[l+3]),u.set(s[l+4],s[l+5]),r.copy(e).add(t).add(n).divideScalar(3);var f=p(r);d(i,l+0,e,f),d(o,l+2,t,f),d(u,l+4,n,f)}})(),function(){for(var e=0;e<s.length;e+=6){var t=s[e+0],n=s[e+2],r=s[e+4],i=Math.max(t,n,r),o=Math.min(t,n,r);i>.9&&o<.1&&(t<.2&&(s[e+0]+=1),n<.2&&(s[e+2]+=1),r<.2&&(s[e+4]+=1))}}()}(),o.setAttribute("position",new pn(a,3)),o.setAttribute("normal",new pn(a.slice(),3)),o.setAttribute("uv",new pn(s,2)),0===i?o.computeVertexNormals():o.normalizeNormals(),o}return ue(t,e),t}(In),Ta=function(e){function t(t,n){var r;void 0===t&&(t=1),void 0===n&&(n=0);var i=(1+Math.sqrt(5))/2,o=1/i,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-i,0,-o,i,0,o,-i,0,o,i,-o,-i,0,-o,i,0,o,-i,0,o,i,0,-i,0,-o,i,0,-o,-i,0,o,i,0,o];return(r=e.call(this,a,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,n)||this).type="DodecahedronGeometry",r.parameters={radius:t,detail:n},r}return ue(t,e),t}(Ia),Oa=new Re,xa=new Re,Ra=new Re,Aa=new qt,La=function(e){function t(t,n){var r;if((r=e.call(this)||this).type="EdgesGeometry",r.parameters={thresholdAngle:n},n=void 0!==n?n:1,!0===t.isGeometry)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),ce(r);for(var i=Math.pow(10,4),o=Math.cos(ve.DEG2RAD*n),a=t.getIndex(),s=t.getAttribute("position"),u=a?a.count:s.count,c=[0,0,0],l=["a","b","c"],d=new Array(3),p={},f=[],h=0;h<u;h+=3){a?(c[0]=a.getX(h),c[1]=a.getX(h+1),c[2]=a.getX(h+2)):(c[0]=h,c[1]=h+1,c[2]=h+2);var g=Aa.a,m=Aa.b,v=Aa.c;if(g.fromBufferAttribute(s,c[0]),m.fromBufferAttribute(s,c[1]),v.fromBufferAttribute(s,c[2]),Aa.getNormal(Ra),d[0]=Math.round(g.x*i)+","+Math.round(g.y*i)+","+Math.round(g.z*i),d[1]=Math.round(m.x*i)+","+Math.round(m.y*i)+","+Math.round(m.z*i),d[2]=Math.round(v.x*i)+","+Math.round(v.y*i)+","+Math.round(v.z*i),d[0]!==d[1]&&d[1]!==d[2]&&d[2]!==d[0])for(var y=0;y<3;y++){var _=(y+1)%3,b=d[y],S=d[_],E=Aa[l[y]],w=Aa[l[_]],I=b+"_"+S,T=S+"_"+b;T in p&&p[T]?(Ra.dot(p[T].normal)<=o&&(f.push(E.x,E.y,E.z),f.push(w.x,w.y,w.z)),p[T]=null):I in p||(p[I]={index0:c[y],index1:c[_],normal:Ra.clone()})}}for(var O in p)if(p[O]){var x=p[O],R=x.index0,A=x.index1;Oa.fromBufferAttribute(s,R),xa.fromBufferAttribute(s,A),f.push(Oa.x,Oa.y,Oa.z),f.push(xa.x,xa.y,xa.z)}return r.setAttribute("position",new pn(f,3)),r}return ue(t,e),t}(In),Ca=function(e,t,n){n=n||2;var r,i,o,a,s,u,c,l=t&&t.length,d=l?t[0]*n:e.length,p=Na(e,0,d,n,!0),f=[];if(!p||p.next===p.prev)return f;if(l&&(p=function(e,t,n,r){var i,o,a,s=[];for(i=0,o=t.length;i<o;i++)(a=Na(e,t[i]*r,i<o-1?t[i+1]*r:e.length,r,!1))===a.next&&(a.steiner=!0),s.push(Ga(a));for(s.sort(ja),i=0;i<s.length;i++)Ba(s[i],n),n=Ma(n,n.next);return n}(e,t,p,n)),e.length>80*n){r=o=e[0],i=a=e[1];for(var h=n;h<d;h+=n)(s=e[h])<r&&(r=s),(u=e[h+1])<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=0!==(c=Math.max(o-r,a-i))?1/c:0}return Pa(p,f,n,r,i,c),f};function Na(e,t,n,r,i){var o,a;if(i===function(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}(e,t,n,r)>0)for(o=t;o<n;o+=r)a=Qa(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=Qa(o,e[o],e[o+1],a);return a&&Wa(a,a.next)&&(es(a),a=a.next),a}function Ma(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!Wa(r,r.next)&&0!==za(r.prev,r,r.next))r=r.next;else{if(es(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Pa(e,t,n,r,i,o,a){if(e){!a&&o&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=qa(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,s,u,c=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,s=0,t=0;t<c&&(s++,r=r.nextZ);t++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(e,r,i,o);for(var s,u,c=e;e.prev!==e.next;)if(s=e.prev,u=e.next,o?ka(e,r,i,o):$a(e))t.push(s.i/n),t.push(e.i/n),t.push(u.i/n),es(e),e=u.next,c=u.next;else if((e=u)===c){a?1===a?Pa(e=Da(Ma(e),t,n),t,n,r,i,o,2):2===a&&Ua(e,t,n,r,i,o):Pa(Ma(e),t,n,r,i,o,1);break}}}function $a(e){var t=e.prev,n=e,r=e.next;if(za(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(Va(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&za(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function ka(e,t,n,r){var i=e.prev,o=e,a=e.next;if(za(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,d=qa(s,u,t,n,r),p=qa(c,l,t,n,r),f=e.prevZ,h=e.nextZ;f&&f.z>=d&&h&&h.z<=p;){if(f!==e.prev&&f!==e.next&&Va(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&za(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,h!==e.prev&&h!==e.next&&Va(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&za(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;f&&f.z>=d;){if(f!==e.prev&&f!==e.next&&Va(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&za(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;h&&h.z<=p;){if(h!==e.prev&&h!==e.next&&Va(i.x,i.y,o.x,o.y,a.x,a.y,h.x,h.y)&&za(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function Da(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!Wa(i,o)&&Ja(i,r,r.next,o)&&Xa(i,o)&&Xa(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),es(r),es(r.next),r=e=o),r=r.next}while(r!==e);return Ma(r)}function Ua(e,t,n,r,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Ha(a,s)){var u=Za(a,s);return a=Ma(a,a.next),u=Ma(u,u.next),Pa(a,t,n,r,i,o),void Pa(u,t,n,r,i,o)}s=s.next}a=a.next}while(a!==e)}function ja(e,t){return e.x-t.x}function Ba(e,t){if(t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,d=n.y,p=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&Va(o<d?i:a,o,l,d,o<d?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),Xa(r,e)&&(u<p||u===p&&(r.x>n.x||r.x===n.x&&Fa(n,r)))&&(n=r,p=u)),r=r.next}while(r!==c);return n}(e,t)){var n=Za(t,e);Ma(t,t.next),Ma(n,n.next)}}function Fa(e,t){return za(e.prev,e,t.prev)<0&&za(t.next,e,e.next)<0}function qa(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ga(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Va(e,t,n,r,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Ha(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Ja(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Xa(e,t)&&Xa(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(za(e.prev,e,t.prev)||za(e,t.prev,t))||Wa(e,t)&&za(e.prev,e,e.next)>0&&za(t.prev,t,t.next)>0)}function za(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Wa(e,t){return e.x===t.x&&e.y===t.y}function Ja(e,t,n,r){var i=Ka(za(e,t,n)),o=Ka(za(e,t,r)),a=Ka(za(n,r,e)),s=Ka(za(n,r,t));return i!==o&&a!==s||(!(0!==i||!Ya(e,n,t))||(!(0!==o||!Ya(e,r,t))||(!(0!==a||!Ya(n,e,r))||!(0!==s||!Ya(n,t,r)))))}function Ya(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Ka(e){return e>0?1:e<0?-1:0}function Xa(e,t){return za(e.prev,e,e.next)<0?za(e,t,e.next)>=0&&za(e,e.prev,t)>=0:za(e,t,e.prev)<0||za(e,e.next,t)<0}function Za(e,t){var n=new ts(e.i,e.x,e.y),r=new ts(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function Qa(e,t,n,r){var i=new ts(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function es(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ts(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var ns={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return ns.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[];rs(e),is(n,e);var o=e.length;t.forEach(rs);for(var a=0;a<t.length;a++)r.push(o),o+=t[a].length,is(n,t[a]);for(var s=Ca(n,r),u=0;u<s.length;u+=3)i.push(s.slice(u,u+3));return i}};function rs(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function is(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var os=function(e){function t(t,n){var r;(r=e.call(this)||this).type="ExtrudeGeometry",r.parameters={shapes:t,options:n},t=Array.isArray(t)?t:[t];for(var i=ce(r),o=[],a=[],s=0,u=t.length;s<u;s++){c(t[s])}function c(e){var t=[],r=void 0!==n.curveSegments?n.curveSegments:12,s=void 0!==n.steps?n.steps:1,u=void 0!==n.depth?n.depth:100,c=void 0===n.bevelEnabled||n.bevelEnabled,l=void 0!==n.bevelThickness?n.bevelThickness:6,d=void 0!==n.bevelSize?n.bevelSize:l-2,p=void 0!==n.bevelOffset?n.bevelOffset:0,f=void 0!==n.bevelSegments?n.bevelSegments:3,h=n.extrudePath,g=void 0!==n.UVGenerator?n.UVGenerator:as;void 0!==n.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=n.amount);var m,v,y,_,b,S=!1;h&&(m=h.getSpacedPoints(s),S=!0,c=!1,v=h.computeFrenetFrames(s,!1),y=new Re,_=new Re,b=new Re),c||(f=0,l=0,d=0,p=0);var E=e.extractPoints(r),w=E.shape,I=E.holes;if(!ns.isClockWise(w)){w=w.reverse();for(var T=0,O=I.length;T<O;T++){var x=I[T];ns.isClockWise(x)&&(I[T]=x.reverse())}}for(var R=ns.triangulateShape(w,I),A=w,L=0,C=I.length;L<C;L++){var N=I[L];w=w.concat(N)}function M(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var P=w.length,$=R.length;function k(e,t,n){var r,i,o,a=e.x-t.x,s=e.y-t.y,u=n.x-e.x,c=n.y-e.y,l=a*a+s*s,d=a*c-s*u;if(Math.abs(d)>Number.EPSILON){var p=Math.sqrt(l),f=Math.sqrt(u*u+c*c),h=t.x-s/p,g=t.y+a/p,m=((n.x-c/f-h)*c-(n.y+u/f-g)*u)/(a*c-s*u),v=(r=h+a*m-e.x)*r+(i=g+s*m-e.y)*i;if(v<=2)return new ye(r,i);o=Math.sqrt(v/2)}else{var y=!1;a>Number.EPSILON?u>Number.EPSILON&&(y=!0):a<-Number.EPSILON?u<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(c)&&(y=!0),y?(r=-s,i=a,o=Math.sqrt(l)):(r=a,i=s,o=Math.sqrt(l/2))}return new ye(r/o,i/o)}for(var D=[],U=0,j=A.length,B=j-1,F=U+1;U<j;U++,B++,F++)B===j&&(B=0),F===j&&(F=0),D[U]=k(A[U],A[B],A[F]);for(var q,G=[],V=D.concat(),H=0,z=I.length;H<z;H++){var W=I[H];q=[];for(var J=0,Y=W.length,K=Y-1,X=J+1;J<Y;J++,K++,X++)K===Y&&(K=0),X===Y&&(X=0),q[J]=k(W[J],W[K],W[X]);G.push(q),V=V.concat(q)}for(var Z=0;Z<f;Z++){for(var Q=Z/f,ee=l*Math.cos(Q*Math.PI/2),te=d*Math.sin(Q*Math.PI/2)+p,ne=0,re=A.length;ne<re;ne++){var ie=M(A[ne],D[ne],te);Me(ie.x,ie.y,-ee)}for(var oe=0,ae=I.length;oe<ae;oe++){var se=I[oe];q=G[oe];for(var ue=0,ce=se.length;ue<ce;ue++){var le=M(se[ue],q[ue],te);Me(le.x,le.y,-ee)}}}for(var de=d+p,pe=0;pe<P;pe++){var fe=c?M(w[pe],V[pe],de):w[pe];S?(_.copy(v.normals[0]).multiplyScalar(fe.x),y.copy(v.binormals[0]).multiplyScalar(fe.y),b.copy(m[0]).add(_).add(y),Me(b.x,b.y,b.z)):Me(fe.x,fe.y,0)}for(var he=1;he<=s;he++)for(var ge=0;ge<P;ge++){var me=c?M(w[ge],V[ge],de):w[ge];S?(_.copy(v.normals[he]).multiplyScalar(me.x),y.copy(v.binormals[he]).multiplyScalar(me.y),b.copy(m[he]).add(_).add(y),Me(b.x,b.y,b.z)):Me(me.x,me.y,u/s*he)}for(var ve=f-1;ve>=0;ve--){for(var _e=ve/f,be=l*Math.cos(_e*Math.PI/2),Se=d*Math.sin(_e*Math.PI/2)+p,Ee=0,we=A.length;Ee<we;Ee++){var Ie=M(A[Ee],D[Ee],Se);Me(Ie.x,Ie.y,u+be)}for(var Te=0,Oe=I.length;Te<Oe;Te++){var xe=I[Te];q=G[Te];for(var Ae=0,Le=xe.length;Ae<Le;Ae++){var Ce=M(xe[Ae],q[Ae],Se);S?Me(Ce.x,Ce.y+m[s-1].y,m[s-1].x+be):Me(Ce.x,Ce.y,u+be)}}}function Ne(e,t){for(var n=e.length;--n>=0;){var r=n,i=n-1;i<0&&(i=e.length-1);for(var o=0,a=s+2*f;o<a;o++){var u=P*o,c=P*(o+1);$e(t+r+u,t+i+u,t+i+c,t+r+c)}}}function Me(e,n,r){t.push(e),t.push(n),t.push(r)}function Pe(e,t,n){ke(e),ke(t),ke(n);var r=o.length/3,a=g.generateTopUV(i,o,r-3,r-2,r-1);De(a[0]),De(a[1]),De(a[2])}function $e(e,t,n,r){ke(e),ke(t),ke(r),ke(t),ke(n),ke(r);var a=o.length/3,s=g.generateSideWallUV(i,o,a-6,a-3,a-2,a-1);De(s[0]),De(s[1]),De(s[3]),De(s[1]),De(s[2]),De(s[3])}function ke(e){o.push(t[3*e+0]),o.push(t[3*e+1]),o.push(t[3*e+2])}function De(e){a.push(e.x),a.push(e.y)}!function(){var e=o.length/3;if(c){for(var t=0,n=P*t,r=0;r<$;r++){var a=R[r];Pe(a[2]+n,a[1]+n,a[0]+n)}n=P*(t=s+2*f);for(var u=0;u<$;u++){var l=R[u];Pe(l[0]+n,l[1]+n,l[2]+n)}}else{for(var d=0;d<$;d++){var p=R[d];Pe(p[2],p[1],p[0])}for(var h=0;h<$;h++){var g=R[h];Pe(g[0]+P*s,g[1]+P*s,g[2]+P*s)}}i.addGroup(e,o.length/3-e,0)}(),function(){var e=o.length/3,t=0;Ne(A,t),t+=A.length;for(var n=0,r=I.length;n<r;n++){var a=I[n];Ne(a,t),t+=a.length}i.addGroup(e,o.length/3-e,1)}()}return r.setAttribute("position",new pn(o,3)),r.setAttribute("uv",new pn(a,2)),r.computeVertexNormals(),r}return ue(t,e),t.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var o=e[r];n.shapes.push(o.uuid)}else n.shapes.push(e.uuid);void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)},t}(In),as={generateTopUV:function(e,t,n,r,i){var o=t[3*n],a=t[3*n+1],s=t[3*r],u=t[3*r+1],c=t[3*i],l=t[3*i+1];return[new ye(o,a),new ye(s,u),new ye(c,l)]},generateSideWallUV:function(e,t,n,r,i,o){var a=t[3*n],s=t[3*n+1],u=t[3*n+2],c=t[3*r],l=t[3*r+1],d=t[3*r+2],p=t[3*i],f=t[3*i+1],h=t[3*i+2],g=t[3*o],m=t[3*o+1],v=t[3*o+2];return Math.abs(s-l)<.01?[new ye(a,1-u),new ye(c,1-d),new ye(p,1-h),new ye(g,1-v)]:[new ye(s,1-u),new ye(l,1-d),new ye(f,1-h),new ye(m,1-v)]}};var ss=function(e){function t(t,n){var r;void 0===t&&(t=1),void 0===n&&(n=0);var i=(1+Math.sqrt(5))/2,o=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];return(r=e.call(this,o,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,n)||this).type="IcosahedronGeometry",r.parameters={radius:t,detail:n},r}return ue(t,e),t}(Ia),us=function(e){function t(t,n,r,i){var o;void 0===n&&(n=12),void 0===r&&(r=0),void 0===i&&(i=2*Math.PI),(o=e.call(this)||this).type="LatheGeometry",o.parameters={points:t,segments:n,phiStart:r,phiLength:i},n=Math.floor(n),i=ve.clamp(i,0,2*Math.PI);for(var a=[],s=[],u=[],c=1/n,l=new Re,d=new ye,p=0;p<=n;p++)for(var f=r+p*c*i,h=Math.sin(f),g=Math.cos(f),m=0;m<=t.length-1;m++)l.x=t[m].x*h,l.y=t[m].y,l.z=t[m].x*g,s.push(l.x,l.y,l.z),d.x=p/n,d.y=m/(t.length-1),u.push(d.x,d.y);for(var v=0;v<n;v++)for(var y=0;y<t.length-1;y++){var _=y+v*t.length,b=_,S=_+t.length,E=_+t.length+1,w=_+1;a.push(b,S,w),a.push(S,E,w)}if(o.setIndex(a),o.setAttribute("position",new pn(s,3)),o.setAttribute("uv",new pn(u,2)),o.computeVertexNormals(),i===2*Math.PI)for(var I=o.attributes.normal.array,T=new Re,O=new Re,x=new Re,R=n*t.length*3,A=0,L=0;A<t.length;A++,L+=3)T.x=I[L+0],T.y=I[L+1],T.z=I[L+2],O.x=I[R+L+0],O.y=I[R+L+1],O.z=I[R+L+2],x.addVectors(T,O).normalize(),I[L+0]=I[R+L+0]=x.x,I[L+1]=I[R+L+1]=x.y,I[L+2]=I[R+L+2]=x.z;return o}return ue(t,e),t}(In),cs=function(e){function t(t,n){var r;void 0===t&&(t=1),void 0===n&&(n=0);return(r=e.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,n)||this).type="OctahedronGeometry",r.parameters={radius:t,detail:n},r}return ue(t,e),t}(Ia);function ls(e,t,n){In.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};var r=[],i=[],o=[],a=[],s=1e-5,u=new Re,c=new Re,l=new Re,d=new Re,p=new Re;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var f=t+1,h=0;h<=n;h++)for(var g=h/n,m=0;m<=t;m++){var v=m/t;e(v,g,c),i.push(c.x,c.y,c.z),v-s>=0?(e(v-s,g,l),d.subVectors(c,l)):(e(v+s,g,l),d.subVectors(l,c)),g-s>=0?(e(v,g-s,l),p.subVectors(c,l)):(e(v,g+s,l),p.subVectors(l,c)),u.crossVectors(d,p).normalize(),o.push(u.x,u.y,u.z),a.push(v,g)}for(var y=0;y<n;y++)for(var _=0;_<t;_++){var b=y*f+_,S=y*f+_+1,E=(y+1)*f+_+1,w=(y+1)*f+_;r.push(b,S,w),r.push(S,E,w)}this.setIndex(r),this.setAttribute("position",new pn(i,3)),this.setAttribute("normal",new pn(o,3)),this.setAttribute("uv",new pn(a,2))}ls.prototype=Object.create(In.prototype),ls.prototype.constructor=ls;var ds=function(e){function t(t,n,r,i,o,a){var s;void 0===t&&(t=.5),void 0===n&&(n=1),void 0===r&&(r=8),void 0===i&&(i=1),void 0===o&&(o=0),void 0===a&&(a=2*Math.PI),(s=e.call(this)||this).type="RingGeometry",s.parameters={innerRadius:t,outerRadius:n,thetaSegments:r,phiSegments:i,thetaStart:o,thetaLength:a},r=Math.max(3,r);for(var u=[],c=[],l=[],d=[],p=t,f=(n-t)/(i=Math.max(1,i)),h=new Re,g=new ye,m=0;m<=i;m++){for(var v=0;v<=r;v++){var y=o+v/r*a;h.x=p*Math.cos(y),h.y=p*Math.sin(y),c.push(h.x,h.y,h.z),l.push(0,0,1),g.x=(h.x/n+1)/2,g.y=(h.y/n+1)/2,d.push(g.x,g.y)}p+=f}for(var _=0;_<i;_++)for(var b=_*(r+1),S=0;S<r;S++){var E=S+b,w=E,I=E+r+1,T=E+r+2,O=E+1;u.push(w,I,O),u.push(I,T,O)}return s.setIndex(u),s.setAttribute("position",new pn(c,3)),s.setAttribute("normal",new pn(l,3)),s.setAttribute("uv",new pn(d,2)),s}return ue(t,e),t}(In),ps=function(e){function t(t,n){var r;void 0===n&&(n=12),(r=e.call(this)||this).type="ShapeGeometry",r.parameters={shapes:t,curveSegments:n};var i=[],o=[],a=[],s=[],u=0,c=0;if(!1===Array.isArray(t))d(t);else for(var l=0;l<t.length;l++)d(t[l]),r.addGroup(u,c,l),u+=c,c=0;function d(e){var t=o.length/3,r=e.extractPoints(n),u=r.shape,l=r.holes;!1===ns.isClockWise(u)&&(u=u.reverse());for(var d=0,p=l.length;d<p;d++){var f=l[d];!0===ns.isClockWise(f)&&(l[d]=f.reverse())}for(var h=ns.triangulateShape(u,l),g=0,m=l.length;g<m;g++){var v=l[g];u=u.concat(v)}for(var y=0,_=u.length;y<_;y++){var b=u[y];o.push(b.x,b.y,0),a.push(0,0,1),s.push(b.x,b.y)}for(var S=0,E=h.length;S<E;S++){var w=h[S],I=w[0]+t,T=w[1]+t,O=w[2]+t;i.push(I,T,O),c+=3}}return r.setIndex(i),r.setAttribute("position",new pn(o,3)),r.setAttribute("normal",new pn(a,3)),r.setAttribute("uv",new pn(s,2)),r}return ue(t,e),t.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)},t}(In);var fs=function(e){function t(t,n,r,i,o,a,s){var u;void 0===t&&(t=1),void 0===n&&(n=8),void 0===r&&(r=6),void 0===i&&(i=0),void 0===o&&(o=2*Math.PI),void 0===a&&(a=0),void 0===s&&(s=Math.PI),(u=e.call(this)||this).type="SphereGeometry",u.parameters={radius:t,widthSegments:n,heightSegments:r,phiStart:i,phiLength:o,thetaStart:a,thetaLength:s},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));for(var c=Math.min(a+s,Math.PI),l=0,d=[],p=new Re,f=new Re,h=[],g=[],m=[],v=[],y=0;y<=r;y++){var _=[],b=y/r,S=0;0==y&&0==a?S=.5/n:y==r&&c==Math.PI&&(S=-.5/n);for(var E=0;E<=n;E++){var w=E/n;p.x=-t*Math.cos(i+w*o)*Math.sin(a+b*s),p.y=t*Math.cos(a+b*s),p.z=t*Math.sin(i+w*o)*Math.sin(a+b*s),g.push(p.x,p.y,p.z),f.copy(p).normalize(),m.push(f.x,f.y,f.z),v.push(w+S,1-b),_.push(l++)}d.push(_)}for(var I=0;I<r;I++)for(var T=0;T<n;T++){var O=d[I][T+1],x=d[I][T],R=d[I+1][T],A=d[I+1][T+1];(0!==I||a>0)&&h.push(O,x,A),(I!==r-1||c<Math.PI)&&h.push(x,R,A)}return u.setIndex(h),u.setAttribute("position",new pn(g,3)),u.setAttribute("normal",new pn(m,3)),u.setAttribute("uv",new pn(v,2)),u}return ue(t,e),t}(In),hs=function(e){function t(t,n){var r;void 0===t&&(t=1),void 0===n&&(n=0);return(r=e.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,n)||this).type="TetrahedronGeometry",r.parameters={radius:t,detail:n},r}return ue(t,e),t}(Ia),gs=function(e){function t(t,n){var r;void 0===n&&(n={});var i=n.font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new In||ce(r);var o=i.generateShapes(t,n.size);return n.depth=void 0!==n.height?n.height:50,void 0===n.bevelThickness&&(n.bevelThickness=10),void 0===n.bevelSize&&(n.bevelSize=8),void 0===n.bevelEnabled&&(n.bevelEnabled=!1),(r=e.call(this,o,n)||this).type="TextGeometry",r}return ue(t,e),t}(os),ms=function(e){function t(t,n,r,i,o){var a;void 0===t&&(t=1),void 0===n&&(n=.4),void 0===r&&(r=8),void 0===i&&(i=6),void 0===o&&(o=2*Math.PI),(a=e.call(this)||this).type="TorusGeometry",a.parameters={radius:t,tube:n,radialSegments:r,tubularSegments:i,arc:o},r=Math.floor(r),i=Math.floor(i);for(var s=[],u=[],c=[],l=[],d=new Re,p=new Re,f=new Re,h=0;h<=r;h++)for(var g=0;g<=i;g++){var m=g/i*o,v=h/r*Math.PI*2;p.x=(t+n*Math.cos(v))*Math.cos(m),p.y=(t+n*Math.cos(v))*Math.sin(m),p.z=n*Math.sin(v),u.push(p.x,p.y,p.z),d.x=t*Math.cos(m),d.y=t*Math.sin(m),f.subVectors(p,d).normalize(),c.push(f.x,f.y,f.z),l.push(g/i),l.push(h/r)}for(var y=1;y<=r;y++)for(var _=1;_<=i;_++){var b=(i+1)*y+_-1,S=(i+1)*(y-1)+_-1,E=(i+1)*(y-1)+_,w=(i+1)*y+_;s.push(b,S,w),s.push(S,E,w)}return a.setIndex(s),a.setAttribute("position",new pn(u,3)),a.setAttribute("normal",new pn(c,3)),a.setAttribute("uv",new pn(l,2)),a}return ue(t,e),t}(In),vs=function(e){function t(t,n,r,i,o,a){var s;void 0===t&&(t=1),void 0===n&&(n=.4),void 0===r&&(r=64),void 0===i&&(i=8),void 0===o&&(o=2),void 0===a&&(a=3),(s=e.call(this)||this).type="TorusKnotGeometry",s.parameters={radius:t,tube:n,tubularSegments:r,radialSegments:i,p:o,q:a},r=Math.floor(r),i=Math.floor(i);for(var u=[],c=[],l=[],d=[],p=new Re,f=new Re,h=new Re,g=new Re,m=new Re,v=new Re,y=new Re,_=0;_<=r;++_){var b=_/r*o*Math.PI*2;C(b,o,a,t,h),C(b+.01,o,a,t,g),v.subVectors(g,h),y.addVectors(g,h),m.crossVectors(v,y),y.crossVectors(m,v),m.normalize(),y.normalize();for(var S=0;S<=i;++S){var E=S/i*Math.PI*2,w=-n*Math.cos(E),I=n*Math.sin(E);p.x=h.x+(w*y.x+I*m.x),p.y=h.y+(w*y.y+I*m.y),p.z=h.z+(w*y.z+I*m.z),c.push(p.x,p.y,p.z),f.subVectors(p,h).normalize(),l.push(f.x,f.y,f.z),d.push(_/r),d.push(S/i)}}for(var T=1;T<=r;T++)for(var O=1;O<=i;O++){var x=(i+1)*(T-1)+(O-1),R=(i+1)*T+(O-1),A=(i+1)*T+O,L=(i+1)*(T-1)+O;u.push(x,R,L),u.push(R,A,L)}function C(e,t,n,r,i){var o=Math.cos(e),a=Math.sin(e),s=n/t*e,u=Math.cos(s);i.x=r*(2+u)*.5*o,i.y=r*(2+u)*a*.5,i.z=r*Math.sin(s)*.5}return s.setIndex(u),s.setAttribute("position",new pn(c,3)),s.setAttribute("normal",new pn(l,3)),s.setAttribute("uv",new pn(d,2)),s}return ue(t,e),t}(In),ys=function(e){function t(t,n,r,i,o){var a;void 0===n&&(n=64),void 0===r&&(r=1),void 0===i&&(i=8),void 0===o&&(o=!1),(a=e.call(this)||this).type="TubeGeometry",a.parameters={path:t,tubularSegments:n,radius:r,radialSegments:i,closed:o};var s=t.computeFrenetFrames(n,o);a.tangents=s.tangents,a.normals=s.normals,a.binormals=s.binormals;var u=new Re,c=new Re,l=new ye,d=new Re,p=[],f=[],h=[],g=[];function m(e){d=t.getPointAt(e/n,d);for(var o=s.normals[e],a=s.binormals[e],l=0;l<=i;l++){var h=l/i*Math.PI*2,g=Math.sin(h),m=-Math.cos(h);c.x=m*o.x+g*a.x,c.y=m*o.y+g*a.y,c.z=m*o.z+g*a.z,c.normalize(),f.push(c.x,c.y,c.z),u.x=d.x+r*c.x,u.y=d.y+r*c.y,u.z=d.z+r*c.z,p.push(u.x,u.y,u.z)}}return function(){for(var e=0;e<n;e++)m(e);m(!1===o?n:0),function(){for(var e=0;e<=n;e++)for(var t=0;t<=i;t++)l.x=e/n,l.y=t/i,h.push(l.x,l.y)}(),function(){for(var e=1;e<=n;e++)for(var t=1;t<=i;t++){var r=(i+1)*(e-1)+(t-1),o=(i+1)*e+(t-1),a=(i+1)*e+t,s=(i+1)*(e-1)+t;g.push(r,o,s),g.push(o,a,s)}}()}(),a.setIndex(g),a.setAttribute("position",new pn(p,3)),a.setAttribute("normal",new pn(f,3)),a.setAttribute("uv",new pn(h,2)),a}return ue(t,e),t.prototype.toJSON=function(){var e=In.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},t}(In),_s=function(e){function t(t){var n;if((n=e.call(this)||this).type="WireframeGeometry",!0===t.isGeometry)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),ce(n);var r=[],i=[0,0],o={},a=new Re;if(null!==t.index){var s=t.attributes.position,u=t.index,c=t.groups;0===c.length&&(c=[{start:0,count:u.count,materialIndex:0}]);for(var l=0,d=c.length;l<d;++l)for(var p=c[l],f=p.start,h=f,g=f+p.count;h<g;h+=3)for(var m=0;m<3;m++){var v=u.getX(h+m),y=u.getX(h+(m+1)%3);i[0]=Math.min(v,y),i[1]=Math.max(v,y);var _=i[0]+","+i[1];void 0===o[_]&&(o[_]={index1:i[0],index2:i[1]})}for(var b in o){var S=o[b];a.fromBufferAttribute(s,S.index1),r.push(a.x,a.y,a.z),a.fromBufferAttribute(s,S.index2),r.push(a.x,a.y,a.z)}}else for(var E=t.attributes.position,w=0,I=E.count/3;w<I;w++)for(var T=0;T<3;T++){var O=3*w+T;a.fromBufferAttribute(E,O),r.push(a.x,a.y,a.z);var x=3*w+(T+1)%3;a.fromBufferAttribute(E,x),r.push(a.x,a.y,a.z)}return n.setAttribute("position",new pn(r,3)),n}return ue(t,e),t}(In),bs=Object.freeze({__proto__:null,BoxGeometry:Vn,BoxBufferGeometry:Vn,CircleGeometry:Sa,CircleBufferGeometry:Sa,ConeGeometry:wa,ConeBufferGeometry:wa,CylinderGeometry:Ea,CylinderBufferGeometry:Ea,DodecahedronGeometry:Ta,DodecahedronBufferGeometry:Ta,EdgesGeometry:La,ExtrudeGeometry:os,ExtrudeBufferGeometry:os,IcosahedronGeometry:ss,IcosahedronBufferGeometry:ss,LatheGeometry:us,LatheBufferGeometry:us,OctahedronGeometry:cs,OctahedronBufferGeometry:cs,ParametricGeometry:ls,ParametricBufferGeometry:ls,PlaneGeometry:sr,PlaneBufferGeometry:sr,PolyhedronGeometry:Ia,PolyhedronBufferGeometry:Ia,RingGeometry:ds,RingBufferGeometry:ds,ShapeGeometry:ps,ShapeBufferGeometry:ps,SphereGeometry:fs,SphereBufferGeometry:fs,TetrahedronGeometry:hs,TetrahedronBufferGeometry:hs,TextGeometry:gs,TextBufferGeometry:gs,TorusGeometry:ms,TorusBufferGeometry:ms,TorusKnotGeometry:vs,TorusKnotBufferGeometry:vs,TubeGeometry:ys,TubeBufferGeometry:ys,WireframeGeometry:_s});function Ss(e){Zt.call(this),this.type="ShadowMaterial",this.color=new Yt(0),this.transparent=!0,this.setValues(e)}function Es(e){Jn.call(this,e),this.type="RawShaderMaterial"}function ws(e){Zt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Yt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}function Is(e){ws.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ye(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=ve.clamp(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}function Ts(e){Zt.call(this),this.type="MeshPhongMaterial",this.color=new Yt(16777215),this.specular=new Yt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Os(e){Zt.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Yt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function xs(e){Zt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Rs(e){Zt.call(this),this.type="MeshLambertMaterial",this.color=new Yt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Yt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function As(e){Zt.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Yt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ls(e){Qo.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}Ss.prototype=Object.create(Zt.prototype),Ss.prototype.constructor=Ss,Ss.prototype.isShadowMaterial=!0,Ss.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.color.copy(e.color),this},Es.prototype=Object.create(Jn.prototype),Es.prototype.constructor=Es,Es.prototype.isRawShaderMaterial=!0,ws.prototype=Object.create(Zt.prototype),ws.prototype.constructor=ws,ws.prototype.isMeshStandardMaterial=!0,ws.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},Is.prototype=Object.create(ws.prototype),Is.prototype.constructor=Is,Is.prototype.isMeshPhysicalMaterial=!0,Is.prototype.copy=function(e){return ws.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new Yt).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this},Ts.prototype=Object.create(Zt.prototype),Ts.prototype.constructor=Ts,Ts.prototype.isMeshPhongMaterial=!0,Ts.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Os.prototype=Object.create(Zt.prototype),Os.prototype.constructor=Os,Os.prototype.isMeshToonMaterial=!0,Os.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},xs.prototype=Object.create(Zt.prototype),xs.prototype.constructor=xs,xs.prototype.isMeshNormalMaterial=!0,xs.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Rs.prototype=Object.create(Zt.prototype),Rs.prototype.constructor=Rs,Rs.prototype.isMeshLambertMaterial=!0,Rs.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},As.prototype=Object.create(Zt.prototype),As.prototype.constructor=As,As.prototype.isMeshMatcapMaterial=!0,As.prototype.copy=function(e){return Zt.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ls.prototype=Object.create(Qo.prototype),Ls.prototype.constructor=Ls,Ls.prototype.isLineDashedMaterial=!0,Ls.prototype.copy=function(e){return Qo.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Cs=Object.freeze({__proto__:null,ShadowMaterial:Ss,SpriteMaterial:bo,RawShaderMaterial:Es,ShaderMaterial:Jn,PointsMaterial:la,MeshPhysicalMaterial:Is,MeshStandardMaterial:ws,MeshPhongMaterial:Ts,MeshToonMaterial:Os,MeshNormalMaterial:xs,MeshLambertMaterial:Rs,MeshDepthMaterial:Qi,MeshDistanceMaterial:eo,MeshBasicMaterial:Qt,MeshMatcapMaterial:As,LineDashedMaterial:Ls,LineBasicMaterial:Qo,Material:Zt}),Ns={arraySlice:function(e,t,n){return Ns.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*t,u=0;u!==t;++u)i[a++]=e[s+u];return i},flattenJSON:function(e,t,n,r){for(var i=1,o=e[0];void 0!==o&&void 0===o[r];)o=e[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(t.push(o.time),n.push.apply(n,a)),o=e[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(t.push(o.time),a.toArray(n,n.length)),o=e[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(t.push(o.time),n.push(a)),o=e[i++]}while(void 0!==o)}},subclip:function(e,t,n,r,i){void 0===i&&(i=30);var o=e.clone();o.name=t;for(var a=[],s=0;s<o.tracks.length;++s){for(var u=o.tracks[s],c=u.getValueSize(),l=[],d=[],p=0;p<u.times.length;++p){var f=u.times[p]*i;if(!(f<n||f>=r)){l.push(u.times[p]);for(var h=0;h<c;++h)d.push(u.values[p*c+h])}}0!==l.length&&(u.times=Ns.convertArray(l,u.times.constructor),u.values=Ns.convertArray(d,u.values.constructor),a.push(u))}o.tracks=a;for(var g=1/0,m=0;m<o.tracks.length;++m)g>o.tracks[m].times[0]&&(g=o.tracks[m].times[0]);for(var v=0;v<o.tracks.length;++v)o.tracks[v].shift(-1*g);return o.resetDuration(),o},makeClipAdditive:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=e),void 0===r&&(r=30),r<=0&&(r=30);for(var i=n.tracks.length,o=t/r,a=function(t){var r=n.tracks[t],i=r.ValueTypeName;if("bool"===i||"string"===i)return"continue";var a=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===i}));if(void 0===a)return"continue";var s=0,u=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=u/3);var c=0,l=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=l/3);var d=r.times.length-1,p=void 0;if(o<=r.times[0]){var f=s,h=u-s;p=Ns.arraySlice(r.values,f,h)}else if(o>=r.times[d]){var g=d*u+s,m=g+u-s;p=Ns.arraySlice(r.values,g,m)}else{var v=r.createInterpolant(),y=s,_=u-s;v.evaluate(o),p=Ns.arraySlice(v.resultBuffer,y,_)}"quaternion"===i&&(new xe).fromArray(p).normalize().conjugate().toArray(p);for(var b=a.times.length,S=0;S<b;++S){var E=S*l+c;if("quaternion"===i)xe.multiplyQuaternionsFlat(a.values,E,p,0,a.values,E);else for(var w=l-2*c,I=0;I<w;++I)a.values[E+I]-=p[I]}},s=0;s<i;++s)a(s);return e.blendMode=W,e}};function Ms(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Ps(e,t,n,r){Ms.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function $s(e,t,n,r){Ms.call(this,e,t,n,r)}function ks(e,t,n,r){Ms.call(this,e,t,n,r)}function Ds(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ns.convertArray(t,this.TimeBufferType),this.values=Ns.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function Us(e,t,n){Ds.call(this,e,t,n)}function js(e,t,n,r){Ds.call(this,e,t,n,r)}function Bs(e,t,n,r){Ds.call(this,e,t,n,r)}function Fs(e,t,n,r){Ms.call(this,e,t,n,r)}function qs(e,t,n,r){Ds.call(this,e,t,n,r)}function Gs(e,t,n,r){Ds.call(this,e,t,n,r)}function Vs(e,t,n,r){Ds.call(this,e,t,n,r)}function Hs(e,t,n,r){void 0===t&&(t=-1),void 0===r&&(r=z),this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=ve.generateUUID(),this.duration<0&&this.resetDuration()}function zs(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Bs;case"vector":case"vector2":case"vector3":case"vector4":return Vs;case"color":return js;case"quaternion":return qs;case"bool":case"boolean":return Us;case"string":return Gs}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];Ns.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(Ms.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var o;n:{r:if(!(e<r)){for(var a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===a)break;if(i=r,e<(r=t[++n]))break t}o=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(var u=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===u)break;if(r=i,e>=(i=t[--n-1]))break t}o=n,n=0}for(;n<o;){var c=n+o>>>1;e<t[c]?o=c:n=c+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,o=0;o!==r;++o)t[o]=n[i+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Ms.prototype,{beforeStart_:Ms.prototype.copySampleValue_,afterEnd_:Ms.prototype.copySampleValue_}),Ps.prototype=Object.assign(Object.create(Ms.prototype),{constructor:Ps,DefaultSettings_:{endingStart:G,endingEnd:G},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,o=e+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case V:i=e,a=2*t-n;break;case H:a=t+r[i=r.length-2]-r[i+1];break;default:i=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case V:o=e,s=2*n-t;break;case H:o=1,s=n+r[1]-r[0];break;default:o=e-1,s=t}var u=.5*(n-t),c=this.valueSize;this._weightPrev=u/(t-a),this._weightNext=u/(s-n),this._offsetPrev=i*c,this._offsetNext=o*c},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,u=s-a,c=this._offsetPrev,l=this._offsetNext,d=this._weightPrev,p=this._weightNext,f=(n-t)/(r-t),h=f*f,g=h*f,m=-d*g+2*d*h-d*f,v=(1+d)*g+(-1.5-2*d)*h+(-.5+d)*f+1,y=(-1-p)*g+(1.5+p)*h+.5*f,_=p*g-p*h,b=0;b!==a;++b)i[b]=m*o[c+b]+v*o[u+b]+y*o[s+b]+_*o[l+b];return i}}),$s.prototype=Object.assign(Object.create(Ms.prototype),{constructor:$s,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,u=s-a,c=(n-t)/(r-t),l=1-c,d=0;d!==a;++d)i[d]=o[u+d]*l+o[s+d]*c;return i}}),ks.prototype=Object.assign(Object.create(Ms.prototype),{constructor:ks,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Ds,{toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:Ns.convertArray(e.times,Array),values:Ns.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}),Object.assign(Ds.prototype,{constructor:Ds,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:F,InterpolantFactoryMethodDiscrete:function(e){return new ks(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new $s(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Ps(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case B:t=this.InterpolantFactoryMethodDiscrete;break;case F:t=this.InterpolantFactoryMethodLinear;break;case q:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return B;case this.InterpolantFactoryMethodLinear:return F;case this.InterpolantFactoryMethodSmooth:return q}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<e;)++i;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==i||o!==r){i>=o&&(i=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=Ns.arraySlice(n,i,o),this.values=Ns.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==r&&Ns.isTypedArray(r))for(var u=0,c=r.length;u!==c;++u){var l=r[u];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,l),e=!1;break}}return e},optimize:function(){for(var e=Ns.arraySlice(this.times),t=Ns.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===q,i=e.length-1,o=1,a=1;a<i;++a){var s=!1,u=e[a];if(u!==e[a+1]&&(1!==a||u!==e[0]))if(r)s=!0;else for(var c=a*n,l=c-n,d=c+n,p=0;p!==n;++p){var f=t[c+p];if(f!==t[l+p]||f!==t[d+p]){s=!0;break}}if(s){if(a!==o){e[o]=e[a];for(var h=a*n,g=o*n,m=0;m!==n;++m)t[g+m]=t[h+m]}++o}}if(i>0){e[o]=e[i];for(var v=i*n,y=o*n,_=0;_!==n;++_)t[y+_]=t[v+_];++o}return o!==e.length?(this.times=Ns.arraySlice(e,0,o),this.values=Ns.arraySlice(t,0,o*n)):(this.times=e,this.values=t),this},clone:function(){var e=Ns.arraySlice(this.times,0),t=Ns.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}),Us.prototype=Object.assign(Object.create(Ds.prototype),{constructor:Us,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:B,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),js.prototype=Object.assign(Object.create(Ds.prototype),{constructor:js,ValueTypeName:"color"}),Bs.prototype=Object.assign(Object.create(Ds.prototype),{constructor:Bs,ValueTypeName:"number"}),Fs.prototype=Object.assign(Object.create(Ms.prototype),{constructor:Fs,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-t)/(r-t),u=e*a,c=u+a;u!==c;u+=4)xe.slerpFlat(i,0,o,u-a,o,u,s);return i}}),qs.prototype=Object.assign(Object.create(Ds.prototype),{constructor:qs,ValueTypeName:"quaternion",DefaultInterpolation:F,InterpolantFactoryMethodLinear:function(e){return new Fs(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Gs.prototype=Object.assign(Object.create(Ds.prototype),{constructor:Gs,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:B,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Vs.prototype=Object.assign(Object.create(Ds.prototype),{constructor:Vs,ValueTypeName:"vector"}),Object.assign(Hs,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,o=n.length;i!==o;++i)t.push(zs(n[i]).scale(r));var a=new Hs(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a},toJSON:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},i=0,o=n.length;i!==o;++i)t.push(Ds.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(e,t,n,r){for(var i=t.length,o=[],a=0;a<i;a++){var s=[],u=[];s.push((a+i-1)%i,a,(a+1)%i),u.push(0,1,0);var c=Ns.getKeyframeOrder(s);s=Ns.sortedArray(s,1,c),u=Ns.sortedArray(u,1,c),r||0!==s[0]||(s.push(i),u.push(u[0])),o.push(new Bs(".morphTargetInfluences["+t[a].name+"]",s,u).scale(1/n))}return new Hs(e,-1,o)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],u=s.name.match(i);if(u&&u.length>1){var c=u[1],l=r[c];l||(r[c]=l=[]),l.push(s)}}var d=[];for(var p in r)d.push(Hs.CreateFromMorphTargetSequence(p,r[p],t,n));return d},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var o=[],a=[];Ns.flattenJSON(n,o,a,r),0!==o.length&&i.push(new e(t,o,a))}},r=[],i=e.name||"default",o=e.fps||30,a=e.blendMode,s=e.length||-1,u=e.hierarchy||[],c=0;c<u.length;c++){var l=u[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){var d={},p=void 0;for(p=0;p<l.length;p++)if(l[p].morphTargets)for(var f=0;f<l[p].morphTargets.length;f++)d[l[p].morphTargets[f]]=-1;for(var h in d){for(var g=[],m=[],v=0;v!==l[p].morphTargets.length;++v){var y=l[p];g.push(y.time),m.push(y.morphTarget===h?1:0)}r.push(new Bs(".morphTargetInfluence["+h+"]",g,m))}s=d.length*(o||1)}else{var _=".bones["+t[c].name+"]";n(Vs,_+".position",l,"pos",r),n(qs,_+".quaternion",l,"rot",r),n(Vs,_+".scale",l,"scl",r)}}return 0===r.length?null:new Hs(i,s,r,a)}}),Object.assign(Hs.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Hs(this.name,this.duration,e,this.blendMode)},toJSON:function(){return Hs.toJSON(this)}});var Ws={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Js(e,t,n){var r=this,i=!1,o=0,a=0,s=void 0,u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===i&&void 0!==r.onStart&&r.onStart(e,o,a),i=!0},this.itemEnd=function(e){o++,void 0!==r.onProgress&&r.onProgress(e,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return u.push(e,t),this},this.removeHandler=function(e){var t=u.indexOf(e);return-1!==t&&u.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=u.length;t<n;t+=2){var r=u[t],i=u[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}}var Ys=new Js;function Ks(e){this.manager=void 0!==e?e:Ys,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Ks.prototype,{load:function(){},loadAsync:function(e,t){var n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var Xs={};function Zs(e){Ks.call(this,e)}function Qs(e){Ks.call(this,e)}function eu(e){Ks.call(this,e)}function tu(e){Ks.call(this,e)}function nu(e){Ks.call(this,e)}function ru(e){Ks.call(this,e)}function iu(e){Ks.call(this,e)}function ou(){this.type="Curve",this.arcLengthDivisions=200}function au(e,t,n,r,i,o,a,s){ou.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function su(e,t,n,r,i,o){au.call(this,e,t,n,n,r,i,o),this.type="ArcCurve"}function uu(){var e=0,t=0,n=0,r=0;function i(i,o,a,s){e=i,t=a,n=-3*i+3*o-2*a-s,r=2*i-2*o+a+s}return{initCatmullRom:function(e,t,n,r,o){i(t,n,o*(n-e),o*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,o,a,s){var u=(t-e)/o-(n-e)/(o+a)+(n-t)/a,c=(n-t)/a-(r-t)/(a+s)+(r-n)/s;i(t,n,u*=a,c*=a)},calc:function(i){var o=i*i;return e+t*i+n*o+r*(o*i)}}}Zs.prototype=Object.assign(Object.create(Ks.prototype),{constructor:Zs,load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Ws.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;if(void 0===Xs[e]){var a,s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var u=s[1],c=!!s[2],l=s[3];l=decodeURIComponent(l),c&&(l=atob(l));try{var d,p=(this.responseType||"").toLowerCase();switch(p){case"arraybuffer":case"blob":for(var f=new Uint8Array(l.length),h=0;h<l.length;h++)f[h]=l.charCodeAt(h);d="blob"===p?new Blob([f.buffer],{type:u}):f.buffer;break;case"document":var g=new DOMParser;d=g.parseFromString(l,u);break;case"json":d=JSON.parse(l);break;default:d=l}setTimeout((function(){t&&t(d),i.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{for(var m in Xs[e]=[],Xs[e].push({onLoad:t,onProgress:n,onError:r}),(a=new XMLHttpRequest).open("GET",e,!0),a.addEventListener("load",(function(t){var n=this.response,r=Xs[e];if(delete Xs[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ws.add(e,n);for(var o=0,a=r.length;o<a;o++){var s=r[o];s.onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(var u=0,c=r.length;u<c;u++){var l=r[u];l.onError&&l.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}}),!1),a.addEventListener("progress",(function(t){for(var n=Xs[e],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(t)}}),!1),a.addEventListener("error",(function(t){var n=Xs[e];delete Xs[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),a.addEventListener("abort",(function(t){var n=Xs[e];delete Xs[e];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)a.setRequestHeader(m,this.requestHeader[m]);a.send(null)}return i.manager.itemStart(e),a}Xs[e].push({onLoad:t,onProgress:n,onError:r})},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}}),Qs.prototype=Object.assign(Object.create(Ks.prototype),{constructor:Qs,load:function(e,t,n,r){var i=this,o=new Zs(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},parse:function(e){for(var t=[],n=0;n<e.length;n++){var r=Hs.parse(e[n]);t.push(r)}return t}}),eu.prototype=Object.assign(Object.create(Ks.prototype),{constructor:eu,load:function(e,t,n,r){var i=this,o=[],a=new ya,s=new Zs(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);var u=0;function c(c){s.load(e[c],(function(e){var n=i.parse(e,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(a.minFilter=v),a.image=o,a.format=n.format,a.needsUpdate=!0,t&&t(a))}),n,r)}if(Array.isArray(e))for(var l=0,d=e.length;l<d;++l)c(l);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}a.image=o}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=v),a.format=n.format,a.needsUpdate=!0,t&&t(a)}),n,r);return a}}),tu.prototype=Object.assign(Object.create(Ks.prototype),{constructor:tu,load:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Ws.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),Ws.add(e,this),t&&t(this),i.manager.itemEnd(e)}function u(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",u,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",u,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a}}),nu.prototype=Object.assign(Object.create(Ks.prototype),{constructor:nu,load:function(e,t,n,r){var i=new Qn,o=new tu(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(e[n],(function(e){i.images[n]=e,6===++a&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var u=0;u<e.length;++u)s(u);return i}}),ru.prototype=Object.assign(Object.create(Ks.prototype),{constructor:ru,load:function(e,t,n,r){var i=this,o=new tr,a=new Zs(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(i.withCredentials),a.load(e,(function(e){var n=i.parse(e);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:p,o.wrapT=void 0!==n.wrapT?n.wrapT:p,o.magFilter=void 0!==n.magFilter?n.magFilter:v,o.minFilter=void 0!==n.minFilter?n.minFilter:v,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(o.encoding=n.encoding),void 0!==n.flipY&&(o.flipY=n.flipY),void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps,o.minFilter=_),1===n.mipmapCount&&(o.minFilter=v),o.needsUpdate=!0,t&&t(o,n))}),n,r),o}}),iu.prototype=Object.assign(Object.create(Ks.prototype),{constructor:iu,load:function(e,t,n,r){var i=new Ee,o=new tu(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(n){i.image=n;var r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?O:x,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}),Object.assign(ou.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),i=0;n.push(0);for(var o=1;o<=e;o++)i+=(t=this.getPoint(o/e)).distanceTo(r),n.push(i),r=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,r=this.getLengths(),i=0,o=r.length;n=t||e*r[o-1];for(var a,s=0,u=o-1;s<=u;)if((a=r[i=Math.floor(s+(u-s)/2)]-n)<0)s=i+1;else{if(!(a>0)){u=i;break}u=i-1}if(r[i=u]===n)return i/(o-1);var c=r[i];return(i+(n-c)/(r[i+1]-c))/(o-1)},getTangent:function(e,t){var n=1e-4,r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);var o=this.getPoint(r),a=this.getPoint(i),s=t||(o.isVector2?new ye:new Re);return s.copy(a).sub(o).normalize(),s},getTangentAt:function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)},computeFrenetFrames:function(e,t){for(var n=new Re,r=[],i=[],o=[],a=new Re,s=new nt,u=0;u<=e;u++){var c=u/e;r[u]=this.getTangentAt(c,new Re),r[u].normalize()}i[0]=new Re,o[0]=new Re;var l=Number.MAX_VALUE,d=Math.abs(r[0].x),p=Math.abs(r[0].y),f=Math.abs(r[0].z);d<=l&&(l=d,n.set(1,0,0)),p<=l&&(l=p,n.set(0,1,0)),f<=l&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],a),o[0].crossVectors(r[0],i[0]);for(var h=1;h<=e;h++){if(i[h]=i[h-1].clone(),o[h]=o[h-1].clone(),a.crossVectors(r[h-1],r[h]),a.length()>Number.EPSILON){a.normalize();var g=Math.acos(ve.clamp(r[h-1].dot(r[h]),-1,1));i[h].applyMatrix4(s.makeRotationAxis(a,g))}o[h].crossVectors(r[h],i[h])}if(!0===t){var m=Math.acos(ve.clamp(i[0].dot(i[e]),-1,1));m/=e,r[0].dot(a.crossVectors(i[0],i[e]))>0&&(m=-m);for(var v=1;v<=e;v++)i[v].applyMatrix4(s.makeRotationAxis(r[v],m*v)),o[v].crossVectors(r[v],i[v])}return{tangents:r,normals:i,binormals:o}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),au.prototype=Object.create(ou.prototype),au.prototype.constructor=au,au.prototype.isEllipseCurve=!0,au.prototype.getPoint=function(e,t){for(var n=t||new ye,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);var a=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var c=Math.cos(this.aRotation),l=Math.sin(this.aRotation),d=s-this.aX,p=u-this.aY;s=d*c-p*l+this.aX,u=d*l+p*c+this.aY}return n.set(s,u)},au.prototype.copy=function(e){return ou.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},au.prototype.toJSON=function(){var e=ou.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},au.prototype.fromJSON=function(e){return ou.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},su.prototype=Object.create(au.prototype),su.prototype.constructor=su,su.prototype.isArcCurve=!0;var cu=new Re,lu=new uu,du=new uu,pu=new uu;function fu(e,t,n,r){void 0===e&&(e=[]),void 0===t&&(t=!1),void 0===n&&(n="centripetal"),void 0===r&&(r=.5),ou.call(this),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}function hu(e,t,n,r,i){var o=.5*(r-t),a=.5*(i-n),s=e*e;return(2*n-2*r+o+a)*(e*s)+(-3*n+3*r-2*o-a)*s+o*e+n}function gu(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function mu(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}function vu(e,t,n,r){void 0===e&&(e=new ye),void 0===t&&(t=new ye),void 0===n&&(n=new ye),void 0===r&&(r=new ye),ou.call(this),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}function yu(e,t,n,r){void 0===e&&(e=new Re),void 0===t&&(t=new Re),void 0===n&&(n=new Re),void 0===r&&(r=new Re),ou.call(this),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}function _u(e,t){void 0===e&&(e=new ye),void 0===t&&(t=new ye),ou.call(this),this.type="LineCurve",this.v1=e,this.v2=t}function bu(e,t){void 0===e&&(e=new Re),void 0===t&&(t=new Re),ou.call(this),this.type="LineCurve3",this.v1=e,this.v2=t}function Su(e,t,n){void 0===e&&(e=new ye),void 0===t&&(t=new ye),void 0===n&&(n=new ye),ou.call(this),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}function Eu(e,t,n){void 0===e&&(e=new Re),void 0===t&&(t=new Re),void 0===n&&(n=new Re),ou.call(this),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}function wu(e){void 0===e&&(e=[]),ou.call(this),this.type="SplineCurve",this.points=e}fu.prototype=Object.create(ou.prototype),fu.prototype.constructor=fu,fu.prototype.isCatmullRomCurve3=!0,fu.prototype.getPoint=function(e,t){void 0===t&&(t=new Re);var n,r,i=t,o=this.points,a=o.length,s=(a-(this.closed?0:1))*e,u=Math.floor(s),c=s-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/a)+1)*a:0===c&&u===a-1&&(u=a-2,c=1),this.closed||u>0?n=o[(u-1)%a]:(cu.subVectors(o[0],o[1]).add(o[0]),n=cu);var l=o[u%a],d=o[(u+1)%a];if(this.closed||u+2<a?r=o[(u+2)%a]:(cu.subVectors(o[a-1],o[a-2]).add(o[a-1]),r=cu),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,f=Math.pow(n.distanceToSquared(l),p),h=Math.pow(l.distanceToSquared(d),p),g=Math.pow(d.distanceToSquared(r),p);h<1e-4&&(h=1),f<1e-4&&(f=h),g<1e-4&&(g=h),lu.initNonuniformCatmullRom(n.x,l.x,d.x,r.x,f,h,g),du.initNonuniformCatmullRom(n.y,l.y,d.y,r.y,f,h,g),pu.initNonuniformCatmullRom(n.z,l.z,d.z,r.z,f,h,g)}else"catmullrom"===this.curveType&&(lu.initCatmullRom(n.x,l.x,d.x,r.x,this.tension),du.initCatmullRom(n.y,l.y,d.y,r.y,this.tension),pu.initCatmullRom(n.z,l.z,d.z,r.z,this.tension));return i.set(lu.calc(c),du.calc(c),pu.calc(c)),i},fu.prototype.copy=function(e){ou.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},fu.prototype.toJSON=function(){var e=ou.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},fu.prototype.fromJSON=function(e){ou.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new Re).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},vu.prototype=Object.create(ou.prototype),vu.prototype.constructor=vu,vu.prototype.isCubicBezierCurve=!0,vu.prototype.getPoint=function(e,t){void 0===t&&(t=new ye);var n=t,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(mu(e,r.x,i.x,o.x,a.x),mu(e,r.y,i.y,o.y,a.y)),n},vu.prototype.copy=function(e){return ou.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},vu.prototype.toJSON=function(){var e=ou.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},vu.prototype.fromJSON=function(e){return ou.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},yu.prototype=Object.create(ou.prototype),yu.prototype.constructor=yu,yu.prototype.isCubicBezierCurve3=!0,yu.prototype.getPoint=function(e,t){void 0===t&&(t=new Re);var n=t,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(mu(e,r.x,i.x,o.x,a.x),mu(e,r.y,i.y,o.y,a.y),mu(e,r.z,i.z,o.z,a.z)),n},yu.prototype.copy=function(e){return ou.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},yu.prototype.toJSON=function(){var e=ou.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},yu.prototype.fromJSON=function(e){return ou.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},_u.prototype=Object.create(ou.prototype),_u.prototype.constructor=_u,_u.prototype.isLineCurve=!0,_u.prototype.getPoint=function(e,t){void 0===t&&(t=new ye);var n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},_u.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},_u.prototype.getTangent=function(e,t){var n=t||new ye;return n.copy(this.v2).sub(this.v1).normalize(),n},_u.prototype.copy=function(e){return ou.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},_u.prototype.toJSON=function(){var e=ou.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},_u.prototype.fromJSON=function(e){return ou.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},bu.prototype=Object.create(ou.prototype),bu.prototype.constructor=bu,bu.prototype.isLineCurve3=!0,bu.prototype.getPoint=function(e,t){void 0===t&&(t=new Re);var n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},bu.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},bu.prototype.copy=function(e){return ou.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},bu.prototype.toJSON=function(){var e=ou.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},bu.prototype.fromJSON=function(e){return ou.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Su.prototype=Object.create(ou.prototype),Su.prototype.constructor=Su,Su.prototype.isQuadraticBezierCurve=!0,Su.prototype.getPoint=function(e,t){void 0===t&&(t=new ye);var n=t,r=this.v0,i=this.v1,o=this.v2;return n.set(gu(e,r.x,i.x,o.x),gu(e,r.y,i.y,o.y)),n},Su.prototype.copy=function(e){return ou.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Su.prototype.toJSON=function(){var e=ou.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Su.prototype.fromJSON=function(e){return ou.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Eu.prototype=Object.create(ou.prototype),Eu.prototype.constructor=Eu,Eu.prototype.isQuadraticBezierCurve3=!0,Eu.prototype.getPoint=function(e,t){void 0===t&&(t=new Re);var n=t,r=this.v0,i=this.v1,o=this.v2;return n.set(gu(e,r.x,i.x,o.x),gu(e,r.y,i.y,o.y),gu(e,r.z,i.z,o.z)),n},Eu.prototype.copy=function(e){return ou.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Eu.prototype.toJSON=function(){var e=ou.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Eu.prototype.fromJSON=function(e){return ou.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},wu.prototype=Object.create(ou.prototype),wu.prototype.constructor=wu,wu.prototype.isSplineCurve=!0,wu.prototype.getPoint=function(e,t){void 0===t&&(t=new ye);var n=t,r=this.points,i=(r.length-1)*e,o=Math.floor(i),a=i-o,s=r[0===o?o:o-1],u=r[o],c=r[o>r.length-2?r.length-1:o+1],l=r[o>r.length-3?r.length-1:o+2];return n.set(hu(a,s.x,u.x,c.x,l.x),hu(a,s.y,u.y,c.y,l.y)),n},wu.prototype.copy=function(e){ou.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this},wu.prototype.toJSON=function(){var e=ou.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e},wu.prototype.fromJSON=function(e){ou.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new ye).fromArray(r))}return this};var Iu=Object.freeze({__proto__:null,ArcCurve:su,CatmullRomCurve3:fu,CubicBezierCurve:vu,CubicBezierCurve3:yu,EllipseCurve:au,LineCurve:_u,LineCurve3:bu,QuadraticBezierCurve:Su,QuadraticBezierCurve3:Eu,SplineCurve:wu});function Tu(){ou.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Ou(e){Tu.call(this),this.type="Path",this.currentPoint=new ye,e&&this.setFromPoints(e)}function xu(e){Ou.call(this,e),this.uuid=ve.generateUUID(),this.type="Shape",this.holes=[]}function Ru(e,t){void 0===t&&(t=1),xt.call(this),this.type="Light",this.color=new Yt(e),this.intensity=t}function Au(e,t,n){Ru.call(this,e,n),this.type="HemisphereLight",this.position.copy(xt.DefaultUp),this.updateMatrix(),this.groundColor=new Yt(t)}function Lu(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new ye(512,512),this.map=null,this.mapPass=null,this.matrix=new nt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ir,this._frameExtents=new ye(1,1),this._viewportCount=1,this._viewports=[new Ie(0,0,1,1)]}function Cu(){Lu.call(this,new Kn(50,1,.5,500)),this.focus=1}function Nu(e,t,n,r,i,o){Ru.call(this,e,t),this.type="SpotLight",this.position.copy(xt.DefaultUp),this.updateMatrix(),this.target=new xt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Cu}function Mu(){Lu.call(this,new Kn(90,1,.5,500)),this._frameExtents=new ye(4,2),this._viewportCount=6,this._viewports=[new Ie(2,1,1,1),new Ie(0,1,1,1),new Ie(3,1,1,1),new Ie(1,1,1,1),new Ie(3,0,1,1),new Ie(1,0,1,1)],this._cubeDirections=[new Re(1,0,0),new Re(-1,0,0),new Re(0,0,1),new Re(0,0,-1),new Re(0,1,0),new Re(0,-1,0)],this._cubeUps=[new Re(0,1,0),new Re(0,1,0),new Re(0,1,0),new Re(0,1,0),new Re(0,0,1),new Re(0,0,-1)]}function Pu(e,t,n,r){Ru.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Mu}function $u(e,t,n,r,i,o){void 0===e&&(e=-1),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=-1),void 0===i&&(i=.1),void 0===o&&(o=2e3),Yn.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}function ku(){Lu.call(this,new $u(-5,5,5,-5,.5,500))}function Du(e,t){Ru.call(this,e,t),this.type="DirectionalLight",this.position.copy(xt.DefaultUp),this.updateMatrix(),this.target=new xt,this.shadow=new ku}function Uu(e,t){Ru.call(this,e,t),this.type="AmbientLight"}function ju(e,t,n,r){Ru.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}Tu.prototype=Object.assign(Object.create(ou.prototype),{constructor:Tu,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new _u(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){void 0===e&&(e=12);for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),u=0;u<s.length;u++){var c=s[u];t&&t.equals(c)||(n.push(c),t=c)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){ou.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=ou.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){ou.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push((new Iu[r.type]).fromJSON(r))}return this}}),Ou.prototype=Object.assign(Object.create(Tu.prototype),{constructor:Ou,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){var n=new _u(this.currentPoint.clone(),new ye(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,n,r){var i=new Su(this.currentPoint.clone(),new ye(e,t),new ye(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(e,t,n,r,i,o){var a=new vu(this.currentPoint.clone(),new ye(e,t),new ye(n,r),new ye(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this},splineThru:function(e){var t=new wu([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+a,t+s,n,r,i,o),this},absarc:function(e,t,n,r,i,o){return this.absellipse(e,t,n,n,r,i,o),this},ellipse:function(e,t,n,r,i,o,a,s){var u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,t+c,n,r,i,o,a,s),this},absellipse:function(e,t,n,r,i,o,a,s){var u=new au(e,t,n,r,i,o,a,s);if(this.curves.length>0){var c=u.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);var l=u.getPoint(1);return this.currentPoint.copy(l),this},copy:function(e){return Tu.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Tu.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Tu.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),xu.prototype=Object.assign(Object.create(Ou.prototype),{constructor:xu,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Ou.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){var e=Ou.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){Ou.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push((new Ou).fromJSON(r))}return this}}),Ru.prototype=Object.assign(Object.create(xt.prototype),{constructor:Ru,isLight:!0,copy:function(e){return xt.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=xt.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Au.prototype=Object.assign(Object.create(Ru.prototype),{constructor:Au,isHemisphereLight:!0,copy:function(e){return Ru.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Lu.prototype,{_projScreenMatrix:new nt,_lightPositionWorld:new Re,_lookTarget:new Re,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(e.matrixWorld),t.position.copy(o),i.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(i),t.updateMatrixWorld(),r.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Cu.prototype=Object.assign(Object.create(Lu.prototype),{constructor:Cu,isSpotLightShadow:!0,updateMatrices:function(e){var t=this.camera,n=2*ve.RAD2DEG*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),Lu.prototype.updateMatrices.call(this,e)}}),Nu.prototype=Object.assign(Object.create(Ru.prototype),{constructor:Nu,isSpotLight:!0,copy:function(e){return Ru.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Mu.prototype=Object.assign(Object.create(Lu.prototype),{constructor:Mu,isPointLightShadow:!0,updateMatrices:function(e,t){void 0===t&&(t=0);var n=this.camera,r=this.matrix,i=this._lightPositionWorld,o=this._lookTarget,a=this._projScreenMatrix;i.setFromMatrixPosition(e.matrixWorld),n.position.copy(i),o.copy(n.position),o.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(o),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),a.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a)}}),Pu.prototype=Object.assign(Object.create(Ru.prototype),{constructor:Pu,isPointLight:!0,copy:function(e){return Ru.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),$u.prototype=Object.assign(Object.create(Yn.prototype),{constructor:$u,isOrthographicCamera:!0,copy:function(e,t){return Yn.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,o=n+e,a=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o=(i+=u*this.view.offsetX)+u*this.view.width,s=(a-=c*this.view.offsetY)-c*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(e){var t=xt.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),ku.prototype=Object.assign(Object.create(Lu.prototype),{constructor:ku,isDirectionalLightShadow:!0,updateMatrices:function(e){Lu.prototype.updateMatrices.call(this,e)}}),Du.prototype=Object.assign(Object.create(Ru.prototype),{constructor:Du,isDirectionalLight:!0,copy:function(e){return Ru.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Uu.prototype=Object.assign(Object.create(Ru.prototype),{constructor:Uu,isAmbientLight:!0}),ju.prototype=Object.assign(Object.create(Ru.prototype),{constructor:ju,isRectAreaLight:!0,copy:function(e){return Ru.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Ru.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});var Bu=function(){function e(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new Re)}var t=e.prototype;return t.set=function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},t.zero=function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},t.getAt=function(e,t){var n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*i),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],n*r*1.092548),t.addScaledVector(o[5],r*i*1.092548),t.addScaledVector(o[6],.315392*(3*i*i-1)),t.addScaledVector(o[7],n*i*1.092548),t.addScaledVector(o[8],.546274*(n*n-r*r)),t},t.getIrradianceAt=function(e,t){var n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*i),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*r),t.addScaledVector(o[5],.858086*r*i),t.addScaledVector(o[6],.743125*i*i-.247708),t.addScaledVector(o[7],.858086*n*i),t.addScaledVector(o[8],.429043*(n*n-r*r)),t},t.add=function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},t.addScaledSH=function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this},t.scale=function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},t.lerp=function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},t.equals=function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},t.copy=function(e){return this.set(e.coefficients)},t.clone=function(){return(new this.constructor).copy(this)},t.fromArray=function(e,t){void 0===t&&(t=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this},t.toArray=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e},e.getBasisAt=function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)},e}();function Fu(e,t){Ru.call(this,void 0,t),this.type="LightProbe",this.sh=void 0!==e?e:new Bu}function qu(e){Ks.call(this,e),this.textures={}}Fu.prototype=Object.assign(Object.create(Ru.prototype),{constructor:Fu,isLightProbe:!0,copy:function(e){return Ru.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){var t=Ru.prototype.toJSON.call(this,e);return t.object.sh=this.sh.toArray(),t}}),qu.prototype=Object.assign(Object.create(Ks.prototype),{constructor:qu,load:function(e,t,n,r){var i=this,o=new Zs(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new Cs[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=(new Yt).setHex(e.sheen)),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(r.morphNormals=e.morphNormals),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.vertexTangents&&(r.vertexTangents=e.vertexTangents),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var i in e.uniforms){var o=e.uniforms[i];switch(r.uniforms[i]={},o.type){case"t":r.uniforms[i].value=n(o.value);break;case"c":r.uniforms[i].value=(new Yt).setHex(o.value);break;case"v2":r.uniforms[i].value=(new ye).fromArray(o.value);break;case"v3":r.uniforms[i].value=(new Re).fromArray(o.value);break;case"v4":r.uniforms[i].value=(new Ie).fromArray(o.value);break;case"m3":r.uniforms[i].value=(new _e).fromArray(o.value);break;case"m4":r.uniforms[i].value=(new nt).fromArray(o.value);break;default:r.uniforms[i].value=o.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var a in e.extensions)r.extensions[a]=e.extensions[a];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new ye).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new ye).fromArray(e.clearcoatNormalScale)),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),r},setTextures:function(e){return this.textures=e,this}});var Gu={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function Vu(){In.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Hu(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),nn.call(this,e,t,n),this.meshPerAttribute=r||1}function zu(e){Ks.call(this,e)}Vu.prototype=Object.assign(Object.create(In.prototype),{constructor:Vu,isInstancedBufferGeometry:!0,copy:function(e){return In.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=In.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),Hu.prototype=Object.assign(Object.create(nn.prototype),{constructor:Hu,isInstancedBufferAttribute:!0,copy:function(e){return nn.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=nn.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),zu.prototype=Object.assign(Object.create(Ks.prototype),{constructor:zu,load:function(e,t,n,r){var i=this,o=new Zs(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},parse:function(e){var t={},n={};function r(e,r){if(void 0!==t[r])return t[r];var i=e.interleavedBuffers[r],o=function(e,t){if(void 0!==n[t])return n[t];var r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),a=new mo(mn(i.type,o),i.stride);return a.uuid=i.uuid,t[r]=a,a}var i=e.isInstancedBufferGeometry?new Vu:new In,o=e.data.index;if(void 0!==o){var a=mn(o.type,o.array);i.setIndex(new nn(a,1))}var s=e.data.attributes;for(var u in s){var c=s[u],l=void 0;if(c.isInterleavedBufferAttribute){l=new _o(r(e.data,c.data),c.itemSize,c.offset,c.normalized)}else{var d=mn(c.type,c.array);l=new(c.isInstancedBufferAttribute?Hu:nn)(d,c.itemSize,c.normalized)}void 0!==c.name&&(l.name=c.name),i.setAttribute(u,l)}var p=e.data.morphAttributes;if(p)for(var f in p){for(var h=p[f],g=[],m=0,v=h.length;m<v;m++){var y=h[m],_=void 0;if(y.isInterleavedBufferAttribute)_=new _o(r(e.data,y.data),y.itemSize,y.offset,y.normalized);else _=new nn(mn(y.type,y.array),y.itemSize,y.normalized);void 0!==y.name&&(_.name=y.name),g.push(_)}i.morphAttributes[f]=g}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);var b=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==b)for(var S=0,E=b.length;S!==E;++S){var w=b[S];i.addGroup(w.start,w.count,w.materialIndex)}var I=e.data.boundingSphere;if(void 0!==I){var T=new Re;void 0!==I.center&&T.fromArray(I.center),i.boundingSphere=new We(T,I.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}});var Wu=function(e){function t(t){return e.call(this,t)||this}ue(t,e);var n=t.prototype;return n.load=function(e,t,n,r){var i=this,o=""===this.path?Gu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;var a=new Zs(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){var o=null;try{o=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?i.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)},n.parse=function(e,t){var n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,(function(){void 0!==t&&t(u)})),a=this.parseTextures(e.textures,o),s=this.parseMaterials(e.materials,a),u=this.parseObject(e.object,i,s,n),c=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,c),void 0!==t){var l=!1;for(var d in o)if(o[d]instanceof HTMLImageElement){l=!0;break}!1===l&&t(u)}return u},n.parseShapes=function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new xu).fromJSON(e[n]);t[i.uuid]=i}return t},n.parseSkeletons=function(e,t){var n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(var i=0,o=e.length;i<o;i++){var a=(new Wo).fromJSON(e[i],r);n[a.uuid]=a}return n},n.parseGeometries=function(e,t){var n,r={};if(void 0!==e)for(var i=new zu,o=0,a=e.length;o<a;o++){var s=void 0,u=e[o];switch(u.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new bs[u.type](u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":s=new bs[u.type](u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new bs[u.type](u.radius,u.segments,u.thetaStart,u.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new bs[u.type](u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new bs[u.type](u.radius,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new bs[u.type](u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new bs[u.type](u.radius,u.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new bs[u.type](u.innerRadius,u.outerRadius,u.thetaSegments,u.phiSegments,u.thetaStart,u.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new bs[u.type](u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new bs[u.type](u.radius,u.tube,u.tubularSegments,u.radialSegments,u.p,u.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new bs[u.type]((new Iu[u.path.type]).fromJSON(u.path),u.tubularSegments,u.radius,u.radialSegments,u.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new bs[u.type](u.points,u.segments,u.phiStart,u.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new bs[u.type](u.vertices,u.indices,u.radius,u.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":n=[];for(var c=0,l=u.shapes.length;c<l;c++){var d=t[u.shapes[c]];n.push(d)}s=new bs[u.type](n,u.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":n=[];for(var p=0,f=u.shapes.length;p<f;p++){var h=t[u.shapes[p]];n.push(h)}var g=u.options.extrudePath;void 0!==g&&(u.options.extrudePath=(new Iu[g.type]).fromJSON(g)),s=new bs[u.type](n,u.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(u);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+u.type+'"');continue}s.uuid=u.uuid,void 0!==u.name&&(s.name=u.name),!0===s.isBufferGeometry&&void 0!==u.userData&&(s.userData=u.userData),r[u.uuid]=s}return r},n.parseMaterials=function(e,t){var n={},r={};if(void 0!==e){var i=new qu;i.setTextures(t);for(var o=0,a=e.length;o<a;o++){var s=e[o];if("MultiMaterial"===s.type){for(var u=[],c=0;c<s.materials.length;c++){var l=s.materials[c];void 0===n[l.uuid]&&(n[l.uuid]=i.parse(l)),u.push(n[l.uuid])}r[s.uuid]=u}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},n.parseAnimations=function(e){var t={};if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n],i=Hs.parse(r);t[i.uuid]=i}return t},n.parseImages=function(e,t){var n,r=this,i={};function o(e){if("string"==typeof e){var t=e;return function(e){return r.manager.itemStart(e),n.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:mn(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){var a=new Js(t);(n=new tu(a)).setCrossOrigin(this.crossOrigin);for(var s=0,u=e.length;s<u;s++){var c=e[s],l=c.url;if(Array.isArray(l)){i[c.uuid]=[];for(var d=0,p=l.length;d<p;d++){var f=o(l[d]);null!==f&&(f instanceof HTMLImageElement?i[c.uuid].push(f):i[c.uuid].push(new tr(f.data,f.width,f.height)))}}else{var h=o(c.url);null!==h&&(i[c.uuid]=h)}}}return i},n.parseTextures=function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,o=e.length;i<o;i++){var a=e[i];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=void 0,u=t[a.image];Array.isArray(u)?(s=new Qn(u),6===u.length&&(s.needsUpdate=!0)):(s=u&&u.data?new tr(u.data,u.width,u.height):new Ee(u),u&&(s.needsUpdate=!0)),s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping,Ju)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=n(a.wrap[0],Yu),s.wrapT=n(a.wrap[1],Yu)),void 0!==a.format&&(s.format=a.format),void 0!==a.type&&(s.type=a.type),void 0!==a.encoding&&(s.encoding=a.encoding),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter,Ku)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter,Ku)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),void 0!==a.premultiplyAlpha&&(s.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(s.unpackAlignment=a.unpackAlignment),r[a.uuid]=s}return r},n.parseObject=function(e,t,n,r){var i,o,a;function s(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function u(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var o=e[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(n[o])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":i=new go,void 0!==e.background&&Number.isInteger(e.background)&&(i.background=new Yt(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?i.fog=new ho(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(i.fog=new fo(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":i=new Kn(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(i.focus=e.focus),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.filmGauge&&(i.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(i.filmOffset=e.filmOffset),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new $u(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(i.zoom=e.zoom),void 0!==e.view&&(i.view=Object.assign({},e.view));break;case"AmbientLight":i=new Uu(e.color,e.intensity);break;case"DirectionalLight":i=new Du(e.color,e.intensity);break;case"PointLight":i=new Pu(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new ju(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new Nu(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":i=new Au(e.color,e.groundColor,e.intensity);break;case"LightProbe":i=(new Fu).fromJSON(e);break;case"SkinnedMesh":i=new Go(o=s(e.geometry),a=u(e.material)),void 0!==e.bindMode&&(i.bindMode=e.bindMode),void 0!==e.bindMatrix&&i.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(i.skeleton=e.skeleton);break;case"Mesh":i=new qn(o=s(e.geometry),a=u(e.material));break;case"InstancedMesh":o=s(e.geometry),a=u(e.material);var c=e.count,l=e.instanceMatrix;(i=new Zo(o,a,c)).instanceMatrix=new nn(new Float32Array(l.array),16);break;case"LOD":i=new Do;break;case"Line":i=new oa(s(e.geometry),u(e.material));break;case"LineLoop":i=new ca(s(e.geometry),u(e.material));break;case"LineSegments":i=new ua(s(e.geometry),u(e.material));break;case"PointCloud":case"Points":i=new ga(s(e.geometry),u(e.material));break;case"Sprite":i=new Mo(u(e.material));break;case"Group":i=new ao;break;case"Bone":i=new Vo;break;default:i=new xt}if(i.uuid=e.uuid,void 0!==e.name&&(i.name=e.name),void 0!==e.matrix?(i.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(i.matrixAutoUpdate=e.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(void 0!==e.position&&i.position.fromArray(e.position),void 0!==e.rotation&&i.rotation.fromArray(e.rotation),void 0!==e.quaternion&&i.quaternion.fromArray(e.quaternion),void 0!==e.scale&&i.scale.fromArray(e.scale)),void 0!==e.castShadow&&(i.castShadow=e.castShadow),void 0!==e.receiveShadow&&(i.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(i.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(i.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(i.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&i.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(i.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.frustumCulled&&(i.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(i.renderOrder=e.renderOrder),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.layers&&(i.layers.mask=e.layers),void 0!==e.children)for(var d=e.children,p=0;p<d.length;p++)i.add(this.parseObject(d[p],t,n,r));if(void 0!==e.animations)for(var f=e.animations,h=0;h<f.length;h++){var g=f[h];i.animations.push(r[g])}if("LOD"===e.type){void 0!==e.autoUpdate&&(i.autoUpdate=e.autoUpdate);for(var m=e.levels,v=0;v<m.length;v++){var y=m[v],_=i.getObjectByProperty("uuid",y.object);void 0!==_&&i.addLevel(_,y.distance)}}return i},n.bindSkeletons=function(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){var n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))},n.setTexturePath=function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)},t}(Ks),Ju={UVMapping:i,CubeReflectionMapping:o,CubeRefractionMapping:a,EquirectangularReflectionMapping:s,EquirectangularRefractionMapping:u,CubeUVReflectionMapping:c,CubeUVRefractionMapping:l},Yu={RepeatWrapping:d,ClampToEdgeWrapping:p,MirroredRepeatWrapping:f},Ku={NearestFilter:h,NearestMipmapNearestFilter:g,NearestMipmapLinearFilter:m,LinearFilter:v,LinearMipmapNearestFilter:y,LinearMipmapLinearFilter:_};function Xu(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Ks.call(this,e),this.options={premultiplyAlpha:"none"}}function Zu(){this.type="ShapePath",this.color=new Yt,this.subPaths=[],this.currentPath=null}Xu.prototype=Object.assign(Object.create(Ks.prototype),{constructor:Xu,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,o=Ws.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;var a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",fetch(e,a).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,i.options)})).then((function(n){Ws.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}),Object.assign(Zu.prototype,{moveTo:function(e,t){return this.currentPath=new Ou,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this},bezierCurveTo:function(e,t,n,r,i,o){return this.currentPath.bezierCurveTo(e,t,n,r,i,o),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],o=new xu;o.curves=i.curves,t.push(o)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=t[i],s=t[o],u=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(a=t[o],u=-u,s=t[i],c=-c),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var l=c*(e.x-a.x)-u*(e.y-a.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return r}var i,o,a,s=ns.isClockWise,u=this.subPaths;if(0===u.length)return[];if(!0===t)return n(u);var c=[];if(1===u.length)return o=u[0],(a=new xu).curves=o.curves,c.push(a),c;var l=!s(u[0].getPoints());l=e?!l:l;var d,p,f=[],h=[],g=[],m=0;h[m]=void 0,g[m]=[];for(var v=0,y=u.length;v<y;v++)i=s(d=(o=u[v]).getPoints()),(i=e?!i:i)?(!l&&h[m]&&m++,h[m]={s:new xu,p:d},h[m].s.curves=o.curves,l&&m++,g[m]=[]):g[m].push({h:o,p:d[0]});if(!h[0])return n(u);if(h.length>1){for(var _=!1,b=[],S=0,E=h.length;S<E;S++)f[S]=[];for(var w=0,I=h.length;w<I;w++)for(var T=g[w],O=0;O<T.length;O++){for(var x=T[O],R=!0,A=0;A<h.length;A++)r(x.p,h[A].p)&&(w!==A&&b.push({froms:w,tos:A,hole:O}),R?(R=!1,f[A].push(x)):_=!0);R&&f[w].push(x)}b.length>0&&(_||(g=f))}for(var L=0,C=h.length;L<C;L++){a=h[L].s,c.push(a);for(var N=0,M=(p=g[L]).length;N<M;N++)a.holes.push(p[N].h)}return c}});var Qu,ec=function(){function e(e){Object.defineProperty(this,"isFont",{value:!0}),this.type="Font",this.data=e}return e.prototype.generateShapes=function(e,t){void 0===t&&(t=100);for(var n=[],r=function(e,t,n){for(var r=Array.from?Array.from(e):String(e).split(""),i=t/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,a=[],s=0,u=0,c=0;c<r.length;c++){var l=r[c];if("\n"===l)s=0,u-=o;else{var d=tc(l,i,s,u,n);s+=d.offsetX,a.push(d.path)}}return a}(e,t,this.data),i=0,o=r.length;i<o;i++)Array.prototype.push.apply(n,r[i].toShapes());return n},e}();function tc(e,t,n,r,i){var o=i.glyphs[e]||i.glyphs["?"];if(o){var a,s,u,c,l,d,p,f,h=new Zu;if(o.o)for(var g=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),m=0,v=g.length;m<v;){switch(g[m++]){case"m":a=g[m++]*t+n,s=g[m++]*t+r,h.moveTo(a,s);break;case"l":a=g[m++]*t+n,s=g[m++]*t+r,h.lineTo(a,s);break;case"q":u=g[m++]*t+n,c=g[m++]*t+r,l=g[m++]*t+n,d=g[m++]*t+r,h.quadraticCurveTo(l,d,u,c);break;case"b":u=g[m++]*t+n,c=g[m++]*t+r,l=g[m++]*t+n,d=g[m++]*t+r,p=g[m++]*t+n,f=g[m++]*t+r,h.bezierCurveTo(l,d,p,f,u,c)}}return{offsetX:o.ha*t,path:h}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".")}function nc(e){Ks.call(this,e)}nc.prototype=Object.assign(Object.create(Ks.prototype),{constructor:nc,load:function(e,t,n,r){var i=this,o=new Zs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=i.parse(n);t&&t(r)}),n,r)},parse:function(e){return new ec(e)}});var rc={getContext:function(){return void 0===Qu&&(Qu=new(window.AudioContext||window.webkitAudioContext)),Qu},setContext:function(e){Qu=e}};function ic(e){Ks.call(this,e)}function oc(e,t,n){Fu.call(this,void 0,n);var r=(new Yt).set(e),i=(new Yt).set(t),o=new Re(r.r,r.g,r.b),a=new Re(i.r,i.g,i.b),s=Math.sqrt(Math.PI),u=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(u)}function ac(e,t){Fu.call(this,void 0,t);var n=(new Yt).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}ic.prototype=Object.assign(Object.create(Ks.prototype),{constructor:ic,load:function(e,t,n,r){var i=this,o=new Zs(i.manager);o.setResponseType("arraybuffer"),o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,(function(n){try{var o=n.slice(0);rc.getContext().decodeAudioData(o,(function(e){t(e)}))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}}),oc.prototype=Object.assign(Object.create(Fu.prototype),{constructor:oc,isHemisphereLightProbe:!0,copy:function(e){return Fu.prototype.copy.call(this,e),this},toJSON:function(e){return Fu.prototype.toJSON.call(this,e)}}),ac.prototype=Object.assign(Object.create(Fu.prototype),{constructor:ac,isAmbientLightProbe:!0,copy:function(e){return Fu.prototype.copy.call(this,e),this},toJSON:function(e){return Fu.prototype.toJSON.call(this,e)}});var sc=new nt,uc=new nt;function cc(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Kn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Kn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(cc.prototype,{update:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n,r,i=e.projectionMatrix.clone(),o=t.eyeSep/2,a=o*t.near/t.focus,s=t.near*Math.tan(ve.DEG2RAD*t.fov*.5)/t.zoom;uc.elements[12]=-o,sc.elements[12]=o,n=-s*t.aspect+a,r=s*t.aspect+a,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*t.aspect-a,r=s*t.aspect-a,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(uc),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(sc)}});var lc=function(){function e(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var t=e.prototype;return t.start=function(){this.startTime=dc(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},t.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},t.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},t.getDelta=function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=dc();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e},e}();function dc(){return("undefined"==typeof performance?Date:performance).now()}var pc=new Re,fc=new xe,hc=new Re,gc=new Re,mc=function(e){function t(){var t;return(t=e.call(this)||this).type="AudioListener",t.context=rc.getContext(),t.gain=t.context.createGain(),t.gain.connect(t.context.destination),t.filter=null,t.timeDelta=0,t._clock=new lc,t}ue(t,e);var n=t.prototype;return n.getInput=function(){return this.gain},n.removeFilter=function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},n.getFilter=function(){return this.filter},n.setFilter=function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},n.getMasterVolume=function(){return this.gain.gain.value},n.setMasterVolume=function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},n.updateMatrixWorld=function(t){e.prototype.updateMatrixWorld.call(this,t);var n=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(pc,fc,hc),gc.set(0,0,-1).applyQuaternion(fc),n.positionX){var i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(pc.x,i),n.positionY.linearRampToValueAtTime(pc.y,i),n.positionZ.linearRampToValueAtTime(pc.z,i),n.forwardX.linearRampToValueAtTime(gc.x,i),n.forwardY.linearRampToValueAtTime(gc.y,i),n.forwardZ.linearRampToValueAtTime(gc.z,i),n.upX.linearRampToValueAtTime(r.x,i),n.upY.linearRampToValueAtTime(r.y,i),n.upZ.linearRampToValueAtTime(r.z,i)}else n.setPosition(pc.x,pc.y,pc.z),n.setOrientation(gc.x,gc.y,gc.z,r.x,r.y,r.z)},t}(xt),vc=function(e){function t(t){var n;return(n=e.call(this)||this).type="Audio",n.listener=t,n.context=t.context,n.gain=n.context.createGain(),n.gain.connect(t.getInput()),n.autoplay=!1,n.buffer=null,n.detune=0,n.loop=!1,n.loopStart=0,n.loopEnd=0,n.offset=0,n.duration=void 0,n.playbackRate=1,n.isPlaying=!1,n.hasPlaybackControl=!0,n.source=null,n.sourceType="empty",n._startedAt=0,n._progress=0,n._connected=!1,n.filters=[],n}ue(t,e);var n=t.prototype;return n.getOutput=function(){return this.gain},n.setNodeSource=function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},n.setMediaElementSource=function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},n.setMediaStreamSource=function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},n.setBuffer=function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},n.play=function(e){if(void 0===e&&(e=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},n.pause=function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.stop=function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},n.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},n.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},n.getFilters=function(){return this.filters},n.setFilters=function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this},n.setDetune=function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},n.getDetune=function(){return this.detune},n.getFilter=function(){return this.getFilters()[0]},n.setFilter=function(e){return this.setFilters(e?[e]:[])},n.setPlaybackRate=function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.getPlaybackRate=function(){return this.playbackRate},n.onEnded=function(){this.isPlaying=!1},n.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},n.setLoop=function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.setLoopStart=function(e){return this.loopStart=e,this},n.setLoopEnd=function(e){return this.loopEnd=e,this},n.getVolume=function(){return this.gain.gain.value},n.setVolume=function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},t}(xt),yc=new Re,_c=new xe,bc=new Re,Sc=new Re,Ec=function(e){function t(t){var n;return(n=e.call(this,t)||this).panner=n.context.createPanner(),n.panner.panningModel="HRTF",n.panner.connect(n.gain),n}ue(t,e);var n=t.prototype;return n.getOutput=function(){return this.panner},n.getRefDistance=function(){return this.panner.refDistance},n.setRefDistance=function(e){return this.panner.refDistance=e,this},n.getRolloffFactor=function(){return this.panner.rolloffFactor},n.setRolloffFactor=function(e){return this.panner.rolloffFactor=e,this},n.getDistanceModel=function(){return this.panner.distanceModel},n.setDistanceModel=function(e){return this.panner.distanceModel=e,this},n.getMaxDistance=function(){return this.panner.maxDistance},n.setMaxDistance=function(e){return this.panner.maxDistance=e,this},n.setDirectionalCone=function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},n.updateMatrixWorld=function(t){if(e.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(yc,_c,bc),Sc.set(0,0,1).applyQuaternion(_c);var n=this.panner;if(n.positionX){var r=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(yc.x,r),n.positionY.linearRampToValueAtTime(yc.y,r),n.positionZ.linearRampToValueAtTime(yc.z,r),n.orientationX.linearRampToValueAtTime(Sc.x,r),n.orientationY.linearRampToValueAtTime(Sc.y,r),n.orientationZ.linearRampToValueAtTime(Sc.z,r)}else n.setPosition(yc.x,yc.y,yc.z),n.setOrientation(Sc.x,Sc.y,Sc.z)}},t}(vc),wc=function(){function e(e,t){void 0===t&&(t=2048),this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}var t=e.prototype;return t.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},t.getAverageFrequency=function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length},e}();function Ic(e,t,n){var r,i,o;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(Ic.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},accumulateAdditive:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){var s=t*this._origIndex;this._mixBufferRegion(n,r,s,1-i,t)}o>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var u=t,c=t+t;u!==c;++u)if(n[u]!==n[u+t]){a.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var i=n,o=r;i!==o;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_setAdditiveIdentityNumeric:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]},_select:function(e,t,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)e[t+o]=e[n+o]},_slerp:function(e,t,n,r){xe.slerpFlat(e,t,e,t,e,n,r)},_slerpAdditive:function(e,t,n,r,i){var o=this._workIndex*i;xe.multiplyQuaternionsFlat(e,o,e,t,e,n),xe.slerpFlat(e,t,e,t,e,o,r)},_lerp:function(e,t,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=t+a;e[s]=e[s]*o+e[n+a]*r}},_lerpAdditive:function(e,t,n,r,i){for(var o=0;o!==i;++o){var a=t+o;e[a]=e[a]+e[n+o]*r}}});var Tc="\\[\\]\\.:\\/",Oc=new RegExp("[\\[\\]\\.:\\/]","g"),xc="[^\\[\\]\\.:\\/]",Rc="[^"+Tc.replace("\\.","")+"]",Ac=/((?:WC+[\/:])*)/.source.replace("WC",xc),Lc=/(WCOD+)?/.source.replace("WCOD",Rc),Cc=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",xc),Nc=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",xc),Mc=new RegExp("^"+Ac+Lc+Cc+Nc+"$"),Pc=["material","materials","bones"];function $c(e,t,n){var r=n||kc.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function kc(e,t,n){this.path=t,this.parsedPath=n||kc.parseTrackName(t),this.node=kc.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Dc(){this.uuid=ve.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}Object.assign($c.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(kc,{Composite:$c,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new kc.Composite(e,t,n):new kc(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Oc,"")},parseTrackName:function(e){var t=Mc.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Pc.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;var o=e(i.children);if(o)return o}return null}(e.children);if(r)return r}return null}}),Object.assign(kc.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=kc.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var o=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[r];if(void 0!==s){var u=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]}else{var l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(kc.prototype,{_getValue_unbound:kc.prototype.getValue,_setValue_unbound:kc.prototype.setValue}),Object.assign(Dc.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,o=i.length,a=void 0,s=e.length,u=this.nCachedObjects_,c=0,l=arguments.length;c!==l;++c){var d=arguments[c],p=d.uuid,f=t[p];if(void 0===f){f=s++,t[p]=f,e.push(d);for(var h=0,g=o;h!==g;++h)i[h].push(new kc(d,n[h],r[h]))}else if(f<u){a=e[f];var m=--u,v=e[m];t[v.uuid]=f,e[f]=v,t[p]=m,e[m]=d;for(var y=0,_=o;y!==_;++y){var b=i[y],S=b[m],E=b[f];b[f]=S,void 0===E&&(E=new kc(d,n[y],r[y])),b[m]=E}}else e[f]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u},remove:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],u=s.uuid,c=t[u];if(void 0!==c&&c>=i){var l=i++,d=e[l];t[d.uuid]=c,e[c]=d,t[u]=l,e[l]=s;for(var p=0,f=r;p!==f;++p){var h=n[p],g=h[l],m=h[c];h[c]=g,h[l]=m}}}this.nCachedObjects_=i},uncache:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,o=e.length,a=0,s=arguments.length;a!==s;++a){var u=arguments[a],c=u.uuid,l=t[c];if(void 0!==l)if(delete t[c],l<i){var d=--i,p=e[d],f=--o,h=e[f];t[p.uuid]=l,e[l]=p,t[h.uuid]=d,e[d]=h,e.pop();for(var g=0,m=r;g!==m;++g){var v=n[g],y=v[d],_=v[f];v[l]=y,v[d]=_,v.pop()}}else{var b=--o,S=e[b];b>0&&(t[S.uuid]=l),e[l]=S,e.pop();for(var E=0,w=r;E!==w;++E){var I=n[E];I[l]=I[b],I.pop()}}}this.nCachedObjects_=i},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,u=s.length,c=this.nCachedObjects_,l=new Array(u);r=i.length,n[e]=r,o.push(e),a.push(t),i.push(l);for(var d=c,p=s.length;d!==p;++d){var f=s[d];l[d]=new kc(f,e,t)}return l},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}});var Uc=function(){function e(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=t.blendMode),this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;for(var i=t.tracks,o=i.length,a=new Array(o),s={endingStart:G,endingEnd:G},u=0;u!==o;++u){var c=i[u].createInterpolant(null);a[u]=c,c.settings=s}this._interpolantSettings=s,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var t=e.prototype;return t.play=function(){return this._mixer._activateAction(this),this},t.stop=function(){return this._mixer._deactivateAction(this),this.reset()},t.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},t.isRunning=function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},t.isScheduled=function(){return this._mixer._isActiveAction(this)},t.startAt=function(e){return this._startTime=e,this},t.setLoop=function(e,t){return this.loop=e,this.repetitions=t,this},t.setEffectiveWeight=function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},t.getEffectiveWeight=function(){return this._effectiveWeight},t.fadeIn=function(e){return this._scheduleFading(e,0,1)},t.fadeOut=function(e){return this._scheduleFading(e,1,0)},t.crossFadeFrom=function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,o=i/r,a=r/i;e.warp(1,o,t),this.warp(a,1,t)}return this},t.crossFadeTo=function(e,t,n){return e.crossFadeFrom(this,t,n)},t.stopFading=function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},t.setEffectiveTimeScale=function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},t.getEffectiveTimeScale=function(){return this._effectiveTimeScale},t.setDuration=function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},t.syncWith=function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},t.halt=function(e){return this.warp(this._effectiveTimeScale,0,e)},t.warp=function(e,t,n){var r=this._mixer,i=r.time,o=this.timeScale,a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,u=a.sampleValues;return s[0]=i,s[1]=i+n,u[0]=e/o,u[1]=t/o,this},t.stopWarping=function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},t.getMixer=function(){return this._mixer},t.getClip=function(){return this._clip},t.getRoot=function(){return this._localRoot||this._mixer._root},t._update=function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var o=(e-i)*n;if(o<0||0===n)return;this._startTime=null,t=n*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0){var u=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case W:for(var l=0,d=u.length;l!==d;++l)u[l].evaluate(a),c[l].accumulateAdditive(s);break;case z:default:for(var p=0,f=u.length;p!==f;++p)u[p].evaluate(a),c[p].accumulate(r,s)}}}else this._updateWeight(e)},t._updateWeight=function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t},t._updateTimeScale=function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},t._updateTime=function(e){var t=this._clip.duration,n=this.loop,r=this.time+e,i=this._loopCount,o=2202===n;if(0===e)return-1===i?r:o&&1==(1&i)?t-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){var a=Math.floor(r/t);r-=t*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&i))return t-r}return r},t._setEndings=function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=V,r.endingEnd=V):(r.endingStart=e?this.zeroSlopeAtStart?V:G:H,r.endingEnd=t?this.zeroSlopeAtEnd?V:G:H)},t._scheduleFading=function(e,t,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=t,a[1]=i+e,s[1]=n,this},e}();function jc(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}jc.prototype=Object.assign(Object.create(pe.prototype),{constructor:jc,_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,o=e._propertyBindings,a=e._interpolants,s=n.uuid,u=this._bindingsByRootAndName,c=u[s];void 0===c&&(c={},u[s]=c);for(var l=0;l!==i;++l){var d=r[l],p=d.name,f=c[p];if(void 0!==f)o[l]=f;else{if(void 0!==(f=o[l])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,p));continue}var h=t&&t._propertyBindings[l].binding.parsedPath;++(f=new Ic(kc.create(n,p,h),d.ValueTypeName,d.getValueSize())).referenceCount,this._addInactiveBinding(f,s,p),o[l]=f}a[l].resultBuffer=f.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,i=this._actionsByClip,o=i[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,u=s[s.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,i=this._bindings,o=r[t];void 0===o&&(o={},r[t]=o),o[n]=e,e._cacheIndex=i.length,i.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=t[t.length-1],u=e._cacheIndex;s._cacheIndex=u,t[u]=s,t.pop(),delete a[i],0===Object.keys(a).length&&delete o[r]},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new $s(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t,n){var r=t||this._root,i=r.uuid,o="string"==typeof e?Hs.findByName(r,e):e,a=null!==o?o.uuid:e,s=this._actionsByClip[a],u=null;if(void 0===n&&(n=null!==o?o.blendMode:z),void 0!==s){var c=s.actionByRoot[i];if(void 0!==c&&c.blendMode===n)return c;u=s.knownActions[0],null===o&&(o=u._clip)}if(null===o)return null;var l=new Uc(this,o,t,n);return this._bindAction(l,u),this._addInactiveAction(l,a,i),l},existingAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?Hs.findByName(n,e):e,o=i?i.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[r]||null},stopAllAction:function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1,a=0;a!==n;++a){t[a]._update(r,e,i,o)}for(var s=this._bindings,u=this._nActiveBindings,c=0;c!==u;++c)s[c].apply(o);return this},setTime:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var u=o[a];this._deactivateAction(u);var c=u._cacheIndex,l=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,l._cacheIndex=c,t[c]=l,t.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}});var Bc=function(){function e(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}return e.prototype.clone=function(){return new e(void 0===this.value.clone?this.value:this.value.clone())},e}();function Fc(e,t,n){mo.call(this,e,t),this.meshPerAttribute=n||1}function qc(e,t,n,r,i){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}function Gc(e,t,n,r){this.ray=new tt(e,t),this.near=n||0,this.far=r||1/0,this.camera=null,this.layers=new ft,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Vc(e,t){return e.distance-t.distance}function Hc(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,o=0,a=i.length;o<a;o++)Hc(i[o],t,n,!0)}Fc.prototype=Object.assign(Object.create(mo.prototype),{constructor:Fc,isInstancedInterleavedBuffer:!0,copy:function(e){return mo.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){var t=mo.prototype.clone.call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(e){var t=mo.prototype.toJSON.call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}),Object.defineProperty(qc.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(qc.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,t){return this.type=e,this.elementSize=t,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}}),Object.assign(Gc.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)},intersectObject:function(e,t,n){var r=n||[];return Hc(e,this,r,t),r.sort(Vc),r},intersectObjects:function(e,t,n){var r=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=e.length;i<o;i++)Hc(e[i],this,r,t);return r.sort(Vc),r}});var zc=function(){function e(e,t,n){return void 0===e&&(e=1),void 0===t&&(t=0),void 0===n&&(n=0),this.radius=e,this.phi=t,this.theta=n,this}var t=e.prototype;return t.set=function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},t.makeSafe=function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},t.setFromVector3=function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},t.setFromCartesianCoords=function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(ve.clamp(t/this.radius,-1,1))),this},e}(),Wc=function(){function e(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}var t=e.prototype;return t.set=function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},t.setFromVector3=function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},t.setFromCartesianCoords=function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this},e}(),Jc=new ye,Yc=function(){function e(e,t){Object.defineProperty(this,"isBox2",{value:!0}),this.min=void 0!==e?e:new ye(1/0,1/0),this.max=void 0!==t?t:new ye(-1/0,-1/0)}var t=e.prototype;return t.set=function(e,t){return this.min.copy(e),this.max.copy(t),this},t.setFromPoints=function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},t.setFromCenterAndSize=function(e,t){var n=Jc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.min.copy(e.min),this.max.copy(e.max),this},t.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},t.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},t.getCenter=function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new ye),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},t.getSize=function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new ye),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},t.expandByPoint=function(e){return this.min.min(e),this.max.max(e),this},t.expandByVector=function(e){return this.min.sub(e),this.max.add(e),this},t.expandByScalar=function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},t.containsPoint=function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},t.containsBox=function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},t.getParameter=function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new ye),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},t.intersectsBox=function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},t.clampPoint=function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new ye),t.copy(e).clamp(this.min,this.max)},t.distanceToPoint=function(e){return Jc.copy(e).clamp(this.min,this.max).sub(e).length()},t.intersect=function(e){return this.min.max(e.min),this.max.min(e.max),this},t.union=function(e){return this.min.min(e.min),this.max.max(e.max),this},t.translate=function(e){return this.min.add(e),this.max.add(e),this},t.equals=function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},e}(),Kc=new Re,Xc=new Re,Zc=function(){function e(e,t){this.start=void 0!==e?e:new Re,this.end=void 0!==t?t:new Re}var t=e.prototype;return t.set=function(e,t){return this.start.copy(e),this.end.copy(t),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.start.copy(e.start),this.end.copy(e.end),this},t.getCenter=function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Re),e.addVectors(this.start,this.end).multiplyScalar(.5)},t.delta=function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Re),e.subVectors(this.end,this.start)},t.distanceSq=function(){return this.start.distanceToSquared(this.end)},t.distance=function(){return this.start.distanceTo(this.end)},t.at=function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Re),this.delta(t).multiplyScalar(e).add(this.start)},t.closestPointToPointParameter=function(e,t){Kc.subVectors(e,this.start),Xc.subVectors(this.end,this.start);var n=Xc.dot(Xc),r=Xc.dot(Kc)/n;return t&&(r=ve.clamp(r,0,1)),r},t.closestPointToPoint=function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Re),this.delta(n).multiplyScalar(r).add(this.start)},t.applyMatrix4=function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},t.equals=function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},e}();function Qc(e){xt.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Qc.prototype=Object.create(xt.prototype),Qc.prototype.constructor=Qc,Qc.prototype.isImmediateRenderObject=!0;var el=new Re,tl=function(e){function t(t,n){var r;(r=e.call(this)||this).light=t,r.light.updateMatrixWorld(),r.matrix=t.matrixWorld,r.matrixAutoUpdate=!1,r.color=n;for(var i=new In,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],a=0,s=1;a<32;a++,s++){var u=a/32*Math.PI*2,c=s/32*Math.PI*2;o.push(Math.cos(u),Math.sin(u),1,Math.cos(c),Math.sin(c),1)}i.setAttribute("position",new pn(o,3));var l=new Qo({fog:!1,toneMapped:!1});return r.cone=new ua(i,l),r.add(r.cone),r.update(),r}ue(t,e);var n=t.prototype;return n.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},n.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),el.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(el),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},t}(xt),nl=new Re,rl=new nt,il=new nt,ol=function(e){function t(t){for(var n,r=al(t),i=new In,o=[],a=[],s=new Yt(0,0,1),u=new Yt(0,1,0),c=0;c<r.length;c++){var l=r[c];l.parent&&l.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),a.push(s.r,s.g,s.b),a.push(u.r,u.g,u.b))}i.setAttribute("position",new pn(o,3)),i.setAttribute("color",new pn(a,3));var d=new Qo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(n=e.call(this,i,d)||this).type="SkeletonHelper",n.isSkeletonHelper=!0,n.root=t,n.bones=r,n.matrix=t.matrixWorld,n.matrixAutoUpdate=!1,n}return ue(t,e),t.prototype.updateMatrixWorld=function(t){var n=this.bones,r=this.geometry,i=r.getAttribute("position");il.copy(this.root.matrixWorld).invert();for(var o=0,a=0;o<n.length;o++){var s=n[o];s.parent&&s.parent.isBone&&(rl.multiplyMatrices(il,s.matrixWorld),nl.setFromMatrixPosition(rl),i.setXYZ(a,nl.x,nl.y,nl.z),rl.multiplyMatrices(il,s.parent.matrixWorld),nl.setFromMatrixPosition(rl),i.setXYZ(a+1,nl.x,nl.y,nl.z),a+=2)}r.getAttribute("position").needsUpdate=!0,e.prototype.updateMatrixWorld.call(this,t)},t}(ua);function al(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,al(e.children[n]));return t}var sl=function(e){function t(t,n,r){var i,o=new fs(n,4,2),a=new Qt({wireframe:!0,fog:!1,toneMapped:!1});return(i=e.call(this,o,a)||this).light=t,i.light.updateMatrixWorld(),i.color=r,i.type="PointLightHelper",i.matrix=i.light.matrixWorld,i.matrixAutoUpdate=!1,i.update(),i}ue(t,e);var n=t.prototype;return n.dispose=function(){this.geometry.dispose(),this.material.dispose()},n.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},t}(qn),ul=new Re,cl=new Yt,ll=new Yt,dl=function(e){function t(t,n,r){var i;(i=e.call(this)||this).light=t,i.light.updateMatrixWorld(),i.matrix=t.matrixWorld,i.matrixAutoUpdate=!1,i.color=r;var o=new cs(n);o.rotateY(.5*Math.PI),i.material=new Qt({wireframe:!0,fog:!1,toneMapped:!1}),void 0===i.color&&(i.material.vertexColors=!0);var a=o.getAttribute("position"),s=new Float32Array(3*a.count);return o.setAttribute("color",new nn(s,3)),i.add(new qn(o,i.material)),i.update(),i}ue(t,e);var n=t.prototype;return n.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},n.update=function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");cl.copy(this.light.color),ll.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?cl:ll;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(ul.setFromMatrixPosition(this.light.matrixWorld).negate())},t}(xt),pl=function(e){function t(t,n,r,i){var o;void 0===t&&(t=10),void 0===n&&(n=10),void 0===r&&(r=4473924),void 0===i&&(i=8947848),r=new Yt(r),i=new Yt(i);for(var a=n/2,s=t/n,u=t/2,c=[],l=[],d=0,p=0,f=-u;d<=n;d++,f+=s){c.push(-u,0,f,u,0,f),c.push(f,0,-u,f,0,u);var h=d===a?r:i;h.toArray(l,p),p+=3,h.toArray(l,p),p+=3,h.toArray(l,p),p+=3,h.toArray(l,p),p+=3}var g=new In;g.setAttribute("position",new pn(c,3)),g.setAttribute("color",new pn(l,3));var m=new Qo({vertexColors:!0,toneMapped:!1});return(o=e.call(this,g,m)||this).type="GridHelper",o}return ue(t,e),t}(ua),fl=function(e){function t(t,n,r,i,o,a){var s;void 0===t&&(t=10),void 0===n&&(n=16),void 0===r&&(r=8),void 0===i&&(i=64),void 0===o&&(o=4473924),void 0===a&&(a=8947848),o=new Yt(o),a=new Yt(a);for(var u=[],c=[],l=0;l<=n;l++){var d=l/n*(2*Math.PI),p=Math.sin(d)*t,f=Math.cos(d)*t;u.push(0,0,0),u.push(p,0,f);var h=1&l?o:a;c.push(h.r,h.g,h.b),c.push(h.r,h.g,h.b)}for(var g=0;g<=r;g++)for(var m=1&g?o:a,v=t-t/r*g,y=0;y<i;y++){var _=y/i*(2*Math.PI),b=Math.sin(_)*v,S=Math.cos(_)*v;u.push(b,0,S),c.push(m.r,m.g,m.b),_=(y+1)/i*(2*Math.PI),b=Math.sin(_)*v,S=Math.cos(_)*v,u.push(b,0,S),c.push(m.r,m.g,m.b)}var E=new In;E.setAttribute("position",new pn(u,3)),E.setAttribute("color",new pn(c,3));var w=new Qo({vertexColors:!0,toneMapped:!1});return(s=e.call(this,E,w)||this).type="PolarGridHelper",s}return ue(t,e),t}(ua),hl=new Re,gl=new Re,ml=new Re,vl=function(e){function t(t,n,r){var i;(i=e.call(this)||this).light=t,i.light.updateMatrixWorld(),i.matrix=t.matrixWorld,i.matrixAutoUpdate=!1,i.color=r,void 0===n&&(n=1);var o=new In;o.setAttribute("position",new pn([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));var a=new Qo({fog:!1,toneMapped:!1});return i.lightPlane=new oa(o,a),i.add(i.lightPlane),(o=new In).setAttribute("position",new pn([0,0,0,0,0,1],3)),i.targetLine=new oa(o,a),i.add(i.targetLine),i.update(),i}ue(t,e);var n=t.prototype;return n.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},n.update=function(){hl.setFromMatrixPosition(this.light.matrixWorld),gl.setFromMatrixPosition(this.light.target.matrixWorld),ml.subVectors(gl,hl),this.lightPlane.lookAt(gl),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(gl),this.targetLine.scale.z=ml.length()},t}(xt),yl=new Re,_l=new Yn,bl=function(e){function t(t){var n,r=new In,i=new Qo({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],a=[],s={},u=new Yt(16755200),c=new Yt(16711680),l=new Yt(43775),d=new Yt(16777215),p=new Yt(3355443);function f(e,t,n){h(e,n),h(t,n)}function h(e,t){o.push(0,0,0),a.push(t.r,t.g,t.b),void 0===s[e]&&(s[e]=[]),s[e].push(o.length/3-1)}return f("n1","n2",u),f("n2","n4",u),f("n4","n3",u),f("n3","n1",u),f("f1","f2",u),f("f2","f4",u),f("f4","f3",u),f("f3","f1",u),f("n1","f1",u),f("n2","f2",u),f("n3","f3",u),f("n4","f4",u),f("p","n1",c),f("p","n2",c),f("p","n3",c),f("p","n4",c),f("u1","u2",l),f("u2","u3",l),f("u3","u1",l),f("c","t",d),f("p","c",p),f("cn1","cn2",p),f("cn3","cn4",p),f("cf1","cf2",p),f("cf3","cf4",p),r.setAttribute("position",new pn(o,3)),r.setAttribute("color",new pn(a,3)),(n=e.call(this,r,i)||this).type="CameraHelper",n.camera=t,n.camera.updateProjectionMatrix&&n.camera.updateProjectionMatrix(),n.matrix=t.matrixWorld,n.matrixAutoUpdate=!1,n.pointMap=s,n.update(),n}return ue(t,e),t.prototype.update=function(){var e=this.geometry,t=this.pointMap;_l.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Sl("c",t,e,_l,0,0,-1),Sl("t",t,e,_l,0,0,1),Sl("n1",t,e,_l,-1,-1,-1),Sl("n2",t,e,_l,1,-1,-1),Sl("n3",t,e,_l,-1,1,-1),Sl("n4",t,e,_l,1,1,-1),Sl("f1",t,e,_l,-1,-1,1),Sl("f2",t,e,_l,1,-1,1),Sl("f3",t,e,_l,-1,1,1),Sl("f4",t,e,_l,1,1,1),Sl("u1",t,e,_l,.7,1.1,-1),Sl("u2",t,e,_l,-.7,1.1,-1),Sl("u3",t,e,_l,0,2,-1),Sl("cf1",t,e,_l,-1,0,1),Sl("cf2",t,e,_l,1,0,1),Sl("cf3",t,e,_l,0,-1,1),Sl("cf4",t,e,_l,0,1,1),Sl("cn1",t,e,_l,-1,0,-1),Sl("cn2",t,e,_l,1,0,-1),Sl("cn3",t,e,_l,0,-1,-1),Sl("cn4",t,e,_l,0,1,-1),e.getAttribute("position").needsUpdate=!0},t}(ua);function Sl(e,t,n,r,i,o,a){yl.set(i,o,a).unproject(r);var s=t[e];if(void 0!==s)for(var u=n.getAttribute("position"),c=0,l=s.length;c<l;c++)u.setXYZ(s[c],yl.x,yl.y,yl.z)}var El,wl,Il,Tl=new Ce,Ol=function(e){function t(t,n){var r;void 0===n&&(n=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(24),a=new In;return a.setIndex(new nn(i,1)),a.setAttribute("position",new nn(o,3)),(r=e.call(this,a,new Qo({color:n,toneMapped:!1}))||this).object=t,r.type="BoxHelper",r.matrixAutoUpdate=!1,r.update(),r}ue(t,e);var n=t.prototype;return n.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Tl.setFromObject(this.object),!Tl.isEmpty()){var t=Tl.min,n=Tl.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}},n.setFromObject=function(e){return this.object=e,this.update(),this},n.copy=function(e){return ua.prototype.copy.call(this,e),this.object=e.object,this},t}(ua),xl=function(e){function t(t,n){var r;void 0===n&&(n=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new In;return o.setIndex(new nn(i,1)),o.setAttribute("position",new pn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),(r=e.call(this,o,new Qo({color:n,toneMapped:!1}))||this).box=t,r.type="Box3Helper",r.geometry.computeBoundingSphere(),r}return ue(t,e),t.prototype.updateMatrixWorld=function(t){var n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),e.prototype.updateMatrixWorld.call(this,t))},t}(ua),Rl=function(e){function t(t,n,r){var i;void 0===n&&(n=1),void 0===r&&(r=16776960);var o=r,a=new In;a.setAttribute("position",new pn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),a.computeBoundingSphere(),(i=e.call(this,a,new Qo({color:o,toneMapped:!1}))||this).type="PlaneHelper",i.plane=t,i.size=n;var s=new In;return s.setAttribute("position",new pn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),s.computeBoundingSphere(),i.add(new qn(s,new Qt({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),i}return ue(t,e),t.prototype.updateMatrixWorld=function(t){var n=-this.plane.constant;Math.abs(n)<1e-8&&(n=1e-8),this.scale.set(.5*this.size,.5*this.size,n),this.children[0].material.side=n<0?1:0,this.lookAt(this.plane.normal),e.prototype.updateMatrixWorld.call(this,t)},t}(oa),Al=new Re,Ll=function(e){function t(t,n,r,i,o,a){var s;return(s=e.call(this)||this).type="ArrowHelper",void 0===t&&(t=new Re(0,0,1)),void 0===n&&(n=new Re(0,0,0)),void 0===r&&(r=1),void 0===i&&(i=16776960),void 0===o&&(o=.2*r),void 0===a&&(a=.2*o),void 0===El&&((El=new In).setAttribute("position",new pn([0,0,0,0,1,0],3)),(wl=new Ea(0,.5,1,5,1)).translate(0,-.5,0)),s.position.copy(n),s.line=new oa(El,new Qo({color:i,toneMapped:!1})),s.line.matrixAutoUpdate=!1,s.add(s.line),s.cone=new qn(wl,new Qt({color:i,toneMapped:!1})),s.cone.matrixAutoUpdate=!1,s.add(s.cone),s.setDirection(t),s.setLength(r,o,a),s}ue(t,e);var n=t.prototype;return n.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Al.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Al,t)}},n.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},n.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},n.copy=function(t){return e.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},t}(xt),Cl=function(e){function t(t){var n;void 0===t&&(t=1);var r=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],i=new In;i.setAttribute("position",new pn(r,3)),i.setAttribute("color",new pn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var o=new Qo({vertexColors:!0,toneMapped:!1});return(n=e.call(this,i,o)||this).type="AxesHelper",n}return ue(t,e),t}(ua),Nl=new Float32Array(1),Ml=new Int32Array(Nl.buffer),Pl={toHalfFloat:function(e){Nl[0]=e;var t=Ml[0],n=t>>16&32768,r=t>>12&2047,i=t>>23&255;return i<103?n:i>142?(n|=31744,n|=(255==i?0:1)&&8388607&t):i<113?n|=((r|=2048)>>114-i)+(r>>113-i&1):(n|=i-112<<10|r>>1,n+=1&r)}},$l=Math.pow(2,8),kl=[.125,.215,.35,.446,.526,.582],Dl=5+kl.length,Ul=20,jl=((Il={})[3e3]=0,Il[3001]=1,Il[3002]=2,Il[3004]=3,Il[3005]=4,Il[3006]=5,Il[3007]=6,Il),Bl=new Qt({side:1,depthWrite:!1,depthTest:!1}),Fl=new qn(new Vn,Bl),ql=new $u,Gl=td(),Vl=Gl._lodPlanes,Hl=Gl._sizeLods,zl=Gl._sigmas,Wl=new Yt,Jl=null,Yl=(1+Math.sqrt(5))/2,Kl=1/Yl,Xl=[new Re(1,1,1),new Re(-1,1,1),new Re(1,1,-1),new Re(-1,1,-1),new Re(0,Yl,Kl),new Re(0,Yl,-Kl),new Re(Kl,0,Yl),new Re(-Kl,0,Yl),new Re(Yl,Kl,0),new Re(-Yl,Kl,0)];function Zl(e){var t=Math.max(e.r,e.g,e.b),n=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);return e.multiplyScalar(Math.pow(2,-n)),(n+128)/255}var Ql=function(){function e(e){var t,n,r;this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=(t=Ul,n=new Float32Array(t),r=new Re(0,1,0),new Es({name:"SphericalGaussianBlur",defines:{n:t},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r},inputEncoding:{value:jl[3e3]},outputEncoding:{value:jl[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var t=e.prototype;return t.fromScene=function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=.1),void 0===r&&(r=100),Jl=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i},t.fromEquirectangular=function(e){return this._fromTexture(e)},t.fromCubemap=function(e){return this._fromTexture(e)},t.compileCubemapShader=function(){null===this._cubemapShader&&(this._cubemapShader=od(),this._compileMaterial(this._cubemapShader))},t.compileEquirectangularShader=function(){null===this._equirectShader&&(this._equirectShader=id(),this._compileMaterial(this._equirectShader))},t.dispose=function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var e=0;e<Vl.length;e++)Vl[e].dispose()},t._cleanup=function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Jl),e.scissorTest=!1,rd(e,0,0,e.width,e.height)},t._fromTexture=function(e){Jl=this._renderer.getRenderTarget();var t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t},t._allocateTargets=function(e){var t={magFilter:h,minFilter:h,generateMipmaps:!1,type:b,format:1023,encoding:ed(e)?e.encoding:X,depthBuffer:!1},n=nd(t);return n.depthBuffer=!e,this._pingPongRenderTarget=nd(t),n},t._compileMaterial=function(e){var t=new qn(Vl[0],e);this._renderer.compile(t,ql)},t._sceneToCubeUV=function(e,t,n,r){var i=new Kn(90,1,t,n),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],s=this._renderer,u=s.autoClear,c=s.outputEncoding,l=s.toneMapping;s.getClearColor(Wl),s.toneMapping=0,s.outputEncoding=J,s.autoClear=!1;var d=!1,p=e.background;if(p){if(p.isColor){Bl.color.copy(p).convertSRGBToLinear(),e.background=null;var f=Zl(Bl.color);Bl.opacity=f,d=!0}}else{Bl.color.copy(Wl).convertSRGBToLinear();var h=Zl(Bl.color);Bl.opacity=h,d=!0}for(var g=0;g<6;g++){var m=g%3;0==m?(i.up.set(0,o[g],0),i.lookAt(a[g],0,0)):1==m?(i.up.set(0,0,o[g]),i.lookAt(0,a[g],0)):(i.up.set(0,o[g],0),i.lookAt(0,0,a[g])),rd(r,m*$l,g>2?$l:0,$l,$l),s.setRenderTarget(r),d&&s.render(Fl,i),s.render(e,i)}s.toneMapping=l,s.outputEncoding=c,s.autoClear=u},t._textureToCubeUV=function(e,t){var n=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=od()):null==this._equirectShader&&(this._equirectShader=id());var r=e.isCubeTexture?this._cubemapShader:this._equirectShader,i=new qn(Vl[0],r),o=r.uniforms;o.envMap.value=e,e.isCubeTexture||o.texelSize.value.set(1/e.image.width,1/e.image.height),o.inputEncoding.value=jl[e.encoding],o.outputEncoding.value=jl[t.texture.encoding],rd(t,0,0,3*$l,2*$l),n.setRenderTarget(t),n.render(i,ql)},t._applyPMREM=function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<Dl;r++){var i=Math.sqrt(zl[r]*zl[r]-zl[r-1]*zl[r-1]),o=Xl[(r-1)%Xl.length];this._blur(e,r-1,r,i,o)}t.autoClear=n},t._blur=function(e,t,n,r,i){var o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",i),this._halfBlur(o,e,n,n,r,"longitudinal",i)},t._halfBlur=function(e,t,n,r,i,o,a){var s=this._renderer,u=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");var c=new qn(Vl[r],u),l=u.uniforms,d=Hl[n]-1,p=isFinite(i)?Math.PI/(2*d):2*Math.PI/39,f=i/p,h=isFinite(i)?1+Math.floor(3*f):Ul;h>Ul&&console.warn("sigmaRadians, "+i+", is too large and will clip, as it requested "+h+" samples when the maximum is set to "+Ul);for(var g=[],m=0,v=0;v<Ul;++v){var y=v/f,_=Math.exp(-y*y/2);g.push(_),0==v?m+=_:v<h&&(m+=2*_)}for(var b=0;b<g.length;b++)g[b]=g[b]/m;l.envMap.value=e.texture,l.samples.value=h,l.weights.value=g,l.latitudinal.value="latitudinal"===o,a&&(l.poleAxis.value=a),l.dTheta.value=p,l.mipInt.value=8-n,l.inputEncoding.value=jl[e.texture.encoding],l.outputEncoding.value=jl[e.texture.encoding];var S=Hl[r];rd(t,3*Math.max(0,$l-2*S),(0===r?0:2*$l)+2*S*(r>4?r-8+4:0),3*S,2*S),s.setRenderTarget(t),s.render(c,ql)},e}();function ed(e){return void 0!==e&&e.type===b&&(e.encoding===J||e.encoding===Y||e.encoding===K)}function td(){for(var e=[],t=[],n=[],r=8,i=0;i<Dl;i++){var o=Math.pow(2,r);t.push(o);var a=1/o;i>4?a=kl[i-8+4-1]:0==i&&(a=0),n.push(a);for(var s=1/(o-1),u=-s/2,c=1+s/2,l=[u,u,c,u,c,c,u,u,c,c,u,c],d=new Float32Array(108),p=new Float32Array(72),f=new Float32Array(36),h=0;h<6;h++){var g=h%3*2/3-1,m=h>2?0:-1,v=[g,m,0,g+2/3,m,0,g+2/3,m+1,0,g,m,0,g+2/3,m+1,0,g,m+1,0];d.set(v,18*h),p.set(l,12*h);var y=[h,h,h,h,h,h];f.set(y,6*h)}var _=new In;_.setAttribute("position",new nn(d,3)),_.setAttribute("uv",new nn(p,2)),_.setAttribute("faceIndex",new nn(f,1)),e.push(_),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function nd(e){var t=new Te(3*$l,3*$l,e);return t.texture.mapping=c,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function rd(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function id(){return new Es({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new ye(1,1)},inputEncoding:{value:jl[3e3]},outputEncoding:{value:jl[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function od(){return new Es({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:jl[3e3]},outputEncoding:{value:jl[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function ad(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),fu.call(this,e),this.type="catmullrom",this.closed=!0}function sd(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),fu.call(this,e),this.type="catmullrom"}function ud(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),fu.call(this,e),this.type="catmullrom"}ou.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(ou.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(Ou.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),ad.prototype=Object.create(fu.prototype),sd.prototype=Object.create(fu.prototype),ud.prototype=Object.create(fu.prototype),Object.assign(ud.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),pl.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},ol.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Ks.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Gu.extractUrlBase(e)}}),Ks.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(Yc.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Ce.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(We.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),ir.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},Zc.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(ve,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ve.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ve.ceilPowerOfTwo(e)}}),Object.assign(_e.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()}}),Object.assign(nt.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Re).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,o)},getInverse:function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()}}),Ct.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Object.assign(xe.prototype,{multiplyVector3:function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}}),Object.assign(tt.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(qt.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(qt,{barycoordFromPoint:function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),qt.getBarycoord(e,t,n,r,i)},normal:function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),qt.getNormal(e,t,n,r)}}),Object.assign(xu.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new os(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ps(this,e)}}),Object.assign(ye.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Re.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ie.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(xt.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(xt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(qn.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(qn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Do.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Wo.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Go.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(ou.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Kn.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Ru.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(nn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===re},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(re)}}}),Object.assign(nn.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?re:ne),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(In.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new nn(arguments[1],arguments[2])))},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(In.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Vu.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(Gc.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(mo.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===re},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(mo.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?re:ne),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(os.prototype,{getArrays:function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")}}),Object.assign(go.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(Bc.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Zt.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Yt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(Ts.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Is.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(Jn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(lo.prototype,{clearTarget:function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(lo.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?Y:J}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(to.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Te.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(vc.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new ic).load(e,(function(e){t.setBuffer(e)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),wc.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Zn.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Zn.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)};var cd={merge:function(e,t,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,t=t.geometry),e.merge(t,r,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};be.crossOrigin=void 0,be.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new iu;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},be.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new nu;i.setCrossOrigin(this.crossOrigin);var o=i.load(e,n,void 0,r);return t&&(o.mapping=t),o},be.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},be.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var ld={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:n}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=n),e.ACESFilmicToneMapping=4,e.AddEquation=r,e.AddOperation=2,e.AdditiveAnimationBlendMode=W,e.AdditiveBlending=2,e.AlphaFormat=1021,e.AlwaysDepth=1,e.AlwaysStencilFunc=519,e.AmbientLight=Uu,e.AmbientLightProbe=ac,e.AnimationClip=Hs,e.AnimationLoader=Qs,e.AnimationMixer=jc,e.AnimationObjectGroup=Dc,e.AnimationUtils=Ns,e.ArcCurve=su,e.ArrayCamera=oo,e.ArrowHelper=Ll,e.Audio=vc,e.AudioAnalyser=wc,e.AudioContext=rc,e.AudioListener=mc,e.AudioLoader=ic,e.AxesHelper=Cl,e.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Cl(e)},e.BackSide=1,e.BasicDepthPacking=3200,e.BasicShadowMap=0,e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new ru(e)},e.Bone=Vo,e.BooleanKeyframeTrack=Us,e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Ol(e,t)},e.Box2=Yc,e.Box3=Ce,e.Box3Helper=xl,e.BoxBufferGeometry=Vn,e.BoxGeometry=Vn,e.BoxHelper=Ol,e.BufferAttribute=nn,e.BufferGeometry=In,e.BufferGeometryLoader=zu,e.ByteType=1010,e.Cache=Ws,e.Camera=Yn,e.CameraHelper=bl,e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},e.CanvasTexture=_a,e.CatmullRomCurve3=fu,e.CineonToneMapping=3,e.CircleBufferGeometry=Sa,e.CircleGeometry=Sa,e.ClampToEdgeWrapping=p,e.Clock=lc,e.ClosedSplineCurve3=ad,e.Color=Yt,e.ColorKeyframeTrack=js,e.CompressedTexture=ya,e.CompressedTextureLoader=eu,e.ConeBufferGeometry=wa,e.ConeGeometry=wa,e.CubeCamera=Zn,e.CubeReflectionMapping=o,e.CubeRefractionMapping=a,e.CubeTexture=Qn,e.CubeTextureLoader=nu,e.CubeUVReflectionMapping=c,e.CubeUVRefractionMapping=l,e.CubicBezierCurve=vu,e.CubicBezierCurve3=yu,e.CubicInterpolant=Ps,e.CullFaceBack=1,e.CullFaceFront=2,e.CullFaceFrontBack=3,e.CullFaceNone=0,e.Curve=ou,e.CurvePath=Tu,e.CustomBlending=5,e.CustomToneMapping=5,e.CylinderBufferGeometry=Ea,e.CylinderGeometry=Ea,e.Cylindrical=Wc,e.DataTexture=tr,e.DataTexture2DArray=Tr,e.DataTexture3D=Or,e.DataTextureLoader=ru,e.DataUtils=Pl,e.DecrementStencilOp=7683,e.DecrementWrapStencilOp=34056,e.DefaultLoadingManager=Ys,e.DepthFormat=R,e.DepthStencilFormat=A,e.DepthTexture=ba,e.DirectionalLight=Du,e.DirectionalLightHelper=vl,e.DiscreteInterpolant=ks,e.DodecahedronBufferGeometry=Ta,e.DodecahedronGeometry=Ta,e.DoubleSide=2,e.DstAlphaFactor=206,e.DstColorFactor=208,e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new nn(e,t).setUsage(re)},e.DynamicCopyUsage=35050,e.DynamicDrawUsage=re,e.DynamicReadUsage=35049,e.EdgesGeometry=La,e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ua(new La(e.geometry),new Qo({color:void 0!==t?t:16777215}))},e.EllipseCurve=au,e.EqualDepth=4,e.EqualStencilFunc=514,e.EquirectangularReflectionMapping=s,e.EquirectangularRefractionMapping=u,e.Euler=lt,e.EventDispatcher=pe,e.ExtrudeBufferGeometry=os,e.ExtrudeGeometry=os,e.Face3=Kt,e.Face4=function(e,t,n,r,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Kt(e,t,n,i,o,a)},e.FaceColors=1,e.FileLoader=Zs,e.FlatShading=1,e.Float16BufferAttribute=dn,e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new pn(e,t)},e.Float32BufferAttribute=pn,e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new fn(e,t)},e.Float64BufferAttribute=fn,e.FloatType=w,e.Fog=ho,e.FogExp2=fo,e.Font=ec,e.FontLoader=nc,e.FrontSide=0,e.Frustum=ir,e.GLBufferAttribute=qc,e.GLSL1="100",e.GLSL3=ie,e.GammaEncoding=K,e.GeometryUtils=cd,e.GreaterDepth=6,e.GreaterEqualDepth=5,e.GreaterEqualStencilFunc=518,e.GreaterStencilFunc=516,e.GridHelper=pl,e.Group=ao,e.HalfFloatType=I,e.HemisphereLight=Au,e.HemisphereLightHelper=dl,e.HemisphereLightProbe=oc,e.IcosahedronBufferGeometry=ss,e.IcosahedronGeometry=ss,e.ImageBitmapLoader=Xu,e.ImageLoader=tu,e.ImageUtils=be,e.ImmediateRenderObject=Qc,e.IncrementStencilOp=7682,e.IncrementWrapStencilOp=34055,e.InstancedBufferAttribute=Hu,e.InstancedBufferGeometry=Vu,e.InstancedInterleavedBuffer=Fc,e.InstancedMesh=Zo,e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new sn(e,t)},e.Int16BufferAttribute=sn,e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new cn(e,t)},e.Int32BufferAttribute=cn,e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new rn(e,t)},e.Int8BufferAttribute=rn,e.IntType=1013,e.InterleavedBuffer=mo,e.InterleavedBufferAttribute=_o,e.Interpolant=Ms,e.InterpolateDiscrete=B,e.InterpolateLinear=F,e.InterpolateSmooth=q,e.InvertStencilOp=5386,e.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},e.KeepStencilOp=te,e.KeyframeTrack=Ds,e.LOD=Do,e.LatheBufferGeometry=us,e.LatheGeometry=us,e.Layers=ft,e.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},e.LessDepth=2,e.LessEqualDepth=3,e.LessEqualStencilFunc=515,e.LessStencilFunc=513,e.Light=Ru,e.LightProbe=Fu,e.Line=oa,e.Line3=Zc,e.LineBasicMaterial=Qo,e.LineCurve=_u,e.LineCurve3=bu,e.LineDashedMaterial=Ls,e.LineLoop=ca,e.LinePieces=1,e.LineSegments=ua,e.LineStrip=0,e.LinearEncoding=J,e.LinearFilter=v,e.LinearInterpolant=$s,e.LinearMipMapLinearFilter=1008,e.LinearMipMapNearestFilter=1007,e.LinearMipmapLinearFilter=_,e.LinearMipmapNearestFilter=y,e.LinearToneMapping=1,e.Loader=Ks,e.LoaderUtils=Gu,e.LoadingManager=Js,e.LogLuvEncoding=3003,e.LoopOnce=2200,e.LoopPingPong=2202,e.LoopRepeat=2201,e.LuminanceAlphaFormat=1025,e.LuminanceFormat=1024,e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},e.Material=Zt,e.MaterialLoader=qu,e.Math=ve,e.MathUtils=ve,e.Matrix3=_e,e.Matrix4=nt,e.MaxEquation=104,e.Mesh=qn,e.MeshBasicMaterial=Qt,e.MeshDepthMaterial=Qi,e.MeshDistanceMaterial=eo,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MeshLambertMaterial=Rs,e.MeshMatcapMaterial=As,e.MeshNormalMaterial=xs,e.MeshPhongMaterial=Ts,e.MeshPhysicalMaterial=Is,e.MeshStandardMaterial=ws,e.MeshToonMaterial=Os,e.MinEquation=103,e.MirroredRepeatWrapping=f,e.MixOperation=1,e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},e.MultiplyBlending=4,e.MultiplyOperation=0,e.NearestFilter=h,e.NearestMipMapLinearFilter=1005,e.NearestMipMapNearestFilter=1004,e.NearestMipmapLinearFilter=m,e.NearestMipmapNearestFilter=g,e.NeverDepth=0,e.NeverStencilFunc=512,e.NoBlending=0,e.NoColors=0,e.NoToneMapping=0,e.NormalAnimationBlendMode=z,e.NormalBlending=1,e.NotEqualDepth=7,e.NotEqualStencilFunc=517,e.NumberKeyframeTrack=Bs,e.Object3D=xt,e.ObjectLoader=Wu,e.ObjectSpaceNormalMap=1,e.OctahedronBufferGeometry=cs,e.OctahedronGeometry=cs,e.OneFactor=201,e.OneMinusDstAlphaFactor=207,e.OneMinusDstColorFactor=209,e.OneMinusSrcAlphaFactor=205,e.OneMinusSrcColorFactor=203,e.OrthographicCamera=$u,e.PCFShadowMap=1,e.PCFSoftShadowMap=2,e.PMREMGenerator=Ql,e.ParametricBufferGeometry=ls,e.ParametricGeometry=ls,e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Mo(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new la(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new ga(e,t)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new la(e)},e.Path=Ou,e.PerspectiveCamera=Kn,e.Plane=Ct,e.PlaneBufferGeometry=sr,e.PlaneGeometry=sr,e.PlaneHelper=Rl,e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new ga(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new la(e)},e.PointLight=Pu,e.PointLightHelper=sl,e.Points=ga,e.PointsMaterial=la,e.PolarGridHelper=fl,e.PolyhedronBufferGeometry=Ia,e.PolyhedronGeometry=Ia,e.PositionalAudio=Ec,e.PropertyBinding=kc,e.PropertyMixer=Ic,e.QuadraticBezierCurve=Su,e.QuadraticBezierCurve3=Eu,e.Quaternion=xe,e.QuaternionKeyframeTrack=qs,e.QuaternionLinearInterpolant=Fs,e.REVISION=n,e.RGBADepthPacking=3201,e.RGBAFormat=x,e.RGBAIntegerFormat=1033,e.RGBA_ASTC_10x10_Format=37819,e.RGBA_ASTC_10x5_Format=37816,e.RGBA_ASTC_10x6_Format=37817,e.RGBA_ASTC_10x8_Format=37818,e.RGBA_ASTC_12x10_Format=37820,e.RGBA_ASTC_12x12_Format=37821,e.RGBA_ASTC_4x4_Format=37808,e.RGBA_ASTC_5x4_Format=37809,e.RGBA_ASTC_5x5_Format=37810,e.RGBA_ASTC_6x5_Format=37811,e.RGBA_ASTC_6x6_Format=37812,e.RGBA_ASTC_8x5_Format=37813,e.RGBA_ASTC_8x6_Format=37814,e.RGBA_ASTC_8x8_Format=37815,e.RGBA_BPTC_Format=36492,e.RGBA_ETC2_EAC_Format=j,e.RGBA_PVRTC_2BPPV1_Format=D,e.RGBA_PVRTC_4BPPV1_Format=k,e.RGBA_S3TC_DXT1_Format=C,e.RGBA_S3TC_DXT3_Format=N,e.RGBA_S3TC_DXT5_Format=M,e.RGBDEncoding=ee,e.RGBEEncoding=X,e.RGBEFormat=1023,e.RGBFormat=O,e.RGBIntegerFormat=1032,e.RGBM16Encoding=Q,e.RGBM7Encoding=Z,e.RGB_ETC1_Format=36196,e.RGB_ETC2_Format=U,e.RGB_PVRTC_2BPPV1_Format=$,e.RGB_PVRTC_4BPPV1_Format=P,e.RGB_S3TC_DXT1_Format=L,e.RGFormat=1030,e.RGIntegerFormat=1031,e.RawShaderMaterial=Es,e.Ray=tt,e.Raycaster=Gc,e.RectAreaLight=ju,e.RedFormat=1028,e.RedIntegerFormat=1029,e.ReinhardToneMapping=2,e.RepeatWrapping=d,e.ReplaceStencilOp=7681,e.ReverseSubtractEquation=102,e.RingBufferGeometry=ds,e.RingGeometry=ds,e.SRGB8_ALPHA8_ASTC_10x10_Format=37851,e.SRGB8_ALPHA8_ASTC_10x5_Format=37848,e.SRGB8_ALPHA8_ASTC_10x6_Format=37849,e.SRGB8_ALPHA8_ASTC_10x8_Format=37850,e.SRGB8_ALPHA8_ASTC_12x10_Format=37852,e.SRGB8_ALPHA8_ASTC_12x12_Format=37853,e.SRGB8_ALPHA8_ASTC_4x4_Format=37840,e.SRGB8_ALPHA8_ASTC_5x4_Format=37841,e.SRGB8_ALPHA8_ASTC_5x5_Format=37842,e.SRGB8_ALPHA8_ASTC_6x5_Format=37843,e.SRGB8_ALPHA8_ASTC_6x6_Format=37844,e.SRGB8_ALPHA8_ASTC_8x5_Format=37845,e.SRGB8_ALPHA8_ASTC_8x6_Format=37846,e.SRGB8_ALPHA8_ASTC_8x8_Format=37847,e.Scene=go,e.SceneUtils=ld,e.ShaderChunk=ur,e.ShaderLib=lr,e.ShaderMaterial=Jn,e.ShadowMaterial=Ss,e.Shape=xu,e.ShapeBufferGeometry=ps,e.ShapeGeometry=ps,e.ShapePath=Zu,e.ShapeUtils=ns,e.ShortType=1011,e.Skeleton=Wo,e.SkeletonHelper=ol,e.SkinnedMesh=Go,e.SmoothShading=2,e.Sphere=We,e.SphereBufferGeometry=fs,e.SphereGeometry=fs,e.Spherical=zc,e.SphericalHarmonics3=Bu,e.Spline=ud,e.SplineCurve=wu,e.SplineCurve3=sd,e.SpotLight=Nu,e.SpotLightHelper=tl,e.Sprite=Mo,e.SpriteMaterial=bo,e.SrcAlphaFactor=204,e.SrcAlphaSaturateFactor=210,e.SrcColorFactor=202,e.StaticCopyUsage=35046,e.StaticDrawUsage=ne,e.StaticReadUsage=35045,e.StereoCamera=cc,e.StreamCopyUsage=35042,e.StreamDrawUsage=35040,e.StreamReadUsage=35041,e.StringKeyframeTrack=Gs,e.SubtractEquation=101,e.SubtractiveBlending=3,e.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},e.TangentSpaceNormalMap=0,e.TetrahedronBufferGeometry=hs,e.TetrahedronGeometry=hs,e.TextBufferGeometry=gs,e.TextGeometry=gs,e.Texture=Ee,e.TextureLoader=iu,e.TorusBufferGeometry=ms,e.TorusGeometry=ms,e.TorusKnotBufferGeometry=vs,e.TorusKnotGeometry=vs,e.Triangle=qt,e.TriangleFanDrawMode=2,e.TriangleStripDrawMode=1,e.TrianglesDrawMode=0,e.TubeBufferGeometry=ys,e.TubeGeometry=ys,e.UVMapping=i,e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new un(e,t)},e.Uint16BufferAttribute=un,e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new ln(e,t)},e.Uint32BufferAttribute=ln,e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new on(e,t)},e.Uint8BufferAttribute=on,e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new an(e,t)},e.Uint8ClampedBufferAttribute=an,e.Uniform=Bc,e.UniformsLib=cr,e.UniformsUtils=Wn,e.UnsignedByteType=b,e.UnsignedInt248Type=T,e.UnsignedIntType=E,e.UnsignedShort4444Type=1017,e.UnsignedShort5551Type=1018,e.UnsignedShort565Type=1019,e.UnsignedShortType=S,e.VSMShadowMap=3,e.Vector2=ye,e.Vector3=Re,e.Vector4=Ie,e.VectorKeyframeTrack=Vs,e.Vertex=function(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Re(e,t,n)},e.VertexColors=2,e.VideoTexture=va,e.WebGL1Renderer=po,e.WebGLCubeRenderTarget=er,e.WebGLMultisampleRenderTarget=Oe,e.WebGLRenderTarget=Te,e.WebGLRenderTargetCube=function(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new er(e,n)},e.WebGLRenderer=lo,e.WebGLUtils=io,e.WireframeGeometry=_s,e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ua(new _s(e.geometry),new Qo({color:void 0!==t?t:16777215}))},e.WrapAroundEnding=H,e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Zs(e)},e.ZeroCurvatureEnding=G,e.ZeroFactor=200,e.ZeroSlopeEnding=V,e.ZeroStencilOp=0,e.sRGBEncoding=Y,Object.defineProperty(e,"__esModule",{value:!0})})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.QRious=t()}(this,(function(){"use strict";var e=function(){},t=Object.prototype.hasOwnProperty,n=Array.prototype.slice;function r(e,r,i){for(var o,a,s=0,u=(i=n.call(arguments,2)).length;s<u;s++)for(o in a=i[s])e&&!t.call(a,o)||(r[o]=a[o])}var i=function(t,n,i,o){var a=this;return"string"!=typeof t&&(o=i,i=n,n=t,t=null),"function"!=typeof n&&(o=i,i=n,n=function(){return a.apply(this,arguments)}),r(!1,n,a,o),n.prototype=function(t,n){var i;return"function"==typeof Object.create?i=Object.create(t):(e.prototype=t,i=new e,e.prototype=null),n&&r(!0,i,n),i}(a.prototype,i),n.prototype.constructor=n,n.class_=t||a.class_,n.super_=a,n};function o(){}o.class_="Nevis",o.super_=Object,o.extend=i;var a=o,s=a.extend((function(e,t,n){this.qrious=e,this.element=t,this.element.qrious=e,this.enabled=Boolean(n)}),{draw:function(e){},getElement:function(){return this.enabled||(this.enabled=!0,this.render()),this.element},getModuleSize:function(e){var t=this.qrious,n=t.padding||0,r=Math.floor((t.size-2*n)/e.width);return Math.max(1,r)},getOffset:function(e){var t=this.qrious,n=t.padding;if(null!=n)return n;var r=this.getModuleSize(e),i=Math.floor((t.size-r*e.width)/2);return Math.max(0,i)},render:function(e){this.enabled&&(this.resize(),this.reset(),this.draw(e))},reset:function(){},resize:function(){}}),u=s.extend({draw:function(e){var t,n,r=this.qrious,i=this.getModuleSize(e),o=this.getOffset(e),a=this.element.getContext("2d");for(a.fillStyle=r.foreground,a.globalAlpha=r.foregroundAlpha,t=0;t<e.width;t++)for(n=0;n<e.width;n++)e.buffer[n*e.width+t]&&a.fillRect(i*t+o,i*n+o,i,i)},reset:function(){var e=this.qrious,t=this.element.getContext("2d"),n=e.size;t.lineWidth=1,t.clearRect(0,0,n,n),t.fillStyle=e.background,t.globalAlpha=e.backgroundAlpha,t.fillRect(0,0,n,n)},resize:function(){var e=this.element;e.width=e.height=this.qrious.size}}),c=a.extend(null,{BLOCK:[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28]}),l=a.extend(null,{BLOCKS:[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],FINAL_FORMAT:[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],LEVELS:{L:1,M:2,Q:3,H:4}}),d=a.extend(null,{EXPONENT:[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],LOG:[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175]}),p=a.extend(null,{BLOCK:[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177]}),f=a.extend((function(e){var t,n,r,i,o,a=e.value.length;for(this._badness=[],this._level=l.LEVELS[e.level],this._polynomial=[],this._value=e.value,this._version=0,this._stringBuffer=[];this._version<40&&(this._version++,r=4*(this._level-1)+16*(this._version-1),i=l.BLOCKS[r++],o=l.BLOCKS[r++],t=l.BLOCKS[r++],n=l.BLOCKS[r],!(a<=(r=t*(i+o)+o-3+(this._version<=9)))););this._dataBlock=t,this._eccBlock=n,this._neccBlock1=i,this._neccBlock2=o;var s=this.width=17+4*this._version;this.buffer=f._createArray(s*s),this._ecc=f._createArray(t+(t+n)*(i+o)+o),this._mask=f._createArray((s*(s+1)+1)/2),this._insertFinders(),this._insertAlignments(),this.buffer[8+s*(s-8)]=1,this._insertTimingGap(),this._reverseMask(),this._insertTimingRowAndColumn(),this._insertVersion(),this._syncMask(),this._convertBitStream(a),this._calculatePolynomial(),this._appendEccToData(),this._interleaveBlocks(),this._pack(),this._finish()}),{_addAlignment:function(e,t){var n,r=this.buffer,i=this.width;for(r[e+i*t]=1,n=-2;n<2;n++)r[e+n+i*(t-2)]=1,r[e-2+i*(t+n+1)]=1,r[e+2+i*(t+n)]=1,r[e+n+1+i*(t+2)]=1;for(n=0;n<2;n++)this._setMask(e-1,t+n),this._setMask(e+1,t-n),this._setMask(e-n,t-1),this._setMask(e+n,t+1)},_appendData:function(e,t,n,r){var i,o,a,s=this._polynomial,u=this._stringBuffer;for(o=0;o<r;o++)u[n+o]=0;for(o=0;o<t;o++){if(255!==(i=d.LOG[u[e+o]^u[n]]))for(a=1;a<r;a++)u[n+a-1]=u[n+a]^d.EXPONENT[f._modN(i+s[r-a])];else for(a=n;a<n+r;a++)u[a]=u[a+1];u[n+r-1]=255===i?0:d.EXPONENT[f._modN(i+s[0])]}},_appendEccToData:function(){var e,t=0,n=this._dataBlock,r=this._calculateMaxLength(),i=this._eccBlock;for(e=0;e<this._neccBlock1;e++)this._appendData(t,n,r,i),t+=n,r+=i;for(e=0;e<this._neccBlock2;e++)this._appendData(t,n+1,r,i),t+=n+1,r+=i},_applyMask:function(e){var t,n,r,i,o=this.buffer,a=this.width;switch(e){case 0:for(i=0;i<a;i++)for(r=0;r<a;r++)r+i&1||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 1:for(i=0;i<a;i++)for(r=0;r<a;r++)1&i||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 2:for(i=0;i<a;i++)for(t=0,r=0;r<a;r++,t++)3===t&&(t=0),t||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 3:for(n=0,i=0;i<a;i++,n++)for(3===n&&(n=0),t=n,r=0;r<a;r++,t++)3===t&&(t=0),t||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 4:for(i=0;i<a;i++)for(t=0,n=i>>1&1,r=0;r<a;r++,t++)3===t&&(t=0,n=!n),n||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 5:for(n=0,i=0;i<a;i++,n++)for(3===n&&(n=0),t=0,r=0;r<a;r++,t++)3===t&&(t=0),(r&i&1)+!(!t|!n)||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 6:for(n=0,i=0;i<a;i++,n++)for(3===n&&(n=0),t=0,r=0;r<a;r++,t++)3===t&&(t=0),(r&i&1)+(t&&t===n)&1||this._isMasked(r,i)||(o[r+i*a]^=1);break;case 7:for(n=0,i=0;i<a;i++,n++)for(3===n&&(n=0),t=0,r=0;r<a;r++,t++)3===t&&(t=0),(t&&t===n)+(r+i&1)&1||this._isMasked(r,i)||(o[r+i*a]^=1)}},_calculateMaxLength:function(){return this._dataBlock*(this._neccBlock1+this._neccBlock2)+this._neccBlock2},_calculatePolynomial:function(){var e,t,n=this._eccBlock,r=this._polynomial;for(r[0]=1,e=0;e<n;e++){for(r[e+1]=1,t=e;t>0;t--)r[t]=r[t]?r[t-1]^d.EXPONENT[f._modN(d.LOG[r[t]]+e)]:r[t-1];r[0]=d.EXPONENT[f._modN(d.LOG[r[0]]+e)]}for(e=0;e<=n;e++)r[e]=d.LOG[r[e]]},_checkBadness:function(){var e,t,n,r,i,o=0,a=this._badness,s=this.buffer,u=this.width;for(i=0;i<u-1;i++)for(r=0;r<u-1;r++)(s[r+u*i]&&s[r+1+u*i]&&s[r+u*(i+1)]&&s[r+1+u*(i+1)]||!(s[r+u*i]||s[r+1+u*i]||s[r+u*(i+1)]||s[r+1+u*(i+1)]))&&(o+=f.N2);var c=0;for(i=0;i<u;i++){for(n=0,a[0]=0,e=0,r=0;r<u;r++)e===(t=s[r+u*i])?a[n]++:a[++n]=1,c+=(e=t)?1:-1;o+=this._getBadness(n)}c<0&&(c=-c);var l=0,d=c;for(d+=d<<2,d<<=1;d>u*u;)d-=u*u,l++;for(o+=l*f.N4,r=0;r<u;r++){for(n=0,a[0]=0,e=0,i=0;i<u;i++)e===(t=s[r+u*i])?a[n]++:a[++n]=1,e=t;o+=this._getBadness(n)}return o},_convertBitStream:function(e){var t,n,r=this._ecc,i=this._version;for(n=0;n<e;n++)r[n]=this._value.charCodeAt(n);var o=this._stringBuffer=r.slice(),a=this._calculateMaxLength();e>=a-2&&(e=a-2,i>9&&e--);var s=e;if(i>9){for(o[s+2]=0,o[s+3]=0;s--;)t=o[s],o[s+3]|=255&t<<4,o[s+2]=t>>4;o[2]|=255&e<<4,o[1]=e>>4,o[0]=64|e>>12}else{for(o[s+1]=0,o[s+2]=0;s--;)t=o[s],o[s+2]|=255&t<<4,o[s+1]=t>>4;o[1]|=255&e<<4,o[0]=64|e>>4}for(s=e+3-(i<10);s<a;)o[s++]=236,o[s++]=17},_getBadness:function(e){var t,n=0,r=this._badness;for(t=0;t<=e;t++)r[t]>=5&&(n+=f.N1+r[t]-5);for(t=3;t<e-1;t+=2)r[t-2]===r[t+2]&&r[t+2]===r[t-1]&&r[t-1]===r[t+1]&&3*r[t-1]===r[t]&&(0===r[t-3]||t+3>e||3*r[t-3]>=4*r[t]||3*r[t+3]>=4*r[t])&&(n+=f.N3);return n},_finish:function(){var e,t;this._stringBuffer=this.buffer.slice();var n=0,r=3e4;for(t=0;t<8&&(this._applyMask(t),(e=this._checkBadness())<r&&(r=e,n=t),7!==n);t++)this.buffer=this._stringBuffer.slice();n!==t&&this._applyMask(n),r=l.FINAL_FORMAT[n+(this._level-1<<3)];var i=this.buffer,o=this.width;for(t=0;t<8;t++,r>>=1)1&r&&(i[o-1-t+8*o]=1,t<6?i[8+o*t]=1:i[8+o*(t+1)]=1);for(t=0;t<7;t++,r>>=1)1&r&&(i[8+o*(o-7+t)]=1,t?i[6-t+8*o]=1:i[7+8*o]=1)},_interleaveBlocks:function(){var e,t,n=this._dataBlock,r=this._ecc,i=this._eccBlock,o=0,a=this._calculateMaxLength(),s=this._neccBlock1,u=this._neccBlock2,c=this._stringBuffer;for(e=0;e<n;e++){for(t=0;t<s;t++)r[o++]=c[e+t*n];for(t=0;t<u;t++)r[o++]=c[s*n+e+t*(n+1)]}for(t=0;t<u;t++)r[o++]=c[s*n+e+t*(n+1)];for(e=0;e<i;e++)for(t=0;t<s+u;t++)r[o++]=c[a+e+t*i];this._stringBuffer=r},_insertAlignments:function(){var e,t,n,r=this._version,i=this.width;if(r>1)for(e=c.BLOCK[r],n=i-7;;){for(t=i-7;t>e-3&&(this._addAlignment(t,n),!(t<e));)t-=e;if(n<=e+9)break;n-=e,this._addAlignment(6,n),this._addAlignment(n,6)}},_insertFinders:function(){var e,t,n,r,i=this.buffer,o=this.width;for(e=0;e<3;e++){for(t=0,r=0,1===e&&(t=o-7),2===e&&(r=o-7),i[r+3+o*(t+3)]=1,n=0;n<6;n++)i[r+n+o*t]=1,i[r+o*(t+n+1)]=1,i[r+6+o*(t+n)]=1,i[r+n+1+o*(t+6)]=1;for(n=1;n<5;n++)this._setMask(r+n,t+1),this._setMask(r+1,t+n+1),this._setMask(r+5,t+n),this._setMask(r+n+1,t+5);for(n=2;n<4;n++)i[r+n+o*(t+2)]=1,i[r+2+o*(t+n+1)]=1,i[r+4+o*(t+n)]=1,i[r+n+1+o*(t+4)]=1}},_insertTimingGap:function(){var e,t,n=this.width;for(t=0;t<7;t++)this._setMask(7,t),this._setMask(n-8,t),this._setMask(7,t+n-7);for(e=0;e<8;e++)this._setMask(e,7),this._setMask(e+n-8,7),this._setMask(e,n-8)},_insertTimingRowAndColumn:function(){var e,t=this.buffer,n=this.width;for(e=0;e<n-14;e++)1&e?(this._setMask(8+e,6),this._setMask(6,8+e)):(t[8+e+6*n]=1,t[6+n*(8+e)]=1)},_insertVersion:function(){var e,t,n,r,i=this.buffer,o=this._version,a=this.width;if(o>6)for(e=p.BLOCK[o-7],t=17,n=0;n<6;n++)for(r=0;r<3;r++,t--)1&(t>11?o>>t-12:e>>t)?(i[5-n+a*(2-r+a-11)]=1,i[2-r+a-11+a*(5-n)]=1):(this._setMask(5-n,2-r+a-11),this._setMask(2-r+a-11,5-n))},_isMasked:function(e,t){var n=f._getMaskBit(e,t);return 1===this._mask[n]},_pack:function(){var e,t,n,r=1,i=1,o=this.width,a=o-1,s=o-1,u=(this._dataBlock+this._eccBlock)*(this._neccBlock1+this._neccBlock2)+this._neccBlock2;for(t=0;t<u;t++)for(e=this._stringBuffer[t],n=0;n<8;n++,e<<=1){128&e&&(this.buffer[a+o*s]=1);do{i?a--:(a++,r?0!==s?s--:(r=!r,6===(a-=2)&&(a--,s=9)):s!==o-1?s++:(r=!r,6===(a-=2)&&(a--,s-=8))),i=!i}while(this._isMasked(a,s))}},_reverseMask:function(){var e,t,n=this.width;for(e=0;e<9;e++)this._setMask(e,8);for(e=0;e<8;e++)this._setMask(e+n-8,8),this._setMask(8,e);for(t=0;t<7;t++)this._setMask(8,t+n-7)},_setMask:function(e,t){var n=f._getMaskBit(e,t);this._mask[n]=1},_syncMask:function(){var e,t,n=this.width;for(t=0;t<n;t++)for(e=0;e<=t;e++)this.buffer[e+n*t]&&this._setMask(e,t)}},{_createArray:function(e){var t,n=[];for(t=0;t<e;t++)n[t]=0;return n},_getMaskBit:function(e,t){var n;return e>t&&(n=e,e=t,t=n),n=t,n+=t*t,n>>=1,n+=e},_modN:function(e){for(;e>=255;)e=((e-=255)>>8)+(255&e);return e},N1:3,N2:3,N3:40,N4:10}),h=f,g=s.extend({draw:function(){this.element.src=this.qrious.toDataURL()},reset:function(){this.element.src=""},resize:function(){var e=this.element;e.width=e.height=this.qrious.size}}),m=a.extend((function(e,t,n,r){this.name=e,this.modifiable=Boolean(t),this.defaultValue=n,this._valueTransformer=r}),{transform:function(e){var t=this._valueTransformer;return"function"==typeof t?t(e,this):e}}),v=a.extend(null,{abs:function(e){return null!=e?Math.abs(e):null},hasOwn:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},noop:function(){},toUpperCase:function(e){return null!=e?e.toUpperCase():null}}),y=a.extend((function(e){this.options={},e.forEach((function(e){this.options[e.name]=e}),this)}),{exists:function(e){return null!=this.options[e]},get:function(e,t){return y._get(this.options[e],t)},getAll:function(e){var t,n=this.options,r={};for(t in n)v.hasOwn(n,t)&&(r[t]=y._get(n[t],e));return r},init:function(e,t,n){var r,i;for(r in"function"!=typeof n&&(n=v.noop),this.options)v.hasOwn(this.options,r)&&(i=this.options[r],y._set(i,i.defaultValue,t),y._createAccessor(i,t,n));this._setAll(e,t,!0)},set:function(e,t,n){return this._set(e,t,n)},setAll:function(e,t){return this._setAll(e,t)},_set:function(e,t,n,r){var i=this.options[e];if(!i)throw new Error("Invalid option: "+e);if(!i.modifiable&&!r)throw new Error("Option cannot be modified: "+e);return y._set(i,t,n)},_setAll:function(e,t,n){if(!e)return!1;var r,i=!1;for(r in e)v.hasOwn(e,r)&&this._set(r,e[r],t,n)&&(i=!0);return i}},{_createAccessor:function(e,t,n){var r={get:function(){return y._get(e,t)}};e.modifiable&&(r.set=function(r){y._set(e,r,t)&&n(r,e)}),Object.defineProperty(t,e.name,r)},_get:function(e,t){return t["_"+e.name]},_set:function(e,t,n){var r="_"+e.name,i=n[r],o=e.transform(null!=t?t:e.defaultValue);return n[r]=o,o!==i}}),_=y,b=a.extend((function(){this._services={}}),{getService:function(e){var t=this._services[e];if(!t)throw new Error("Service is not being managed with name: "+e);return t},setService:function(e,t){if(this._services[e])throw new Error("Service is already managed with name: "+e);t&&(this._services[e]=t)}}),S=new _([new m("background",!0,"white"),new m("backgroundAlpha",!0,1,v.abs),new m("element"),new m("foreground",!0,"black"),new m("foregroundAlpha",!0,1,v.abs),new m("level",!0,"L",v.toUpperCase),new m("mime",!0,"image/png"),new m("padding",!0,null,v.abs),new m("size",!0,100,v.abs),new m("value",!0,"")]),E=new b,w=a.extend((function(e){S.init(e,this,this.update.bind(this));var t=S.get("element",this),n=E.getService("element"),r=t&&n.isCanvas(t)?t:n.createCanvas(),i=t&&n.isImage(t)?t:n.createImage();this._canvasRenderer=new u(this,r,!0),this._imageRenderer=new g(this,i,i===t),this.update()}),{get:function(){return S.getAll(this)},set:function(e){S.setAll(e,this)&&this.update()},toDataURL:function(e){return this.canvas.toDataURL(e||this.mime)},update:function(){var e=new h({level:this.level,value:this.value});this._canvasRenderer.render(e),this._imageRenderer.render(e)}},{use:function(e){E.setService(e.getName(),e)}});Object.defineProperties(w.prototype,{canvas:{get:function(){return this._canvasRenderer.getElement()}},image:{get:function(){return this._imageRenderer.getElement()}}});var I=w,T=a.extend({getName:function(){}}).extend({createCanvas:function(){},createImage:function(){},getName:function(){return"element"},isCanvas:function(e){},isImage:function(e){}}).extend({createCanvas:function(){return document.createElement("canvas")},createImage:function(){return document.createElement("img")},isCanvas:function(e){return e instanceof HTMLCanvasElement},isImage:function(e){return e instanceof HTMLImageElement}});return I.use(new T),I}));
//# sourceMappingURL=vendors.min.js.map